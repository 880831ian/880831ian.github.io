<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PIN-YI â€“ Google Cloud Platform</title><link>https://pin-yi.me/blog/gcp/</link><description>Recent content in Google Cloud Platform on PIN-YI</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><atom:link href="https://pin-yi.me/blog/gcp/index.xml" rel="self" type="application/rss+xml"/><item><title>GCP Memorystore HA é«˜å¯ç”¨æ€§ failover æ¸¬è©¦</title><link>https://pin-yi.me/blog/gcp/gcp-memorystore-failover/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/gcp-memorystore-failover/</guid><description>
&lt;p>æ­¤æ–‡ç« ä¸»è¦é‡å° GCP Memorystore failover ä¾†åšæ¸¬è©¦ï¼Œæ¸¬è©¦ Memorystore é«˜å¯ç”¨æ€§ (HA) åœ¨æ¨™æº– Standard Tier failover æ•…éšœè½‰ç§»éœ€è¦å¤šä¹…ï¼Œä»¥åŠä¸åŒ replica æ¢ä»¶ä¸‹è½‰ç§»æ˜¯å¦æœƒæœ‰å·®ç•°ç­‰ç­‰ã€‚&lt;/p>
&lt;br>
&lt;h2>æ–‡ä»¶èªªæ˜&lt;span class="absolute -mt-20" id="æ–‡ä»¶èªªæ˜">&lt;/span>
&lt;a href="#%e6%96%87%e4%bb%b6%e8%aa%aa%e6%98%8e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é¦–å…ˆæˆ‘å€‘å¯ä»¥å…ˆé–±è®€ &lt;a href="https://cloud.google.com/memorystore/docs/redis/faq" target="_blank" rel="noopener">Google Memorystore for Redis FAQ&lt;/a> æ–‡ç« ï¼Œå¯ä»¥å¾—çŸ¥ Standard Tier åœ¨ failover è½‰ç§»ï¼Œå¤§ç´„æœƒèŠ± 30 ç§’å·¦å³ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/1.png"
alt="Google Memorystore for Redis FAQ" width="400">&lt;figcaption>
&lt;p>Google Memorystore for Redis FAQ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘ä¹Ÿå¯ä»¥å¾ &lt;a href="https://cloud.google.com/memorystore/docs/redis/high-availability-for-memorystore-for-redis#when_a_failover_is_triggered" target="_blank" rel="noopener">High availability for Memorystore for Redis&lt;/a> æ–‡ç« ä¸­çŸ¥é“ï¼Œç•¶ Primary è³‡æ–™åº«ç™¼ç”Ÿæ•…éšœæ™‚ï¼Œå°±æœƒç™¼ç”Ÿæ•…éšœè½‰ç§»ã€‚åœ¨è½‰ç§»æœŸé–“ï¼ŒPrimary Endpoint å’Œ Read Endpoint æœƒè‡ªå‹•é‡æ–°å°å‘æ–°çš„ Primary è³‡æ–™åº« å’Œ Replicaã€‚&lt;b>é€™æ™‚å€™ Primary Endpoint å’Œ Read Endpoint é€£ç·šéƒ½æœƒè¢«åˆªé™¤&lt;/b>ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/2.png"
alt="when a failover is triggered" width="700">&lt;figcaption>
&lt;p>when a failover is triggered&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å› æ¬¡æœƒå°è‡´æœ‰å¹¾ç§’é˜é€£ä¸åˆ° Redisã€‚é‡æ–°é€£æ¥æ™‚ï¼Œå°‡ä½¿ç”¨åŸæœ¬çš„ IP ä½å€å³å¯è‡ªå‹•é‡æ–°å®šå‘åˆ°æ–°çš„æœå‹™ä¸Šã€‚æ•…éšœè½‰ç§»å¾Œï¼Œä¸éœ€è¦èª¿æ•´é€£ç·šè¨­å®šã€‚&lt;/p>
&lt;br>
&lt;p>æ¥ä¸‹ä¾†æˆ‘å€‘ä¾†å¯¦éš›æ¸¬è©¦çœ‹çœ‹ï¼Œæˆ‘å€‘åˆ†æˆå…©å€‹æ¸¬è©¦çµ„ï¼Œåˆ†åˆ¥ç‚ºï¼š1m1sã€1m2s çš„æ–¹å¼ï¼Œä¾†çœ‹çœ‹æ•…éšœè½‰ç§»æ™‚ï¼Œéœ€è¦èŠ±å¤šä¹…ï¼Œé‚„æœ‰ä¸åŒ Replica æ¢ä»¶ä¸‹æœƒä¸æœƒæœ‰å·®ç•°ã€‚&lt;/p>
&lt;h2>å¯¦ä½œæ¸¬è©¦ (1m1s)&lt;span class="absolute -mt-20" id="å¯¦ä½œæ¸¬è©¦-1m1s">&lt;/span>
&lt;a href="#%e5%af%a6%e4%bd%9c%e6%b8%ac%e8%a9%a6-1m1s" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å¯ä»¥åªç”¨ä¹‹å‰ &lt;a href="../../terraform/" >IaC&lt;/a> æ–‡ç« ä¾†å»ºç«‹ï¼Œæˆ–æ˜¯ç”¨ UI ä¾†å»ºç«‹ Memorystoreï¼Œé€™é‚Šç”¨ IaC ä¾†ç¤ºç¯„ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-terragrunt.hcl" data-lang="terragrunt.hcl">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> source &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;${get_path_to_repo_root()}/modules/memorystore&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">include&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">find_in_parent_folders&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputs &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ian-1m1s&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> memory_size_gb &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> region &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;asia-east1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> network &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;bbin-XXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> replica_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> redis_version &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;REDIS_6_X&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> redis_configs &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;#34;maxmemory-policy&amp;#34; &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;allkeys-lru&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é€™é‚Š memorystore module é è¨­æ˜¯ Standard Tierï¼Œå¦å¤–å°æé†’ï¼Œå¦‚æœè¦ä½¿ç”¨ Replica memory_size_gb æœ€å°å¿…é ˆæ˜¯ 5Gã€‚&lt;/p>
&lt;br>
&lt;h3>è¨­å®šç›£æ§&lt;span class="absolute -mt-20" id="è¨­å®šç›£æ§">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a%e7%9b%a3%e6%8e%a7" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å»ºç«‹å®Œæˆå¾Œï¼Œæˆ‘å€‘ä¹Ÿå…ˆæŠŠç›£æ§çµ¦æ‹‰å‡ºä¾†ï¼Œè¨­å®šå¯ä»¥åƒè€ƒ &lt;a href="https://cloud.google.com/memorystore/docs/redis/about-manual-failover#stackdriver_verification" target="_blank" rel="noopener">About manual failover&lt;/a>ï¼Œä¸»è¦æ˜¯é¸æ“‡ &lt;b>Cloud Memorystore Redis &amp;gt; replication &amp;gt; Node role&lt;/b>&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/3.png"
alt="ç›£æ§åœ–è¡¨" width="850">&lt;figcaption>
&lt;p>ç›£æ§åœ–è¡¨&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ° node-0 è·Ÿ node-1ï¼Œæ•¸å­— 1 ä»£è¡¨ Primary (node-0)ã€æ•¸å­— 0 ä»£è¡¨ Replica (node-1)&lt;/p>
&lt;br>
&lt;h3>æŸ¥çœ‹ describe&lt;span class="absolute -mt-20" id="æŸ¥çœ‹-describe">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b-describe" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘ä¹Ÿå¯ä»¥ä¸‹æŒ‡ä»¤æŸ¥çœ‹ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>gcloud redis instances describe ian-1m1s --region&lt;span style="color:#f92672">=&lt;/span>asia-east1 --project&lt;span style="color:#f92672">={&lt;/span>project_id&lt;span style="color:#f92672">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/4.png"
alt="describe ç•«é¢" width="650">&lt;figcaption>
&lt;p>describe ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ° &lt;b>currentLocationId&lt;/b> ä»£è¡¨ç¾åœ¨ Primary (node-0) asia-east1-aï¼Œ&lt;b>locationId&lt;/b> ä»£è¡¨æœ€åˆé…ç½® Primary å€åŸŸï¼Œ&lt;b>alternativeLocationId&lt;/b> å‰‡æ˜¯æœ€åˆé…ç½® Replica çš„å€åŸŸï¼Œå› æ­¤æˆ‘å€‘ä¹Ÿå¯ä»¥åœ¨æ•…éšœè½‰ç§»å¾Œï¼Œä¾†æŸ¥çœ‹å€åŸŸæ˜¯å¦è®ŠåŒ–ã€‚è©³ç´°å¯ä»¥åƒè€ƒï¼š&lt;a href="https://cloud.google.com/memorystore/docs/redis/about-manual-failover#gcloud_verification" target="_blank" rel="noopener">gcloud verification&lt;/a>&lt;/p>
&lt;br>
&lt;p>æ¥è‘—æˆ‘å€‘å¯ä»¥åƒè€ƒ &lt;a href="https://cloud.google.com/memorystore/docs/redis/initiate-manual-failover" target="_blank" rel="noopener">Initiate a manual failover&lt;/a> æ–‡ç« ï¼Œæ‰‹å‹•ä¾†è§¸ç™¼ failoverï¼Œé€™é‚Šæé†’ä¸€ä¸‹ æ‰‹å‹• failover æœ‰åˆ†å…©ç¨®è³‡æ–™ä¿è­·æ¨¡å¼ï¼šlimited-data-lossã€force-data-lossï¼Œè©³ç´°è«‹çœ‹ &lt;a href="https://cloud.google.com/memorystore/docs/redis/initiate-manual-failover#optional_data_protection_mode" target="_blank" rel="noopener">Optional data protection mode&lt;/a>ï¼Œé€™é‚Šæ¸¬è©¦å°±ä¸è¨è«–å…©ç¨®ä¿è­·æ¨¡å¼ï¼Œéƒ½ä½¿ç”¨é è¨­çš„ limited-data-loss ä¾†æ¸¬è©¦ã€‚&lt;/p>
&lt;br>
&lt;h3>å¯« shell æ¸¬è©¦ redis é€£ç·š&lt;span class="absolute -mt-20" id="å¯«-shell-æ¸¬è©¦-redis-é€£ç·š">&lt;/span>
&lt;a href="#%e5%af%ab-shell-%e6%b8%ac%e8%a9%a6-redis-%e9%80%a3%e7%b7%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å¦å¤–ï¼Œæˆ‘å€‘åœ¨å¯«ä¸€å€‹ shell åˆ° GKE è£¡é¢ (ç”¨åŒ VPC æ‰“) æ‰“ Memorystore Redis çš„ Primary Endpoint ä»¥åŠ Read Endpointï¼Œçœ‹çœ‹ç•¶ failover æ˜¯ä¸æ˜¯æœƒæœ‰é€£ä¸ä¸Šçš„å•é¡Œ ï½&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">apiVersion&lt;/span>: &lt;span style="color:#ae81ff">v1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">kind&lt;/span>: &lt;span style="color:#ae81ff">Pod&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">metadata&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">redis-test&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">namespace&lt;/span>: &lt;span style="color:#ae81ff">default&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">spec&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">initContainers&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">copy-scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">busybox&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;sh&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;-c&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;cp /config/redis.sh /scripts/ &amp;amp;&amp;amp; chmod +x /scripts/redis.sh&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumeMounts&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">config-volume&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mountPath&lt;/span>: &lt;span style="color:#ae81ff">/config&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mountPath&lt;/span>: &lt;span style="color:#ae81ff">/scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">containers&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">redis-cli&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">redis:alpine&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;sh&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;-c&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;while true; do /scripts/redis.sh; sleep 1; done&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">READ_PRIMARY_HOST&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">value&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;172.18.0.69&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">READ_REPLICA_HOST&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">value&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;172.18.0.68&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">REDIS_PASSWORD&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">value&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;XXXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumeMounts&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mountPath&lt;/span>: &lt;span style="color:#ae81ff">/scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">workingDir&lt;/span>: &lt;span style="color:#ae81ff">/scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">config-volume&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">configMap&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">redis-scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">emptyDir&lt;/span>: {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">apiVersion&lt;/span>: &lt;span style="color:#ae81ff">v1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">kind&lt;/span>: &lt;span style="color:#ae81ff">ConfigMap&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">metadata&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">redis-scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">namespace&lt;/span>: &lt;span style="color:#ae81ff">default&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">data&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">redis.sh&lt;/span>: |&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> #!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> ## é¡è‰²è¨­å®š
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> GREEN=&amp;#34;\033[1;32m&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> RED=&amp;#34;\033[1;31m&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> NC=&amp;#34;\033[0m&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> READ_PRIMARY_HOST=${READ_PRIMARY_HOST}
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> READ_REPLICA_HOST=${READ_REPLICA_HOST}
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> READ_REPLICA_PORT=6379
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> REDIS_PASSWORD=${REDIS_PASSWORD}
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> while true; do
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> TIMESTAMP=$(TZ=&amp;#34;Asia/Taipei&amp;#34; date +&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> PRIMARY_OUTPUT=$(timeout 1 redis-cli -h $READ_PRIMARY_HOST -p $READ_REPLICA_PORT -a $REDIS_PASSWORD --no-auth-warning PING) 1&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> if [ $? -eq 0 ]; then
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> echo -e &amp;#34;[$TIMESTAMP] PRIMARY PING ${GREEN}SUCCESS${NC}ï¼š&amp;#34; &amp;#34;$PRIMARY_OUTPUT&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> else
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> echo -e &amp;#34;[$TIMESTAMP] PRIMARY PING ${RED}FAILED${NC}&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> fi
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> REPLICA_OUTPUT=$(timeout 1 redis-cli -h $READ_REPLICA_HOST -p $READ_REPLICA_PORT -a $REDIS_PASSWORD --no-auth-warning PING) 1&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> if [ $? -eq 0 ]; then
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> echo -e &amp;#34;[$TIMESTAMP] REPLICA PING ${GREEN}SUCCESS${NC}ï¼š&amp;#34; &amp;#34;$REPLICA_OUTPUT&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> else
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> echo -e &amp;#34;[$TIMESTAMP] REPLICA PING ${RED}FAILED${NC}&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> fi
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> sleep 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> done&lt;/span> &lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>é–‹å§‹æ‰‹å‹•è§¸ç™¼ failover&lt;span class="absolute -mt-20" id="é–‹å§‹æ‰‹å‹•è§¸ç™¼-failover">&lt;/span>
&lt;a href="#%e9%96%8b%e5%a7%8b%e6%89%8b%e5%8b%95%e8%a7%b8%e7%99%bc-failover" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘æº–å‚™å¥½ç›£æ§ä»¥åŠä¹Ÿå…ˆçœ‹å¥½ describe å¾Œï¼Œå°±å¯ä»¥ä¸‹æŒ‡ä»¤ä¾†æ‰‹å‹•è§¸ç™¼ failoverï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>gcloud redis instances failover ian-1m1s --data-protection-mode&lt;span style="color:#f92672">=&lt;/span>limited-data-loss --region&lt;span style="color:#f92672">=&lt;/span>asia-east1 --project&lt;span style="color:#f92672">={&lt;/span>project_id&lt;span style="color:#f92672">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°ç›®å‰ ian-1m1s å°±é–‹å§‹ Failing over äº†ï½&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/5.png"
alt="memorystore UI ç•«é¢" width="350">&lt;figcaption>
&lt;p>memorystore UI ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>å¾ŒçºŒè§€å¯Ÿ&lt;span class="absolute -mt-20" id="å¾ŒçºŒè§€å¯Ÿ">&lt;/span>
&lt;a href="#%e5%be%8c%e7%ba%8c%e8%a7%80%e5%af%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>æŸ¥çœ‹ç›£æ§&lt;span class="absolute -mt-20" id="æŸ¥çœ‹ç›£æ§">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b%e7%9b%a3%e6%8e%a7" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é¦–å…ˆæˆ‘å€‘å…ˆçœ‹ç›£æ§éƒ¨åˆ†ï¼Œå¯ä»¥çœ‹åˆ°åŸæœ¬çš„ node-1 æ˜¯ Primary å¾Œä¾†æ‰ä¸‹ä¾†çš„åŒæ™‚ï¼Œç”± node-2 è®Šæˆ Primary æœ€å¾Œå®Œæˆæ•…éšœè½‰ç§»ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/6.png"
alt="ç›£æ§ç•«é¢" width="500">&lt;figcaption>
&lt;p>ç›£æ§ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å†ä¾†çœ‹ describe çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç™¼ç¾åŸæœ¬çš„ &lt;b>currentLocationId&lt;/b> å¾ Primary (node-0) asia-east1-a è®Šæˆ(node-1) asia-east1-bï¼Œå®Œæˆæ•…éšœè½‰ç§»ï¼Œå› æ­¤æ›´æ›å€åŸŸã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/7.png"
alt="describe ç•«é¢" width="650">&lt;figcaption>
&lt;p>describe ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æŸ¥çœ‹è…³æœ¬&lt;span class="absolute -mt-20" id="æŸ¥çœ‹è…³æœ¬">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b%e8%85%b3%e6%9c%ac" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æœ€å¾Œï¼ŒæŸ¥çœ‹ä¸€ä¸‹è…³æœ¬çš„åŸ·è¡Œç´€éŒ„å¯ä»¥ç™¼ç¾ï¼šåœ¨ 18:12:58ï¼Œ å‡ºç¾ç¬¬ä¸€ç­† Primary PING ä¸åˆ°çš„éŒ¯èª¤ï¼Œåˆ° 18:13:18 æ‰æ¢å¾©ï¼Œä»£è¡¨æ•…éšœè½‰ç§»æ™‚é–“ç´„ 20 å·¦å³ (æœ€å¾Œé¢æœƒæ¸¬è©¦ 5 æ¬¡ä¾†å–å¹³å‡)ï¼Œå…¶æµç¨‹æ˜¯ Primary æœƒå…ˆé€£ä¸åˆ°ï¼Œæ¥è‘—è®Šæˆ Primary è·Ÿ Replica éƒ½é€£ä¸åˆ°ï¼Œæœ€å¾Œå‰©ä¸‹ Replicaï¼Œåˆ°éƒ½æ­£å¸¸ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/8.png"
alt="shell ç•«é¢" width="500">&lt;figcaption>
&lt;p>shell ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>å¯¦ä½œæ¸¬è©¦ (1m2s)&lt;span class="absolute -mt-20" id="å¯¦ä½œæ¸¬è©¦-1m2s">&lt;/span>
&lt;a href="#%e5%af%a6%e4%bd%9c%e6%b8%ac%e8%a9%a6-1m2s" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç”±æ–¼è¨­å®šéƒ½å·®ä¸å¤šï¼Œæ‰€ä»¥ä¸Šè¿° 1m1s è¨­å®šé€™é‚Šå°±ä¸é‡è¤‡èªªæ˜ï¼Œè¨˜å¾—æŠŠ IaC çš„ replica_count æ”¹æˆ 2ï¼Œä»¥åŠ shell çš„ IP è·Ÿ Password è¦è¨˜å¾—æ›ï¼&lt;/p>
&lt;p>ç›´æ¥çœ‹ç›£æ§éƒ¨åˆ†ï¼šå¯ä»¥çœ‹åˆ°ç¾åœ¨ node-2 æ˜¯ 1ï¼Œä»£è¡¨ node-2 æ˜¯ Primaryï¼Œå…¶ä»– node-1ã€node-0 éƒ½æ˜¯ Replicaã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/9.png"
alt="ç›£æ§ç•«é¢" width="650">&lt;figcaption>
&lt;p>ç›£æ§ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ¥è‘—çœ‹ describeï¼š&lt;b>currentLocationId&lt;/b> æ˜¯ asia-east1-cï¼Œä¹Ÿå°±æ˜¯ node-2 (Primary)ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/10.png"
alt="describe ç•«é¢" width="650">&lt;figcaption>
&lt;p>describe ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä¸€æ¨£ä¸‹æŒ‡ä»¤ä¾†è·‘ shellï¼Œä¸¦è§€å¯Ÿç›£æ§ã€describe ä¾†æœ‰ shellï¼š
è®Šæˆ node-0 è®Šæˆ Primaryï¼Œnode-2 è®Šæˆ Replicaï¼Œnode-1 ä¸€æ¨£æ˜¯ Replicaã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/11.png"
alt="ç›£æ§ç•«é¢" width="600">&lt;figcaption>
&lt;p>ç›£æ§ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>&lt;b>currentLocationId&lt;/b> è®Šæˆæ˜¯ asia-east1-aï¼ŒPrimary å¾ node-2 è®Šæˆ node-0ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/12.png"
alt="describe ç•«é¢" width="650">&lt;figcaption>
&lt;p>describe ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>è§€å¯Ÿ shell ç™¼ç¾ï¼Œæœ‰å‡ºç¾ FAILED éƒ½æ˜¯ Primaryï¼ŒReplica éƒ½æ­£å¸¸ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-memorystore-failover/13.png"
alt="shell ç•«é¢" width="500">&lt;figcaption>
&lt;p>shell ç•«é¢&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>æ•´ç†æ•…éšœè½‰ç§»æ™‚é–“&lt;span class="absolute -mt-20" id="æ•´ç†æ•…éšœè½‰ç§»æ™‚é–“">&lt;/span>
&lt;a href="#%e6%95%b4%e7%90%86%e6%95%85%e9%9a%9c%e8%bd%89%e7%a7%bb%e6%99%82%e9%96%93" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">æ¸¬æ¸¬æ¬¡æ•¸&lt;/th>
&lt;th style="text-align:center">1m1s (ç§’)&lt;/th>
&lt;th style="text-align:center">1m2s (ç§’)&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">#1&lt;/td>
&lt;td style="text-align:center">16&lt;/td>
&lt;td style="text-align:center">13&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">#2&lt;/td>
&lt;td style="text-align:center">19&lt;/td>
&lt;td style="text-align:center">10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">#3&lt;/td>
&lt;td style="text-align:center">22&lt;/td>
&lt;td style="text-align:center">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">#4&lt;/td>
&lt;td style="text-align:center">20&lt;/td>
&lt;td style="text-align:center">10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">#5&lt;/td>
&lt;td style="text-align:center">18&lt;/td>
&lt;td style="text-align:center">9&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;br>
&lt;p>å¯ä»¥ç™¼ç¾ï¼Œå¤šä¸€å€‹ Replicaï¼Œåœ¨æ•…éšœè½‰ç§»çš„æ™‚é–“å¯ä»¥æ›´å¿«é€Ÿã€‚&lt;/p>
&lt;br>
&lt;h2>æœ€ä½³å¯¦è¸&lt;span class="absolute -mt-20" id="æœ€ä½³å¯¦è¸">&lt;/span>
&lt;a href="#%e6%9c%80%e4%bd%b3%e5%af%a6%e8%b8%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æ‰€ä»¥æˆ‘å€‘çŸ¥é“ï¼Œæ¯ç•¶ç™¼ç”Ÿ Failover æ™‚ï¼Œä¸€å®šæœƒå‡ºç¾æ–·ç·šçš„å•é¡Œï¼Œå®˜æ–¹åœ¨ Memorystore for Redis çš„ &lt;a href="https://cloud.google.com/memorystore/docs/redis/general-best-practices" target="_blank" rel="noopener">General best practices&lt;/a> ä¸­æœ‰æåˆ°&lt;a href="https://cloud.google.com/memorystore/docs/redis/general-best-practices#operations_and_scenarios_that_require_a_connection_retry" target="_blank" rel="noopener">éœ€è¦é‡æ–°é€£ç·šçš„æ“ä½œå’Œå ´æ™¯&lt;/a>ï¼Œä»¥ä¸‹éƒ½æœƒå°è‡´èˆ‡ Redis instance ç¶²è·¯é€£ç·šä¸­æ–·ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://cloud.google.com/memorystore/docs/redis/version-upgrade-behavior" target="_blank" rel="noopener">Version upgrade&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://cloud.google.com/memorystore/docs/redis/scaling-instances" target="_blank" rel="noopener">Scaling up/down&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://cloud.google.com/memorystore/docs/redis/import-export-overview" target="_blank" rel="noopener">Importing&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://cloud.google.com/memorystore/docs/redis/maintenance-policy" target="_blank" rel="noopener">Manual failover&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://cloud.google.com/memorystore/docs/redis/maintenance-policy" target="_blank" rel="noopener">System maintenance&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://cloud.google.com/memorystore/docs/redis/in-transit-encryption#certificate_authority_rotation" target="_blank" rel="noopener">Certificate Authority rotation&lt;/a> for Redis instances that have &lt;a href="https://cloud.google.com/memorystore/docs/redis/in-transit-encryption" target="_blank" rel="noopener">in-transit encryption&lt;/a> enabled&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Emergency failover&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>æ‰€ä»¥æˆ‘å€‘éœ€è¦å†è¨­è¨ˆæ‡‰ç”¨ç¨‹å¼æ™‚ï¼Œè€ƒé‡åˆ°é€™ä¸€é»ï¼Œå¯ä»¥åƒè€ƒ &lt;a href="https://cloud.google.com/memorystore/docs/redis/exponential-backoff" target="_blank" rel="noopener">Exponential backoff&lt;/a> ï¼Œè¦åŠ ä¸Šé‡è©¦é‚è¼¯ï¼Œè®“æ‡‰ç”¨ç¨‹å¼è‡ªå‹•é‡æ–°é€£ç·šä¸¦æŒçºŒæ­£å¸¸é‹ä½œã€‚&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Memorystore for Redis FAQï¼š&lt;a href="https://cloud.google.com/memorystore/docs/redis/faq" target="_blank" rel="noopener">https://cloud.google.com/memorystore/docs/redis/faq&lt;/a>&lt;/p>
&lt;p>High availability for Memorystore for Redisï¼š&lt;a href="https://cloud.google.com/memorystore/docs/redis/high-availability-for-memorystore-for-redis#when_a_failover_is_triggered" target="_blank" rel="noopener">https://cloud.google.com/memorystore/docs/redis/high-availability-for-memorystore-for-redis#when_a_failover_is_triggered&lt;/a>&lt;/p>
&lt;p>About manual failoverï¼š&lt;a href="https://cloud.google.com/memorystore/docs/redis/about-manual-failover#stackdriver_verification" target="_blank" rel="noopener">https://cloud.google.com/memorystore/docs/redis/about-manual-failover#stackdriver_verification&lt;/a>&lt;/p>
&lt;p>Initiate a manual failoverï¼š&lt;a href="https://cloud.google.com/memorystore/docs/redis/initiate-manual-failover" target="_blank" rel="noopener">https://cloud.google.com/memorystore/docs/redis/initiate-manual-failover&lt;/a>&lt;/p>
&lt;p>General best practicesï¼š&lt;a href="https://cloud.google.com/memorystore/docs/redis/general-best-practices" target="_blank" rel="noopener">https://cloud.google.com/memorystore/docs/redis/general-best-practices&lt;/a>&lt;/p>
&lt;p>Exponential backoffï¼š&lt;a href="https://cloud.google.com/memorystore/docs/redis/exponential-backoff" target="_blank" rel="noopener">https://cloud.google.com/memorystore/docs/redis/exponential-backoff&lt;/a>&lt;/p></description></item><item><title>å¦‚ä½•éæ¿¾ GCP LOGï¼Œæ¸›å°‘ Cloud Logging API çš„èŠ±è²»</title><link>https://pin-yi.me/blog/gcp/gcp-log-reduce-cloud-logging-api/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/gcp-log-reduce-cloud-logging-api/</guid><description>
&lt;p>ç•¶æˆ‘å€‘ä½¿ç”¨ GCP çš„ Cloud Logging æœå‹™ä¾†æŸ¥çœ‹ Log æ™‚ï¼Œæœ‰æ™‚å€™æœƒæœ‰ä¸€äº›æˆ‘å€‘ä¸éœ€è¦é¡¯ç¤ºå‡ºä¾†çš„ï¼Œæˆ–æ˜¯å¾ä¾†éƒ½ä¸æœƒå»æŸ¥è©¢çš„ Logï¼Œå†è€…æ˜¯ GCP æœ¬èº«çš„éŒ¯èª¤å°è‡´å¤§é‡å™´éŒ¯çš„ Log ï¼Œé€™äº› Log éƒ½æœƒå°è‡´ Cloud Logging çš„è²»ç”¨å¢åŠ ã€‚&lt;/p>
&lt;h2>ä»‹ç´¹ Cloud Logging&lt;span class="absolute -mt-20" id="ä»‹ç´¹-cloud-logging">&lt;/span>
&lt;a href="#%e4%bb%8b%e7%b4%b9-cloud-logging" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å…ˆä¾†ç°¡å–®èªªä¸€ä¸‹ Cloud Logging é€™é …æœå‹™çš„åŸºæœ¬æ¶æ§‹ï¼Œè«‹çœ‹åœ–ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/overview.png"
alt="Cloud Logging åŸºæœ¬æ¶æ§‹" width="800">&lt;figcaption>
&lt;p>Cloud Logging åŸºæœ¬æ¶æ§‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ° Logs Data æœƒé€é API å†ç¶“é _Default log sink (router) å­˜åˆ°ç›¸æ‡‰å‘½åçš„ log bucket (é è¨­é…ç½®)ï¼Œåœ–ä¸­ _Required ä»¥åŠ _Default çš„ log sink éƒ½æ˜¯ GCP è‡ªå‹•å‰µå»ºçš„æ¥æ”¶å™¨ï¼Œä¸‹é¢ç°¡è¿°ä¸€ä¸‹å®ƒå€‘çš„å€åˆ¥ï¼š&lt;/p>
&lt;br>
&lt;h3>_Required æ—¥èªŒå„²å­˜æ¡¶&lt;span class="absolute -mt-20" id="_required-æ—¥èªŒå„²å­˜æ¡¶">&lt;/span>
&lt;a href="#_required-%e6%97%a5%e8%aa%8c%e5%84%b2%e5%ad%98%e6%a1%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Cloud Logging æœƒå°‡ä»¥ä¸‹é¡å‹çš„ Log å­˜åˆ° _Required å„²å­˜æ¡¶&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ç®¡ç†å“¡æ´»å‹•å¯©æ ¸ Log&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç³»çµ±äº‹ä»¶å¯©æ ¸ Log&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Access Transparency Log&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Cloud Logging æœƒå°‡ _Required å„²å­˜æ¡¶ Log ä¿ç•™ 400 å¤©ï¼Œç„¡æ³•èª¿æ•´è©²æœŸé™ï¼Œä¸”ç„¡æ³•ä¿®æ”¹æˆ–åˆªé™¤ _Required å„²å­˜æ¡¶ï¼Œä¹Ÿæ²’è¾¦æ³•åœç”¨ _Required log sink æ¥å—å™¨è·¯ç”±åˆ° _Required å„²å­˜æ¡¶çš„è¨­å®šã€‚&lt;/p>
&lt;br>
&lt;h3>_Default æ—¥èªŒå„²å­˜æ¡¶&lt;span class="absolute -mt-20" id="_default-æ—¥èªŒå„²å­˜æ¡¶">&lt;/span>
&lt;a href="#_default-%e6%97%a5%e8%aa%8c%e5%84%b2%e5%ad%98%e6%a1%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åªè¦ä¸æ˜¯å­˜åœ¨ _Required æ—¥èªŒå„²å­˜æ¡¶çš„ Log å°±æœƒé€é _Default log sink æ¥å—å™¨è·¯ç”±åˆ° _Default å„²å­˜æ¡¶ã€‚&lt;/p>
&lt;p>é™¤éæœ‰å¦å¤–é…ç½®è‡ªå®šç¾©è¨­å®šï¼Œ å¦å‰‡ _Default æ—¥èªŒå„²å­˜æ¡¶ Log åªæœƒä¿ç•™ 30 å¤©ï¼Œä¹Ÿä¸€æ¨£ç„¡æ³•åˆªé™¤ _Default æ—¥èªŒå„²å­˜æ¡¶ã€‚æ­¤å¤– Cloud Logging çš„è²»ç”¨æ˜¯ä»¥å­˜åœ¨ _Default æ—¥èªŒå„²å­˜æ¡¶ä¾†è¨ˆç®—ã€‚&lt;/p>
&lt;br>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>åŠŸèƒ½&lt;/th>
&lt;th>åƒ¹æ ¼&lt;/th>
&lt;th>æ¯æœˆå…è²»é¡åº¦&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Logging æå–&lt;/td>
&lt;td>æå–çš„ Log $0.5/GiB&lt;/td>
&lt;td>æ¯å€‹é …ç›®å‰ 50 GiB&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Logging å„²å­˜&lt;/td>
&lt;td>ä¿ç•™è¶…é 30 å¤©çš„ Logï¼Œæ¯æœˆæ¯ GiB $0.01&lt;/td>
&lt;td>åœ¨é»˜èªä¿ç•™æœŸé™çš„ Log ä¸æœƒæœ‰é¡å¤–å„²å­˜è²»ç”¨&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æŸ¥çœ‹è©²å°ˆæ¡ˆä½¿ç”¨çš„ Cloud Logging API è²»ç”¨ï¼š&lt;a href="https://console.cloud.google.com/apis/api/logging.googleapis.com/cost" target="_blank" rel="noopener">https://console.cloud.google.com/apis/api/logging.googleapis.com/cost&lt;/a>&lt;/p>
&lt;br>
&lt;h2>éæ¿¾ Log&lt;span class="absolute -mt-20" id="éæ¿¾-log">&lt;/span>
&lt;a href="#%e9%81%8e%e6%bf%be-log" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é‚£ç¾åœ¨çŸ¥é“ Cloud Logging çš„æ¶æ§‹ï¼Œé‚£ç•¶æˆ‘å€‘é‡åˆ°éœ€è¦éæ¿¾ Log æ™‚ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ­¥é©Ÿä¾†éæ¿¾ä»¥ç¯€çœ Cloud Logging API è²»ç”¨ï¼š&lt;/p>
&lt;h3>ç¯„ä¾‹èªªæ˜&lt;span class="absolute -mt-20" id="ç¯„ä¾‹èªªæ˜">&lt;/span>
&lt;a href="#%e7%af%84%e4%be%8b%e8%aa%aa%e6%98%8e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é€™æ¬¡ç¯„ä¾‹æ˜¯ google åœ¨ 2023/07/06 æ‰€ç™¼ä½ˆçš„ Service Healthï¼Œç•¶ GKE ç‰ˆæœ¬å¤§æ–¼ 1.24 ä»¥ä¸Šï¼Œå°±æœƒå™´&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Failed to get record: decoder: failed to decode payload: EOF&lt;/p>
&lt;/li>
&lt;li>
&lt;p>cannot parse &amp;lsquo;0609 05:31:59.491654&amp;rsquo; after %L&lt;/p>
&lt;/li>
&lt;li>
&lt;p>invalid time format %m%d %H:%M:%S.%L%z for &amp;lsquo;0609 05:31:59.490647&amp;rsquo;&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>é€™ä¸‰ç¨®é¡å‹çš„éŒ¯èª¤ Logï¼Œåœ¨ç­‰å¾…å®˜æ–¹ä¿®å¾©å‰ï¼Œå®˜æ–¹çš„å»ºè­°æ˜¯å…ˆå°‡ä»–çµ¦éæ¿¾æ‰ï¼Œé¿å…ä¸€ç›´åˆ·å™´éŒ¢ â”(Â´Ğ´`)â”Œ&lt;/p>
&lt;p>é™„ä¸Šç•¶æ™‚çš„ Service Health é€£çµï¼š&lt;a href="https://status.cloud.google.com/incidents/y5XvpyBXFhsphSt4DfiE" target="_blank" rel="noopener">https://status.cloud.google.com/incidents/y5XvpyBXFhsphSt4DfiE&lt;/a>&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘åœ¨ä¸Šé¢æ¶æ§‹åœ–æœ‰èªªåˆ°ï¼ŒLog æœƒé€é log sink è·¯ç”±åˆ° bucketï¼Œæ‰€ä»¥æˆ‘å€‘è¦å°‡éæ¿¾æ¢ä»¶åŠ åœ¨ log router ä¸Šï¼š&lt;/p>
&lt;div class="steps ml-4 mb-12 border-l border-gray-200 pl-6 dark:border-neutral-800 [counter-reset:step]">
&lt;h3>é¸æ“‡ Log Router&lt;span class="absolute -mt-20" id="é¸æ“‡-log-router">&lt;/span>
&lt;a href="#%e9%81%b8%e6%93%87-log-router" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/1.png"
alt="é¸æ“‡ Log Router" width="550">&lt;figcaption>
&lt;p>é¸æ“‡ Log Router&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>é¸æ“‡ Log Router Sinks&lt;span class="absolute -mt-20" id="é¸æ“‡-log-router-sinks">&lt;/span>
&lt;a href="#%e9%81%b8%e6%93%87-log-router-sinks" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é¸æ“‡ _Default çš„ Log Router Sinksï¼Œé»é¸å³é‚ŠæŒ‰éˆ•çš„ Edit Sink&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/2.png"
alt="é¸æ“‡ _Default çš„ Log Router Sinks">&lt;figcaption>
&lt;p>é¸æ“‡ _Default çš„ Log Router Sinks&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨­å®š Sink details&lt;span class="absolute -mt-20" id="è¨­å®š-sink-details">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a-sink-details" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç¬¬ä¸€å€‹æ˜¯ detailsï¼Œå¯ä»¥è¼¸å…¥èªªæ˜ï¼Œé€™é‚Šè¼¸å…¥ï¼šgoogle æœ‰ bug æœƒå™´å¤§é‡çš„æ„å¤– LOGï¼Œæ€•è²»ç”¨é£†é«˜ï¼Œå…ˆç”¨å®˜æ–¹å»ºè­°çš„ä¾†éæ¿¾ LOGï¼Œè©³ç´°å¯ä»¥çœ‹ï¼š &lt;a href="https://status.cloud.google.com/incidents/y5XvpyBXFhsphSt4DfiE" target="_blank" rel="noopener">https://status.cloud.google.com/incidents/y5XvpyBXFhsphSt4DfiE&lt;/a>&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/3.png"
alt="è¼¸å…¥ Sink details èªªæ˜">&lt;figcaption>
&lt;p>è¼¸å…¥ Sink details èªªæ˜&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>é¸æ“‡ Sink Service è·Ÿ Bucket&lt;span class="absolute -mt-20" id="é¸æ“‡-sink-service-è·Ÿ-bucket">&lt;/span>
&lt;a href="#%e9%81%b8%e6%93%87-sink-service-%e8%b7%9f-bucket" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ¥è‘— sink æœå‹™é¸æ“‡ Logging bucketï¼Œä»¥åŠå°æ‡‰å„²å­˜çš„ log bucket (é€™é‚ŠåŸºæœ¬ä¸Šéƒ½æ˜¯é è¨­)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/4.png"
alt="é¸æ“‡ Logging bucket">&lt;figcaption>
&lt;p>é¸æ“‡ Logging bucket&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨­å®š include Log&lt;span class="absolute -mt-20" id="è¨­å®š-include-log">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a-include-log" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é¸æ“‡é‚£äº›å¯ä»¥è¢« include åˆ° sink æ¥æ”¶å™¨çš„ LOG æ ¼å¼ (é€™é‚ŠåŸºæœ¬ä¸Šéƒ½æ˜¯é è¨­)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/5.png"
alt="é è¨­çš„ LOG æ ¼å¼">&lt;figcaption>
&lt;p>é è¨­çš„ LOG æ ¼å¼&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨­å®š filter Log&lt;span class="absolute -mt-20" id="è¨­å®š-filter-log">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a-filter-log" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é€™é‚Šå°±æ˜¯æˆ‘å€‘è¦è¼¸å…¥éæ¿¾çš„åœ°æ–¹ï¼Œå…ˆé»æ“Š ADD EXCLUSIONï¼Œè¼¸å…¥éæ¿¾çš„åç¨±ï¼Œä»¥åŠéæ¿¾çš„å…§å®¹æ ¼å¼ï¼Œæˆ‘å€‘è¼¸å…¥ google åœ¨ Service Health æ‰€æä¾›çš„æ ¼å¼ï¼Œæœ€å¾ŒæŒ‰ä¸‹ UPDATE SINK&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/6.png"
alt="æ–°å¢è¦éæ¿¾çš„ LOG æ ¼å¼">&lt;figcaption>
&lt;p>æ–°å¢è¦éæ¿¾çš„ LOG æ ¼å¼&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨­å®šå®Œæˆ&lt;span class="absolute -mt-20" id="è¨­å®šå®Œæˆ">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a%e5%ae%8c%e6%88%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç­‰å¾…æ›´æ–°å®Œæˆï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘å€‘å·²ç¶“åœ¨æ¥æ”¶å™¨ä¸Šè¨­å®šå¥½éæ¿¾æ¢ä»¶å›‰ï½&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/7.png"
alt="æŸ¥çœ‹è©³ç´°æ¥æ”¶å™¨è¨­å®š">&lt;figcaption>
&lt;p>æŸ¥çœ‹è©³ç´°æ¥æ”¶å™¨è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æª¢æŸ¥ Log æ˜¯å¦éæ¿¾æˆåŠŸ&lt;span class="absolute -mt-20" id="æª¢æŸ¥-log-æ˜¯å¦éæ¿¾æˆåŠŸ">&lt;/span>
&lt;a href="#%e6%aa%a2%e6%9f%a5-log-%e6%98%af%e5%90%a6%e9%81%8e%e6%bf%be%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æœ€å¾Œå†æª¢æŸ¥ä¸€ä¸‹ Log æ˜¯ä¸æ˜¯æ²’æœ‰æ”¶åˆ°è©²éŒ¯èª¤çš„ Log å…§å®¹&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gcp-log-reduce-cloud-logging-api/8.png"
alt="æª¢æŸ¥ LOG æ˜¯å¦ä¸æœƒå†å‡ºç¾">&lt;figcaption>
&lt;p>æª¢æŸ¥ LOG æ˜¯å¦ä¸æœƒå†å‡ºç¾&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;/div>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Routing and storage overview &lt;a href="https://cloud.google.com/logging/docs/routing/overview" target="_blank" rel="noopener">https://cloud.google.com/logging/docs/routing/overview&lt;/a>&lt;/p></description></item><item><title>Google Kubernetes Engine CronJob æœƒæœ‰çŸ­æš«æ™‚é–“æ²’æœ‰åŸ·è¡Œ Job</title><link>https://pin-yi.me/blog/gcp/gke-cronjob-not-working/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/gke-cronjob-not-working/</guid><description>
&lt;p>å‰é™£å­å…¬å¸å»ºç«‹åœ¨ Google Kubernetes Engine å¢é›†ä¸Šçš„ CronJob æœå‹™æœƒæœ‰çŸ­æš«æ™‚é–“æ²’æœ‰åŸ·è¡Œ Jobã€‚å…ˆå‰æƒ…æè¦ä¸€ä¸‹ï¼Œæ­¤ CronJob çš„è¨­å®šæ˜¯æ¯åˆ†é˜éƒ½æœƒåŸ·è¡Œ (åœ–ä¸€)ï¼Œæ‰€ä»¥ç†ç•¶ä¾†èªª Log æ‡‰è©²è¦å¯ä»¥çœ‹åˆ°æ¯åˆ†é˜éƒ½æœ‰æ­¤ CronJob çš„ç´€éŒ„ï¼Œä½†æœ‰æ™‚å€™æœƒç™¼ç”Ÿ CronJob çŸ­æš«æ™‚é–“éƒ½æ²’æœ‰åŸ·è¡Œçš„ç‹€æ³ï¼Œæ‰¾äº†ä¸€é™£å­éƒ½æ²’æœ‰æ‰¾åˆ°åŸå› ï¼Œæœ€å¾Œé–‹æ”¯æ´å–®è«‹ Google é‚£é‚Šå”åŠ©æŸ¥çœ‹ï¼Œçµ‚æ–¼æ‰¾åˆ°åŸå› æ‹‰ ğŸ˜ã€‚é‚£å°±è·Ÿæˆ‘ä¸€èµ·çœ‹ä¸€ä¸‹ç™¼ç”Ÿçš„éç¨‹ï¼Œä»¥åŠ Google å¹«æˆ‘å€‘æ‰¾åˆ°çš„åŸå› ï¼Œä»¥åŠè¦å¦‚ä½•è§£æ±ºç­‰ç­‰ï½&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/1.png"
alt="(åœ–ä¸€) CronJob schedule æ™‚é–“ç‚ºæ¯åˆ†é˜åŸ·è¡Œ" width="600">&lt;figcaption>
&lt;p>(åœ–ä¸€) CronJob schedule æ™‚é–“ç‚ºæ¯åˆ†é˜åŸ·è¡Œ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>å•é¡Œç™¼ç”Ÿä»¥åŠå•é¡ŒåŸå› &lt;span class="absolute -mt-20" id="å•é¡Œç™¼ç”Ÿä»¥åŠå•é¡ŒåŸå› ">&lt;/span>
&lt;a href="#%e5%95%8f%e9%a1%8c%e7%99%bc%e7%94%9f%e4%bb%a5%e5%8f%8a%e5%95%8f%e9%a1%8c%e5%8e%9f%e5%9b%a0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘å€‘ä½¿ç”¨ Google Cloud Platform è£¡é¢çš„è¨˜éŒ„åŠŸèƒ½ï¼Œå¯ä»¥çœ‹åˆ° (åœ–äºŒ)ï¼Œåœ¨æ¯åˆ†é˜åŸ·è¡Œçš„ Log ä¸­ï¼Œæœ‰çŸ­æš«æ™‚é–“æ²’æœ‰åŸ·è¡Œ Jobï¼Œä½†é€™å€‹æ™‚é–“é™¤äº† CronJob ä»¥å¤–ï¼Œå…¶ä»–çš„æœå‹™éƒ½æ˜¯å¥½çš„ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/2.png"
alt="(åœ–äºŒ) Google Cloud Platform è¨˜éŒ„æœ‰çŸ­æš«æ²’æœ‰åŸ·è¡Œ" width="700">&lt;figcaption>
&lt;p>(åœ–äºŒ) Google Cloud Platform è¨˜éŒ„æœ‰çŸ­æš«æ²’æœ‰åŸ·è¡Œ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ‰¾äº†ä¸€é™£å­éƒ½æ²’æœ‰æ‰¾åˆ°åŸå› ï¼Œæ–¼æ˜¯æˆ‘å€‘é–‹æ”¯æ´å–®è«‹ Google é‚£é‚Šå”åŠ©æŸ¥çœ‹ï¼ŒGoogle é‚£é‚Šæ‰¾äº†ä¸€é™£å­å¾Œçµ‚æ–¼æ‰¾åˆ°åŸå› æ‹‰ï¼ï¼ï¼æˆ‘å€‘ä¸€èµ·ä¾†çœ‹çœ‹å§ (åœ–ä¸‰)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/3.png"
alt="(åœ–ä¸‰) Google æ”¯æ´å–®å›è¦†" width="700">&lt;figcaption>
&lt;p>(åœ–ä¸‰) Google æ”¯æ´å–®å›è¦†&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å°±å¦‚åŒ Google æ‰€èªªï¼Œä½¿ç”¨æä¾›çš„æŒ‡ä»¤åƒæ•¸ä¾†æŸ¥è©¢ï¼Œå¢é›†åœ¨è©²æ™‚æ®µæœ‰ç™¼ç”Ÿ master control plane çš„å‡ç´šï¼Œå¦‚ (åœ–å››)ï¼Œå†åŠ ä¸Šæˆ‘å€‘å»ºçš„é€™å€‹ cluster æ˜¯ä½¿ç”¨ zonal cluster (åœ–äº”)ï¼Œæ‰€ä»¥å¢é›†åªæœ‰ä¸€å€‹ control planeï¼Œç•¶ control plane åœ¨æ›´æ–°æ™‚ï¼Œæœƒç„¡æ³•éƒ¨ç½²æ–°çš„ workloadï¼Œå°è‡´è©² CronJob æ²’æœ‰åŸ·è¡Œ Jobã€‚åƒè€ƒè³‡æ–™ [1]&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/4.png"
alt="(åœ–å››) ç™¼ç”Ÿ master control plane çš„å‡ç´š" width="700">&lt;figcaption>
&lt;p>(åœ–å››) ç™¼ç”Ÿ master control plane çš„å‡ç´š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/5.png"
alt="(åœ–äº”) æœ‰å•é¡Œçš„å¢é›†ä½ç½®é¡å‹" width="450">&lt;figcaption>
&lt;p>(åœ–äº”) æœ‰å•é¡Œçš„å¢é›†ä½ç½®é¡å‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>Google çš„å»ºè­°æ˜¯å¯ä»¥è€ƒæ…®ä½¿ç”¨å¦ä¸€å€‹ regional clusterï¼Œè®“ master node åœ¨æ›´æ–°æ™‚ä¸æœƒåªåœ¨å–®ä¸€åœ°å€ï¼Œæˆ–æ˜¯ä¸€æ¨£ä½¿ç”¨èˆŠçš„ zonal clusterï¼Œé€éè¨­å®š Maintenance window æˆ–è€… Maintenance exclusions ä¾†é™ä½æœå‹™å—åˆ° workload çš„å½±éŸ¿ã€‚åƒè€ƒè³‡æ–™ [2]&lt;/p>
&lt;br>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
&lt;ol>
&lt;li>
&lt;p>å°±ç®—æŠŠ node_pool è£¡é¢çš„è‡ªå‹•å‡ç´šçµ¦åœæ‰ï¼Œä¹Ÿæ²’æœ‰è¾¦æ³•è§£æ±ºæ­¤å•é¡Œï¼å› ç‚ºæ­¤ master control plane (ä¹Ÿå°±æ˜¯ master node) çš„å‡ç´šï¼Œä¸æ˜¯ worker node çš„ node pool å‡ç´šï¼Œæ˜¯ç”± GKE è² è²¬ç¶­è­·çš„ï¼Œæ‰€ä»¥ä»–å€‘æœƒå®šæœŸå‡ç´š control planeï¼Œä¹Ÿæ²’è¾¦æ³•åœæ­¢æ­¤é¡çš„å‡ç´šã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è‹¥å·²ç¶“å»ºç«‹å¥½ zonal cluster å¾Œï¼Œæƒ³è¦æ”¹æˆ regional cluster ï¼Œæ˜¯æ²’æœ‰è¾¦æ³•ä½¿ç”¨ä¿®æ”¹çš„æ–¹å¼ï¼Œä¸€å®šåªèƒ½é‡å»º clusterï¼Œæ‰€ä»¥å¤§å®¶åœ¨å»ºç«‹æ™‚è¦æ³¨æ„ï½&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h2>è§£æ±ºå•é¡Œ&lt;span class="absolute -mt-20" id="è§£æ±ºå•é¡Œ">&lt;/span>
&lt;a href="#%e8%a7%a3%e6%b1%ba%e5%95%8f%e9%a1%8c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æœ€å¾Œæˆ‘å€‘é¸æ“‡å°‡å¢é›†çµ¦æ•´å€‹é‡å»ºï¼Œä¾†ç¢ºä¿ CronJob ä¸æœƒæœ‰æ²’æœ‰åŸ·è¡Œåˆ°çš„ç‹€æ³ç™¼ç”Ÿï¼Œé‡å»ºå¢é›†è·Ÿæ¬æœå‹™çš„éç¨‹å¾ˆè¾›è‹¦çš„ ğŸ˜° å¸Œæœ›å¤§å®¶ä¸è¦ç™¼ç”Ÿ QQï¼Œæœ€å¾Œæˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹é‡å»ºå®Œå¾Œï¼Œåœ¨ master control plane æ›´æ–°çš„æ™‚å€™ï¼Œé‚„æœƒä¸æœƒæœ‰ CronJob æ²’æœ‰åŸ·è¡Œçš„æƒ…æ³ç™¼ç”Ÿã€‚&lt;/p>
&lt;br>
&lt;p>æ–°å¢é›†ä½¿ç”¨ regional cluster ä¾†å»ºç«‹ï¼Œåœ¨ 2/1 ä¹Ÿæœ‰ master control plane çš„å‡ç´šã€‚ (åœ–å…­)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/6.png"
alt="(åœ–å…­) ç™¼ç”Ÿ master control plane çš„å‡ç´š" width="700">&lt;figcaption>
&lt;p>(åœ–å…­) ç™¼ç”Ÿ master control plane çš„å‡ç´š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æŸ¥çœ‹ CronJob åŸ·è¡Œçš„ç´€éŒ„å¯ä»¥ç™¼ç¾ä¸¦æ²’æœ‰ Job æ²’æœ‰åŸ·è¡Œçš„æƒ…æ³ç™¼ç”Ÿã€‚ (åœ–ä¸ƒ)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/7.png"
alt="(åœ–ä¸ƒ) å¢é›†ä½ç½®é¡å‹" width="700">&lt;figcaption>
&lt;p>(åœ–ä¸ƒ) å¢é›†ä½ç½®é¡å‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/8.png"
alt="(åœ–å…«) æ–°å¢é›†ä½ç½®é¡å‹" width="450">&lt;figcaption>
&lt;p>(åœ–å…«) æ–°å¢é›†ä½ç½®é¡å‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>[1] Standard cluster upgradesï¼š&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-upgrades" target="_blank" rel="noopener">https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-upgrades&lt;/a>&lt;/p>
&lt;p>[2] maintenance-windows-and-exclusionsï¼š&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/maintenance-windows-and-exclusions" target="_blank" rel="noopener">https://cloud.google.com/kubernetes-engine/docs/concepts/maintenance-windows-and-exclusions&lt;/a>&lt;/p></description></item><item><title>Google Cloud Platform (GCP) - IAM èˆ‡ç®¡ç†</title><link>https://pin-yi.me/blog/gcp/iam/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/iam/</guid><description>
&lt;p>IAM çš„å…¨åæ˜¯ Identity and Access Managementï¼Œç•¶æˆ‘å€‘è—‰ç”± IAMï¼Œå¯ä»¥æˆèˆ‡ç‰¹å®š Google Cloud è³‡æºçš„ &lt;strong>ç²¾ç´°&lt;/strong> è¨ªå•æ¬Šé™ï¼Œä¸¦é˜²æ­¢å°å…¶ä»–è³‡æºçš„è¨ªå•ã€‚ç–‘ï¼ï¼Ÿç‚ºä»€éº¼æ˜¯ç²¾ç´°ï¼Ÿæˆ‘å€‘æ¥è‘—çœ‹ä¸‹å»ï¼Œæˆ‘å€‘å¯ä»¥æ¡ç”¨æœ€å°æ¬Šé™å®‰å…¨åŸå‰‡ï¼Œè©²åŸå‰‡è¦æ±‚ä»»ä½•äººéƒ½ä¸æ‡‰æ“æœ‰è¶…å‡ºå¯¦éš›æ‰€éœ€çš„æ¬Šé™ã€‚&lt;/p>
&lt;br>
&lt;h2>IAM çš„å·¥ä½œåŸç†&lt;span class="absolute -mt-20" id="iam-çš„å·¥ä½œåŸç†">&lt;/span>
&lt;a href="#iam-%e7%9a%84%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é¦–å…ˆæˆ‘å€‘å…ˆä¾†äº†è§£ä¸€ä¸‹ IAM çš„å·¥ä½œåŸç†ï¼Œè—‰ç”± IAMï¼Œæˆ‘å€‘å¯ä»¥å®šç¾©èª° (å“ªä¸€å€‹èº«ä»½) å°å“ªäº›è³‡æºæœ‰å“ªç¨®çš„è¨ªå•æ¬Šé™ (è§’è‰²) ä¾†ç®¡ç†è¨ªå•æ¬Šé™æ§åˆ¶ã€‚ä»€éº¼æ˜¯è³‡æºï¼Ÿä¾‹å¦‚ï¼Œ Compute Engine è™›æ“¬æ©Ÿ (GCE)ã€Google Kubernetes Engine (GKE) é›†ç¾¤å’Œ Cloud Storage å­˜å„²åˆ†å€éƒ½æ˜¯ Google Cloud è³‡æºï¼Œæˆ‘å€‘ç”¨æ–¼æ•´ç†è³‡æºçš„çµ„ç¹”æˆ–è³‡æ–™å¤¾ã€é …ç›®ç­‰ä¹Ÿéƒ½æ˜¯è³‡æº&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/logo.png"
alt="GCP IAM Logo" width="150">&lt;figcaption>
&lt;p>GCP IAM Logo&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘å¯ä»¥æŠŠå®ƒç†è§£æˆ&lt;/p>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
ä»€éº¼ ã€ äºº ã€ï¼Œå¯ä»¥å°ä»€éº¼ã€ è³‡æº ã€ï¼Œåšä»€éº¼ã€ äº‹æƒ… ã€
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>IAM ä¸æœƒç›´æ¥å‘ç”¨æˆ¶æˆèˆ‡è³‡æºçš„è¨ªå•æ¬Šé™ï¼Œè€Œæ˜¯å°‡æ¬Šé™åˆ†æˆå¤šå€‹è§’è‰²ï¼Œç„¶å¾Œå°‡é€™äº›è§’è‰²æˆèˆ‡ç¶“éèº«ä»½é©—è­‰çš„ä¸»å¸³è™Ÿã€‚(ä»¥å‰ IAM æœƒå°‡ä¸»å¸³è™Ÿç¨±ç‚ºæˆå“¡ï¼Œç›®å‰éƒ¨åˆ† API ä»ç„¶ä½¿ç”¨æ­¤è¡“èªã€‚)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/iam-overview-basics.png"
alt="IAM ä¸­çš„æ¬Šé™ç®¡ç†" width="800">&lt;figcaption>
&lt;p>IAM ä¸­çš„æ¬Šé™ç®¡ç†&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°é€™å¼µåœ–ç‰‡ï¼Œè¨ªå•æ¬Šé™ç®¡ç†ä¸»è¦åŒ…å«ä¸‰å€‹éƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸»å¸³è™Ÿ (Principal)ï¼šä¸»å¸³è™Ÿå¯ä»¥æ˜¯ Google å¸³è™Ÿ (é‡å°ç”¨æˆ¶)ã€æœå‹™å¸³è™Ÿ (é‡å°æ‡‰ç”¨å’Œè¨ˆç®—å·¥ä½œè² è¼‰)ã€Google ç¾¤çµ„æˆ– Workspace å¸³è™Ÿæˆ–å¯ä»¥è¨ªå•è³‡æºçš„ Cloud Identity ç¶²åŸŸç­‰ç­‰&lt;/li>
&lt;li>è§’è‰² (Role)ï¼šä¸€å€‹è§’è‰²å°æ‡‰ä¸€çµ„æ¬Šé™ï¼Œæ¬Šé™æ±ºå®šäº†å¯ä»¥å°è³‡æºåŸ·è¡Œçš„æ“ä½œã€‚å‘ä¸»å¸³è™Ÿæˆèˆ‡æŸå€‹è…³è‰²ï¼Œ ä»£è¡¨æˆèˆ‡è©²è§’è‰²åŒ…å«çš„æ‰€æœ‰æ¬Šé™çµ¦ä¸»å¸³è™Ÿ&lt;/li>
&lt;li>æ”¿ç­– (Policy)ï¼šå…è¨±æ”¿ç­– (Allow Policy) æ˜¯å°‡ä¸€å€‹æˆ–å¤šå€‹ä¸»é«”ç¶å®šåœ¨å„å€‹è§’è‰²ï¼Œç•¶æƒ³è¦å®šç¾©èª° (ä¸»é«”) å°è³‡æºæ“æœ‰ä½•ç¨®é¡å‹çš„è¨ªå• (è§’è‰²) æ™‚ï¼Œå¯ä»¥å‰µå»ºå…è¨±æ”¿ç­–ä¸¦å°‡å…¶é™„åŠ åˆ°è³‡æºã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h2>IAM æ¸¬è©¦&lt;span class="absolute -mt-20" id="iam-æ¸¬è©¦">&lt;/span>
&lt;a href="#iam-%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘ä¾†æ¸¬è©¦çœ‹çœ‹ IAM å¯¦éš›è¨­å®šä»¥åŠç”¨é€”å§ï¼ æˆ‘å€‘æœƒä½¿ç”¨ GCP æ‰€ä»¥æä¾›çš„ &lt;a href="https://www.cloudskillsboost.google/focuses/551?parent=catalog" target="_blank" rel="noopener">[Qwiklabs] Cloud IAMï¼šQwik Start&lt;/a> ä¾†é€²è¡Œæ¸¬è©¦ï¼Œä¹‹å¾Œçš„æ­¥é©Ÿæœƒè·Ÿ Cloud IAMï¼šQwik Start å…§å®¹ä¸€æ¨£ï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥é‚Šæ“ä½œé‚Šåƒè€ƒå‘¦ï¼é‚£æˆ‘å€‘é–‹å§‹å›‰ ğŸ™ƒ&lt;/p>
&lt;p>é€²å…¥ç¶²é å¾Œï¼Œè«‹å…ˆç™»å…¥è‡ªå·±çš„ Google å¸³è™Ÿï¼Œæ¥è‘—é»é¸å·¦ä¸Šè§’çš„ &lt;strong>Start Lab&lt;/strong>ï¼Œæœƒè·³å‡ºèˆ‡ä¸‹é¢åœ–ç‰‡é¡ä¼¼çš„å…§å®¹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/1.png"
alt="æ¸¬è©¦ç”¨çš„å¸³è™Ÿå¯†ç¢¼" width="250">&lt;figcaption>
&lt;p>æ¸¬è©¦ç”¨çš„å¸³è™Ÿå¯†ç¢¼&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>é€™é‚Šæœƒæä¾›å…©çµ„çš„å¸³è™ŸåŠå¯†ç¢¼ï¼Œåˆ†åˆ¥æ˜¯ Username1 ä»¥åŠ Username2 (å¾Œé¢æœƒä»¥ Username 1 è·Ÿ 2 ä¾†èªªæ˜)ï¼Œå¯†ç¢¼æœƒç”¨å…±ç”¨ï¼Œä¸”æœƒåœ¨åŒä¸€å€‹å°ˆæ¡ˆä¸‹ã€‚&lt;/p>
&lt;br>
&lt;h3>ç”¨ç¬¬ä¸€å€‹ Username1 ç™»å…¥ GCP&lt;span class="absolute -mt-20" id="ç”¨ç¬¬ä¸€å€‹-username1-ç™»å…¥-gcp">&lt;/span>
&lt;a href="#%e7%94%a8%e7%ac%ac%e4%b8%80%e5%80%8b-username1-%e7%99%bb%e5%85%a5-gcp" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>é»é¸ &lt;strong>Open Google Console&lt;/strong> æŒ‰éˆ•ä¾†é–‹å•Ÿ GCP ä¸»æ§å°&lt;/li>
&lt;li>ç™»å…¥çš„å¸³è™Ÿå°±è¼¸å…¥ç¬¬ä¸€å€‹ Username1 &lt;student-03-XXXXXX>ï¼Œå¯†ç¢¼è¼¸å…¥å…±ç”¨å¯†ç¢¼ &lt;lsLrXXXXX>ï¼Œæœ€å¾Œç™»å…¥&lt;/li>
&lt;li>ç™»å…¥æˆåŠŸæœƒé€²å…¥ GCP ä¸»æ§å°ï¼Œæœƒè·³å‡ºä¸‹æ–¹åœ–ç‰‡å…§å®¹ï¼Œåœ‹å®¶é¸æ“‡å°ç£ï¼Œé»é¸åŒæ„ &lt;strong>Terms of Service&lt;/strong>ï¼Œæœ€å¾ŒæŒ‰ &lt;strong>AGREE AND CONTINUE&lt;/strong>&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/2.png"
alt="ç™»å…¥ Username 1 GCP ä¸»æ§å°" width="1000">&lt;figcaption>
&lt;p>ç™»å…¥ Username 1 GCP ä¸»æ§å°&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ç”¨ç¬¬äºŒå€‹ Username2 ç™»å…¥ GCP&lt;span class="absolute -mt-20" id="ç”¨ç¬¬äºŒå€‹-username2-ç™»å…¥-gcp">&lt;/span>
&lt;a href="#%e7%94%a8%e7%ac%ac%e4%ba%8c%e5%80%8b-username2-%e7%99%bb%e5%85%a5-gcp" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>æ­¥é©Ÿèˆ‡ç¬¬ä¸€å€‹ç›¸åŒï¼Œé€™é‚Šå°±ä¸åœ¨é‡è¤‡ï¼Œä½†å»ºè­°ä½¿ç”¨ç„¡ç—•ï¼Œé¿å… Username1 è·Ÿ Username2 æ¶ä¾†æ¶å»ï¼Œä»¥åŠç™»å…¥å¸³è™Ÿè¦é¸ Username2ï¼Œæ‡‰è©²ä¸æœƒé¸éŒ¯å§ ğŸ¤£&lt;/li>
&lt;/ul>
&lt;br>
&lt;h3>Username1 IAM ä¸»æ§å°&lt;span class="absolute -mt-20" id="username1-iam-ä¸»æ§å°">&lt;/span>
&lt;a href="#username1-iam-%e4%b8%bb%e6%8e%a7%e5%8f%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>åˆ° Username1 çš„ GCP ä¸»æ§å°é¦–é &lt;/li>
&lt;li>é»é¸å·¦å´çš„ menu &amp;gt; &lt;strong>IAM èˆ‡ç®¡ç†&lt;/strong>&lt;/li>
&lt;li>é»æ“Šé é¢ä¸Šæ–¹çš„ &lt;strong>+ADD&lt;/strong> æŒ‰éˆ•ï¼Œå¯ä»¥å¾ä¸‹æ‹‰é¸å–®å»æŸ¥çœ‹å„å¼å„é …çš„å°ˆæ¡ˆç›¸é—œè§’è‰²ï¼Œå¯ä»¥çœ‹åˆ°è¶…ç´šå¤šçš„è§’è‰²è¨­å®šï¼Œæ‰€ä»¥æˆ‘å€‘ä¸€é–‹å§‹æ‰æœƒèªªä»–æ˜¯å¯ä»¥è¨­å®š ** ç²¾ç´°** çš„è¨ªå•æ¬Šé™&lt;/li>
&lt;li>æˆ‘å€‘é¸æ“‡ &lt;strong>Base&lt;/strong>ï¼Œå³å´æœ‰ 4 ç¨®è§’è‰²ï¼Œåˆ†åˆ¥æ˜¯ç€è¦½è€… (Browser)ã€ç·¨è¼¯è€… (Editor)ã€æ‰€æœ‰è€… (Owner)ã€æª¢è¦–è€… (Viewer)ï¼Œè©³ç´°å€åˆ¥è«‹çœ‹ä¸‹é¢ ğŸ‘‡ğŸ‘‡&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/3.png"
alt="ADD IAM" width="1000">&lt;figcaption>
&lt;p>ADD IAM&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>æ­¤è¡¨æ˜¯å– Google Cloud IAM æ–‡ç« &lt;a href="https://cloud.google.com/iam/docs/understanding-roles#primitive_roles" target="_blank" rel="noopener">åŸºæœ¬è§’è‰²&lt;/a>ä¸­çš„å®šç¾©ï¼Œç°¡å–®èªªæ˜ 4 ç¨®è§’è‰²çš„å·®åˆ¥ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">è§’è‰²åç¨±&lt;/th>
&lt;th style="text-align:center">æ¬Šé™&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">role/viewer (æª¢è¦–è€…)&lt;/td>
&lt;td style="text-align:center">ä¸å½±éŸ¿ç‹€æ…‹çš„åªè®€æ“ä½œæ¬Šé™ï¼Œä¾‹å¦‚ï¼šæŸ¥çœ‹ (ä½†ä¸ä¿®æ”¹) ç¾æœ‰è³‡æºæˆ–æ˜¯è³‡æ–™&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">role/editor (ç·¨è¼¯è€…)&lt;/td>
&lt;td style="text-align:center">æ‰€æœ‰æŸ¥çœ‹è€…æ¬Šé™ï¼Œä»¥åŠä¿®æ”¹ç‹€æ…‹çš„æ“ä½œæ¬Šé™ï¼Œä¾‹å¦‚ï¼šæ›´æ”¹ç¾æœ‰è³‡æº&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">role/owner (æ“æœ‰è€…)&lt;/td>
&lt;td style="text-align:center">ä»¥ä¸‹æ“ä½œçš„æ‰€æœ‰ç·¨è¼¯æ¬Šé™ï¼š 1. ç®¡ç†é …ç›®å’Œé …ç›®å…§çš„æ‰€æœ‰è³‡æºè§’è‰²åŠæ¬Šé™ 2. ç‚ºé …ç›®è¨­ç½®å¸³å–®&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">role/browser (ç€è¦½è€…)&lt;/td>
&lt;td style="text-align:center">è®€å–æ¬Šé™ä»¥åŠç€è¦½é …ç›®çš„å±¤æ¬¡çµæ§‹ï¼ŒåŒ…å«è³‡æ–™å¤¾ã€çµ„ç¹”å’Œ IAM æ”¿ç­–ã€‚ä½†æ­¤è§’è‰²ä¸åŒ…å«æŸ¥çœ‹é …ç›®ä¸­è³‡æºçš„æ¬Šé™&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æˆ‘å€‘çš„ Username1 ç‚º ownerï¼ŒUsername2 ç‚º viewer&lt;/p>
&lt;br>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
Google å»ºè­°ï¼šBase è§’è‰²åŒ…å«æ‰€æœ‰ Google Cloud æœå‹™çš„æ•¸åƒå€‹æ¬Šé™ã€‚é™¤éåˆ¥ç„¡é¸æ“‡ï¼Œå¦å‰‡ä¸è¦æˆèˆ‡ç”¨æˆ¶ Base è§’è‰²ï¼Œè«‹è¨­å®šæœ€æœ‰é™çš„è‡ªè¨‚ç¾©è§’è‰²æˆ–æ˜¯å¯ä»¥æ»¿è¶³è©²éœ€æ±‚çš„è§’è‰²å³å¯
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>åˆ‡æ›åˆ° Username2 IAM ä¸»æ§å°&lt;span class="absolute -mt-20" id="åˆ‡æ›åˆ°-username2-iam-ä¸»æ§å°">&lt;/span>
&lt;a href="#%e5%88%87%e6%8f%9b%e5%88%b0-username2-iam-%e4%b8%bb%e6%8e%a7%e5%8f%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘å¯ä»¥åœ¨è¡¨æ ¼è£¡é¢æ”¶å°‹ Username1 è·Ÿ Username2 çš„å¸³è™Ÿï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä»–å€‘æˆèˆ‡çš„è§’è‰²æ˜¯å¦èˆ‡ä¸Šé¢èªªçš„ä¸€è‡´ï¼Œå¤§æ¦‚å¯ä»¥åƒè€ƒä»¥ä¸‹åœ–ç‰‡ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/4.png"
alt="Username1 è·Ÿ Username2 æ¬Šé™" width="1000">&lt;figcaption>
&lt;p>Username1 è·Ÿ Username2 æ¬Šé™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>åœ¨ Username2 å› ç‚ºæ˜¯ Viewer æ¬Šé™ï¼Œæ‰€ä»¥é»æ“Šä¸Šé¢çš„ &lt;strong>+ ADD&lt;/strong>ï¼Œä¸æœƒåæ‡‰ï¼Œæœƒè·³å‡ºä»¥ä¸‹ç…§ç‰‡å…§å®¹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/5.png"
alt="Username2 æ¬Šé™ä¸è¶³" width="500">&lt;figcaption>
&lt;p>Username2 æ¬Šé™ä¸è¶³&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>å†åˆ‡å› Username1 Cloud Storage&lt;span class="absolute -mt-20" id="å†åˆ‡å›-username1-cloud-storage">&lt;/span>
&lt;a href="#%e5%86%8d%e5%88%87%e5%9b%9e-username1-cloud-storage" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>æ¥ä¸‹ä¾†æˆ‘å€‘è¦å»ºç«‹ä¸€å€‹ GCS å„²å­˜ç©ºé–“ï¼Œé»é¸ menu &amp;gt; &lt;strong>Cloud Storage&lt;/strong> &amp;gt; &lt;strong>Browser&lt;/strong>&lt;/li>
&lt;li>é»é¸ &lt;strong>Create a bucket&lt;/strong>&lt;/li>
&lt;li>çµ¦äºˆä»–ä¸€å€‹ç¨ç‰¹çš„åç¨±ï¼Œä»¥åŠåœ¨ Choose where to store your data é¸æ“‡ Multi-Region&lt;/li>
&lt;li>æœ€å¾Œé»é¸ &lt;strong>CREATE&lt;/strong>&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/6.png"
alt="Create a bucket" width="1000">&lt;figcaption>
&lt;p>Create a bucket&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ä¸Šå‚³ç¯„ä¾‹æª”æ¡ˆ&lt;span class="absolute -mt-20" id="ä¸Šå‚³ç¯„ä¾‹æª”æ¡ˆ">&lt;/span>
&lt;a href="#%e4%b8%8a%e5%82%b3%e7%af%84%e4%be%8b%e6%aa%94%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>é€²å…¥æ–°å»ºç«‹çš„ Cloud Storageï¼Œé»é¸ &lt;strong>Upload fiiles&lt;/strong> æŒ‰éˆ•&lt;/li>
&lt;li>ä¸Šå‚³ä¸€å€‹ txt æª”æ¡ˆï¼Œå¯ä»¥å…ˆå–åç‚º &lt;code>sample.txt&lt;/code>ï¼Œæˆ–æ˜¯ä¸Šå‚³å¾Œä½¿ç”¨æœ€å¾Œä¸‰å€‹å°é»åœ–æ¡ˆå…§çš„ Rename ä¾†ä¿®æ”¹åç¨±&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/7.png"
alt="Upload sample.txt fiiles" width="1200">&lt;figcaption>
&lt;p>Upload sample.txt fiiles&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>é©—è­‰å°ˆæ¡ˆæª¢è¦–è€…å­˜å–æ¬Šé™&lt;span class="absolute -mt-20" id="é©—è­‰å°ˆæ¡ˆæª¢è¦–è€…å­˜å–æ¬Šé™">&lt;/span>
&lt;a href="#%e9%a9%97%e8%ad%89%e5%b0%88%e6%a1%88%e6%aa%a2%e8%a6%96%e8%80%85%e5%ad%98%e5%8f%96%e6%ac%8a%e9%99%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>æˆ‘å€‘å†åˆ‡æ›å› Username2 çš„ä¸»æ§å°ï¼Œé¸æ“‡ menu &amp;gt; &lt;strong>Cloud Storage&lt;/strong> &amp;gt; &lt;strong>Browser&lt;/strong>&lt;/li>
&lt;li>å°±å¯ä»¥çœ‹åˆ°è·Ÿä¸Šé¢ä¸€æ¨£çš„å„²å­˜å€&lt;/li>
&lt;/ol>
&lt;p>Username2 è¢«æˆèˆ‡ &amp;ldquo;æª¢è¦–è€… Viewer&amp;rdquo; è§’è‰²ï¼Œé€™å€‹è§’è‰²æœ‰ä¸å½±éŸ¿ç‹€æ…‹çš„åªè®€æ¬Šé™ã€‚é€™å€‹ç¯„ä¾‹ä¸­èªªæ˜é€™å€‹åŠŸèƒ½ï¼Œä»–åƒ…èƒ½æª¢è¦–ï¼Œæ²’æœ‰è¾¦æ³•ä¸Šå‚³&lt;/p>
&lt;br>
&lt;h3>ç§»é™¤å°ˆæ¡ˆå­˜å–æ¬Šé™&lt;span class="absolute -mt-20" id="ç§»é™¤å°ˆæ¡ˆå­˜å–æ¬Šé™">&lt;/span>
&lt;a href="#%e7%a7%bb%e9%99%a4%e5%b0%88%e6%a1%88%e5%ad%98%e5%8f%96%e6%ac%8a%e9%99%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>æˆ‘å€‘å†æ¬¡åˆ‡å› Username ä¸»æ§å°ï¼Œé¸æ“‡ menu &amp;gt; &lt;strong>IAM èˆ‡ç®¡ç†&lt;/strong> ï¼Œæ‰¾åˆ° Username2 æ—é‚Šçš„é‰›ç­†åœ–æ¡ˆ&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/8.png"
alt="ä¿®æ”¹ Username2 æ¬Šé™" width="1200">&lt;figcaption>
&lt;p>ä¿®æ”¹ Username2 æ¬Šé™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>é»æ“Šè§’è‰²åç¨±çš„åƒåœ¾æ¡¶ä¾†ç§»é™¤ Username2 çš„æª¢è¦–è€…æ¬Šé™ï¼Œé»æ“Š &lt;strong>Save&lt;/strong>&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/9.png"
alt="ç§»é™¤ Username2 æ¬Šé™" width="550">&lt;figcaption>
&lt;p>ç§»é™¤ Username2 æ¬Šé™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
é€™å€‹å‹•ä½œè¦å®Œæˆç”Ÿæ•ˆåˆ°æ‰€æœ‰æœå‹™ä¸Šï¼Œæ‰€ä»¥æœƒéœ€è¦ä¸€é»æ™‚é–“ï¼Œè©³ç´°å¯ä»¥åƒè€ƒ&lt;a href="https://cloud.google.com/iam/docs/faq" target="_blank" rel="noopener">é»æˆ‘&lt;/a>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>æª¢æŸ¥ Username2 æ˜¯å¦æœ‰å­˜å–æ¬Šé™&lt;span class="absolute -mt-20" id="æª¢æŸ¥-username2-æ˜¯å¦æœ‰å­˜å–æ¬Šé™">&lt;/span>
&lt;a href="#%e6%aa%a2%e6%9f%a5-username2-%e6%98%af%e5%90%a6%e6%9c%89%e5%ad%98%e5%8f%96%e6%ac%8a%e9%99%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>åˆ‡æ›åˆ° Username2 ä¸»æ§å°ï¼Œé¸æ“‡ menu &amp;gt; &lt;strong>Cloud Storage&lt;/strong> &amp;gt; &lt;strong>Browser&lt;/strong>&lt;/li>
&lt;li>æœƒç™¼ç¾å‡ºç¾ä»¥ä¸‹çš„éŒ¯èª¤è¨Šæ¯ï¼Œä»£è¡¨æˆ‘å€‘ç§»é™¤æ¬Šé™æˆåŠŸ&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/10.png"
alt="Username2 æ²’æœ‰æ¬Šé™" width="800">&lt;figcaption>
&lt;p>Username2 æ²’æœ‰æ¬Šé™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ–°å¢å„²å­˜è§’è‰²&lt;span class="absolute -mt-20" id="æ–°å¢å„²å­˜è§’è‰²">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e%e5%84%b2%e5%ad%98%e8%a7%92%e8%89%b2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>æˆ‘å€‘å†æ¬¡åˆ‡æ›åˆ° Username1 ä¸»æ§ç‰ˆï¼Œé¸æ“‡ menu &amp;gt; &amp;gt; &lt;strong>IAM èˆ‡ç®¡ç†&lt;/strong>ï¼Œé»é¸ä¸Šæ–¹ &lt;strong>+ ADD&lt;/strong>ï¼Œåœ¨ New principals ä¸Šè²¼ä¸Š Username2 çš„å¸³è™Ÿï¼ŒRole é¸æ“‡ &lt;strong>Storage Object Viewer&lt;/strong>&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/11.png"
alt="æ–°å¢ Username2 è§’è‰²" width="600">&lt;figcaption>
&lt;p>æ–°å¢ Username2 è§’è‰²&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/12.png"
alt="æŸ¥çœ‹ Username2 æ¬Šé™" width="1000">&lt;figcaption>
&lt;p>æŸ¥çœ‹ Username2 æ¬Šé™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æª¢æŸ¥ Username2 æ˜¯å¦æœ‰å­˜å–æ¬Šé™&lt;span class="absolute -mt-20" id="æª¢æŸ¥-username2-æ˜¯å¦æœ‰å­˜å–æ¬Šé™-1">&lt;/span>
&lt;a href="#%e6%aa%a2%e6%9f%a5-username2-%e6%98%af%e5%90%a6%e6%9c%89%e5%ad%98%e5%8f%96%e6%ac%8a%e9%99%90-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>åˆ‡æ›åˆ° Username2 ä¸»æ§å°ï¼Œå› ç‚º Username2 æ²’æœ‰å°ˆæ¡ˆæª¢è¦–è€…çš„è§’è‰²ï¼Œæ‰€ä»¥çœ‹ä¸åˆ°å°ˆæ¡ˆä»¥åŠä»»ä½•çš„è³‡æºï¼Œä½†é€™å€‹ä½¿ç”¨è€…å°æˆ‘å€‘å‰›å‰›è¨­å®šçš„ Cloud Storage æœ‰ç‰¹åˆ¥çš„å­˜å–æ¬Š&lt;/li>
&lt;li>æ‰“é–‹å³ä¸Šè§’çš„ Activate Cloud Shell å‘½ä»¤åˆ—å·¥å…· ï¼Œå¦‚ä¸‹åœ–ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/13.png"
alt="é–‹å•Ÿ Activate Cloud Shell å‘½ä»¤åˆ—å·¥å…·" width="1200">&lt;figcaption>
&lt;p>é–‹å•Ÿ Activate Cloud Shell å‘½ä»¤åˆ—å·¥å…·&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>è¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>gsutil ls gs://&amp;lt;å‰›å‰›å»ºçš„ Cloud Storage åç¨±&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å¦‚æœå‡ºç¾è·Ÿä¸‹æ–¹åœ–ç‰‡ä¸€æ¨£ï¼Œå°±ä»£è¡¨æˆ‘å€‘è¨­å®šæˆåŠŸå›‰ï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/14.png"
alt="Username2 Storage Object Viewer æ¬Šé™" width="600">&lt;figcaption>
&lt;p>Username2 Storage Object Viewer æ¬Šé™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æœ€å¾Œçš„æœ€å¾Œï¼Œå¦‚æœæœ‰è·Ÿæˆ‘å€‘ä¸€æ­¥ä¸€æ­¥ä¾†çš„æœ‹å‹ï¼Œåœ¨ &lt;a href="https://www.cloudskillsboost.google/focuses/551?parent=catalog" target="_blank" rel="noopener">[Qwiklabs] Cloud IAMï¼šQwik Start&lt;/a> é é¢ä¸­ï¼Œæ‡‰è©²æœƒçœ‹åˆ°ä¸€å€‹å« Check my progress çš„æŒ‰éˆ•ï¼Œåšå®Œæ¯ä¸€æ­¥é©Ÿï¼Œéƒ½å¯ä»¥é»ä¸€ä¸‹ï¼Œä»–æœƒè‡ªå‹•å»åˆ¤æ–·ä½ æ˜¯å¦æœ‰å®Œæˆé€™é …å‹•ä½œæ­ï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/iam/15.png"
alt="Check my progress" width="600">&lt;figcaption>
&lt;p>Check my progress&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>åˆ°é€™é‚Šå°±å®Œæˆäº†æˆ‘å€‘åœ¨ IAM çš„æ¸¬è©¦å›‰ï½æˆ‘å€‘çŸ¥é“ IAM å¯ä»¥è¨­å®šå¾ˆå¤šçš„è§’è‰²ï¼Œä»¥åŠæ¸¬è©¦äº†æŸ¥çœ‹ã€æ–°å¢ã€ä¿®æ”¹ã€åˆªé™¤è§’è‰²çš„åŠŸèƒ½ï¼Œå¸Œæœ›å¤§å®¶æœƒå–œæ­¡ä»Šå¤©çš„æ–‡ç«  ğŸ¥°&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>IAM æ¦‚è¦½ï¼š&lt;a href="https://cloud.google.com/iam/docs/overview" target="_blank" rel="noopener">https://cloud.google.com/iam/docs/overview&lt;/a>&lt;/p>
&lt;p>ä»€éº¼æ˜¯ Cloud IAMï¼ŸGCP æ¬Šé™ç®¡ç†æœå‹™ä»‹ç´¹ï¼š&lt;a href="https://blog.cloud-ace.tw/identity-security/what-is-cloud-iam/" target="_blank" rel="noopener">https://blog.cloud-ace.tw/identity-security/what-is-cloud-iam/&lt;/a>&lt;/p></description></item><item><title>Google Cloud Platform (GCP) - Compute Engine</title><link>https://pin-yi.me/blog/gcp/compute-engine/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/compute-engine/</guid><description>
&lt;p>è·Ÿå¤§å®¶ä»‹ç´¹ä¸€ä¸‹ä»Šå¤©çš„ä¸»é¡Œ Google Compute Engine(GCE)ï¼ŒGCE æ˜¯ Google Cloud ä¸Šçš„åŸºç¤æ¶æ§‹æœå‹™ (IaaS)ï¼Œè©²å¹³å°å¯ä»¥æä¾›å¤§è¦æ¨¡çš„è™›æ“¬æ©Ÿå™¨ä»¥åŠç›¸é—œçš„åŸºç¤å»ºè¨­ (åŒ…å«ç¡¬ç¢Ÿã€ç¶²è·¯ã€é™„è¼‰å¹³è¡¡å™¨&amp;hellip; ç­‰ç­‰)ä¾†å»ºç½®åŠé‹ä½œæ‚¨çš„æœå‹™ï¼Œé‚£æˆ‘å€‘å¯ä»¥å°‡ GCE æœå‹™çš„ä¸»è¦åŠŸèƒ½åŠƒåˆ†æˆä»¥ä¸‹å¹¾é»ï¼š&lt;/p>
&lt;br>
&lt;h2>Google Compute Engine ç‰¹è‰²&lt;span class="absolute -mt-20" id="google-compute-engine-ç‰¹è‰²">&lt;/span>
&lt;a href="#google-compute-engine-%e7%89%b9%e8%89%b2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>ç©©å¥çš„ç¶²è·¯åŠŸèƒ½&lt;span class="absolute -mt-20" id="ç©©å¥çš„ç¶²è·¯åŠŸèƒ½">&lt;/span>
&lt;a href="#%e7%a9%a9%e5%81%a5%e7%9a%84%e7%b6%b2%e8%b7%af%e5%8a%9f%e8%83%bd" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æä¾›ä½¿ç”¨è€…æ“æœ‰ç©©å¥çš„ç¶²è·¯åŠŸèƒ½ï¼Œä»¥é‹è¡Œå„é …æ‡‰ç”¨ç¨‹å¼åŠæœå‹™ã€‚&lt;/p>
&lt;br>
&lt;h3>è‡ªè¨‚ç¶²è·¯èˆ‡é è¨­ç¶²è·¯&lt;span class="absolute -mt-20" id="è‡ªè¨‚ç¶²è·¯èˆ‡é è¨­ç¶²è·¯">&lt;/span>
&lt;a href="#%e8%87%aa%e8%a8%82%e7%b6%b2%e8%b7%af%e8%88%87%e9%a0%90%e8%a8%ad%e7%b6%b2%e8%b7%af" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>GCE åŒ…å«å…§éƒ¨èˆ‡å¤–éƒ¨çš„ç¶²è·¯é€£ç·šèƒ½åŠ›ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥é€éè‡ªè¨‚è¦åŠƒä¾†å»ºç½®å±¬æ–¼è‡ªå·±æœå‹™é©ç”¨çš„ç¶²è·¯ï¼Œè€Œåœ¨ GCE æœå‹™é–‹é€šç•¶ä¸‹ï¼Œä¹Ÿæä¾›é è¨­çš„ default networkï¼Œå…§å»ºå¸¸ç”¨çš„è·¯ç”±èˆ‡é˜²ç«ç‰†è¨­å®š (ä¾‹å¦‚ï¼šSSHã€RDPã€ICMP&amp;hellip; ç­‰)ï¼Œä¾›å…¥é–€ä½¿ç”¨è€…ç›´æ¥ä½¿ç”¨ã€‚&lt;/p>
&lt;br>
&lt;h3>é˜²ç«ç‰†è¦å‰‡&lt;span class="absolute -mt-20" id="é˜²ç«ç‰†è¦å‰‡">&lt;/span>
&lt;a href="#%e9%98%b2%e7%81%ab%e7%89%86%e8%a6%8f%e5%89%87" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é™¤äº†é è¨­é˜²ç«ç‰†è¦å‰‡å¤–ï¼Œä½¿ç”¨è€…ä¹Ÿå¯ä»¥é€éè‡ªå»ºé˜²ç«ç‰†ä¾†é–‹æ”¾å¯ä»¥é€£å…¥çš„ IPã€‚&lt;/p>
&lt;br>
&lt;h3>å„å€åŸŸçš„ HTTP(S) çš„è² è¼‰å¹³è¡¡&lt;span class="absolute -mt-20" id="å„å€åŸŸçš„-https-çš„è² è¼‰å¹³è¡¡">&lt;/span>
&lt;a href="#%e5%90%84%e5%8d%80%e5%9f%9f%e7%9a%84-https-%e7%9a%84%e8%b2%a0%e8%bc%89%e5%b9%b3%e8%a1%a1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç‚º Layer 7 çš„è² è¼‰å¹³è¡¡è¨­å‚™ï¼Œé€éè¨­å®šå¯ä»¥ä¸²é€£å¤šå°ä¸»æ©Ÿæˆ–æ˜¯ä¸»æ©Ÿç¾¤çµ„ï¼Œè®“æœå‹™ä¸å†åªæ˜¯ä¾è³´æ–¼å–®é»å­˜åœ¨çš„ä¼ºæœå™¨ã€‚Layer 7 çš„è² è¼‰å¹³è¡¡æ›´å¯ä»¥è­˜åˆ¥è·¯ç”±è¦åŠƒï¼Œé€²ä¸€æ­¥å¯ä»¥æä¾›ä¸åŒè·¯ç”±çš„é‡å°è¦å‰‡è¨­å®šï¼Œä¹Ÿå¯ä»¥æä¾› CDN çš„ Cache åŠŸèƒ½ã€‚&lt;/p>
&lt;br>
&lt;h3>ç¶²è·¯çš„è² è¼‰å¹³è¡¡&lt;span class="absolute -mt-20" id="ç¶²è·¯çš„è² è¼‰å¹³è¡¡">&lt;/span>
&lt;a href="#%e7%b6%b2%e8%b7%af%e7%9a%84%e8%b2%a0%e8%bc%89%e5%b9%b3%e8%a1%a1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç‚º Layer4 çš„è² è¼‰å¹³è¡¡è¨­å‚™ï¼Œå¯ä»¥é€é Protocol èˆ‡ Port çš„æ–¹å¼ä¾†é‡å°å¤–éƒ¨æµé‡åˆ° GCE ä¸»æ©Ÿæˆ–ä¸»æ©Ÿç¾¤ï¼Œä¸¦å¯ä»¥é€é Health Check çš„æ–¹å¼ï¼Œè®“æµé‡åƒ…é€šéå¥åº·çš„ä¸»æ©Ÿï¼Œé¿å…æœå‹™ä¸­æ–·ã€‚&lt;/p>
&lt;br>
&lt;h3>å­ç¶²è·¯&lt;span class="absolute -mt-20" id="å­ç¶²è·¯">&lt;/span>
&lt;a href="#%e5%ad%90%e7%b6%b2%e8%b7%af" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é€é CIDR çš„æ–¹å¼è¨­å®š GCE Network ä¸­çš„å„å­ç¶²è·¯ç¯„åœï¼Œä¸¦å¯ä»¥é€éè·¯ç”±çš„æ–¹å¼ä¸²æ¥å„å­ç¶²è·¯ä¸­é–“çš„é€šè¨Šï¼Œè®“ GCE ç¶²è·¯çš„è¨­è¨ˆè¦åŠƒå¯ä»¥æ›´æœ‰å½ˆæ€§ï¼Œä¹Ÿå¯ä»¥è®“å­ç¶²è·¯çš„è¦åŠƒä¾†å¯¦ä½œæ›´å®‰å…¨çš„é›²ç«¯ç¶²è·¯æ¶æ§‹ã€‚&lt;/p>
&lt;br>
&lt;h2>Google Compute Engine æ¸¬è©¦&lt;span class="absolute -mt-20" id="google-compute-engine-æ¸¬è©¦">&lt;/span>
&lt;a href="#google-compute-engine-%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é¦–å…ˆæˆ‘å€‘ä½¿ç”¨ cloudskillsboost æä¾›çš„ &lt;a href="https://www.cloudskillsboost.google/focuses/3563?locale=zh_TW&amp;amp;parent=catalog" target="_blank" rel="noopener">Creating a Virtual Machine &lt;/a> ä¾†åšç·´ç¿’ï¼Œæ‰“é–‹å¾Œï¼Œè«‹å…ˆç™»å…¥è‡ªå·±çš„ Google å¸³è™Ÿï¼Œæ¥è‘—é»é¸å·¦ä¸Šè§’çš„ &lt;strong>Start Lab&lt;/strong>ï¼Œæœƒè·³å‡ºèˆ‡ä¸‹é¢åœ–ç‰‡é¡ä¼¼çš„å…§å®¹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/1.png"
alt="æ¸¬è©¦ç”¨çš„å¸³è™Ÿå¯†ç¢¼" width="250">&lt;figcaption>
&lt;p>æ¸¬è©¦ç”¨çš„å¸³è™Ÿå¯†ç¢¼&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ–°å¢æ–°çš„ VM å¯¦ä¾‹&lt;span class="absolute -mt-20" id="æ–°å¢æ–°çš„-vm-å¯¦ä¾‹">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e%e6%96%b0%e7%9a%84-vm-%e5%af%a6%e4%be%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>é»é¸ &lt;strong>Open Google Console&lt;/strong> æŒ‰éˆ•ä¾†é–‹å•Ÿ GCP ä¸»æ§å°&lt;/li>
&lt;li>ç™»å…¥å¸³è™Ÿå°±ä½¿ç”¨ä¸Šé¢åœ–ç‰‡æ‰€æä¾›çš„å¸³è™Ÿå¯†ç¢¼ä¾†é€²è¡Œç™»å…¥&lt;/li>
&lt;li>ç™»å…¥æˆåŠŸæœƒé€²å…¥ GCP ä¸»æ§å°ï¼Œé»é¸å·¦å´çš„ menu &amp;gt; &lt;strong>Compute Engine&lt;/strong> &amp;gt; &lt;strong>VM Instances&lt;/strong>ï¼Œå¯ä»¥åƒè€ƒä¸‹æ–¹åœ–ç‰‡&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/2.png"
alt="æ–°å¢ VM å¯¦ä¾‹" width="600">&lt;figcaption>
&lt;p>æ–°å¢ VM å¯¦ä¾‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>é»é¸ &lt;strong>CREATE INSTANCE&lt;/strong>ï¼Œè«‹ä¾ç…§ä¸‹æ–¹è¡¨æ ¼ä¾†é€²è¡Œè¨­å®šï¼š&lt;/li>
&lt;/ol>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">æ¨™é¡Œ&lt;/th>
&lt;th style="text-align:center">è¨­å®šå€¼&lt;/th>
&lt;th style="text-align:center">èªªæ˜&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">Name&lt;/td>
&lt;td style="text-align:center">gcelab&lt;/td>
&lt;td style="text-align:center">è™›æ“¬æ©Ÿå¯¦ä¾‹çš„åç¨±&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">Region&lt;/td>
&lt;td style="text-align:center">us-central1ï¼ˆæ„›è·è¯å·ï¼‰&lt;/td>
&lt;td style="text-align:center">æœ‰é—œå€åŸŸçš„æ›´å¤šä¿¡æ¯ï¼Œè«‹åƒé–± Compute Engine æŒ‡å— &lt;a href="https://cloud.google.com/compute/docs/regions-zones" target="_blank" rel="noopener">Regions and zones&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">Zone&lt;/td>
&lt;td style="text-align:center">us-central1-f&lt;/td>
&lt;td style="text-align:center">&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">Series&lt;/td>
&lt;td style="text-align:center">N1&lt;/td>
&lt;td style="text-align:center">&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">Machine type&lt;/td>
&lt;td style="text-align:center">n1-standard-2&lt;/td>
&lt;td style="text-align:center">é€™æ˜¯ä¸€å€‹ 2 vCPUã€7.5 GB RAM å¯¦ä¾‹&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">Boot disk&lt;/td>
&lt;td style="text-align:center">New balanced persistent disk/10 GB/Debian GNU/Linux 10&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">Firewall&lt;/td>
&lt;td style="text-align:center">Allow HTTP taffic&lt;/td>
&lt;td style="text-align:center">&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/3.png"
alt="VM å¯¦ä¾‹ (Nameã€Regionã€Zoneã€Series)" width="800">&lt;figcaption>
&lt;p>VM å¯¦ä¾‹ (Nameã€Regionã€Zoneã€Series)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/4.png"
alt="VM å¯¦ä¾‹ (Machine typeã€Boot diskã€Firewall)" width="800">&lt;figcaption>
&lt;p>VM å¯¦ä¾‹ (Machine typeã€Boot diskã€Firewall)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="5">
&lt;li>æ–°å¢å®Œå¾Œï¼Œå¤§ç´„éœ€è¦ç­‰å¾…ä¸€åˆ†é˜ï¼Œæ–°çš„è™›æ“¬æ©Ÿå°±æœƒåˆ—åœ¨ &lt;strong>VM Instances&lt;/strong> é é¢ä¸Šã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/5.png"
alt="VM å¯¦ä¾‹" width="1000">&lt;figcaption>
&lt;p>VM å¯¦ä¾‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>å®‰è£ NGINX Web æœå‹™å™¨&lt;span class="absolute -mt-20" id="å®‰è£-nginx-web-æœå‹™å™¨">&lt;/span>
&lt;a href="#%e5%ae%89%e8%a3%9d-nginx-web-%e6%9c%8d%e5%8b%99%e5%99%a8" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>é»æ“Š VM instances å¯¦ä¾‹æœ€å¾Œçš„ SSHï¼Œæœƒé–‹å•Ÿ SSH ç”¨æˆ¶ç«¯&lt;/li>
&lt;li>åœ¨ SSH çµ‚ç«¯ï¼Œè¦å…ˆç²å¾— &lt;code>root&lt;/code> è¨ªå•æ¬Šé™ï¼Œæ‰æ›´æ–¹ä¾¿çš„é€²è¡Œå¾ŒçºŒçš„å‹•ä½œï¼Œè«‹å…ˆä½¿ç”¨ä¸€ä¸‹æŒ‡ä»¤ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo su -&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>åˆ©ç”¨ &lt;code>root&lt;/code> ç”¨æˆ¶ï¼Œä¾†æ›´æ–°æ“ä½œç³»çµ±ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>apt-get update&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/6.png"
alt="æ›´æ–°æ“ä½œç³»çµ±" width="1000">&lt;figcaption>
&lt;p>æ›´æ–°æ“ä½œç³»çµ±&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>å®‰è£ NGINXï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>apt-get nginx -y&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/7.png"
alt="å®‰è£ NGINX" width="1000">&lt;figcaption>
&lt;p>å®‰è£ NGINX&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="5">
&lt;li>æœ€å¾Œç¢ºèª NGINX æ˜¯å¦é‹è¡Œï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ps auwx | grep nginx&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/8.png"
alt="ç¢ºèª NGINX æ˜¯å¦é‹è¡Œ" width="1000">&lt;figcaption>
&lt;p>ç¢ºèª NGINX æ˜¯å¦é‹è¡Œ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="6">
&lt;li>å¯ä»¥æ‰“é–‹ç€è¦½å™¨ç€è¦½ &lt;code>http://å¤–éƒ¨ IP/&lt;/code> æˆ–æ˜¯ä½¿ç”¨ &lt;code>curl å¤–éƒ¨IP&lt;/code>ï¼Œå¤–éƒ¨ IP æœƒåœ¨è·Ÿå‰›å‰› VM å¯¦ä¾‹çš„ External IP æ¬„ä½å‘¦ï½&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/9.png"
alt="curl å¤–éƒ¨ IP" width="700">&lt;figcaption>
&lt;p>curl å¤–éƒ¨ IP&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="7">
&lt;li>å®Œæˆå¾Œï¼Œè¨˜å¾—å¯ä»¥é»é¸ &lt;strong>Check my progress&lt;/strong> ä¾†æª¢æŸ¥é€²åº¦å§ï¼&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/10.png"
alt="Check my progress" width="500">&lt;figcaption>
&lt;p>Check my progress&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ä½¿ç”¨ gcloud å‰µå»ºä¸€å€‹æ–°å¯¦ä¾‹&lt;span class="absolute -mt-20" id="ä½¿ç”¨-gcloud-å‰µå»ºä¸€å€‹æ–°å¯¦ä¾‹">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8-gcloud-%e5%89%b5%e5%bb%ba%e4%b8%80%e5%80%8b%e6%96%b0%e5%af%a6%e4%be%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘å‰›å‰›æ˜¯ä½¿ç”¨ç¶²é ç‰ˆä¾†æ–°å¢ï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ gcloud æŒ‡ä»¤ä¾†æ–°å¢ï¼Œé€™å€‹å·¥å…·æœ‰é å…ˆè£åœ¨ &lt;a href="https://cloud.google.com/shell#how_do_i_get_started" target="_blank" rel="noopener">Google Cloud Shell&lt;/a> ä¸­ã€‚Cloud Shell æ˜¯ä¸€å€‹åŸºæ–¼ Debian çš„è™›æ“¬æ©Ÿï¼ŒåŒ…å«äº†å¸¸ç”¨çš„é–‹ç™¼å·¥å…· (&lt;code>gcloud&lt;/code>ã€&lt;code>git&lt;/code> ç­‰å·¥å…·)ï¼Œå¦å¤–ä½ ä¹Ÿå¯ä»¥å°‡ gcloud ä¸‹è¼‰è‡³æœ¬æ©Ÿä¸Šä¾†åšä½¿ç”¨ï¼Œè«‹é–±è®€&lt;a href="https://cloud.google.com/sdk/gcloud/" target="_blank" rel="noopener"> gcloud å‘½ä»¤è¡Œå·¥å…·æŒ‡å—&lt;/a>&lt;/p>
&lt;br>
&lt;ol>
&lt;li>åœ¨ Cloud Shell ä¸­ï¼Œä½¿ç”¨ &lt;code>gcloud&lt;/code> ä¾†æ–°å¢æ–°çš„è™›æ“¬æ©Ÿå¯¦ä¾‹ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>gcloud compute instances create gcelab2 --machine-type n1-standard-2 --zone us-central1-f&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å°±æœƒè·³å‡ºä»¥ä¸‹åœ–ç‰‡çš„å…§å®¹ï¼Œéä¸€é™£å­å»æŸ¥çœ‹ VM Instances ä¹Ÿå¯ä»¥çœ‹åˆ°æˆ‘å€‘æ‰€æ–°å¢çš„è™›æ“¬æ©Ÿå¯¦ä¾‹æ­ï½&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/compute-engine/11.png"
alt="Check my progress" width="1000">&lt;figcaption>
&lt;p>Check my progress&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>åˆ°é€™é‚Šå°±å®Œæˆäº†æˆ‘å€‘ Google Compute Engine æ¸¬è©¦å›‰ï½æˆ‘å€‘çŸ¥é“å¯ä»¥æ–°å¢ GCE å°‡å¯¦é«”ä¸»æ©Ÿçš„å…§å®¹ï¼Œç§»æ¤åˆ°é›²ç«¯ä¸Šå›‰ï¼å¸Œæœ›å¤§å®¶æœƒå–œæ­¡ä»Šå¤©çš„æ–‡ç«  ğŸ¥°&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Compute Engine åŸºæœ¬ä»‹ç´¹ï¼š&lt;a href="https://gdgcloud-taipei.gitbook.io/google-cloud-platform-in-practice/google-cloud-shang-de-yun-suan-fu-wu/compute-engine/compute-engine-ji-ben-jie-shao" target="_blank" rel="noopener">https://gdgcloud-taipei.gitbook.io/google-cloud-platform-in-practice/google-cloud-shang-de-yun-suan-fu-wu/compute-engine/compute-engine-ji-ben-jie-shao&lt;/a>&lt;/p>
&lt;p>Creating a Virtual Machineï¼š&lt;a href="https://www.cloudskillsboost.google/focuses/3563?locale=zh_TW&amp;amp;parent=catalog" target="_blank" rel="noopener">https://www.cloudskillsboost.google/focuses/3563?locale=zh_TW&amp;amp;parent=catalog&lt;/a>&lt;/p></description></item><item><title>Google Cloud Platform (GCP) - Cloud Source Repositories</title><link>https://pin-yi.me/blog/gcp/cloud-source-repositories/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/cloud-source-repositories/</guid><description>
&lt;p>è·Ÿå¤§å®¶ä»‹ç´¹ä¸€ä¸‹ä»Šå¤©çš„ä¸»é¡Œ Cloud Source Repositoriesï¼Œè½åˆ° Source Repositories æ˜¯ä¸æ˜¯æ„Ÿè¦ºè·Ÿä»€éº¼æ±è¥¿å¾ˆåƒå‘€ï¼Œæ²’éŒ¯ï¼Œå°±è·Ÿæˆ‘å€‘çš„ GitHub or GitLab ä¸€æ¨£ï¼Œå¯ä»¥ç”¨ä¾†å­˜æ”¾æˆ‘å€‘çš„ç¨‹å¼ç¢¼çš„å„²å­˜åº«ï¼Œæˆ‘å€‘ä¾†çœ‹çœ‹å®˜æ–¹æ€éº¼ä»‹ç´¹ä»–å§ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/1.png"
alt="å®˜æ–¹ä»‹ç´¹ Cloud Source Repositories" width="800">&lt;figcaption>
&lt;p>å®˜æ–¹ä»‹ç´¹ Cloud Source Repositories&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¾ˆå¥½æ­ï¼Œéå¸¸ç°¡å–®æ˜ç­ ğŸ¤£ï¼Œæ²’éŒ¯ï¼ŒCloud Source Repositories å°±æ˜¯è¨—ç®¡åœ¨ Google Cloud ä¸ŠåŠŸèƒ½é½Šå…¨(ï¼Ÿ)çš„ç§æœ‰ Git å„²å­˜åº«ã€‚ç‚ºä»€éº¼æœƒæ‰“ä¸€å€‹å•è™Ÿå‘¢ï¼Ÿæ˜¯å› ç‚ºä»–å…¶å¯¦æ²’æœ‰é‚£éº¼å¥½ç”¨ï¼Œæ‰€ä»¥æˆ‘å€‘é€šå¸¸çš„åšæ³•ï¼Œé‚„æ˜¯æœƒä¾é  GitHab æˆ–æ˜¯ GitLab ä¾†å­˜æ”¾ç¨‹å¼ç¢¼ï¼Œå†é€éé¡åƒ (mirror) çš„æ–¹å¼åˆ° Google Cloud Source Repositoriesã€‚ é‚£æˆ‘å€‘å°±é–‹å§‹å›‰ï½&lt;/p>
&lt;br>
&lt;h2>Cloud Source Repositories æ¸¬è©¦&lt;span class="absolute -mt-20" id="cloud-source-repositories-æ¸¬è©¦">&lt;/span>
&lt;a href="#cloud-source-repositories-%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>å»ºç«‹ GitLab Project&lt;span class="absolute -mt-20" id="å»ºç«‹-gitlab-project">&lt;/span>
&lt;a href="#%e5%bb%ba%e7%ab%8b-gitlab-project" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é¦–å…ˆï¼Œæˆ‘å€‘ç”¨ GitLab ä¾†ç•¶ç¤ºç¯„ï¼Œå¦‚ä½•é€éé¡åƒ (mirror) åˆ° Cloud Source Repositories ä¸Šé¢ï¼Œæˆ‘å€‘å…ˆåœ¨ GitLab ä¸Šå»ºç«‹ä¸€å€‹ Projectï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/2.png"
alt="å»ºç«‹ GitLab Project" width="800">&lt;figcaption>
&lt;p>å»ºç«‹ GitLab Project&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ä½¿ç”¨ gcloud æŒ‡ä»¤å»ºç«‹ Source Repo&lt;span class="absolute -mt-20" id="ä½¿ç”¨-gcloud-æŒ‡ä»¤å»ºç«‹-source-repo">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8-gcloud-%e6%8c%87%e4%bb%a4%e5%bb%ba%e7%ab%8b-source-repo" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>é¦–å…ˆï¼Œä¸€å®šè¦å…ˆè£ &lt;code>gcloud&lt;/code> æŒ‡ä»¤åˆ°æœ¬æ©Ÿï¼Œé€™å€‹æ­¥é©Ÿï¼Œå‰é¢æ–‡ç« ä¹Ÿæœ‰èªªéï¼Œé€™é‚Šå°±ä¸åœ¨èªªæ˜ï¼Œæˆ‘å€‘å…ˆä½¿ç”¨ä¸€ä¸‹æŒ‡ä»¤ä¾†æŸ¥çœ‹ç›®å‰æ‰€åœ¨çš„ GCP å°ˆæ¡ˆï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>gcloud config get-value project&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ­£å¸¸ä¾†èªªï¼Œå¦‚æœæœ‰å…ˆç”¨ config è¨­å®šå¥½ï¼Œæœƒç›´æ¥è·³å‡ºä½ ç›®å‰çš„å°ˆæ¡ˆ IDï¼Œå¦‚æœæ²’æœ‰è·³å‡ºä¾†ï¼Œè«‹ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ä¾†è¨­å®šï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>gcloud config set project &amp;lt;project id&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>æ¥è‘—æˆ‘å€‘è¦å•Ÿå‹•è©²å°ˆæ¡ˆçš„ Cloud Source Repositories APIï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>gcloud services enable sourcerepo.googleapis.com&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>å‰µå»º Cloud Source Repositories&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>gcloud source repos create &amp;lt;repo name&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ol start="4">
&lt;li>å®Œæˆå¾Œï¼Œé–‹å•Ÿ GCP æª¢æŸ¥ä¸€ä¸‹æ˜¯å¦æœ‰å»ºç«‹æˆåŠŸï½é»æ“Šå·¦å´ menu &amp;gt; &lt;strong>Source Repositories&lt;/strong>ï¼Œ&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/3.png"
alt="é–‹å•Ÿ Source Repositories" width="800">&lt;figcaption>
&lt;p>é–‹å•Ÿ Source Repositories&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/4.png"
alt="æˆåŠŸå»ºç«‹ Source Repositories" width="1000">&lt;figcaption>
&lt;p>æˆåŠŸå»ºç«‹ Source Repositories&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>å°‡ç¨‹å¼ç¢¼æ–°å¢è‡³å­˜æ”¾å€ä¸­&lt;span class="absolute -mt-20" id="å°‡ç¨‹å¼ç¢¼æ–°å¢è‡³å­˜æ”¾å€ä¸­">&lt;/span>
&lt;a href="#%e5%b0%87%e7%a8%8b%e5%bc%8f%e7%a2%bc%e6%96%b0%e5%a2%9e%e8%87%b3%e5%ad%98%e6%94%be%e5%8d%80%e4%b8%ad" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>æˆ‘å€‘è¦åœ¨é€™ä¸€æ­¥ä¾†è¨­å®šé¡åƒ (mirror)ï¼Œé¦–å…ˆæˆ‘å€‘çœ‹å‰›å‰›ä¸Šé¢å»ºç«‹å¥½çš„ Source Repositoriesï¼Œå…¶ä¸­æœ‰ä¸€å€‹&lt;strong>æ‰‹å‹•ç”¢ç”Ÿçš„æ†‘è­‰&lt;/strong>ï¼Œé»é¸ &lt;strong>ç”¢ç”ŸåŠå„²å­˜ Git æ†‘è­‰&lt;/strong>&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/5.png"
alt="ç”¢ç”ŸåŠå„²å­˜ Git æ†‘è­‰" width="650">&lt;figcaption>
&lt;p>ç”¢ç”ŸåŠå„²å­˜ Git æ†‘è­‰&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>é»å®Œå¾Œæœƒéœ€è¦å…ˆç™»å…¥ä½ çš„ GCP å¸³è™Ÿï¼Œç™»å…¥å®Œå¾Œæœƒå‡ºç¾ä»¥ä¸‹å…§å®¹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/6.png"
alt="Configure Git" width="800">&lt;figcaption>
&lt;p>Configure Git&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>æ¥è‘—æŠŠè—è‰²æ¡†æ¡†å…§çš„è¼¸å…¥åˆ°çµ‚ç«¯æ©Ÿå…§&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/7.png"
alt="Configure Git" width="800">&lt;figcaption>
&lt;p>Configure Git&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>æ¥è‘—è«‹è¤‡è£½ä»¥ä¸‹æŒ‡ä»¤è²¼åˆ°çµ‚ç«¯æ©Ÿå…§ï¼Œæœƒç”Ÿæˆæ†‘è­‰å¯†ç¢¼ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>grep &lt;span style="color:#e6db74">&amp;#39;source.developers.google.com&amp;#39;&lt;/span> ~/.gitcookies | tail -1 | cut -d&lt;span style="color:#f92672">=&lt;/span> -f2&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/8.png"
alt="ç”Ÿæˆæ†‘è­‰å¯†ç¢¼" width="800">&lt;figcaption>
&lt;p>ç”Ÿæˆæ†‘è­‰å¯†ç¢¼&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="5">
&lt;li>æ¥è‘—è«‹è¤‡è£½ä»¥ä¸‹æŒ‡ä»¤è²¼åˆ°çµ‚ç«¯æ©Ÿå…§ï¼Œå°‡ç”¨æˆ¶åå­˜å„²åœ¨ CSR_USER ç’°å¢ƒè®Šé‡ä¸­ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>CSR_USER&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>grep &lt;span style="color:#e6db74">&amp;#39;source.developers.google.com&amp;#39;&lt;/span> ~/.gitcookies | &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> tail -1 | cut -d&lt;span style="color:#e6db74">$&amp;#39;\t&amp;#39;&lt;/span> -f7 | cut -d&lt;span style="color:#f92672">=&lt;/span> -f1&lt;span style="color:#66d9ef">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/9.png"
alt="ç”¨æˆ¶åå­˜å„²åœ¨ CSR_USER ç’°å¢ƒè®Šé‡ä¸­" width="800">&lt;figcaption>
&lt;p>ç”¨æˆ¶åå­˜å„²åœ¨ CSR_USER ç’°å¢ƒè®Šé‡ä¸­&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="6">
&lt;li>æ¥è‘—è«‹è¤‡è£½ä»¥ä¸‹æŒ‡ä»¤è²¼åˆ°çµ‚ç«¯æ©Ÿå…§ï¼Œå°‡ GCP å­˜å„²åº«çš„ URL å­˜å„²åœ¨ CSR_REPO ç’°å¢ƒè®Šé‡ä¸­ (repo name è¦æ”¹æˆä½ åœ¨ gcp ä¸Šé¢çš„ repo)ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>CSR_REPO&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>gcloud source repos describe &amp;lt;repo name&amp;gt; --format&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;value(url)&amp;#34;&lt;/span>&lt;span style="color:#66d9ef">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/10.png"
alt="å°‡ GCP å­˜å„²åº«çš„ URL å­˜å„²åœ¨ CSR_REPO ç’°å¢ƒè®Šé‡ä¸­" width="800">&lt;figcaption>
&lt;p>å°‡ GCP å­˜å„²åº«çš„ URL å­˜å„²åœ¨ CSR_REPO ç’°å¢ƒè®Šé‡ä¸­&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="7">
&lt;li>æ¥è‘—è«‹è¤‡è£½ä»¥ä¸‹æŒ‡ä»¤è²¼åˆ°çµ‚ç«¯æ©Ÿå…§ï¼Œå°‡å­˜å„²åº«çš„ URLï¼ˆåŒ…æ‹¬ç”¨æˆ¶åï¼‰å°åˆ°çµ‚ç«¯æ©Ÿä¸Šï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>echo $CSR_REPO | sed &lt;span style="color:#e6db74">&amp;#34;s/:\/\//:\/\/&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>CSR_USER&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">@/&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/11.png"
alt="å­˜å„²åº«çš„ URLï¼ˆåŒ…æ‹¬ç”¨æˆ¶åï¼‰å°åˆ°çµ‚ç«¯æ©Ÿä¸Š" width="800">&lt;figcaption>
&lt;p>å­˜å„²åº«çš„ URLï¼ˆåŒ…æ‹¬ç”¨æˆ¶åï¼‰å°åˆ°çµ‚ç«¯æ©Ÿä¸Š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç¶“éä¸Šé¢æ“ä½œï¼Œæˆ‘å€‘å¯ä»¥åœ¨ç¬¬ 4 æ­¥é©Ÿæ‹¿åˆ°å¯†ç¢¼ï¼Œä»¥åŠåœ¨ç¬¬ 7 æ­¥é©Ÿæ‹¿åˆ°å®Œæ•´çš„ GCP URLï¼Œæ¥è‘—æˆ‘å€‘è¦åˆ° GItLab Mirror ä¾†è¨­å®šé¡åƒã€‚&lt;/p>
&lt;br>
&lt;h3>åˆ° GitLab Mirror è¨­å®šé¡åƒ&lt;span class="absolute -mt-20" id="åˆ°-gitlab-mirror-è¨­å®šé¡åƒ">&lt;/span>
&lt;a href="#%e5%88%b0-gitlab-mirror-%e8%a8%ad%e5%ae%9a%e9%8f%a1%e5%83%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>å…ˆå¾å³å´ muen &amp;gt; é¸æ“‡ &lt;strong>Settings&lt;/strong> &amp;gt; é»é¸ &lt;strong>Repository&lt;/strong>ï¼Œæ‰¾åˆ° &lt;strong>Mirroring repositories&lt;/strong>&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/12.png"
alt="GitLab Mirror è¨­å®šé¡åƒ" width="800">&lt;figcaption>
&lt;p>GitLab Mirror è¨­å®šé¡åƒ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>å°‡å‰›å‰›æ‹¿åˆ°çš„ URL ä»¥åŠå¯†ç¢¼å„åˆ¥è¼¸å…¥ Git repository URL ä»¥åŠ Passwordï¼Œè¨˜å¾—è¦é¸æ“‡ Mirror directionï¼Œå› ç‚ºæˆ‘å€‘æ˜¯è¦å°‡ gitlab çš„é¡åƒåˆ° GCP çš„ Cloud Source Repositoriesï¼Œæ‰€ä»¥æˆ‘å€‘è¦é¸æ“‡ &lt;strong>PUSH&lt;/strong>ï¼Œæœ€å¾ŒæŒ‰ä¸‹ &lt;strong>Mirror repository&lt;/strong>ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/13.png"
alt="GitLab Mirror è¨­å®šé¡åƒ" width="800">&lt;figcaption>
&lt;p>GitLab Mirror è¨­å®šé¡åƒ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¦‚æœæ²’æœ‰è·³å‡ºéŒ¯èª¤ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ²’æœ‰å•é¡Œäº†ï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/14.png"
alt="GitLab Mirror æª¢æŸ¥" width="800">&lt;figcaption>
&lt;p>GitLab Mirror æª¢æŸ¥&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>å°±å¯ä»¥è©¦è‘—åœ¨ gitlab ä¸Šé¢æ¨ç¨‹å¼ï¼Œçœ‹çœ‹æœ‰æ²’æœ‰è·‘åˆ° Cloud Source Repositories ä¸Šé¢å›‰ï¼&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-source-repositories/15.png"
alt="GitLab æ¨ç¨‹å¼æ¸¬è©¦" width="800">&lt;figcaption>
&lt;p>GitLab æ¨ç¨‹å¼æ¸¬è©¦&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://cloud.google.com/source-repositories/docs" target="_blank" rel="noopener">Cloud Source Repositories documentation&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://cloud.google.com/architecture/mirroring-gitlab-repositories-to-cloud-source-repositories" target="_blank" rel="noopener">Mirroring GitLab repositories to Cloud Source Repositories&lt;/a>&lt;/p></description></item><item><title>Google Cloud Platform (GCP) - Container Registry</title><link>https://pin-yi.me/blog/gcp/container-registry/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/container-registry/</guid><description>
&lt;p>è·Ÿå¤§å®¶ä»‹ç´¹ä¸€ä¸‹ä»Šå¤©çš„ä¸»é¡Œ Container Registryï¼ŒContainer Registry æ˜¯å„²å­˜ã€ç®¡ç†å’Œä¿è­· Docker å®¹å™¨æ˜ åƒæª”çš„å­˜æ”¾å€ï¼Œå¯ä»¥è®“åœ˜éšŠé€éåŒä¸€é …æœå‹™æœå‹™é›†ä¸­ç®¡ç† Docker æ˜ åƒæª”ã€ä¹Ÿå¯ä»¥åŸ·è¡Œå®‰å…¨æ¼æ´åˆ†æï¼Œé‚„èƒ½é€éç²¾å¯†çš„å­˜å–æ¬Šç®¡ç†æ©Ÿåˆ¶ï¼Œä¾†æ±ºå®šèª°å¯ä»¥å­˜å–å“ªäº›å…§å®¹ã€‚ç°¡å–®ä¾†èªªä»–å°±æ˜¯ä¸€å€‹è®“æˆ‘å€‘å­˜æ”¾ Docker æ˜ åƒæª”çš„åœ°æ–¹ï¼Œä»–æœ‰ä»¥ä¸‹å¹¾å€‹ç‰¹é»ï¼š&lt;/p>
&lt;br>
&lt;h2>Container Registry ç‰¹é»&lt;span class="absolute -mt-20" id="container-registry-ç‰¹é»">&lt;/span>
&lt;a href="#container-registry-%e7%89%b9%e9%bb%9e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ol>
&lt;li>å®‰å…¨çš„ç§äºº Docker è¨»å†Šè³‡æ–™åº«ï¼šåªéœ€è¦å¹¾åˆ†é˜çš„æ™‚é–“ï¼Œå³å¯é–‹å§‹åœ¨ Google Cloud Platform ä¸­ä½¿ç”¨å®‰å…¨çš„ç§äºº Docker æ˜ åƒæª”å„²å­˜ç©ºé–“ï¼Œæ§ç®¡èƒ½å¤ å­˜å–ã€æª¢è¦–æˆ–ä¸‹è¼‰æ˜ åƒæª”çš„äººå“¡ï¼Œä¸¦åœ¨å—åˆ° Google å®‰å…¨é˜²è­·æ©Ÿåˆ¶ä¿è­·çš„åŸºç¤æ¶æ§‹ä¸Šç©©å®šåŸ·è¡Œã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;ol start="2">
&lt;li>è‡ªå‹•å»ºç«‹åŠéƒ¨ç½²æ˜ åƒæª”ï¼šåœ¨æ‚¨ä¿®è¨‚ Cloud Source Repositories ä¸­çš„ç¨‹å¼ç¢¼æ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•å»ºç«‹æ˜ åƒæª”ä¸¦æ¨é€è‡³ç§äººè¨»å†Šè³‡æ–™åº«ã€‚æ‚¨å¯ä»¥è¼•é¬†è¨­å®šæŒçºŒæ•´åˆ/æŒçºŒæ¨é€è»Ÿé«”æ›´æ–°ç®¡é“ï¼Œä¸¦æ•´åˆè‡³ Cloud Buildï¼Œæˆ–æ˜¯ç›´æ¥å°‡ç®¡é“éƒ¨ç½²è‡³ Google Kubernetes Engineã€App Engineã€Cloud Functions æˆ– Firebaseã€‚(é€™å€‹å°±æ˜¯æˆ‘å€‘åœ¨&lt;a href="https://pin-yi.me/blog/gcp/cloud-build/" >ä¸‹ä¸€ç¯‡æ–‡ç« &lt;/a>æœƒä½¿ç”¨åˆ°çš„åŠŸèƒ½)&lt;/li>
&lt;/ol>
&lt;br>
&lt;ol start="3">
&lt;li>æ·±åº¦å®‰å…¨æ¼æ´æƒæï¼šåœ¨è»Ÿé«”éƒ¨ç½²é€±æœŸçš„æ—©æœŸéšæ®µæ‰¾å‡ºå®‰å…¨æ¼æ´ï¼Œè—‰æ­¤ç¢ºä¿æ‚¨å¯ä»¥å®‰å…¨åœ°éƒ¨ç½²å®¹å™¨æ˜ åƒæª”ã€‚è³‡æ–™åº«æœƒæŒçºŒé‡æ–°æ•´ç†ï¼Œè®“æ‚¨çš„å®‰å…¨æ¼æ´æƒæä½œæ¥­å–å¾—æœ€æ–°å‹æƒ¡æ„è»Ÿé«”çš„ç›¸é—œè³‡è¨Šã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;ol start="4">
&lt;li>é–å®šæœ‰é¢¨éšªçš„æ˜ åƒæª”ï¼šé‹ç”¨äºŒé€²ä½æˆæ¬Šçš„åŸç”Ÿæ•´åˆåŠŸèƒ½ä¾†å®šç¾©æ”¿ç­–ï¼Œé¿å…éƒ¨ç½²èˆ‡æ‰€è¨­å®šæ”¿ç­–ç›¸è¡çªçš„æ˜ åƒæª”ã€‚æ‚¨å¯ä»¥è§¸ç™¼å®¹å™¨æ˜ åƒæª”çš„è‡ªå‹•é–å®šåŠŸèƒ½ï¼Œç¦æ­¢å°‡æœ‰é¢¨éšªçš„æ˜ åƒæª”éƒ¨ç½²è‡³ Google Kubernetes Engineã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;ol start="5">
&lt;li>åŸç”Ÿæ”¯æ´ Dockerï¼šæ‚¨ä¸åƒ…å¯ä»¥è¦–éœ€æ±‚å®šç¾©å¤šå€‹è¨»å†Šè³‡æ–™åº«ï¼Œä¹Ÿèƒ½ä½¿ç”¨æ¨™æº–çš„ Docker æŒ‡ä»¤åˆ—ä»‹é¢ï¼Œå°‡ Docker æ˜ åƒæª”æ¨é€å’Œæå–åˆ°æ‚¨çš„ç§äºº Container Registryã€‚Docker æä¾›ä¾æ“šåç¨±å’Œæ¨™è¨˜æœå°‹æ˜ åƒæª”çš„åŠŸèƒ½ï¼Œè®“æ‚¨å¯ä»¥é †æš¢ä½¿ç”¨ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;ol start="6">
&lt;li>å¿«é€Ÿçš„é«˜å¯ç”¨æ€§å­˜å–èƒ½åŠ›ï¼šæ‚¨å¯ä½¿ç”¨æˆ‘å€‘éå¸ƒå…¨çƒçš„å€åŸŸæ€§ç§äººå­˜æ”¾å€ï¼Œæ–¼å…¨ä¸–ç•Œçš†èƒ½äº«æœ‰æœ€å¿«é€Ÿçš„å›æ‡‰æ™‚é–“ã€‚æ‚¨å¯ä»¥å°±è¿‘å°‡æ˜ åƒæª”å„²å­˜åœ¨ä½æ–¼æ­æ´²ã€äºæ´²æˆ–ç¾åœ‹çš„é‹ç®—åŸ·è¡Œå€‹é«”ä¸­ï¼Œä¸¦é€é Google çš„é«˜æ•ˆèƒ½å…¨çƒç¶²è·¯å¿«é€Ÿå®Œæˆéƒ¨ç½²ä½œæ¥­ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>ä¸Šé¢æœ‰æåˆ° Container Registry å…¶ä¸­ä¸€å€‹ç‰¹é»å°±æ˜¯æƒææ˜ åƒæª”ï¼Œæœƒæª¢æŸ¥æœ‰æ²’æœ‰å¥‡æ€ªçš„å…§å®¹æˆ–æ˜¯éŒ¯èª¤ï¼Œè®“æˆ‘å€‘åœ¨éƒ¨ç½²å‰å¯ä»¥å…ˆåšæª¢æŸ¥ï¼Œåº•ä¸‹æ˜¯æ•´å€‹çš„æµç¨‹åœ–ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/container-registry/1.webp"
alt="Container Registry æƒææµç¨‹åœ–" width="800">&lt;figcaption>
&lt;p>Container Registry æƒææµç¨‹åœ–&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘å¯ä»¥å»¶çºŒä¸Šä¸€ç¯‡æ–‡ç«  &lt;a href="https://pin-yi.me/blog/gcp/cloud-source-repositories/" >Cloud Source Repositories&lt;/a> ä¾†èªªæ˜ä¸Šé¢åœ–ç‰‡ï¼Œä¸€é–‹å§‹å…ˆ commit åˆ° GCP ä¸Šï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒç•¶æˆ Cloud Source Repositoriesï¼Œå°±è‘—é€éæœƒé€é&lt;a href="https://pin-yi.me/blog/gcp/cloud-build/" >ä¸‹ä¸€ç¯‡è¦è¬›çš„ Cloud Build&lt;/a> ä¾†å»ºç½®ï¼Œä¸¦ä¸”æƒæï¼Œå¦‚æœæ²’æœ‰å•é¡Œå°±æœƒ Pubish åˆ° Container Registry å­˜æ”¾å›‰ï½&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å°±ç°¡å–®èªªæ˜è¦æ€éº¼æŸ¥çœ‹æˆ‘å€‘çš„ Container Registryï¼Œé»é¸å‰‡å·¦å´çš„ menu &amp;gt; é¸æ“‡ &lt;strong>Container Registry&lt;/strong> &amp;gt; é»æ“Š &lt;strong>æ˜ åƒæª”&lt;/strong>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/container-registry/2.png"
alt="Container Registry" width="350">&lt;figcaption>
&lt;p>Container Registry&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä¸€é–‹å§‹å¯èƒ½æ²’æœ‰ä»»ä½•çš„è³‡æ–™å¤¾ï¼Œä¹‹å¾Œç•¶æˆ‘å€‘ Build æ™‚ï¼Œå¯ä»¥æ–°å¢ç‰¹å®šçš„è³‡æ–™å¤¾ä¾†æ”¾æˆ‘å€‘çš„æ˜ åƒæª”ï¼Œå¯ä»¥åƒè€ƒä¸‹æ–¹åœ–ç‰‡ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/container-registry/3.png"
alt="Container Registry è³‡æ–™å¤¾" width="750">&lt;figcaption>
&lt;p>Container Registry è³‡æ–™å¤¾&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é€²å…¥è©²è³‡æ–™å¤¾å¾Œï¼Œå°±å¯ä»¥çœ‹åˆ°è£¡é¢çš„æ˜ åƒæª”æ¡ˆï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/container-registry/4.png"
alt="Container Registry æ˜ åƒæª”" width="1000">&lt;figcaption>
&lt;p>Container Registry æ˜ åƒæª”&lt;/p>
&lt;/figcaption>
&lt;/figure></description></item><item><title>Google Cloud Platform (GCP) - Cloud Build</title><link>https://pin-yi.me/blog/gcp/cloud-build/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/cloud-build/</guid><description>
&lt;p>è·Ÿå¤§å®¶ä»‹ç´¹ä¸€ä¸‹ä»Šå¤©çš„ä¸»é¡Œ Cloud Buildï¼ŒCloud Build å¯ä»¥å¹«æˆ‘å€‘åšæŒçºŒå»ºæ§‹ã€æ¸¬è©¦å’Œéƒ¨ç½²ï¼Œæˆ‘å€‘å¯ä»¥æŠŠå®ƒæƒ³æˆç°¡æ˜“ç‰ˆçš„ Jenkinsï¼Œå¾æ•´å€‹æ˜ åƒæª”æ¡ˆæ‰“åŒ…åˆ°éƒ¨ç½²ï¼Œä¹Ÿå°±å¹¾åˆ†é˜çš„äº‹æƒ…ï¼Œä¸”å…§å»ºè¨±å¤šæŒ‡ä»¤ã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘ä»Šå¤©æ–‡ç« ï¼Œéœ€è¦ä½¿ç”¨å‰å¹¾å¤©æåˆ°çš„ &lt;a href="https://pin-yi.me/blog/gcp/cloud-source-repositories/" >Cloud Source Repositories&lt;/a> ã€&lt;a href="https://pin-yi.me/blog/gcp/compute-engine/" >Compute Engine&lt;/a>ã€&lt;a href="https://pin-yi.me/blog/gcp/container-registry/" >Container Registry&lt;/a>ï¼Œæˆ‘å€‘éœ€è¦å…ˆé€é GitLab å°‡ç¨‹å¼é¡åƒåˆ° Cloud Source Repositoriesï¼Œå†é€é Cloud Build è§¸ç™¼å°‡ GitLab ä¸Šé¢çš„ Dockerfile å»ºç½®åˆ° Container Registry ä¸­ï¼Œå†éƒ¨ç½²åˆ° Compute Engine VM ä¸Šã€‚å¤§å®¶å¯ä»¥åƒè€ƒæµç¨‹åœ–ï¼Œæœƒæ›´æ¸…æ¥šä»Šå¤©çš„æµç¨‹ï¼é‚£æˆ‘å€‘å°±é–‹å§‹å›‰ ğŸ¥¸&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/1.png"
alt="æµç¨‹åœ–" width="1200">&lt;figcaption>
&lt;p>æµç¨‹åœ–&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>Cloud Source Repositories æ¸¬è©¦&lt;span class="absolute -mt-20" id="cloud-source-repositories-æ¸¬è©¦">&lt;/span>
&lt;a href="#cloud-source-repositories-%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å‰é¢ GitLab é¡åƒè¨­å®šï¼Œè«‹å…ˆåƒè€ƒä¸Šä¸Šç¯‡ &lt;a href="https://pin-yi.me/blog/gcp/cloud-source-repositories/" >Google Cloud Platform (GCP) - Cloud Source Repositories&lt;/a>ï¼Œä¸Šä¸Šç¯‡æœƒå¸¶å¤§å®¶å¾ GitLab é¡åƒåˆ° Cloud Source Repositoriesï¼Œæ‰€ä»¥æˆ‘å€‘å°±æ¥çºŒä¹‹å‰çš„å…§å®¹ï¼Œç¹¼çºŒå¾€ä¸‹é–‹å§‹å­¸ç¿’å§ï½&lt;/p>
&lt;br>
&lt;ol>
&lt;li>é–‹å•Ÿ GCPï¼Œé¸æ“‡å·¦å´çš„ menu &amp;gt; é»æ“Š &lt;strong>Cloud Build&lt;/strong> &amp;gt; é¸æ“‡ &lt;strong>è§¸ç™¼æ¢ä»¶&lt;/strong>ï¼Œé»æ“Š &lt;strong>å»ºç«‹è§¸ç™¼æ¢ä»¶&lt;/strong> æŒ‰éˆ•ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;ol start="2">
&lt;li>è¼¸å…¥è§¸ç™¼æ¢ä»¶çš„åç¨±ï¼Œäº‹ä»¶å¯ä»¥è¨­å®šæˆ‘å€‘è¦æ€éº¼é€²è¡Œè§¸ç™¼ï¼Œæˆ‘å€‘é€™é‚Šå…ˆé¸æ“‡ &lt;strong>æ¨é€è‡³åˆ†æ”¯çš„ç‰ˆæœ¬&lt;/strong> ä¾†è§¸ç™¼ï¼Œåœ¨ä¾†æºé¸æ“‡ä¸Šä¸Šç¯‡å»ºç«‹å¥½çš„ Cloud Source Repositories å­˜æ”¾å€ï¼Œåˆ†æ”¯ç‰ˆæœ¬æˆ‘å€‘å…ˆä½¿ç”¨é è¨­çš„ masterï¼Œä¹Ÿå°±æ˜¯æ¨ç¨‹å¼åˆ° master ä»–æœƒå°±è§¸ç™¼ Cloud Buildï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/2.png"
alt="å»ºç«‹è§¸ç™¼æ¢ä»¶ 1" width="900">&lt;figcaption>
&lt;p>å»ºç«‹è§¸ç™¼æ¢ä»¶ 1&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>è¨­å®šé¡å‹æˆ‘å€‘é¸æ“‡ Cloud Build è¨­å®šæª”ï¼Œä»–ä¹Ÿæ˜¯ Cloud Build å°ˆç”¨çš„è¨­å®šæª”ï¼Œå¾Œé¢æœƒå¸¶å¤§å®¶å¯«ä¸€ä»½ Cloud Buildï¼Œä½ç½®ç•¶ç„¶æ˜¯ä½¿ç”¨æˆ‘å€‘ Cloud Source Repositories å­˜æ”¾å€ï¼Œä»¥åŠå¯ä»¥ä¾ç…§å°ˆæ¡ˆä¾†ä¿®æ”¹ cloudbuild.yaml æ”¾åœ¨å°ˆæ¡ˆçš„å“ªè£¡ï¼Œæœ€å¾Œéƒ½æ²’å•é¡Œï¼Œå°±æŒ‰ä¸‹å»ºç«‹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/3.png"
alt="å»ºç«‹è§¸ç™¼æ¢ä»¶ 2" width="900">&lt;figcaption>
&lt;p>å»ºç«‹è§¸ç™¼æ¢ä»¶ 2&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ’°å¯« cloudbuild.yaml è¨­å®šæª”&lt;span class="absolute -mt-20" id="æ’°å¯«-cloudbuildyaml-è¨­å®šæª”">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab-cloudbuildyaml-%e8%a8%ad%e5%ae%9a%e6%aa%94" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨é–‹å§‹å»ºç«‹æª”æ¡ˆå‰ï¼Œå…ˆä¾†è·Ÿå¤§å®¶èªªèªªæª”æ¡ˆå…§æœ‰å“ªäº›è¨­å®šå§ï¼š&lt;/p>
&lt;br>
&lt;p>é¦–å…ˆ Cloud Build å»ºæ§‹å™¨æ˜¯è£æœ‰å¸¸ç”¨çš„ç¨‹å¼èªè¨€å’Œå·¥å…·çš„å®¹å™¨æ˜ åƒã€‚æˆ‘å€‘å¯ä»¥é…ç½® Cloud Buildï¼Œè®“å»ºæ§‹å™¨ä¸­é‹è¡Œç‰¹å®šå‘½ä»¤ï¼Œæˆ‘èˆ‰å€‹ä¾‹å­è®“å¤§å®¶äº†è§£ï¼š&lt;/p>
&lt;p>ä»¥ä¸‹ç¨‹å¼ç¢¼æ˜¯ä¾†è‡ª &lt;a href="https://hub.docker.com/search?q=&amp;amp;type=image" target="_blank" rel="noopener">Docker Hub&lt;/a> çš„ &lt;code>ubnutu&lt;/code> æ˜ åƒæª”ä¸­æ‰€åŸ·è¡Œçš„å‘½ä»¤ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">steps&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ubuntu&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;echo&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;hello world&amp;#34;&lt;/span>]&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘é…ç½®æ–‡ä»¶ä¸­ &lt;code>steps&lt;/code> åƒæ•¸æ˜¯æŒ‡æˆ‘å€‘è¦å»ºæ§‹çš„æ­¥é©Ÿï¼Œ &lt;code>name&lt;/code> å­—æ®µæŒ‡å®š Docker æ˜ åƒæª”çš„ä½ç½®ï¼Œä»¥åŠ &lt;code>args&lt;/code> å­—æ®µä¸­æ˜¯æŒ‡å®šæ˜ åƒæª”é‹è¡Œçš„å‘½ä»¤ã€‚&lt;/p>
&lt;p>æˆ‘å€‘çš„ Cloud Build ä¸€æ¨£æœƒéœ€è¦ç”¨ &lt;code>name&lt;/code> ä¾†æŒ‡å®šå»ºæ§‹å®¹å™¨çš„æ˜ åƒæª”ï¼Œä»¥åŠä½¿ç”¨ &lt;code>args&lt;/code> ä¾†åŸ·è¡Œæˆ‘å€‘æ˜ åƒæª”æ‰€è¦é‹è¡Œçš„å‘½ä»¤ã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘çš„ Cloud Build è¨­å®šæª”ä¸­çš„ &lt;code>name&lt;/code> å¸¸ç”¨çš„å»ºæ§‹å™¨æ˜ åƒæª”å¦‚ä¸‹ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">Builder&lt;/th>
&lt;th style="text-align:center">åç¨±&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">bazel&lt;/td>
&lt;td style="text-align:center">gcr.io/cloud-builders/bazel&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">docker&lt;/td>
&lt;td style="text-align:center">gcr.io/cloud-builders/docker&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">git&lt;/td>
&lt;td style="text-align:center">gcr.io/cloud-builders/git&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">gcloud&lt;/td>
&lt;td style="text-align:center">gcr.io/cloud-builders/gcloud&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">gke-deploy&lt;/td>
&lt;td style="text-align:center">gcr.io/cloud-builders/gke-deploy&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;br>
&lt;p>æ¥è‘—æˆ‘å€‘ä¾†è©¦è‘—å¯«ä¸€å€‹ cloudbuild.yaml ä¾†å»ºæ§‹æˆ‘å€‘çš„ nginx æœå‹™ï¼Œä¸¦éƒ¨ç½²åˆ° Compute Engine ä¸Šã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å…ˆå›åˆ° Gitlab è©²å°ˆæ¡ˆä¸‹çš„ç›®éŒ„ï¼Œæ–°å¢ cloudbuild.yaml æª”æ¡ˆï¼Œå°‡è¤‡è£½ä»¥ä¸‹å…§å®¹ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">steps&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Docker Build&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcr.io/cloud-builders/docker&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;build&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;-t&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;gcr.io/$PROJECT_ID/ian-test:ian-nginx-test&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Docker Push&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcr.io/cloud-builders/docker&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;push&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;gcr.io/$PROJECT_ID/ian-test:ian-nginx-test&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Build VM&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcr.io/google.com/cloudsdktool/cloud-sdk&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">entrypoint&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcloud&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;compute&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;instances&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;create-with-container&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ian-test-vm&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;--container-image&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;gcr.io/$PROJECT_ID/ian-test:ian-nginx-test&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;CLOUDSDK_COMPUTE_REGION=asia-east1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;CLOUDSDK_COMPUTE_ZONE=asia-east1-b&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æˆ‘å€‘ä¸€å€‹ä¸€å€‹ä¾†èªªèªªçš„é€™å€‹ cloudbuild.yaml è£¡é¢çš„è¨­å®šå§ï¼(æˆ‘ä»¥å‰é¢çš„è¨»è§£ä¾†å€åˆ†)&lt;/p>
&lt;ul>
&lt;li>Docker Buildï¼šé€™é‚Šçš„ &lt;code>name&lt;/code> æˆ‘å€‘ç”¨ &lt;code>gcr.io/cloud-builders/docker&lt;/code>ï¼Œä»£è¡¨æˆ‘å€‘å°‡ä½¿ç”¨ docker å»ºæ§‹å™¨ï¼Œ&lt;code>args&lt;/code> é€™é‚Šä¸‹çš„æ„æ€æ˜¯è¦æŠŠèˆ‡ cloudbuild.yaml æ”¾åœ¨ä¸€èµ·çš„ Dokcerfile çµ¦ build èµ·ä¾†ï¼Œä¸¦æ”¹åç‚º gcr.io/$PROJECT_ID/ian-test:ian-nginx-testã€‚&lt;/li>
&lt;li>Docker Pushï¼šé€™é‚Šä¸€æ¨£ä½¿ç”¨ &lt;code>gcr.io/cloud-builders/docker&lt;/code>ï¼Œ&lt;code>args&lt;/code> æŒ‡ä»¤éƒ¨åˆ†è®Šæˆæˆ‘å€‘è¦æŠŠä»– push åˆ° gcr.io/$PROJECT_ID/ian-test é€™å€‹ Cloud Source Repositoriesï¼Œå…¶ä¸­é€™å€‹æ˜ åƒæª”æ¡ˆçš„ tag ç‚º ian-nginx-testã€‚&lt;/li>
&lt;li>Build VMï¼šé€™é‚Šæˆ‘å€‘ä½¿ç”¨ &lt;code>gcr.io/google.com/cloudsdktool/cloud-sdk&lt;/code>ï¼Œå¯ä»¥é€éå®ƒä¾†å»ºç«‹ VMï¼Œä¸¦ä¸”åŸ·è¡Œ tag åç‚º ian-nginx-test çš„æ˜ åƒæª”ï¼Œå¾Œé¢ç’°å¢ƒè®Šæ•¸æ˜¯ä¾†è¨­å®š VM çš„å€åŸŸç­‰ç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
&lt;code>ian-test&lt;/code> æ˜¯ Container Registry è³‡æ–™å¤¾åç¨±ï¼Œ&lt;code>ian-nginx-test&lt;/code> æ˜¯ Container Registry æ˜ åƒæª”çš„ tagï¼Œ&lt;code>ian-test-vm&lt;/code> æ˜¯æˆ‘å€‘å»ºç«‹ VM çš„åå­—ï¼Œæ‰€ä»¥è¦è¨˜å¾—æ”¹æˆè‡ªå·±çš„å‘½åæ­ï¼
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>æ’°å¯« Dockerfile&lt;span class="absolute -mt-20" id="æ’°å¯«-dockerfile">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab-dockerfile" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ¥ä¸‹ä¾†å‰›å‰›æœ‰æåˆ° Docker Build æœƒå°‡æˆ‘å€‘æ”¾åœ¨ä¸€èµ·çš„ Dockerfile çµ¦ build èµ·ä¾†ï¼Œæ‰€ä»¥æˆ‘å€‘ä¹Ÿè¦å…ˆå¯«å¥½è¦ç”¨çš„ Dockerfileï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> nginx:latest&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> ./index.html /usr/share/nginx/html/&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æˆ‘å€‘çš„ Dockerfile å¾ˆç°¡å–®ï¼Œç°¡å–®å¯«äº†è¦ä½¿ç”¨çš„æ˜ åƒæª”ï¼Œä»¥åŠå°‡æˆ‘å€‘ç­‰ç­‰è¦æ¸¬è©¦çš„ index è¤‡è£½åˆ°è£¡é¢&lt;/p>
&lt;br>
&lt;h3>æ’°å¯«æ¸¬è©¦ index.html&lt;span class="absolute -mt-20" id="æ’°å¯«æ¸¬è©¦-indexhtml">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab%e6%b8%ac%e8%a9%a6-indexhtml" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">html&lt;/span> &lt;span style="color:#a6e22e">lang&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;en&amp;#34;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">head&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">meta&lt;/span> &lt;span style="color:#a6e22e">charset&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;UTF-8&amp;#34;&lt;/span> /&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">meta&lt;/span> &lt;span style="color:#a6e22e">http-equiv&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;X-UA-Compatible&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;IE=edge&amp;#34;&lt;/span> /&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">meta&lt;/span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;viewport&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&lt;/span> /&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">title&lt;/span>&amp;gt;æ¸¬è©¦æ¸¬è©¦æ¸¬è©¦&amp;lt;/&lt;span style="color:#f92672">title&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">head&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">body&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> æˆ‘æ˜¯æ¸¬è©¦æª”æ¡ˆ
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">body&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">html&lt;/span>&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™å€‹æ¸¬è©¦æª”æ¡ˆï¼Œæœƒè“‹é nginx çš„é è¨­ç•«é¢ï¼Œç•¶æˆ‘å€‘æˆåŠŸå°‡ VM å»ºç«‹å¾Œï¼Œç€è¦½ 80 Port æ™‚ï¼Œæ‡‰è©²æœƒè·³å‡ºé€™å€‹æ¸¬è©¦çš„ç¶²é ã€‚&lt;/p>
&lt;br>
&lt;h3>Commit åˆ° GitLab&lt;span class="absolute -mt-20" id="commit-åˆ°-gitlab">&lt;/span>
&lt;a href="#commit-%e5%88%b0-gitlab" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç•¶æˆ‘å€‘éƒ½æ–°å¢å¥½æª”æ¡ˆå¾Œï¼Œæˆ‘å€‘å°±å°‡ç¨‹å¼æ¨åˆ°æˆ‘å€‘å‰å¹¾ç¯‡çš„ Cloud Source Repositories å·²ç¶“é¡åƒçš„ GitLab ä¸­ï¼Œæ¥è‘—å°±æ˜¯ç­‰å¾…è¦‹è­‰å¥‡è¹Ÿçš„æ™‚å€™äº†ï¼¸ï¼¤&lt;/p>
&lt;ol>
&lt;li>ç•¶æˆ‘å€‘æ¨é€å¾Œï¼Œæˆ‘å€‘å…ˆæª¢æŸ¥ Cloud Source Repositories æ˜¯å¦æœ‰æˆåŠŸå¾ GitLab é¡åƒéä¾†ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/4.png"
alt="Cloud Source Repositories" width="700">&lt;figcaption>
&lt;p>Cloud Source Repositories&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>æª¢æŸ¥çœ‹çœ‹ Container Registry æ˜¯å¦å¤šäº†åç‚º &lt;code>ian-test&lt;/code> çš„è³‡æ–™å¤¾ï¼Œä¸”è£¡é¢æœ‰ä¸€å€‹ tag ç‚º &lt;code>ian-nginx-test&lt;/code> çš„æ˜ åƒæª”ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/5.png"
alt="Container Registry" width="1000">&lt;figcaption>
&lt;p>Container Registry&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>æª¢æŸ¥ä¸€ä¸‹ Cloud Build çš„è§¸ç™¼æ¢ä»¶æ˜¯ä¸æ˜¯åœ¨é‹ä½œï¼Œæœ€å¾ŒæˆåŠŸå¯ä»¥çœ‹åˆ°é¡ä¼¼ä¸‹æ–¹åœ–ç‰‡å…§å®¹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/6.png"
alt="Cloud Build çš„è§¸ç™¼æ¢ä»¶" width="1200">&lt;figcaption>
&lt;p>Cloud Build çš„è§¸ç™¼æ¢ä»¶&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>æª¢æŸ¥ Compute Engine çš„ VM æ˜¯å¦æœ‰æˆåŠŸè¢«å»ºç«‹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/7.png"
alt="Compute Engine" width="1200">&lt;figcaption>
&lt;p>Compute Engine&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="5">
&lt;li>æœ€å¾Œå°±æ˜¯æ¸¬è©¦é€™å€‹æ˜ åƒæª”æ¡ˆï¼Œæ˜¯ä¸æ˜¯æˆ‘å€‘æ‰€ Build çš„ï¼Œæ¸¬è©¦æ–¹æ³•å¾ˆç°¡å–®ï¼Œæˆ‘å€‘å‰›å‰›åœ¨ Dockerfile æœ‰è¤‡è£½æˆ‘å€‘è‡ªå·±å¯«çš„ index.html æª”æ¡ˆï¼Œå»è“‹æ‰åŸæœ¬ nginx çš„é è¨­æª”ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥ç€è¦½ä¸Šé¢åœ–ç‰‡çš„å¤–éƒ¨ IPï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘å€‘æ‰€æ”¹çš„é é¢å›‰ï¼&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/8.png"
alt="æ¸¬è©¦ç”¨ index.html" width="700">&lt;figcaption>
&lt;p>æ¸¬è©¦ç”¨ index.html&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Cloud Builderï¼š&lt;a href="https://cloud.google.com/build/docs/cloud-builders" target="_blank" rel="noopener">https://cloud.google.com/build/docs/cloud-builders&lt;/a>&lt;/p>
&lt;p>Day27 - ç”¨ Cloud Build å¯¦ä½œ CI éƒ¨åˆ†ï¼š&lt;a href="https://ithelp.ithome.com.tw/articles/10224727" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10224727&lt;/a>&lt;/p></description></item></channel></rss>