<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PIN-YI â€“ Node.js</title><link>https://pin-yi.me/blog/nodejs/</link><description>Recent content in Node.js on PIN-YI</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><atom:link href="https://pin-yi.me/blog/nodejs/index.xml" rel="self" type="application/rss+xml"/><item><title>ç”¨ Node.jså¯«ä¸€å€‹ Repository Restful API çš„ç•™è¨€æ¿ (expressã€sequelize å¥—ä»¶)</title><link>https://pin-yi.me/blog/nodejs/nodejs-restful-api-repository-messageboard/</link><pubDate>Mon, 11 Apr 2022 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/nodejs/nodejs-restful-api-repository-messageboard/</guid><description>
&lt;p>æœ¬æ–‡ç« æ˜¯ä½¿ç”¨ Node.js ä¾†å¯«ä¸€å€‹ Repository Restful API çš„ç•™è¨€æ¿ï¼Œä¸¦ä¸”æœƒä½¿ç”¨ express ä»¥åŠ sequelize (ä½¿ç”¨ Mysql)å¥—ä»¶ã€‚&lt;/p>
&lt;p>å»ºè­°å¯ä»¥å…ˆè§€çœ‹ &lt;a href="https://pin-yi.me/node/" target="_blank" rel="noopener">Node.js ä»‹ç´¹&lt;/a> æ–‡ç« ä¾†ç°¡å–®å­¸ç¿’ Node èªè¨€ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/880831ian/node-restful-api-repository-messageboard" target="_blank" rel="noopener">ç¯„ä¾‹ç¨‹å¼é€£çµ é»æˆ‘ ğŸ˜˜
&lt;/a>&lt;/p>
&lt;p>ç‰ˆæœ¬è³‡è¨Š&lt;/p>
&lt;ul>
&lt;li>macOSï¼š11.6&lt;/li>
&lt;li>nodeï¼šv16.14.2&lt;/li>
&lt;li>npmï¼š8.5.0&lt;/li>
&lt;li>Mysqlï¼šmysql Ver 8.0.28 for macos11.6 on x86_64 (Homebrew)
&lt;br>&lt;/li>
&lt;/ul>
&lt;h2>å¯¦ä½œ&lt;span class="hx-absolute -hx-mt-20" id="å¯¦ä½œ">&lt;/span>
&lt;a href="#%e5%af%a6%e4%bd%9c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>æª”æ¡ˆçµæ§‹&lt;span class="hx-absolute -hx-mt-20" id="æª”æ¡ˆçµæ§‹">&lt;/span>
&lt;a href="#%e6%aa%94%e6%a1%88%e7%b5%90%e6%a7%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ app.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â””â”€â”€ config.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ controllers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ auth.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ message.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â””â”€â”€ reply.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ middleware
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â””â”€â”€ index.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ migrations
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ 20220331054531-create-user.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ 20220401093019-create-message.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â””â”€â”€ 20220404041905-create-reply.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ models
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ index.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ message.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ reply.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â””â”€â”€ user.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ node_modules&lt;span style="color:#f92672">(&lt;/span>ä»¥ä¸‹æª”æ¡ˆçœç•¥&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ package-lock.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ package.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ repositories
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ auth.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â”œâ”€â”€ message.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â””â”€â”€ reply.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â””â”€â”€ router
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> â””â”€â”€ index.js&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æˆ‘å€‘ä¾†èªªæ˜ä¸€ä¸‹ä¸Šé¢çš„è³‡æ–™å¤¾ä»¥åŠæª”æ¡ˆå„åˆ¥åŠŸèƒ½èˆ‡ä½œç”¨&lt;/p>
&lt;ul>
&lt;li>app.jsï¼šç¨‹å¼çš„å•Ÿå‹•å…¥å£ï¼Œè£¡é¢æœƒæ”¾ç½®æœ‰é—œç¨‹å¼ç³»çµ±éœ€è¦å‘¼å«å“ªäº›å¥—ä»¶ç­‰ç­‰ã€‚&lt;/li>
&lt;li>configï¼šæ”¾ç½®è³‡æ–™åº«é€£ç·šè³‡æ–™ (ä½¿ç”¨ sequelize-cli å¥—ä»¶è‡ªå‹•ç”¢ç”Ÿ)ã€‚&lt;/li>
&lt;li>controllersï¼šå•†ç”¨é‚è¼¯æ§åˆ¶ã€‚&lt;/li>
&lt;li>middlewareï¼šç”¨ä¾†æª¢æŸ¥ç™»å…¥æ¬Šé™ã€‚&lt;/li>
&lt;li>migrationsï¼šæ”¾ç½®ç”¢ç”Ÿä¸åŒ Model è³‡æ–™è¡¨ (ä½¿ç”¨ sequelize-cli å¥—ä»¶è‡ªå‹•ç”¢ç”Ÿ)ã€‚&lt;/li>
&lt;li>modelsï¼šå®šç¾©è³‡æ–™è¡¨è³‡æ–™å‹æ…‹ (ä½¿ç”¨ sequelize-cli å¥—ä»¶è‡ªå‹•ç”¢ç”Ÿ)ã€‚&lt;/li>
&lt;li>node_modulesï¼šæ”¾ç½®ä¸‹è¼‰ä½¿ç”¨çš„å¥—ä»¶ä½ç½®ã€‚&lt;/li>
&lt;li>package.json/package-lock.jsonï¼šå°ˆæ¡ˆè³‡è¨Šçš„é‡è¦æª”æ¡ˆ (ä½¿ç”¨ &lt;code>npm init&lt;/code> è‡ªå‹•ç”¢ç”Ÿ)ã€‚&lt;/li>
&lt;li>repositoriesï¼šè™•ç†èˆ‡è³‡æ–™åº«é€²è¡Œäº¤æ¡ã€‚&lt;/li>
&lt;li>routerï¼šè¨­å®šç¶²ç«™ç¶²å€è·¯ç”±ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>ä»¥ä¸‹è©³ç´°èªªæ˜éƒ¨åˆ†ï¼Œåªæœƒèªªæ˜ app.jsã€configã€controllersã€middlewareã€migrationsã€modelsã€repositoriesã€router (ä»‹ç´¹æœƒä¾ç…§ç¨‹å¼æµç¨‹ä¾†ä»‹ç´¹)ã€‚&lt;/p>
&lt;br>
&lt;h3>config&lt;span class="hx-absolute -hx-mt-20" id="config">&lt;/span>
&lt;a href="#config" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;development&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;root&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;password&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;database&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;node&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;127.0.0.1&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dialect&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;mysql&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dialectOptions&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dateStrings&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;typeCast&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;timezone&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;+08:00&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;test&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;root&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;password&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;database&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;node&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;127.0.0.1&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dialect&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;mysql&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dialectOptions&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dateStrings&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;typeCast&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;timezone&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;+08:00&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;production&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;root&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;password&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;database&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;node&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;host&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;127.0.0.1&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dialect&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;mysql&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dialectOptions&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dateStrings&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;typeCast&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;timezone&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;+08:00&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç”± sequelize-cli å¥—ä»¶è‡ªå‹•ç”¢ç”Ÿï¼Œå¯ä»¥ä¾ç…§ä¸åŒç¨‹å¼ç‹€æ…‹(é–‹ç™¼ developmentã€æ¸¬è©¦ testã€ä¸Šç·š production)ä¾†ä¿®æ”¹é€£ç·šæ™‚çš„åƒæ•¸ã€‚&lt;/p>
&lt;br>
&lt;h3>migrations&lt;span class="hx-absolute -hx-mt-20" id="migrations">&lt;/span>
&lt;a href="#migrations" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æª”æ¡ˆåŸºæœ¬ä¸Šéƒ½é›·åŒï¼Œèˆ‰å…¶ä¸­ä¸€å€‹ç‚ºèªªæ˜ã€‚migrations ä¹Ÿæ˜¯ç”± sequelize-cli å¥—ä»¶è‡ªå‹•ç”¢ç”Ÿï¼Œç›¸é—œæŒ‡ä»¤æœƒçµ±ä¸€æ”¾åœ¨æœ€å¾Œã€‚&lt;/p>
&lt;ul>
&lt;li>20220401093019-create-message.js&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">module.exports = {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">async up(queryInterface, Sequelize) {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">await queryInterface.createTable(&amp;#34;message&amp;#34;, {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">id&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">allowNull&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">autoIncrement&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">primaryKey&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Sequelize.INTEGER,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">user_id&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">allowNull&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Sequelize.INTEGER,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">references&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">model&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;user&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">key&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;id&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">content&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">allowNull&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Sequelize.STRING,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">version&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Sequelize.INTEGER,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">defaultValue&lt;/span>: &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">createdAt&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">allowNull&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Sequelize.DATE,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">updatedAt&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">allowNull&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Sequelize.DATE,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">deletedAt&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">allowNull&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">type&lt;/span>: &lt;span style="color:#ae81ff">Sequelize.DATE,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#ae81ff">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">async down(queryInterface, Sequelize) {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">await queryInterface.dropTable(&amp;#34;message&amp;#34;);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;span style="color:#ae81ff">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é€™å€‹æª”æ¡ˆçš„æ ¼å¼ä¹Ÿæ˜¯é€éæŒ‡ä»¤ç”¢ç”Ÿï¼Œæœƒæœ‰ up è·Ÿ downï¼Œup å°±æ˜¯åŸ·è¡ŒæŒ‡ä»¤å¾Œæœƒç”¢ç”Ÿä»€éº¼ï¼Œä¸»è¦éƒ½æœƒæ˜¯æ–°å¢è³‡æ–™è¡¨æˆ–æ˜¯ä¿®æ”¹è³‡æ–™è¡¨ï¼Œdown å‰‡æ˜¯å›å¾©çš„åŠŸèƒ½ï¼Œå¯ä»¥å°‡è³‡æ–™è¡¨çµ¦ dropTable ã€‚æˆ‘å€‘ä¸»è¦æœƒä¿®æ”¹çš„åœ°æ–¹æ˜¯ createTable å…§çš„è³‡æ–™ï¼Œè£¡é¢çš„è³‡æ–™ä»£è¡¨è³‡æ–™è¡¨çš„æ¬„ä½ï¼Œä»¥ä¸‹åˆ—å‡ºå¸¸ç”¨çš„æ ¼å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>allowNullï¼šæ˜¯å¦ç‚ºç©ºå€¼&lt;/li>
&lt;li>autoIncrementï¼šè‡ªå‹•ç´¯åŠ &lt;/li>
&lt;li>primaryKeyï¼šä¸»éµ&lt;/li>
&lt;li>typeï¼šè£¡é¢å°±æ”¾æ¬„ä½é¡å‹ï¼Œä¾‹å¦‚ INTEGERã€STRINGã€DATEç­‰ç­‰&lt;/li>
&lt;/ul>
&lt;h3>app.js&lt;span class="hx-absolute -hx-mt-20" id="appjs">&lt;/span>
&lt;a href="#appjs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;express&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">sessions&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;express-session&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">port&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">8888&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// è¨­å®š Session
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">oneDay&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1000&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sessions&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">secret&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;mySecret&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;user&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">saveUninitialized&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rolling&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">cookie&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">maxAge&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">oneDay&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">resave&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// è¨»å†Šè·¯ç”±
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/api/v1&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;./router&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æª¢æŸ¥æ˜¯å¦æœ‰tableï¼Œæ²’æœ‰å°±å»ºç«‹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// const Message = require(&amp;#34;./models&amp;#34;).message;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// const User = require(&amp;#34;./models&amp;#34;).user;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Message.sync();
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// User.sync();
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// é–‹å•Ÿç›£è½
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">listen&lt;/span>(&lt;span style="color:#a6e22e">port&lt;/span>, &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;å•Ÿå‹• Server,Port:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">port&lt;/span>));&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ol>
&lt;li>å…ˆå¼•å…¥æœƒä½¿ç”¨çš„å¥—ä»¶ (expressï¼šnode web æ¡†æ¶ã€express-sessionï¼šsession å¥—ä»¶)&lt;/li>
&lt;li>è¨­å®š app ç‚º express() å¯¦ä¾‹ï¼Œport ç‚º 8888ã€‚&lt;/li>
&lt;li>è¨­å®š session å¤±æ•ˆæ™‚é–“ã€åç¨±ç­‰è¨­å®šã€‚
&lt;ul>
&lt;li>secret(å¿…è¦)ï¼šç”¨ä¾†ç°½ç«  sessionID çš„cookie, å¯ä»¥æ˜¯ä¸€secretå­—ä¸²æˆ–æ˜¯å¤šå€‹secretçµ„æˆçš„ä¸€å€‹é™£åˆ—ã€‚&lt;/li>
&lt;li>nameï¼šåœ¨responseä¸­ï¼Œè¨­å®šçš„ sessionID cookie åå­—ã€‚é è¨­æ˜¯ connect.sidã€‚&lt;/li>
&lt;li>saveUninitializedï¼šå¼·åˆ¶å°‡æœªåˆå§‹åŒ–çš„sessionå­˜å› session storeï¼Œæœªåˆå§‹åŒ–çš„æ„æ€æ˜¯å®ƒæ˜¯æ–°çš„è€Œä¸”æœªè¢«ä¿®æ”¹ã€‚&lt;/li>
&lt;li>rollingï¼šå¼·åˆ¶åœ¨æ¯ä¸€æ¬¡å›æ‡‰æ™‚ï¼Œé‡æ–°è¨­ç½®ä¸€å€‹sessionID cookieã€‚&lt;/li>
&lt;li>cookieï¼šè¨­å®šsessionID çš„cookieç›¸é—œé¸é …ã€‚&lt;/li>
&lt;li>resaveï¼šå¼·åˆ¶å°‡sessionå­˜å› session store, å³ä½¿å®ƒæ²’æœ‰è¢«ä¿®æ”¹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¨»å†Šè·¯ç”±ï¼Œé€£ç·š &lt;code>http://127.0.0.1/api/v1&lt;/code> å¾Œé¢æœƒå°å‘ router æª”æ¡ˆã€‚&lt;/li>
&lt;li>è¨»è§£éƒ¨åˆ†ç‚ºå¯ä»¥æ¯æ¬¡å•Ÿå‹•å¾Œå…ˆæª¢æŸ¥æ˜¯å¦æœ‰tableï¼Œæ²’æœ‰å°±å»ºç«‹ã€‚&lt;/li>
&lt;li>é–‹å•Ÿ port(8888) ç›£è½ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;h3>router&lt;span class="hx-absolute -hx-mt-20" id="router">&lt;/span>
&lt;a href="#router" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;express&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">middleware&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../middleware&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">router&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">register&lt;/span>, &lt;span style="color:#a6e22e">login&lt;/span>, &lt;span style="color:#a6e22e">lojsut&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../controllers/auth&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">getAllMessage&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">getMessage&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">createMessage&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">updateMessage&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">deleteMessage&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>} &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../controllers/message&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">createReply&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">updateReply&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">deleteReply&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>} &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../controllers/reply&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// è¨»å†Šã€ç™»å…¥ã€ç™»å‡º
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">post&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/register&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>(), &lt;span style="color:#a6e22e">register&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">post&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/login&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>(), &lt;span style="color:#a6e22e">login&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">post&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/lojsut&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">lojsut&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æŸ¥è©¢ç•™è¨€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">getAllMessage&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message/:message_id&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">getMessage&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//éœ€è¦é©—è­‰æ‰å¯ä»¥ä½¿ç”¨ï¼ˆæ–°å¢ç•™è¨€ã€ä¿®æ”¹ç•™è¨€ã€åˆªé™¤ç•™è¨€ã€æ–°å¢ç•™è¨€å›è¦†ã€ä¿®æ”¹ç•™è¨€å›è¦†ã€åˆªé™¤ç•™è¨€å›è¦†ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">use&lt;/span>(&lt;span style="color:#a6e22e">middleware&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">post&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>(), &lt;span style="color:#a6e22e">createMessage&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">patch&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message/:message_id&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>(), &lt;span style="color:#a6e22e">updateMessage&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#66d9ef">delete&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message/:message_id&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">deleteMessage&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">post&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message/:message_id&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>(), &lt;span style="color:#a6e22e">createReply&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#a6e22e">patch&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message/:message_id/:reply_id&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">express&lt;/span>.&lt;span style="color:#a6e22e">json&lt;/span>(), &lt;span style="color:#a6e22e">updateReply&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">router&lt;/span>.&lt;span style="color:#66d9ef">delete&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/message/:message_id/:reply_id&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">deleteReply&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">router&lt;/span>;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¨­å®šè·¯ç”±ï¼Œåˆ†åˆ¥æ˜¯è¨»å†Šã€ç™»å…¥ã€ç™»å‡ºã€æ–°å¢ç•™è¨€ã€æŸ¥è©¢å…¨éƒ¨ç•™è¨€ã€æŸ¥è©¢ {id} ç•™è¨€ã€ä¿®æ”¹ {id} ç•™è¨€ã€åˆªé™¤ {id} ç•™è¨€ï¼Œé€£æ¥åˆ°ä¸åŒçš„ controller functionã€‚express.json() å‡½æ•¸æ˜¯ç‚ºäº†è¦è®“ body-parser è§£æå¸¶æœ‰ JSON å‚³å…¥å¾Œé¢çš„ controllerï¼Œå…¶ä¸­æ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯å› ç‚ºæ–°å¢ç•™è¨€ã€ä¿®æ”¹ç•™è¨€ã€åˆªé™¤ç•™è¨€ã€æ–°å¢ç•™è¨€å›è¦†ã€ä¿®æ”¹ç•™è¨€å›è¦†ã€åˆªé™¤ç•™è¨€å›è¦†éœ€è¦ç™»å…¥å¾Œæ‰å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥å¤šä¸€å€‹ middleware ä¾†é©—è­‰æ˜¯å¦ç™»å…¥ã€‚&lt;/p>
&lt;br>
&lt;h3>middleware&lt;span class="hx-absolute -hx-mt-20" id="middleware">&lt;/span>
&lt;a href="#middleware" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>, &lt;span style="color:#a6e22e">next&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">401&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ç”¨æˆ¶éœ€è¦èªè­‰&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">next&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä½¿ç”¨ session ä¾†é©—è­‰æ˜¯å¦æœ‰ç™»å…¥ã€‚&lt;/p>
&lt;br>
&lt;h3>models&lt;span class="hx-absolute -hx-mt-20" id="models">&lt;/span>
&lt;a href="#models" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æœƒæ”¾ç½®èˆ‡è³‡æ–™è¡¨è³‡æ–™å‹æ…‹æœ‰é—œçš„è³‡è¨Šï¼Œå…¶ä¸­ index.js æ˜¯ç”± sequelize-cli å¥—ä»¶è‡ªå‹•ç”¢ç”Ÿï¼Œç”¨ä¾†è®€å–ç›®å‰å¯«åœ¨ config çš„é€£ç·šè¨­å®šæª”ç­‰è³‡è¨Šã€‚&lt;/p>
&lt;h4>index.js&lt;span class="hx-absolute -hx-mt-20" id="indexjs">&lt;/span>
&lt;a href="#indexjs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">fs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fs&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;path&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Sequelize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;sequelize&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">basename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">path&lt;/span>.&lt;span style="color:#a6e22e">basename&lt;/span>(&lt;span style="color:#a6e22e">__filename&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">env&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>.&lt;span style="color:#a6e22e">NODE_ENV&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#e6db74">&amp;#34;development&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/../config/config.json&amp;#34;&lt;/span>)[&lt;span style="color:#a6e22e">env&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">sequelize&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">use_env_variable&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sequelize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Sequelize&lt;/span>(&lt;span style="color:#a6e22e">process&lt;/span>.&lt;span style="color:#a6e22e">env&lt;/span>[&lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">use_env_variable&lt;/span>], &lt;span style="color:#a6e22e">config&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>} &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sequelize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">Sequelize&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">database&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">username&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">password&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">config&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">fs&lt;/span>.&lt;span style="color:#a6e22e">readdirSync&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">filter&lt;/span>((&lt;span style="color:#a6e22e">file&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>) &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">file&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#a6e22e">basename&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">slice&lt;/span>(&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>) &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#e6db74">&amp;#34;.js&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">forEach&lt;/span>((&lt;span style="color:#a6e22e">file&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#a6e22e">path&lt;/span>.&lt;span style="color:#a6e22e">join&lt;/span>(&lt;span style="color:#a6e22e">__dirname&lt;/span>, &lt;span style="color:#a6e22e">file&lt;/span>))(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sequelize&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Sequelize&lt;/span>.&lt;span style="color:#a6e22e">DataTypes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">db&lt;/span>[&lt;span style="color:#a6e22e">model&lt;/span>.&lt;span style="color:#a6e22e">name&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">model&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Object.&lt;span style="color:#a6e22e">keys&lt;/span>(&lt;span style="color:#a6e22e">db&lt;/span>).&lt;span style="color:#a6e22e">forEach&lt;/span>((&lt;span style="color:#a6e22e">modelName&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">db&lt;/span>[&lt;span style="color:#a6e22e">modelName&lt;/span>].&lt;span style="color:#a6e22e">associate&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">db&lt;/span>[&lt;span style="color:#a6e22e">modelName&lt;/span>].&lt;span style="color:#a6e22e">associate&lt;/span>(&lt;span style="color:#a6e22e">db&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">sequelize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">sequelize&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">Sequelize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">Sequelize&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span>;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h4>user.js&lt;span class="hx-absolute -hx-mt-20" id="userjs">&lt;/span>
&lt;a href="#userjs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">Model&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;sequelize&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">sequelize&lt;/span>, &lt;span style="color:#a6e22e">DataTypes&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">user&lt;/span> &lt;span style="color:#66d9ef">extends&lt;/span> &lt;span style="color:#a6e22e">Model&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">associate&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user&lt;/span>.&lt;span style="color:#a6e22e">hasMany&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>.&lt;span style="color:#a6e22e">message&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">foreignKey&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;user_id&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user&lt;/span>.&lt;span style="color:#a6e22e">init&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">username&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">STRING&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">unique&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">STRING&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sequelize&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">paranoid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">freezeTableName&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">modelName&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;user&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">user&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ­¤ç‚º user è³‡æ–™è¡¨çš„æ¬„ä½è³‡æ–™ï¼Œæœ‰é è¨­çš„ init åˆå§‹åŒ–ï¼Œæ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯å¦‚æœæœ‰ç”¨åˆ°é—œè¯æ€§çš„å¤–éµç­‰ç­‰è¦è¨˜å¾—åœ¨ associate åšè¨­å®šï¼Œ&lt;code>user.hasMany(models.message,{foreignKey: &amp;quot;user_id&amp;quot;,})&lt;/code> ä»£è¡¨ user é€™å¼µè¡¨å¯ä»¥æœ‰å¾ˆå¤šå€‹ messageï¼Œå…¶ message å¤–éµæ˜¯ user_idã€‚&lt;/p>
&lt;ul>
&lt;li>paranoidï¼šä»£è¡¨æœƒåŸ·è¡Œè»Ÿåˆªé™¤è€Œä¸æ˜¯ç¡¬åˆªé™¤ï¼Œä½†å¿…é ˆè¦å¤šä¸€å€‹ &lt;code>deletedAt&lt;/code> ä¾†å­˜æ”¾è»Ÿåˆªé™¤æ™‚é–“ã€‚&lt;/li>
&lt;li>freezeTableNameï¼šå› ç‚º sequelize æœƒè‡ªå‹•å†ç”¢ç”Ÿè³‡æ–™è¡¨æ™‚åŠ ä¸Šè¤‡æ•¸ï¼Œå¦‚æœä¸æƒ³è¦å°±å¿…é ˆä½¿ç”¨å®ƒè®“ sequelize ä¸æœƒè‡ªå‹•åŠ å…¥ s (è¤‡æ•¸)ã€‚&lt;/li>
&lt;li>modelNameï¼šæ­¤ model åç¨±ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>message.js&lt;span class="hx-absolute -hx-mt-20" id="messagejs">&lt;/span>
&lt;a href="#messagejs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">Model&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;sequelize&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">sequelize&lt;/span>, &lt;span style="color:#a6e22e">DataTypes&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">message&lt;/span> &lt;span style="color:#66d9ef">extends&lt;/span> &lt;span style="color:#a6e22e">Model&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">associate&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message&lt;/span>.&lt;span style="color:#a6e22e">hasMany&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>.&lt;span style="color:#a6e22e">reply&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">foreignKey&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;message_id&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message&lt;/span>.&lt;span style="color:#a6e22e">belongsTo&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>.&lt;span style="color:#a6e22e">user&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">foreignKey&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;user_id&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message&lt;/span>.&lt;span style="color:#a6e22e">init&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">INTEGER&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">allowNull&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">STRING&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">allowNull&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">STRING&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sequelize&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">paranoid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">freezeTableName&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">modelName&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">message&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ­¤ç‚º message è³‡æ–™è¡¨çš„æ¬„ä½è³‡æ–™ï¼Œassociate è¨­å®šæœ‰ &lt;code>message.hasMany(models.reply,{foreignKey: &amp;quot;message_id&amp;quot;,})&lt;/code> ä»£è¡¨ message é€™å¼µè¡¨å¯ä»¥æœ‰å¾ˆå¤šå€‹ replyï¼Œå…¶ reply å¤–éµæ˜¯ message_idã€‚ä»¥åŠ &lt;code>message.belongsTo(models.user, {foreignKey: &amp;quot;user_id&amp;quot;,});&lt;/code> ä»£è¡¨ message å­˜åœ¨ä¸€å°ä¸€çš„é—œä¿‚ï¼Œå¤–éµæ˜¯ user_idã€‚&lt;/p>
&lt;br>
&lt;h4>reply.js&lt;span class="hx-absolute -hx-mt-20" id="replyjs">&lt;/span>
&lt;a href="#replyjs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;use strict&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> { &lt;span style="color:#a6e22e">Model&lt;/span> } &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;sequelize&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">sequelize&lt;/span>, &lt;span style="color:#a6e22e">DataTypes&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">reply&lt;/span> &lt;span style="color:#66d9ef">extends&lt;/span> &lt;span style="color:#a6e22e">Model&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">associate&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">reply&lt;/span>.&lt;span style="color:#a6e22e">belongsTo&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>.&lt;span style="color:#a6e22e">message&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">foreignKey&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;message_id&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">reply&lt;/span>.&lt;span style="color:#a6e22e">belongsTo&lt;/span>(&lt;span style="color:#a6e22e">models&lt;/span>.&lt;span style="color:#a6e22e">user&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">foreignKey&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;user_id&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">reply&lt;/span>.&lt;span style="color:#a6e22e">init&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">INTEGER&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">allowNull&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">INTEGER&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">allowNull&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">STRING&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">allowNull&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">DataTypes&lt;/span>.&lt;span style="color:#a6e22e">STRING&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">sequelize&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">paranoid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">freezeTableName&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">modelName&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;reply&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">reply&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ­¤ç‚º reply è³‡æ–™è¡¨çš„æ¬„ä½è³‡æ–™ï¼Œassociate è¨­å®šæœ‰&lt;code>reply.belongsTo(models.message, {foreignKey: &amp;quot;message_id&amp;quot;,});&lt;/code> ä»£è¡¨ reply å­˜åœ¨ä¸€å°ä¸€çš„é—œä¿‚ï¼Œå¤–éµæ˜¯ message_idï¼Œä»¥åŠ &lt;code>reply.belongsTo(models.user, {foreignKey: &amp;quot;user_id&amp;quot;,});&lt;/code> ä»£è¡¨ reply å­˜åœ¨ä¸€å°ä¸€çš„é—œä¿‚ï¼Œå¤–éµæ˜¯ user_idã€‚&lt;/p>
&lt;br>
&lt;h3>controllers&lt;span class="hx-absolute -hx-mt-20" id="controllers">&lt;/span>
&lt;a href="#controllers" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘éµå¾ª MVC çš„è¨­è¨ˆè¦ç¯„ï¼Œæ‰€æœ‰çš„å•†ç”¨é‚è¼¯éƒ½æœƒæ”¾åœ¨ controller å…§ï¼Œrepository åªè² è²¬èˆ‡è³‡æ–™åº«é€²è¡Œäº¤æ¡ã€‚&lt;/p>
&lt;h4>auth.js&lt;span class="hx-absolute -hx-mt-20" id="authjs">&lt;/span>
&lt;a href="#authjs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Auth&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../repositories/auth&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">bcrypt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;bcrypt&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// è¨»å†Š
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">register&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">password&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ²’æœ‰æ­£ç¢ºè¼¸å…¥å¸³è™Ÿæˆ–å¯†ç¢¼&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">salt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">bcrypt&lt;/span>.&lt;span style="color:#a6e22e">genSalt&lt;/span>(&lt;span style="color:#ae81ff">10&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">bcrypt_password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">bcrypt&lt;/span>.&lt;span style="color:#a6e22e">hash&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">password&lt;/span>, &lt;span style="color:#a6e22e">salt&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Auth&lt;/span>.&lt;span style="color:#a6e22e">register&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">username&lt;/span>, &lt;span style="color:#a6e22e">bcrypt_password&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">user&lt;/span>[&lt;span style="color:#ae81ff">1&lt;/span>]) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;usernameå·²å­˜åœ¨&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">201&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">user&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç™»å…¥
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">login&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">password&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ²’æœ‰æ­£ç¢ºè¼¸å…¥å¸³è™Ÿæˆ–å¯†ç¢¼&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Auth&lt;/span>.&lt;span style="color:#a6e22e">login&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">username&lt;/span>, &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">password&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">user&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">user&lt;/span>.&lt;span style="color:#a6e22e">id&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">200&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ç™»å…¥æˆåŠŸ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç™»å‡º
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">logout&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">destroy&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">200&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ç™»å‡ºæˆåŠŸ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">register&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">login&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">logout&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸»è¦æœ‰3 å€‹éƒ¨ä»½ï¼Œè¨»å†Šã€ç™»å…¥ã€ç™»å‡ºï¼š&lt;/p>
&lt;ul>
&lt;li>è¨»å†Šï¼šæœƒå…ˆé©—è­‰æ˜¯å¦æ­£ç¢ºè¼¸å…¥è³‡æ–™(åŒ…å«æ¬„ä½æ˜¯å¦éŒ¯èª¤ç­‰)ï¼Œå¦‚æœæœ‰éŒ¯ï¼Œå°±æœƒå›æ‡‰ 400 ä»¥åŠæ²’æœ‰æ­£ç¢ºè¼¸å…¥å¸³è™Ÿæˆ–å¯†ç¢¼ã€‚æ¥ä¸‹ä¾†æœƒä½¿ç”¨åˆ° &lt;code>bcrypt&lt;/code> ä¾†å¹«å¯†ç¢¼é€²è¡ŒåŠ å¯†è™•ç†ï¼Œå†æŠŠåŠ å¯†å¾Œçš„å¯†ç¢¼ä»¥åŠå¸³è™Ÿä¸Ÿåˆ° Auth.register repository ä¾†é€²è¡Œè³‡æ–™åº«çš„å­˜å–ï¼Œå¦‚æœéŒ¯èª¤æœƒå›æ‡‰ 400 ä»¥åŠ username å·²å­˜åœ¨ï¼ŒæˆåŠŸæœƒå›æ‡‰ 201 ä»¥åŠæ–°å¢çš„å¸³è™Ÿè³‡è¨Šã€‚&lt;/li>
&lt;li>ç™»å…¥ï¼šä¸€æ¨£æœƒå…ˆæª¢æŸ¥è¼¸å…¥è³‡æ–™ï¼Œæ¥è‘—æŠŠè³‡æ–™ä¸Ÿåˆ° Auth.login repository ä¾†é€²è¡Œè³‡æ–™åº«çš„é©—è­‰ï¼Œå¦‚æœéŒ¯èª¤æœƒå›æ‡‰ 400 ä»¥åŠå¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼ŒæˆåŠŸæœƒå›æ‡‰ 200 ä»¥åŠç™»å‡ºæˆåŠŸã€‚&lt;/li>
&lt;li>ç™»å‡ºï¼šå°‡ session çµ¦æ¸…é™¤ï¼Œç„¶å¾Œå›æ‡‰ 200 ä»¥åŠç™»å‡ºæˆåŠŸã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>message.js&lt;span class="hx-absolute -hx-mt-20" id="messagejs-1">&lt;/span>
&lt;a href="#messagejs-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>(ç”±æ–¼å…§å®¹è¼ƒå¤šï¼Œæ‰€ä»¥ä¾ç…§åŠŸèƒ½æ‹†åˆ†å¾Œèªªæ˜)&lt;/p>
&lt;p>&lt;strong>æŸ¥è©¢ç•™è¨€åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../repositories/message&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../repositories/reply&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æŸ¥è©¢æ‰€æœ‰ç•™è¨€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">getAllMessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">getAll&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">200&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//æŸ¥è©¢{id}ç•™è¨€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">getMessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>(&lt;span style="color:#a6e22e">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>))) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">404&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ‰¾ä¸åˆ°ç•™è¨€&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">200&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å…ˆè¼‰å…¥è¦ä½¿ç”¨çš„ repository ï¼ŒæŸ¥è©¢æ‰€æœ‰ç•™è¨€æœƒä½¿ç”¨ Message.getAll() repository ä¾†é€²è¡Œè³‡æ–™åº«çš„è®€å–ï¼Œæœƒå›æ‡‰ 200 ä»¥åŠæŸ¥è©¢å…§å®¹ï¼Œè‹¥æ˜¯å°šæœªæœ‰ç•™è¨€å‰‡æœƒé¡¯ç¤ºç©ºé™£åˆ—ã€‚æŸ¥è©¢{id}ç•™è¨€æœƒå°‡ &lt;code>req.params.message_id&lt;/code> ä¸Ÿåˆ° Message.get repository ä¾†é€²è¡Œè³‡æ–™åº«çš„è®€å–ï¼Œå¦‚æœéŒ¯èª¤æœƒå›æ‡‰ 404 ä»¥åŠ æ‰¾ä¸åˆ°ç•™è¨€ï¼ŒæˆåŠŸæœƒå›æ‡‰ 200 ä»¥åŠæŸ¥è©¢å…§å®¹ã€‚&lt;/p>
&lt;br>
&lt;p>&lt;strong>æ–°å¢ç•™è¨€åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//æ–°å¢ç•™è¨€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">createMessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ²’æœ‰è¼¸å…¥å…§å®¹æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">create&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span>, &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">201&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ–°å¢ç•™è¨€æœƒå…ˆæª¢æŸ¥è¼¸å…¥å…§å®¹æ˜¯å¦ç‚ºç©ºä»¥åŠä¸èƒ½å¤§æ–¼20å€‹å­—å…ƒï¼Œå¦‚æœéŒ¯èª¤å°±å›æ‡‰ 400 ä»¥åŠæ²’æœ‰è¼¸å…¥å…§å®¹æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒï¼Œå†å°‡ &lt;code>req.session.userid&lt;/code>ã€&lt;code>req.body.content&lt;/code> ä¸Ÿåˆ° Message.create repository ä¾†é€²è¡Œè³‡æ–™åº«çš„å­˜å–ï¼ŒæˆåŠŸæœƒå›æ‡‰ 201 ä»¥åŠæ–°å¢çš„ç•™è¨€ã€‚&lt;/p>
&lt;br>
&lt;p>&lt;strong>ä¿®æ”¹ç•™è¨€åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//ä¿®æ”¹ç•™è¨€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">updateMessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>(&lt;span style="color:#a6e22e">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>))) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">404&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ‰¾ä¸åˆ°ç•™è¨€&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ²’æœ‰è¼¸å…¥å…§å®¹æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">update&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;version&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )) &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ä¿®æ”¹ç•™è¨€å¤±æ•—&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">200&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ä¿®æ”¹ç•™è¨€æˆåŠŸ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¿®æ”¹ç•™è¨€å› ç‚ºéœ€è¦å…ˆå¾è³‡æ–™ä¸­å–å¾— &lt;code>version&lt;/code> ä¾†æª¢æŸ¥æ¨‚è§€é–ï¼Œæ‰€ä»¥æœƒå…ˆå°‡ &lt;code>req.params.message_id&lt;/code> ä¸Ÿåˆ° Message.get repository ä¾†é€²è¡Œè³‡æ–™åº«çš„æŸ¥è©¢ï¼ŒéŒ¯èª¤æœƒå›æ‡‰ 404 ä»¥åŠæ‰¾ä¸åˆ°ç•™è¨€ã€‚
å…ˆæª¢æŸ¥è¼¸å…¥å…§å®¹æ˜¯å¦ç‚ºç©ºä»¥åŠä¸èƒ½å¤§æ–¼20å€‹å­—å…ƒï¼Œå¦‚æœéŒ¯èª¤å°±å›æ‡‰ 400 ä»¥åŠæ²’æœ‰è¼¸å…¥å…§å®¹æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒï¼Œå†å°‡ &lt;code>req.params.message_id&lt;/code>ã€&lt;code>req.session.userid&lt;/code>ã€&lt;code>req.body.content&lt;/code>ã€&lt;code>message[&amp;quot;version&amp;quot;]&lt;/code> ä¸Ÿåˆ° Message.update repository ä¾†é€²è¡Œè³‡æ–™åº«çš„æ›´æ–°ï¼ŒéŒ¯èª¤æœƒå›æ‡‰ 400 ä»¥åŠä¿®æ”¹ç•™è¨€å¤±æ•—ï¼ŒæˆåŠŸæœƒå›æ‡‰ 200 ä»¥åŠä¿®æ”¹ç•™è¨€æˆåŠŸã€‚&lt;/p>
&lt;br>
&lt;p>&lt;strong>åˆªé™¤ç•™è¨€åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//åˆªé™¤ç•™è¨€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">deleteMessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>(&lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#66d9ef">delete&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>, &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span>))) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;åˆªé™¤ç•™è¨€å¤±æ•—&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åˆªé™¤ç•™è¨€æ™‚åŒæ­¥åˆªé™¤æ‰€æœ‰å›è¦†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">deleteMessage&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">204&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;åˆªé™¤ç•™è¨€æˆåŠŸ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åˆªé™¤ç•™è¨€æœƒå°‡ &lt;code>req.params.message_id&lt;/code>ã€&lt;code>req.session.userid&lt;/code> ä¸Ÿåˆ° Message.delete repository ä¾†é€²è¡Œè³‡æ–™åº«çš„è»Ÿåˆªé™¤ï¼ŒéŒ¯èª¤æœƒå›æ‡‰ 400 ä»¥åŠåˆªé™¤ç•™è¨€å¤±æ•—ï¼Œå› ç‚ºæˆ‘å€‘åˆªé™¤ç•™è¨€å¾Œï¼Œä¸èƒ½åœ¨å°è©²ç•™è¨€é€²è¡Œå›è¦†çš„ä»»ä½•åŠŸèƒ½ï¼Œæ‰€ä»¥ä¸€åŒè»Ÿåˆªé™¤æ‰€æœ‰çš„å›è¦†ï¼ŒæˆåŠŸå¾Œæœƒå›æ‡‰ 204 ä»¥åŠåˆªé™¤ç•™è¨€æˆåŠŸã€‚&lt;/p>
&lt;br>
&lt;h4>reply.js&lt;span class="hx-absolute -hx-mt-20" id="replyjs-1">&lt;/span>
&lt;a href="#replyjs-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>(ç”±æ–¼å…§å®¹è¼ƒå¤šï¼Œæ‰€ä»¥ä¾ç…§åŠŸèƒ½æ‹†åˆ†å¾Œèªªæ˜)&lt;/p>
&lt;p>&lt;strong>æ–°å¢å›è¦†åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../repositories/reply&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//æ–°å¢å›è¦†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">createReply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ²’æœ‰è¼¸å…¥å›è¦†æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">!&lt;/span>(&lt;span style="color:#a6e22e">reply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">create&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ–°å¢å›è¦†å¤±æ•—&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">201&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">reply&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å…ˆè¼‰å…¥è¦ä½¿ç”¨çš„ repositoryï¼Œæ–°å¢å›è¦†å…ˆæª¢æŸ¥è¼¸å…¥å…§å®¹æ˜¯å¦ç‚ºç©ºä»¥åŠä¸èƒ½å¤§æ–¼20å€‹å­—å…ƒï¼Œå¦‚æœéŒ¯èª¤å°±å›æ‡‰ 400 ä»¥åŠæ²’æœ‰è¼¸å…¥å…§å®¹æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒï¼Œå†å°‡ &lt;code>req.params.message_id&lt;/code>ã€&lt;code>req.session.userid&lt;/code>ã€&lt;code>req.body.content&lt;/code> ä¸Ÿåˆ° Reply.create repository ä¾†é€²è¡Œè³‡æ–™åº«çš„å­˜å–ï¼ŒéŒ¯èª¤æœƒå›æ‡‰ 400 ä»¥åŠæ–°å¢ç•™è¨€å¤±æ•—ï¼ŒæˆåŠŸæœƒå›æ‡‰ 201 ä»¥åŠæ–°å¢å›è¦†å…§å®¹ã€‚&lt;/p>
&lt;br>
&lt;p>&lt;strong>ä¿®æ”¹å›è¦†åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//ä¿®æ”¹å›è¦†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">updateReply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>(&lt;span style="color:#a6e22e">reply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">reply_id&lt;/span>, &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>))) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">404&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ‰¾ä¸åˆ°å›è¦†&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ²’æœ‰è¼¸å…¥å›è¦†æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">update&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">reply_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">body&lt;/span>.&lt;span style="color:#a6e22e">content&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">reply&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;version&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )) &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ä¿®æ”¹å›è¦†å¤±æ•—&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">200&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ä¿®æ”¹å›è¦†æˆåŠŸ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¿®æ”¹ç•™è¨€å› ç‚ºéœ€è¦å…ˆå¾è³‡æ–™ä¸­å–å¾— &lt;code>version&lt;/code> ä¾†æª¢æŸ¥æ¨‚è§€é–ï¼Œæ‰€ä»¥æœƒå…ˆå°‡ &lt;code>req.params.reply_id&lt;/code>ã€&lt;code>req.params.message_id&lt;/code> ä¸Ÿåˆ° Reply.get repository ä¾†é€²è¡Œè³‡æ–™åº«çš„æŸ¥è©¢ï¼ŒéŒ¯èª¤æœƒå›æ‡‰ 404 ä»¥åŠæ‰¾ä¸åˆ°ç•™è¨€ã€‚
å…ˆæª¢æŸ¥è¼¸å…¥å…§å®¹æ˜¯å¦ç‚ºç©ºä»¥åŠä¸èƒ½å¤§æ–¼20å€‹å­—å…ƒï¼Œå¦‚æœéŒ¯èª¤å°±å›æ‡‰ 400 ä»¥åŠæ²’æœ‰è¼¸å…¥å…§å®¹æˆ–é•·åº¦è¶…é20å€‹å­—å…ƒï¼Œå†å°‡ &lt;code>req.params.reply_id &lt;/code>ã€&lt;code>req.params.message_id&lt;/code>ã€&lt;code>req.session.userid&lt;/code>ã€&lt;code>req.body.content&lt;/code>ã€&lt;code>reply[&amp;quot;version&amp;quot;]&lt;/code> ä¸Ÿåˆ° Reply.update repository ä¾†é€²è¡Œè³‡æ–™åº«çš„æ›´æ–°ï¼ŒéŒ¯èª¤æœƒå›æ‡‰ 400 ä»¥åŠä¿®æ”¹å›è¦†å¤±æ•—ï¼ŒæˆåŠŸæœƒå›æ‡‰ 200 ä»¥åŠä¿®æ”¹å›è¦†æˆåŠŸã€‚&lt;/p>
&lt;br>
&lt;p>&lt;strong>åˆªé™¤å›è¦†åŠŸèƒ½&lt;/strong>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//åˆªé™¤å›è¦†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">deleteReply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">!&lt;/span>(&lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#66d9ef">delete&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">reply_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">params&lt;/span>.&lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">userid&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">400&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;åˆªé™¤å›è¦†å¤±æ•—&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">status&lt;/span>(&lt;span style="color:#ae81ff">204&lt;/span>).&lt;span style="color:#a6e22e">json&lt;/span>({ &lt;span style="color:#a6e22e">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;åˆªé™¤å›è¦†æˆåŠŸ&amp;#34;&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åˆªé™¤å›è¦†æœƒå°‡ &lt;code>req.params.reply_id&lt;/code>ã€&lt;code>req.params.message_id&lt;/code>ã€&lt;code>req.session.userid&lt;/code> ä¸Ÿåˆ° Reply.delete repository ä¾†é€²è¡Œè³‡æ–™åº«çš„è»Ÿåˆªé™¤ï¼ŒéŒ¯èª¤æœƒå›æ‡‰ 400 ä»¥åŠåˆªé™¤å›è¦†å¤±æ•—ï¼ŒæˆåŠŸå¾Œæœƒå›æ‡‰ 204 ä»¥åŠåˆªé™¤å›è¦†æˆåŠŸã€‚&lt;/p>
&lt;br>
&lt;h3>repositories&lt;span class="hx-absolute -hx-mt-20" id="repositories">&lt;/span>
&lt;a href="#repositories" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ­¤æœƒæ”¾ç½®èˆ‡è³‡æ–™åº«é€²è¡Œäº¤æ¡çš„ç¨‹å¼ã€‚&lt;/p>
&lt;h4>auth.js&lt;span class="hx-absolute -hx-mt-20" id="authjs-1">&lt;/span>
&lt;a href="#authjs-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">User&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../models&amp;#34;&lt;/span>).&lt;span style="color:#a6e22e">user&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">bcrypt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;bcrypt&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">auth&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è¨»å†Š
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">register&lt;/span>(&lt;span style="color:#a6e22e">username&lt;/span>, &lt;span style="color:#a6e22e">bcrypt_password&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">User&lt;/span>.&lt;span style="color:#a6e22e">findOrCreate&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">username&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">username&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">defaults&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">username&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">username&lt;/span>, &lt;span style="color:#a6e22e">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">bcrypt_password&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç™»å…¥
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">login&lt;/span>(&lt;span style="color:#a6e22e">username&lt;/span>, &lt;span style="color:#a6e22e">password&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">User&lt;/span>.&lt;span style="color:#a6e22e">findOne&lt;/span>({ &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">username&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">username&lt;/span> } });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">user&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> (&lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">bcrypt&lt;/span>.&lt;span style="color:#a6e22e">compare&lt;/span>(&lt;span style="color:#a6e22e">password&lt;/span>, &lt;span style="color:#a6e22e">user&lt;/span>.&lt;span style="color:#a6e22e">password&lt;/span>)) &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#a6e22e">user&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">auth&lt;/span>;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>auth å…§ä¸»è¦æœ‰å…©å€‹èˆ‡è³‡æ–™åº«é€²è¡Œäº’å‹•ï¼Œåˆ†åˆ¥æ˜¯ï¼Œè¨»å†Šä»¥åŠç™»å…¥ï¼Œè¨»å†Šæœƒå°‡å‚³å…¥çš„å¸³è™Ÿä»¥åŠåŠ å¯†éå¾Œå¯†ç¢¼ä½¿ç”¨ &lt;code>User.findOrCreate&lt;/code> ä¾†é€²è¡ŒæŸ¥è©¢æˆ–æ–°å¢ï¼Œå¦‚æœå¸³è™Ÿä¸å­˜åœ¨æ‰æœƒé€²è¡Œæ–°å¢å‹•ä½œã€‚ç™»å…¥æœƒå°‡å‚³å…¥çš„å¸³è™ŸåŠå¯†ç¢¼ä½¿ç”¨ &lt;code>User.findOne&lt;/code> ä¾†æª¢æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å†æª¢æŸ¥å¯†ç¢¼èˆ‡è³‡æ–™åº«æ˜¯å¦æ­£ç¢ºã€‚&lt;/p>
&lt;br>
&lt;h4>message.js&lt;span class="hx-absolute -hx-mt-20" id="messagejs-2">&lt;/span>
&lt;a href="#messagejs-2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../models&amp;#34;&lt;/span>).&lt;span style="color:#a6e22e">message&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../models&amp;#34;&lt;/span>).&lt;span style="color:#a6e22e">reply&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">repository&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">getAll&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">findAll&lt;/span>({ &lt;span style="color:#a6e22e">include&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">model&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span> } });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#a6e22e">message_id&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">findOne&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">include&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">model&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">create&lt;/span>(&lt;span style="color:#a6e22e">user_id&lt;/span>, &lt;span style="color:#a6e22e">content&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">create&lt;/span>({ &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">user_id&lt;/span>, &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">update&lt;/span>(&lt;span style="color:#a6e22e">message_id&lt;/span>, &lt;span style="color:#a6e22e">user_id&lt;/span>, &lt;span style="color:#a6e22e">content&lt;/span>, &lt;span style="color:#a6e22e">version&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">update&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">version&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">user_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">version&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">delete&lt;/span>(&lt;span style="color:#a6e22e">message_id&lt;/span>, &lt;span style="color:#a6e22e">user_id&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">destroy&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span>, &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">user_id&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">repository&lt;/span>;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>message.js è£¡é¢æœ‰æœƒæŸ¥è©¢å…¨éƒ¨ç•™è¨€ã€æŸ¥è©¢{id}ç•™è¨€ã€æ–°å¢ç•™è¨€ã€ä¿®æ”¹{id}ç•™è¨€ã€åˆªé™¤{id}ç•™è¨€ç­‰ï¼Œä»¥ä¸‹æœƒèªªæ˜å„åˆ¥è² è²¬åŠŸç”¨ï¼š&lt;/p>
&lt;ul>
&lt;li>æŸ¥è©¢å…¨éƒ¨ç•™è¨€ getAll()ï¼šä½¿ç”¨ &lt;code>Message.findAll&lt;/code> ä¾†é¡¯ç¤ºæŸ¥è©¢çµæœï¼Œä¸¦ä¸” include model Reply å›è¦†å…§å®¹ã€‚&lt;/li>
&lt;li>æŸ¥è©¢{id}ç•™è¨€ get()ï¼šä½¿ç”¨ &lt;code>Message.findOne&lt;/code> æŸ¥è©¢ message.id ç­‰æ–¼ message_id çš„çµæœï¼Œä¸¦ä¸” include model Reply å›è¦†å…§å®¹ã€‚&lt;/li>
&lt;li>æ–°å¢ç•™è¨€ create()ï¼šä½¿ç”¨ &lt;code>Message.create&lt;/code> æ–°å¢ message.user_id ä»¥åŠ message.contentã€‚&lt;/li>
&lt;li>ä¿®æ”¹{id}ç•™è¨€ update()ï¼šä½¿ç”¨ &lt;code>Message.update&lt;/code> æ›´æ–° content ä»¥åŠ versionï¼Œä¸” message.id è¦ç­‰æ–¼ message_id åŠ message.user_id ç­‰æ–¼ user_id åŠ message.version ç­‰æ–¼ versionã€‚&lt;/li>
&lt;li>åˆªé™¤{id}ç•™è¨€ delete()ï¼šä½¿ç”¨ &lt;code>Message.destroy&lt;/code> åˆªé™¤ç¬¦åˆ message.id ç­‰æ–¼ message_id åŠ message.user_id ç­‰æ–¼ user_idã€‚
&lt;br>&lt;/li>
&lt;/ul>
&lt;h4>reply.js&lt;span class="hx-absolute -hx-mt-20" id="replyjs-2">&lt;/span>
&lt;a href="#replyjs-2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../models&amp;#34;&lt;/span>).&lt;span style="color:#a6e22e">message&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;../models&amp;#34;&lt;/span>).&lt;span style="color:#a6e22e">reply&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">reply&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#a6e22e">reply_id&lt;/span>, &lt;span style="color:#a6e22e">message_id&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">findOne&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">reply_id&lt;/span>, &lt;span style="color:#a6e22e">message_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">create&lt;/span>(&lt;span style="color:#a6e22e">message_id&lt;/span>, &lt;span style="color:#a6e22e">user_id&lt;/span>, &lt;span style="color:#a6e22e">content&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">is_exist&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Message&lt;/span>.&lt;span style="color:#a6e22e">findOne&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">is_exist&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">create&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">user_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">update&lt;/span>(&lt;span style="color:#a6e22e">reply_id&lt;/span>, &lt;span style="color:#a6e22e">message_id&lt;/span>, &lt;span style="color:#a6e22e">user_id&lt;/span>, &lt;span style="color:#a6e22e">content&lt;/span>, &lt;span style="color:#a6e22e">version&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">update&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">version&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">reply_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">user_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">version&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">delete&lt;/span>(&lt;span style="color:#a6e22e">reply_id&lt;/span>, &lt;span style="color:#a6e22e">message_id&lt;/span>, &lt;span style="color:#a6e22e">user_id&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">destroy&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">reply_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">user_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">user_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#a6e22e">deleteMessage&lt;/span>(&lt;span style="color:#a6e22e">message_id&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">Reply&lt;/span>.&lt;span style="color:#a6e22e">destroy&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">message_id&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">message_id&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">module&lt;/span>.&lt;span style="color:#a6e22e">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">reply&lt;/span>;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>reply.js è£¡é¢æœ‰æœƒæ–°å¢å›è¦†ã€ä¿®æ”¹{id}å›è¦†ã€åˆªé™¤{id}å›è¦†ç­‰ï¼Œé™¤æ­¤ä¹‹å¤–é‚„å¤šäº†å…©å€‹ &lt;code>get&lt;/code>ã€&lt;code>deleteMessage&lt;/code> ç”¨ä¾†å–å¾— version æ¨‚è§€é–ä»¥åŠåŒæ­¥åˆªé™¤å›è¦†åŠŸèƒ½ï¼Œé‚£ä»¥ä¸‹æœƒèªªæ˜å„åˆ¥è² è²¬åŠŸç”¨ï¼š&lt;/p>
&lt;ul>
&lt;li>æ–°å¢å›è¦† create()ï¼šå› ç‚ºè¦å…ˆç¢ºèªç•™è¨€æ˜¯å¦è¢«åˆªé™¤ï¼Œæ‰€ä»¥å…ˆä½¿ç”¨ &lt;code>Message.findOne&lt;/code> æª¢æŸ¥ç•™è¨€æ˜¯å¦è¢«åˆªé™¤ï¼Œåœ¨ç”¨ &lt;code>Reply.create&lt;/code> æ–°å¢ reply.message_id è·Ÿ reply.user_id ä»¥åŠ reply.contentã€‚&lt;/li>
&lt;li>ä¿®æ”¹{id}å›è¦† update()ï¼šä½¿ç”¨ &lt;code>Reply.update&lt;/code> æ›´æ–° content ä»¥åŠ versionï¼Œä¸” reply.id è¦ç­‰æ–¼ reply_id åŠ reply.message_id ç­‰æ–¼ message_id åŠ reply.user_id ç­‰æ–¼ user_id åŠ reply.version ç­‰æ–¼ versionã€‚&lt;/li>
&lt;li>åˆªé™¤{id}å›è¦† delete()ï¼šä½¿ç”¨ &lt;code>Reply.destroy &lt;/code> åˆªé™¤ç¬¦åˆ reply.id ç­‰æ–¼ reply_id è·Ÿ reply.message_id ç­‰æ–¼ message_id åŠ reply.user_id ç­‰æ–¼ user_idã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h2>å¸¸ç”¨æŒ‡ä»¤ (sequelize-cli)&lt;span class="hx-absolute -hx-mt-20" id="å¸¸ç”¨æŒ‡ä»¤-sequelize-cli">&lt;/span>
&lt;a href="#%e5%b8%b8%e7%94%a8%e6%8c%87%e4%bb%a4-sequelize-cli" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>sequelize db:migrateï¼šå°‡è³‡æ–™è¡¨ä¾ç…§ up å…§å®¹åŸ·è¡Œ(&lt;a href="https://pin-yi.me/node-restful-api-repository-messageboard/#migrations" target="_blank" rel="noopener">migrate æª”æ¡ˆ&lt;/a>)ã€‚&lt;/li>
&lt;li>sequelize db:migrate:undo:allï¼šå°‡è³‡æ–™è¡¨ä¾ç…§ down å…§å®¹åŸ·è¡Œ(&lt;a href="https://pin-yi.me/node-restful-api-repository-messageboard/#migrations" target="_blank" rel="noopener">migrate æª”æ¡ˆ&lt;/a>)ã€‚&lt;/li>
&lt;li>sequelize db:seedï¼šç”¢ç”Ÿå‡è³‡æ–™&lt;/li>
&lt;/ul>
&lt;br>
&lt;h2>Postman æ¸¬è©¦&lt;span class="hx-absolute -hx-mt-20" id="postman-æ¸¬è©¦">&lt;/span>
&lt;a href="#postman-%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>è¨»å†Š - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="è¨»å†Š---æˆåŠŸ">&lt;/span>
&lt;a href="#%e8%a8%bb%e5%86%8a---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/register-success.png"
alt="è¨»å†Š æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>è¨»å†Š æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨»å†Š - å¤±æ•—(ç„¡è¼¸å…¥)&lt;span class="hx-absolute -hx-mt-20" id="è¨»å†Š---å¤±æ•—ç„¡è¼¸å…¥">&lt;/span>
&lt;a href="#%e8%a8%bb%e5%86%8a---%e5%a4%b1%e6%95%97%e7%84%a1%e8%bc%b8%e5%85%a5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/register-error-1.png"
alt="è¨»å†Š å¤±æ•—(ç„¡è¼¸å…¥)" width="700">&lt;figcaption>
&lt;p>è¨»å†Š å¤±æ•—(ç„¡è¼¸å…¥)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨»å†Š - å¤±æ•—(å·²ç¶“è¨»å†Šé)&lt;span class="hx-absolute -hx-mt-20" id="è¨»å†Š---å¤±æ•—å·²ç¶“è¨»å†Šé">&lt;/span>
&lt;a href="#%e8%a8%bb%e5%86%8a---%e5%a4%b1%e6%95%97%e5%b7%b2%e7%b6%93%e8%a8%bb%e5%86%8a%e9%81%8e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/register-error-2.png"
alt="è¨»å†Š å¤±æ•—(å·²ç¶“è¨»å†Šé)" width="700">&lt;figcaption>
&lt;p>è¨»å†Š å¤±æ•—(å·²ç¶“è¨»å†Šé)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ç™»å…¥ - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="ç™»å…¥---æˆåŠŸ">&lt;/span>
&lt;a href="#%e7%99%bb%e5%85%a5---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/login-success.png"
alt="ç™»å…¥ æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>ç™»å…¥ æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ç™»å…¥ - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="ç™»å…¥---å¤±æ•—">&lt;/span>
&lt;a href="#%e7%99%bb%e5%85%a5---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/login-error.png"
alt="ç™»å…¥ å¤±æ•—" width="700">&lt;figcaption>
&lt;p>ç™»å…¥ å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æŸ¥è©¢å…¨éƒ¨ç•™è¨€ - æˆåŠŸ(ç„¡è³‡æ–™)&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥è©¢å…¨éƒ¨ç•™è¨€---æˆåŠŸç„¡è³‡æ–™">&lt;/span>
&lt;a href="#%e6%9f%a5%e8%a9%a2%e5%85%a8%e9%83%a8%e7%95%99%e8%a8%80---%e6%88%90%e5%8a%9f%e7%84%a1%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/get-success-1.png"
alt="æŸ¥è©¢ç•™è¨€ æˆåŠŸ(ç„¡è³‡æ–™)" width="700">&lt;figcaption>
&lt;p>æŸ¥è©¢ç•™è¨€ æˆåŠŸ(ç„¡è³‡æ–™)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æŸ¥è©¢å…¨éƒ¨ç•™è¨€ - æˆåŠŸ(æœ‰è³‡æ–™)&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥è©¢å…¨éƒ¨ç•™è¨€---æˆåŠŸæœ‰è³‡æ–™">&lt;/span>
&lt;a href="#%e6%9f%a5%e8%a9%a2%e5%85%a8%e9%83%a8%e7%95%99%e8%a8%80---%e6%88%90%e5%8a%9f%e6%9c%89%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/get-success-2.png"
alt="æŸ¥è©¢ç•™è¨€ æˆåŠŸ(æœ‰è³‡æ–™)" width="700">&lt;figcaption>
&lt;p>æŸ¥è©¢ç•™è¨€ æˆåŠŸ(æœ‰è³‡æ–™)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æŸ¥è©¢{id}ç•™è¨€ - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥è©¢idç•™è¨€---æˆåŠŸ">&lt;/span>
&lt;a href="#%e6%9f%a5%e8%a9%a2id%e7%95%99%e8%a8%80---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/get-id-success.png"
alt="æŸ¥è©¢{id}ç•™è¨€ æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>æŸ¥è©¢{id}ç•™è¨€ æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æŸ¥è©¢{id}ç•™è¨€ - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥è©¢idç•™è¨€---å¤±æ•—">&lt;/span>
&lt;a href="#%e6%9f%a5%e8%a9%a2id%e7%95%99%e8%a8%80---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/get-error.png"
alt="æŸ¥è©¢{id}ç•™è¨€ å¤±æ•—" width="700">&lt;figcaption>
&lt;p>æŸ¥è©¢{id}ç•™è¨€ å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ–°å¢ç•™è¨€ - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="æ–°å¢ç•™è¨€---æˆåŠŸ">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e%e7%95%99%e8%a8%80---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/create.png"
alt="æ–°å¢ç•™è¨€ æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>æ–°å¢ç•™è¨€ æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ–°å¢ç•™è¨€ - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="æ–°å¢ç•™è¨€---å¤±æ•—">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e%e7%95%99%e8%a8%80---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/create-error.png"
alt="æ–°å¢ç•™è¨€ å¤±æ•—" width="700">&lt;figcaption>
&lt;p>æ–°å¢ç•™è¨€ å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ä¿®æ”¹{id}ç•™è¨€ - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="ä¿®æ”¹idç•™è¨€---æˆåŠŸ">&lt;/span>
&lt;a href="#%e4%bf%ae%e6%94%b9id%e7%95%99%e8%a8%80---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/patch-success.png"
alt="ä¿®æ”¹ {id}ç•™è¨€ æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>ä¿®æ”¹ {id}ç•™è¨€ æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ä¿®æ”¹{id}ç•™è¨€ - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="ä¿®æ”¹idç•™è¨€---å¤±æ•—">&lt;/span>
&lt;a href="#%e4%bf%ae%e6%94%b9id%e7%95%99%e8%a8%80---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/patch-error.png"
alt="ä¿®æ”¹ {id}ç•™è¨€ å¤±æ•—" width="700">&lt;figcaption>
&lt;p>ä¿®æ”¹ {id}ç•™è¨€ å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>åˆªé™¤{id}ç•™è¨€ - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="åˆªé™¤idç•™è¨€---æˆåŠŸ">&lt;/span>
&lt;a href="#%e5%88%aa%e9%99%a4id%e7%95%99%e8%a8%80---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/delete.png"
alt="åˆªé™¤ {id}ç•™è¨€ æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>åˆªé™¤ {id}ç•™è¨€ æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>åˆªé™¤{id}ç•™è¨€ - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="åˆªé™¤idç•™è¨€---å¤±æ•—">&lt;/span>
&lt;a href="#%e5%88%aa%e9%99%a4id%e7%95%99%e8%a8%80---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/delete-error.png"
alt="åˆªé™¤ {id}ç•™è¨€ å¤±æ•—" width="700">&lt;figcaption>
&lt;p>åˆªé™¤ {id}ç•™è¨€ å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ–°å¢å›è¦† - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="æ–°å¢å›è¦†---æˆåŠŸ">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e%e5%9b%9e%e8%a6%86---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/reply-create.png"
alt="æ–°å¢å›è¦† æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>æ–°å¢å›è¦† æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ–°å¢å›è¦† - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="æ–°å¢å›è¦†---å¤±æ•—">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e%e5%9b%9e%e8%a6%86---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/reply-create-error.png"
alt="æ–°å¢å›è¦† å¤±æ•—" width="700">&lt;figcaption>
&lt;p>æ–°å¢å›è¦† å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ä¿®æ”¹{id}å›è¦† - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="ä¿®æ”¹idå›è¦†---æˆåŠŸ">&lt;/span>
&lt;a href="#%e4%bf%ae%e6%94%b9id%e5%9b%9e%e8%a6%86---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/reply-patch-success.png"
alt="ä¿®æ”¹ {id}å›è¦† æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>ä¿®æ”¹ {id}å›è¦† æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ä¿®æ”¹{id}å›è¦† - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="ä¿®æ”¹idå›è¦†---å¤±æ•—">&lt;/span>
&lt;a href="#%e4%bf%ae%e6%94%b9id%e5%9b%9e%e8%a6%86---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/reply-patch-error.png"
alt="ä¿®æ”¹ {id}å›è¦† å¤±æ•—" width="700">&lt;figcaption>
&lt;p>ä¿®æ”¹ {id}å›è¦† å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>åˆªé™¤{id}å›è¦† - æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="åˆªé™¤idå›è¦†---æˆåŠŸ">&lt;/span>
&lt;a href="#%e5%88%aa%e9%99%a4id%e5%9b%9e%e8%a6%86---%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/reply-delete.png"
alt="åˆªé™¤ {id}å›è¦† æˆåŠŸ" width="700">&lt;figcaption>
&lt;p>åˆªé™¤ {id}å›è¦† æˆåŠŸ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>åˆªé™¤{id}å›è¦† - å¤±æ•—&lt;span class="hx-absolute -hx-mt-20" id="åˆªé™¤idå›è¦†---å¤±æ•—">&lt;/span>
&lt;a href="#%e5%88%aa%e9%99%a4id%e5%9b%9e%e8%a6%86---%e5%a4%b1%e6%95%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-restful-api-repository-messageboard/reply-delete-error.png"
alt="åˆªé™¤ {id}å›è¦† å¤±æ•—" width="700">&lt;figcaption>
&lt;p>åˆªé™¤ {id}å›è¦† å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Node.js å®˜ç¶²ï¼š&lt;a href="https://nodejs.dev/learn/introduction-to-nodejs" target="_blank" rel="noopener">https://nodejs.dev/learn/introduction-to-nodejs&lt;/a>&lt;/p>
&lt;p>Sequelizeï¼š&lt;a href="https://sequelize.org/v6/index.html" target="_blank" rel="noopener">https://sequelize.org/v6/index.html&lt;/a>&lt;/p>
&lt;p>é€é sequelize ä¾†é”æˆ DB Schema Migrationï¼š&lt;a href="https://hackmd.io/@TSMI_E7ORNeP8YBbWm-lFA/ryCtaVW_M?print-pdf#%E4%BD%BF%E7%94%A8sequelize%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%BC%B5user-table" target="_blank" rel="noopener">https://hackmd.io/@TSMI_E7ORNeP8YBbWm-lFA/ryCtaVW_M?print-pdf#%E4%BD%BF%E7%94%A8sequelize%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%BC%B5user-table&lt;/a>&lt;/p>
&lt;p>How to create JOIN queries with Sequelizeï¼š&lt;a href="https://sebhastian.com/sequelize-join/" target="_blank" rel="noopener">https://sebhastian.com/sequelize-join/&lt;/a>&lt;/p></description></item><item><title>Node.js ä»‹ç´¹</title><link>https://pin-yi.me/blog/nodejs/nodejs-introduce/</link><pubDate>Wed, 30 Mar 2022 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/nodejs/nodejs-introduce/</guid><description>
&lt;h2>ä»€éº¼æ˜¯ Node.js ?&lt;span class="hx-absolute -hx-mt-20" id="ä»€éº¼æ˜¯-nodejs-">&lt;/span>
&lt;a href="#%e4%bb%80%e9%ba%bc%e6%98%af-nodejs-" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Node.js æ˜¯èƒ½å¤ åœ¨ä¼ºæœå™¨ç«¯é‹è¡Œ JavaScript çš„é–‹æ”¾åŸå§‹ç¢¼ã€è·¨å¹³å°åŸ·è¡Œç’°å¢ƒã€‚&lt;/p>
&lt;p>Node.js çš„å‡ºç¾ï¼Œè®“å‰ç«¯ç¶²ç«™é–‹ç™¼äººå“¡å¯ä»¥ä½¿ç”¨ JaveScript ä¾†åšå¾Œç«¯æˆ–æ˜¯ç³»çµ±å±¤é¢çš„å·¥ä½œã€‚è®“å‰ç«¯é–‹ç™¼ç¶²ç«™é–‹ç™¼äººå“¡ä½¿ç”¨å·²æ‡‚çš„ JavaScript èªè¨€å°±å¯ä»¥è‡ªè¡Œè¨­å®šç¶²ç«™ä¼ºæœå™¨ã€‚&lt;/p>
&lt;p>Node.js æ¡ç”¨ Google é–‹ç™¼çš„ Chrome V8 JavaScript å¼•æ“å’Œ libuv å‡½å¼åº«ï¼Œå¯ä»¥ç”¨æŒ‡ä»¤å»åŸ·è¡Œ JavaScriptï¼Œä½¿ç”¨éé˜»å¡è¼¸å…¥è¼¸å‡ºã€éåŒæ­¥ã€äº‹ä»¶é©…å‹•ç­‰æŠ€è¡“ä¾†æé«˜æ•ˆèƒ½ï¼Œå¯æœ€ä½³åŒ–æ‡‰ç”¨ç¨‹å¼çš„å‚³è¼¸é‡å’Œè¦æ¨¡ã€‚é€™äº›æŠ€è¡“é€šå¸¸ç”¨æ–¼è³‡æ–™å¯†é›†çš„å³æ™‚æ‡‰ç”¨ç¨‹å¼ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-introduce/main-nodejs.png"
alt="ä¸»è¦çš„ Node.js çµ„ä»¶ (An Intro to Node.js That You May Have Missed)" width="700">&lt;figcaption>
&lt;p>ä¸»è¦çš„ Node.js çµ„ä»¶ (&lt;a href="https://itnext.io/an-intro-to-node-js-that-you-may-have-missed-b175ef4277f7" target="_blank" rel="noopener">An Intro to Node.js That You May Have Missed&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å…¶ä»–é–‹æºã€ä½ç´šçµ„ä»¶ï¼Œä¸»è¦ç”¨ C/C++ ç·¨å¯«ï¼š&lt;/p>
&lt;ul>
&lt;li>c-ares : ç”¨æ–¼éåŒæ­¥ DNS è«‹æ±‚çš„ C å‡½å¼åº«ï¼Œç”¨æ–¼ Node.js ä¸­çš„ä¸€äº› DNS è«‹æ±‚ã€‚&lt;/li>
&lt;li>http-parserï¼šä¸€å€‹è¼•é‡ç´šçš„ HTTP è«‹æ±‚/å›æ‡‰è§£æå™¨ã€‚&lt;/li>
&lt;li>OpenSSLï¼šä¸€å€‹è‘—åçš„é€šç”¨å¯†ç¢¼åº«ã€‚ç”¨æ–¼ &lt;code>tls&lt;/code> å’Œ &lt;code>cryto&lt;/code> æ¨¡çµ„ã€‚&lt;/li>
&lt;li>zlibï¼šç„¡ææ•¸æ“šå£“ç¸®åº«ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>Node.js èƒ½å¿«é€Ÿçš„åŸå› æ˜¯å› ç‚ºä»–å°è³‡æºçš„èª¿æ ¡ä¸åŒï¼Œç•¶ç¨‹å¼æ”¶åˆ°ä¸€ç­†é€£ç·šï¼Œ&lt;/p>
&lt;p>ç›¸è¼ƒæ–¼ PHP çš„æ¯æ¬¡é€£ç·šéƒ½æœƒæ–°ç”Ÿæˆä¸€å€‹åŸ·è¡Œç·’ï¼Œç•¶é€£ç·šæ•¸é‡æš´å¢æ™‚å¾ˆå¿«å°±æœƒæ¶ˆè€—æ‰ç³»çµ±çš„è³‡æºï¼Œä¸¦ä¸”å®¹æ˜“ç”¢ç”Ÿé˜»å¡ (block)ï¼Œ&lt;/p>
&lt;p>è€Œ Node.js å‰‡æ˜¯æœƒé€šçŸ¥ä½œæ¥­ç³»çµ±é€é epollã€kqueueã€/dev/pollã€select ç­‰å°‡é€£ç·šä¿ç•™ï¼Œä¸¦æ”¾å…¥ heap ä¸­é…ç½®ï¼Œå…ˆè®“é€£ç·šé€²å…¥ä¼‘çœ  (Sleep) ç‹€æ…‹ï¼Œç­‰ç³»çµ±é€šçŸ¥æ‰è§¸ç™¼é€£ç·šçš„ callbackã€‚&lt;/p>
&lt;p>é€™ç¨®è™•ç†æ–¹å¼åªæœƒä½”ç”¨è¨˜æ†¶é«”ï¼Œä¸¦ä¸æœƒä½¿ç”¨åˆ° CPU è³‡æºã€‚å¦å¤–å› ç‚º JavaScript èªè¨€çš„ç‰¹æ€§ï¼Œæ¯ä¸€å€‹ request éƒ½æœƒæœ‰ä¸€å€‹ callbackï¼Œå¯ä»¥é¿å…ç™¼ç”Ÿé˜»å¡çš„ç‹€æ³ç™¼ç”Ÿã€‚&lt;/p>
&lt;br>
&lt;p>ä»¥ä¸‹æœƒå…ˆå¾éé˜»å¡è¼¸å…¥è¼¸å‡ºã€éåŒæ­¥ï¼Œå†è«‡åˆ°äº‹ä»¶é©…å‹•ã€‚&lt;/p>
&lt;br>
&lt;h3>éé˜»å¡ (non-blocking)&lt;span class="hx-absolute -hx-mt-20" id="éé˜»å¡-non-blocking">&lt;/span>
&lt;a href="#%e9%9d%9e%e9%98%bb%e5%a1%9e-non-blocking" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è¼¸å…¥è¼¸å‡º(I/O) æ˜¯ç¨‹å¼è·Ÿç³»çµ±è¨˜æ†¶é«”æˆ–ç¶²è·¯çš„äº’å‹•ï¼Œä¾‹å¦‚ç™¼é€ HTTP è«‹æ±‚ã€å°è³‡æ–™åº«CRUD æ“ä½œç­‰ç­‰ã€‚&lt;/p>
&lt;p>ä»¥ç¶²ç«™é–‹ç™¼è€…è§’åº¦ä¾†çœ‹ï¼Œå¤§éƒ¨åˆ†çš„ç¶²ç«™ç¨‹å¼éƒ½ä¸éœ€è¦å¤ªå¤šçš„ CPU è¨ˆç®—ï¼Œåè€Œæ˜¯åœ¨ç­‰å¾…å¤§é‡çš„ I/O è™•ç†å®Œç•¢ (HTTP è«‹æ±‚ã€è³‡æ–™åº«çš„å–å¾—è³‡æ–™æˆ–æ˜¯æ›´æ–°è³‡æ–™ç­‰)ï¼Œæ‰€ä»¥è™•ç† I/O çš„é€Ÿåº¦æœƒæ˜¯ç¶²é ç¨‹å¼æ•ˆèƒ½çš„é—œéµã€‚&lt;/p>
&lt;br>
&lt;p>é‚£è¦æ€éº¼æ‰èƒ½è®“ç­‰å¾… I/O çš„æ™‚é–“ï¼Œä¸è¦å¡ä½å¾ŒçºŒçš„ç¨‹å¼ç¢¼å‘¢ï¼Ÿå¯ä»¥è®“ç¨‹å¼ä¸€é‚Šç­‰ I/O è™•ç†ï¼Œä¸€é‚Šç¹¼çºŒåŸ·è¡Œå…¶ä»–éƒ¨åˆ†çš„ç¨‹å¼ç¢¼ï¼Œä¸»è¦æœ‰å…©ç¨®æ–¹æ³•ï¼š&lt;/p>
&lt;ol>
&lt;li>å¤šåŸ·è¡Œç·’ (multi-threaded)ï¼šä½¿ç”¨é˜»å¡ (blocking) I/O çš„è¨­è¨ˆã€‚&lt;/li>
&lt;li>å–®åŸ·è¡Œç·’ (single-threaded)ï¼šä½¿ç”¨éé˜»å¡ (non-blocking) I/O çš„è¨­è¨ˆ + éåŒæ­¥ (asynchronous) è™•ç†ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>&lt;strong>é˜»å¡å°±æ˜¯ I/O çš„è™•ç†é˜»æ“‹äº†å…¶ä»–å¾ŒçºŒç¨‹å¼ç¢¼çš„åŸ·è¡Œ&lt;/strong>ã€‚èˆ‰å€‹ä¾‹å­ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">é˜»å¡ (blocking)&lt;/th>
&lt;th style="text-align: center">éé˜»å¡ (non-blocking)&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">é˜»å¡å¾ŒçºŒç¨‹å¼ç¢¼çš„åŸ·è¡Œï¼Œå°±å¥½åƒæ˜¯æˆ‘å€‘å»é™„è¿‘è²·çƒ¤è‚‰ï¼Œäº¤çµ¦è€é—†å¾Œï¼Œç‚ºäº†æƒ³åƒåˆ°ç†±é¨°é¨°çš„é£Ÿç‰©ï¼Œæ‰€ä»¥åªèƒ½ç•™åœ¨åŸåœ°ï¼Œä¸èƒ½å…ˆå»å…¶ä»–åœ°æ–¹&lt;/td>
&lt;td style="text-align: center">éé˜»å¡ä¸æœƒé˜»æ“‹å¾ŒçºŒç¨‹å¼ç¢¼çš„åŸ·è¡Œï¼Œå°±å¥½åƒæ˜¯æˆ‘å€‘å»ç™¾è²¨å…¬å¸ç¾é£Ÿè¡—é»é¤ï¼Œé»å®Œé¤å¾Œæœƒæ‹¿åˆ°ä¸€å€‹å‘¼å«å™¨ï¼Œå°±å¯ä»¥å…ˆé›¢é–‹ï¼Œç­‰åˆ°å‘¼å«å™¨éŸ¿äº†å†å›å»æ‹¿å³å¯&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;br>
&lt;p>åƒæ˜¯ &lt;strong>Pythonã€Ruby ç­‰èªè¨€æ˜¯ä½¿ç”¨å¤šåŸ·è¡Œç·’ (multi-threaded)ï¼Œä½¿ç”¨é˜»å¡ I/O&lt;/strong> ï¼š&lt;/p>
&lt;p>ç¨‹å¼æœƒç­‰ç¶²è·¯æˆ–æ˜¯è¨˜æ†¶é«”çš„ä½œæ¥­çµæŸå¾Œæ‰æœƒç¹¼çºŒå¾€ä¸‹ï¼Œç­‰å¾…æ™‚é–“é€™å€‹ä½œæ¥­ä¸­çš„åŸ·è¡Œç·’ä¸æœƒå»åšå…¶ä»–äº‹æƒ…ã€‚&lt;/p>
&lt;p>å¦‚æœæƒ³è¦é”åˆ°ã€ç­‰å¾… I/O æœŸé–“ä¸è¦å¡ä½å…¶ä»–ç¨‹å¼ç¢¼ã€ï¼Œçš„åšæ³•å°±æ˜¯æ–°é–‹ä¸€å€‹åŸ·è¡Œç·’ï¼Œç›´åˆ°ä»»å‹™å®Œæˆï¼Œå†å‘Šè¨´ä¸»åŸ·è¡Œç·’èªª( æˆ‘å®Œæˆå›‰ï¼) å³å¯ã€‚&lt;/p>
&lt;br>
&lt;p>&lt;strong>Node.js ä½¿ç”¨å–®åŸ·è¡Œç·’ (single-threaded) ï¼Œéé˜»å¡ I/O + éåŒæ­¥å‡½å¼&lt;/strong>ï¼š&lt;/p>
&lt;p>Node.js ä½¿ç”¨éé˜»å¡è¨­è¨ˆï¼Œé‚£è¦æ€éº¼å»æ“ä½œè³‡æ–™åº«æˆ–æ˜¯ HTTP è«‹æ±‚çš„è¼¸å…¥è¼¸å‡ºå‘¢ï¼Ÿå°±è¦é€ééåŒæ­¥ (asynchronous) ä¾†è™•ç†å›‰ï¼&lt;/p>
&lt;br>
&lt;h3>éåŒæ­¥ (asynchronous)&lt;span class="hx-absolute -hx-mt-20" id="éåŒæ­¥-asynchronous">&lt;/span>
&lt;a href="#%e9%9d%9e%e5%90%8c%e6%ad%a5-asynchronous" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>éåŒæ­¥ä¹Ÿå¯ä»¥ç¨±ç‚ºç•°æ­¥ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯è®“ç¨‹å¼ä¸è¦è¢«é˜»æ“‹ç­‰ I/O è™•ç†å®Œï¼Œæ‰å¯ä»¥è·‘ä¸‹ä¸€è¡Œç¨‹å¼ç¢¼ï¼Œæ˜¯ç›´åˆ°å‡½å¼ä¸­çš„ callback è¢«å‘¼å«çš„æ™‚å€™å†åŸ·è¡Œå¾ŒçºŒè¦åšçš„äº‹æƒ…ã€‚&lt;/p>
&lt;br>
&lt;p>åŒæ­¥ vs. éåŒæ­¥&lt;/p>
&lt;br>
&lt;ul>
&lt;li>éåŒæ­¥ (asynchronous)&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥æƒ³åƒä¸€ä¸‹ä½ å»å’–å•¡å»³è²·æ‹¿éµè·Ÿé»‘å’–å•¡ï¼Œå¯èƒ½æœƒç™¼ç”Ÿçš„æƒ…æ³æ˜¯ï¼š&lt;/p>
&lt;ol>
&lt;li>ä½ é»äº†æ‹¿éµè·Ÿé»‘å’–å•¡&lt;/li>
&lt;li>åº—å“¡åœ¨æ”¶éŠ€æ©Ÿä¸Šè¼¸å…¥é»é¤å…§å®¹&lt;/li>
&lt;li>åº—å“¡è«‹åŒäº‹ A æº–å‚™æ‹¿éµã€è«‹åŒäº‹ B æº–å‚™é»‘å’–å•¡ï¼Œä¸¦å‘ŠçŸ¥åšå®Œå¾Œï¼Œè¦æé†’åº—å“¡&lt;/li>
&lt;li>é»‘å’–å•¡è£½ä½œæœƒæ¯”è¼ƒå¿«ï¼ŒB åŒäº‹æœƒå…ˆå®Œæˆï¼Œè€Œå‰›å¥½åº—å“¡å‰›å¹«ä½ çµå¸³å®Œæ²’äº‹ï¼Œæ‰€ä»¥æŠŠé»‘å’–å•¡æ‹¿çµ¦ä½ &lt;/li>
&lt;li>æ‹¿éµè£½ä½œåŒ…å«è¼ƒå¤šæ­¥é©Ÿï¼ŒèŠ±è²»æ™‚é–“è¼ƒä¹…ï¼Œç­‰ A åŒäº‹å®Œæˆå¾Œï¼Œåº—å“¡å‰›å¥½æ²’äº‹ï¼Œæ‰€ä»¥æŠŠæ‹¿éµæ‹¿çµ¦ä½ &lt;/li>
&lt;/ol>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæ«ƒæª¯åº—å“¡ä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹æƒ…ï¼Œä½†ç‚ºäº†ç¯€çœæ™‚é–“ï¼Œåº—å“¡å°‡å·¥ä½œåˆ†é…çµ¦å…¶ä»–åŒäº‹ï¼Œåœ¨ä¸‹å®ŒæŒ‡ä»¤å¾Œï¼Œåº—å“¡æœƒç¹¼çºŒå¹«ä½ çµå¸³ï¼Œç­‰åŒäº‹å€‘å„è‡ªå®Œæˆå¾Œæœƒå‘ŠçŸ¥åº—å“¡ï¼Œåº—å“¡åœ¨ä¾åºæŠŠé£²æ–™äº¤çµ¦ä½  - æœ€çµ‚ç­‰å¾…æ™‚é–“æ¸›å°‘ï¼Œä¹Ÿä¸æœƒæµªè²»é–’ç½®çš„è³‡æºï¼Œé€™å°±æ˜¯ç¾å¯¦ç”Ÿæ´»ä¸­éåŒæ­¥çš„æƒ…æ³ã€‚&lt;/p>
&lt;br>
&lt;ul>
&lt;li>åŒæ­¥ (synchronous)&lt;/li>
&lt;/ul>
&lt;p>ä¸€æ¨£æˆ‘å€‘é»äº†æ‹¿éµè·Ÿé»‘å’–å•¡ï¼Œæ›æˆåŒæ­¥çš„è©±ï¼š&lt;/p>
&lt;ol>
&lt;li>åº—å“¡åœ¨æ”¶éŠ€æ©Ÿä¸Šè¼¸å…¥é»é¤å…§å®¹&lt;/li>
&lt;li>åº—å“¡è«‹åŒäº‹ A é–‹å§‹æº–å‚™æ‹¿éµ&lt;/li>
&lt;li>A åŒäº‹æº–å‚™å®Œæ‹¿éµï¼Œåº—å“¡è½‰äº¤çµ¦ä½ &lt;/li>
&lt;li>åº—å“¡è«‹åŒäº‹ B é–‹å§‹æº–å‚™é»‘å’–å•¡&lt;/li>
&lt;li>B åŒäº‹æº–å‚™å®Œé»‘å’–å•¡ï¼Œåº—å“¡äº¤çµ¦ä½ &lt;/li>
&lt;li>åº—å“¡å¹«ä½ åˆ·è¼‰å…·ã€æ‰“çµ±ç·¨ã€æ‰¾éŒ¢ç­‰ç­‰&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>åŒæ¨£çš„é¤é»å…§å®¹ï¼Œå¦‚æœæ˜¯åŒæ­¥è™•ç†ï¼Œä»£è¡¨è¦ç­‰æ¯ä¸€ä»¶äº‹æƒ…åšå®Œï¼Œæ‰å¯ä»¥åšä¸‹ä¸€æ­¥ã€‚ä¹Ÿå°±æ˜¯èªªåŒäº‹ A å®Œæˆæ‹¿éµå¾Œï¼Œåº—å“¡æ‰è«‹ B åŒäº‹æº–å‚™é»‘å’–å•¡ã€‚ç›¸å°æ–¼éåŒæ­¥ä¾†èªªï¼ŒæœƒèŠ±è²»ä¸å°‘æ™‚é–“ä»¥åŠæµªè²»ä¸å°‘é–’ç½®è³‡æºã€‚&lt;/p>
&lt;br>
&lt;p>å¾å’–å•¡åº—çš„ä¾‹å­ä¸­å¯ä»¥ç™¼ç¾ï¼š&lt;/p>
&lt;ol>
&lt;li>æ«ƒæª¯åº—å“¡æ‰‹ä¸Šä¸€æ¬¡èƒ½åšçš„äº‹æƒ…åªæœ‰ä¸€ä»¶ (Single thread å–®åŸ·è¡Œç·’)ï¼Œåªæ˜¯åœ¨éåŒæ­¥çš„ä¾‹å­ä¸­ï¼Œå°‡è£½ä½œå’–å•¡çš„äº‹æƒ…å§”æ´¾çµ¦å…¶ä»–åŒäº‹è™•ç†ï¼Œè®“è‡ªå·±å¯ä»¥ç¹¼çºŒå¹«ä½ çµå¸³ï¼Œä¾†æé«˜æ•ˆç‡ â€” JavaScript æ˜¯ Single threadï¼Œä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹æƒ…ã€‚&lt;/li>
&lt;li>åœ¨éåŒæ­¥çš„ä¾‹å­ä¸­ï¼Œæ«ƒæª¯åº—å“¡å°‡è£½ä½œå’–å•¡çš„äº‹æƒ…å§”æ´¾å‡ºå»ï¼Œå…¶å¯¦åº—å“¡ä¹Ÿä¸çŸ¥é“å“ªä¸€å€‹ä»»å‹™æœƒå…ˆè¢«å®Œæˆï¼Œä½†åº—å“¡é‚„æ˜¯å¯ä»¥ç¹¼çºŒå®Œæˆçµå¸³çš„ä»»å‹™ï¼Œä¸æœƒå› ç‚ºåŒäº‹ Aã€B é‚„åœ¨è£½ä½œå’–å•¡ï¼Œå°±ä¸èƒ½æ¥ä¸‹å»å‹•ä½œ (non-blocking) â€” JavaScript ä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹ï¼Œä½†è—‰ç”± Node æä¾›çš„ API å”åŠ©ï¼Œåœ¨èƒŒå¾Œè™•ç†é€™äº›äº‹ä»¶ (åŒäº‹åœ¨èƒŒå¾Œè£½ä½œå’–å•¡)ï¼Œå¯ä»¥ç­‰å¾…è£½ä½œåŒæ™‚ï¼Œä¸æœƒè¢«é˜»å¡ (blocking) åˆ°ä¸‹ä¸€ä»¶äº‹æƒ…çš„åŸ·è¡Œã€‚&lt;/li>
&lt;li>éåŒæ­¥çš„ä¾‹å­ä¸­ï¼Œåº—å“¡å§”æ´¾äº‹æƒ…çš„æµç¨‹å¾ˆç°¡å–®ï¼šå°±æ˜¯è«‹åŒäº‹å®Œæˆè£½ä½œå’–å•¡ (event) + åœ¨æ”¶åˆ°åŒäº‹é€šçŸ¥å®Œæˆå¾Œæ¥æ‰‹å’–å•¡ï¼Œä¸¦è½‰äº¤çµ¦ä½  (callback function) â€” è‹¥æ˜¯æ¡ç”¨éåŒæ­¥è™•ç†ï¼Œæœƒæœ‰ callback function ä¾†æŒ‡å®šäº‹ä»¶å®Œæˆå¾Œè¦æ¥çºŒåšä»€éº¼ï¼šå®ƒä¸æœƒç«‹å³è¢«åŸ·è¡Œï¼Œè€Œæ˜¯ç­‰å¾…å§”è¨—çš„äº‹æƒ…è¢«å®Œæˆå¾Œæ‰è§¸ç™¼ã€‚&lt;/li>
&lt;li>ç•¶åŒäº‹ Aã€B åˆ†åˆ¥é€šçŸ¥å®Œæˆå¾Œï¼Œå°±æœƒä¾åºæŠŠå’–å•¡æ”¾åœ¨åº—å“¡çš„æ—é‚Šæ’æˆä¸€æ’ (event queue)ã€‚æƒ³å‘åº—å“¡æœ‰ä¸€å€‹å°åŠ©æ‰‹ (event loop) ï¼Œä»–çš„å·¥ä½œå…§å®¹æ˜¯ç¢ºèªåº—å“¡çµå¸³å®Œäº†æ²’æœ‰ï¼šå¦‚æœçµå¸³å®Œäº†ï¼Œå°±æœƒæŠŠéšŠä¼ä¸­ç¬¬ä¸€æ¯å’–å•¡å«çµ¦åº—å“¡ï¼Œè®“åº—å“¡äº¤çµ¦ä½  (è§¸ç™¼ callback function) ; å¦‚æœåº—å“¡é‚„åœ¨çµå¸³ï¼Œå°±æœƒè®“éšŠä¼ä¸­çš„å’–å•¡æ“ºåœ¨æ—é‚Šç¹¼çºŒç­‰å¾…ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>JaveScript å¯¦ç¾éåŒæ­¥çš„æ–¹æ³•ä¸æ–·æ¼”é€²è‘—ï¼šå¾ callbackã€promise åˆ°æœ€æ–°çš„ async-await å‡½å¼ã€‚&lt;/p>
&lt;br>
&lt;h4>Callback&lt;span class="hx-absolute -hx-mt-20" id="callback">&lt;/span>
&lt;a href="#callback" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;h5>ä»€éº¼æ˜¯ Callback&lt;span class="hx-absolute -hx-mt-20" id="ä»€éº¼æ˜¯-callback">&lt;/span>
&lt;a href="#%e4%bb%80%e9%ba%bc%e6%98%af-callback" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>å‡è¨­æœ‰ Aã€Bã€C ä¸‰ä»¶å·¥ä½œï¼Œå…¶ä¸­ B å¿…é ˆç­‰å¾… C åšå®Œæ‰èƒ½åŸ·è¡Œã€‚å¤§éƒ¨ä»½çš„äººå¹¾ä¹éƒ½æ˜¯åš Aï¼Œå†åš Cï¼Œç­‰å¾… C åšå®Œä»¥å¾Œæœ€å¾Œåš Bã€‚ä½†å°æ–¼å¯å¤šå·¥çš„äººä¾†èªªï¼Œå»å¯èƒ½æ˜¯åŒæ™‚åš A èˆ‡ Cï¼ˆå¤šå·¥ï¼‰ï¼Œç­‰å¾… C å®Œæˆå¾Œåš Bã€‚&lt;/p>
&lt;p>Callback function æ˜¯ä¸€å€‹è¢«ä½œç‚ºåƒæ•¸å¸¶å…¥å¦ä¸€å€‹å‡½å¼ä¸­çš„ã€Œå‡½å¼ã€ï¼Œé€™å€‹è¢«ä½œç‚ºåƒæ•¸å¸¶å…¥çš„å‡½å¼å°‡åœ¨ã€Œæœªä¾†æŸå€‹æ™‚é–“é»ã€è¢«å‘¼å«å’ŒåŸ·è¡Œ â€” é€™æ˜¯è™•ç†éåŒæ­¥äº‹ä»¶çš„ä¸€ç¨®æ–¹å¼ã€‚&lt;/p>
&lt;p>å†æ¬¡èˆ‰ Aã€Bã€C ä¸‰ä»¶å·¥ä½œçš„ä¾‹å­ï¼Œå…¶ä¸­ B å¿…é ˆç­‰å¾… C åšå®Œæ‰èƒ½åŸ·è¡Œï¼Œæ–¼æ˜¯æˆ‘å€‘å°‡ B æ”¾åˆ° C çš„ callback ä¸­ï¼Œè®“å®¿ä¸»ç’°å¢ƒåœ¨æ”¶åˆ° C å®Œæˆçš„å›æ‡‰æ™‚å¾Œ B æ”¾åˆ°ä½‡åˆ—ä¸­æº–å‚™åŸ·è¡Œã€‚&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">doA&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">doC&lt;/span>(&lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">doB&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å¸¸è¦‹çš„ä¾‹å­ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ç€è¦½å™¨æ‰€æä¾›çš„ &lt;code>setTimeout()&lt;/code>æˆ–æ˜¯ &lt;code>setInterval()&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;é€™å€‹è¨Šæ¯å°‡åœ¨ä¸‰ç§’å¾Œè¢«å°å‡ºä¾†&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}, &lt;span style="color:#ae81ff">3000&lt;/span>)&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æä¾›ä¸€å€‹åŒ¿åå‡½å¼ä½œç‚ºåƒæ•¸å¸¶å…¥ setTimeout() å‡½å¼ä¸­ï¼Œç›®çš„å°±æ˜¯è«‹ setTimeout() åœ¨æœªä¾†æŸå€‹æ™‚é–“é»ï¼ˆä¸‰ç§’å¾Œï¼‰å‘¼å«å’ŒåŸ·è¡Œé€™å€‹åŒ¿åå‡½å¼ã€‚&lt;/p>
&lt;br>
&lt;ul>
&lt;li>DOM çš„äº‹ä»¶ç›£è½&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">btn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> document.&lt;span style="color:#a6e22e">querySelector&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;button&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">btn&lt;/span>.&lt;span style="color:#a6e22e">addEventListener&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;click&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">callbackFunctionName&lt;/span>)&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>callbackFunctionName åšç‚ºåƒæ•¸è¢«å¸¶å…¥ addEventListener() ä¸­ï¼ŒcallbackFunctionName ä¸æœƒç«‹å³è¢«åŸ·è¡Œï¼Œè€Œæ˜¯æœªä¾†æŒ‰éˆ•è¢«é»æ“Šæ™‚æ‰æœƒåŸ·è¡Œã€‚&lt;/p>
&lt;br>
&lt;p>Callback ä¸»è¦æœ‰ä¸€å€‹ç¼ºé»ï¼š&lt;code>å›å‘¼åœ°ç„&lt;/code>&lt;/p>
&lt;br>
&lt;h5>å›å‘¼åœ°ç„ (Callback Hell)&lt;span class="hx-absolute -hx-mt-20" id="å›å‘¼åœ°ç„-callback-hell">&lt;/span>
&lt;a href="#%e5%9b%9e%e5%91%bc%e5%9c%b0%e7%8d%84-callback-hell" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>å›å‘¼åœ°ç„ (Callback Hell) åˆç¨±ç‚ºã€Œæ¯€æ»…é‡‘å­—å¡”ã€ï¼ŒæŒ‡çš„æ˜¯å±¤æ¬¡å¤ªæ·±çš„å·¢ç‹€ Callbackï¼Œè®“ç¨‹å¼è®Šçš„æ›´è¤‡é›œä¸”é›£ä»¥é æ¸¬æˆ–æ˜¯è¿½è¹¤ã€‚&lt;/p>
&lt;p>å‘é ç«¯ä¼ºæœå™¨ç™¼å‡ºè«‹æ±‚ä¸¦ç²å¾—è³‡è¨Šå¾Œï¼ŒåŸ·è¡Œ Callbackï¼Œå†ç™¼å‡ºè«‹æ±‚ï¼Œç²å¾—è³‡è¨Šå¾ŒåŸ·è¡Œ Callbackï¼Œå†ç™¼å‡ºè«‹æ±‚ï¼Œç²å¾—è³‡è¨Šå¾ŒåŸ·è¡Œ Callbackï¼Œå°±æœƒä¸å°å¿ƒä¸€å±¤åŒ…ä¸€å±¤ï¼Œè®Šæˆæ‰€è¬‚çš„ Callback Hellã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">doA&lt;/span>(&lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">doB&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">doC&lt;/span>(&lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">doD&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">doE&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">doF&lt;/span>();&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç¼ºé»ï¼š&lt;/p>
&lt;ol>
&lt;li>å¯è®€æ€§ä½ï¼šå¦‚æœç¨‹å¼ç¢¼å‡ºéŒ¯ï¼Œè¦å›é ­æ…¢æ…¢æ‰¾éŒ¯èª¤çš„åœ°æ–¹&lt;/li>
&lt;li>å¯ç¶­è­·æ€§ä½ï¼šå¦‚æœè¦ä¿®æ”¹å…¶ä¸­ä¸€çµ„å‡½å¼ï¼Œç‰½ä¸€é«®è€Œå‹•å…¨èº«&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>é‚£åœ¨åŒæ­¥åŸ·è¡Œæƒ…æ³ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>try...catch&lt;/code> ä¾†æ•æ‰éŒ¯èª¤è¨Šæ¯ï¼Œä½†å¦‚æœæ˜¯åœ¨éåŒæ­¥æƒ…æ³ä¸‹ï¼Œè¦æ€éº¼è™•ç†éŒ¯èª¤æˆ–æ˜¯ä¾‹å¤–è¨Šæ¯å‘¢ï¼ï¼Ÿ ä¸»è¦æœ‰å…©ç¨®æ–¹å¼ï¼š&lt;/p>
&lt;br>
&lt;h5>åˆ†åˆ¥å›å‘¼ (Split Callback)&lt;span class="hx-absolute -hx-mt-20" id="åˆ†åˆ¥å›å‘¼-split-callback">&lt;/span>
&lt;a href="#%e5%88%86%e5%88%a5%e5%9b%9e%e5%91%bc-split-callback" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>åˆ†åˆ¥çš„å›å‘¼è¦è¨­å®šå…©å€‹ Callbackï¼Œä¸€å€‹ç”¨æ–¼æˆåŠŸé€šçŸ¥ï¼Œå¦ä¸€å€‹å‰‡ç”¨æ–¼éŒ¯èª¤é€šçŸ¥ã€‚å¦‚ä¸‹ï¼Œç¬¬ä¸€å€‹åƒæ•¸æ˜¯ç”¨æ–¼æˆåŠŸçš„ Callbackï¼Œç¬¬äºŒå€‹åƒæ•¸æ˜¯ç”¨æ–¼å¤±æ•—çš„ Callbackï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">success&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">failure&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">error&lt;/span>(&lt;span style="color:#a6e22e">error&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">ajax&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;http://sample.url&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">success&lt;/span>, &lt;span style="color:#a6e22e">failure&lt;/span>);&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é‚£å¦‚æœåœ¨ Callback ä¸­ç™¼ç”ŸéŒ¯èª¤ï¼Œè¦æ€éº¼è¾¦å‘¢!?&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">success&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">x&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">failure&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">error&lt;/span>(&lt;span style="color:#a6e22e">error&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">ajax&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;http://sample.url&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">success&lt;/span>, &lt;span style="color:#a6e22e">failure&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Uncaught (in promise) ReferenceError: x is not defined
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æœƒç›´æ¥å ±éŒ¯ï¼Œä¸¦ä¸æœƒé€²å…¥åˆ° failure é€™å€‹ Callback è£¡é¢ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œå¦‚æœæ˜¯åœ¨ Callback å…§ç™¼ç”ŸéŒ¯èª¤ï¼Œæ˜¯ä¸æœƒè¢«æ•æ‰åˆ°çš„ã€‚&lt;/p>
&lt;br>
&lt;h5>éŒ¯èª¤å„ªå…ˆè™•ç† (Error-First Style)&lt;span class="hx-absolute -hx-mt-20" id="éŒ¯èª¤å„ªå…ˆè™•ç†-error-first-style">&lt;/span>
&lt;a href="#%e9%8c%af%e8%aa%a4%e5%84%aa%e5%85%88%e8%99%95%e7%90%86-error-first-style" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>Node.js çš„ API å¸¸è¦‹é€™æ¨£çš„è¨­è¨ˆæ–¹å¼ï¼Œç¬¬ä¸€å€‹åƒæ•¸æ˜¯ error ï¼Œç¬¬äºŒå€‹åƒæ•¸æ˜¯å›æ‡‰çš„è³‡æ–™ (data)ã€‚æª¢æŸ¥ error æ˜¯å¦æœ‰å€¼æˆ–æ˜¯ trueï¼Œå¦å‰‡å°±æ¥çºŒè™•ç† dataã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">response&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>, &lt;span style="color:#a6e22e">data&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">error&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">ajax&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;http://sample.url&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">response&lt;/span>);&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ¥ä¸‹ä¾†æˆ‘å€‘ä¾†çœ‹ Promiseï¼Œå¯ä»¥è§£æ±º callback å¯è®€æ€§ä½çš„ Callback Hell å•é¡Œã€‚&lt;/p>
&lt;br>
&lt;h4>Promise&lt;span class="hx-absolute -hx-mt-20" id="promise">&lt;/span>
&lt;a href="#promise" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Promiseï¼šCallback ä»¥å¤–çš„å¦ä¸€ç¨®æ–¹å¼ä¾†è™•ç†éåŒæ­¥äº‹ä»¶ï¼Œä¸”å¯è®€æ€§èˆ‡å¯ç¶­è­·æ€§æ¯” Callback å¥½å¾ˆå¤šã€‚
Promise æ˜¯ä¸€å€‹ç‰©ä»¶ï¼Œä»£è¡¨è‘—ä¸€å€‹å°šæœªå®Œæˆï¼Œä½†æœ€çµ‚æœƒå®Œæˆçš„ä¸€å€‹å‹•ä½œ - åœ¨ä¸€å€‹éåŒæ­¥è™•ç†æµç¨‹ä¸­ï¼Œå®ƒåªæ˜¯ä¸€å€‹æš«å­˜çš„å€¼ã€‚&lt;/p>
&lt;p>æˆ‘å€‘ä¸€æ¨£ä¾†èªªå‰›å‰›å’–å•¡åº—çš„ä¾‹å­ï¼š
ç•¶æˆ‘å€‘é»å®Œæ‹¿éµè·Ÿé»‘å’–å•¡å¾Œï¼Œåº—å“¡æœƒçµ¦ä½ ä¸€å¼µå°æœ‰è™Ÿç¢¼çš„æ”¶æ“šï¼Œç„¶å¾Œå‘Šè¨´ä½ ç­‰ç­‰è½åˆ°è™Ÿç¢¼ï¼Œå°±å¯ä»¥ä¾†é ˜å’–å•¡äº†ï¼Œè€Œé€™å¼µæ”¶æ“šå°±æ˜¯ Promiseï¼Œä»£è¡¨é€™å€‹ä»»å‹™å®Œæˆå¾Œï¼Œå°±å¯ä»¥æ¥è‘—åŸ·è¡Œæ¥ä¸‹ä¾†çš„å‹•ä½œäº†ã€‚&lt;/p>
&lt;p>åœ¨ç­‰å¾…éç¨‹ä¸­ï¼Œå…¶å¯¦ç„¡æ³•ç™¾åˆ†ç™¾ç¢ºå®šæœ€å¾Œä¸€å®šæœƒæ‹¿åˆ°å’–å•¡ (Promise) ; åº—å“¡å¯èƒ½é †åˆ©åšå®Œå’–å•¡äº¤åˆ°ä½ æ‰‹ä¸Š (Resolved) ; å¯èƒ½ç‰›å¥¶æˆ–æ˜¯å’–å•¡è±†æ²’äº†ï¼Œæ‰€ä»¥åº—å“¡å‘Šè¨´ä½ ä»Šå¤©åšä¸å‡ºä¾†å’–å•¡ (Rejected)ã€‚&lt;/p>
&lt;p>Promise å°±åƒä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæœƒè™•åœ¨ä¸‰å€‹ä»»æ„éšæ®µä¸­ï¼š&lt;/p>
&lt;ul>
&lt;li>Pedningï¼šç­‰å¾…äº‹æƒ…å®Œæˆä¸­ï¼Œä½†ä¸ç¢ºå®šæœ€çµ‚æœƒé †åˆ©å®Œæˆæˆ–å¤±æ•—&lt;/li>
&lt;li>Resolvedï¼ˆæˆ–ç¨± Fulfilledï¼‰ï¼šä»£è¡¨é †åˆ©å®Œæˆäº†ï¼Œä¸¦è½‰äº¤çµæœ&lt;/li>
&lt;li>Rejectesdï¼šä»£è¡¨å¤±æ•—äº†ï¼Œä¸¦å‘ŠçŸ¥å¤±æ•—åŸå› &lt;/li>
&lt;/ul>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">getData&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è£½ä½œå’–å•¡.....
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½œæ¥­å®Œæˆï¼Œä¸¦å›å‚³éŒ¯èª¤è¨Šæ¯æ™‚
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">reject&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;ç‰›å¥¶æˆ–æ˜¯å’–å•¡è±†æ²’äº†&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½œæ¥­æˆåŠŸå®Œæˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">resolve&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">data&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#39;å’–å•¡äº¤åˆ°ä½ æ‰‹ä¸Š&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>resolve å‡½å¼ï¼šç•¶éåŒæ­¥ä½œæ¥­æˆåŠŸå®Œæˆæ™‚ï¼Œå°‡çµæœåšç‚ºåƒæ•¸å¸¶å…¥åŸ·è¡Œã€‚&lt;/li>
&lt;li>reject å‡½å¼ï¼šç•¶éåŒæ­¥ä½œæ¥­å¤±æ•—æ™‚ï¼Œå°‡éŒ¯èª¤è¨Šæ¯ä½œç‚ºåƒæ•¸å¸¶å…¥åŸ·è¡Œã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>å‰µå»ºå‡ºä¾†çš„ Promise ç‰©ä»¶åœ¨å¯¦ä¾‹ä¸Šæœ‰å…©å€‹é‡è¦çš„æ–¹æ³•ï¼š&lt;/p>
&lt;h5>.then() æ–¹æ³•&lt;span class="hx-absolute -hx-mt-20" id="then-æ–¹æ³•">&lt;/span>
&lt;a href="#then-%e6%96%b9%e6%b3%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>ç•¶æˆåŠŸå¾ &lt;code>resolve()&lt;/code> ç²å¾—çµæœæ™‚ - ç‹€æ…‹æœƒç”± Pending è½‰ç‚º Resolved - &lt;code>then()&lt;/code> æ–¹æ³•å°±æœƒè¢«èª¿ç”¨ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">getData&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½¿ç”¨ then æ–¹æ³•ï¼Œä¸¦å°‡æˆåŠŸè¨Šæ¯å°å‡ºä¾†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> .&lt;span style="color:#a6e22e">then&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span> =&amp;gt; {&lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;æˆåŠŸè³‡æ–™&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">data&lt;/span>)})&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä»¥å‰›å‰›å’–å•¡åº—çš„ä¾‹å­ä¾†çœ‹ï¼Œ &lt;code>then()&lt;/code> æ–¹æ³•å°±åƒä½ æœƒå»è½å’–å•¡äººå“¡æ˜¯å¦å«è™Ÿï¼Œä¸¦ç¢ºèªå’–å•¡æ˜¯å¦æˆåŠŸæº–å‚™å¥½äº†ï¼Œå°±é ˜å–å’–å•¡ä¾†å–ã€‚&lt;/p>
&lt;br>
&lt;h5>.catch() æ–¹æ³•&lt;span class="hx-absolute -hx-mt-20" id="catch-æ–¹æ³•">&lt;/span>
&lt;a href="#catch-%e6%96%b9%e6%b3%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>ç•¶å¾ &lt;code>reject()&lt;/code> ç²å¾—éŒ¯èª¤è¨Šæ¯æ™‚ - ç‹€æ…‹ç”± Pending è½‰ç‚º Rejected - &lt;code>catch()&lt;/code> æ–¹æ³•å°±æœƒè¢«èª¿ç”¨ä¾†è™•ç†éŒ¯èª¤ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">getData&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½¿ç”¨ then æ–¹æ³•ï¼Œä¸¦å°‡æˆåŠŸè¨Šæ¯å°å‡ºä¾†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> .&lt;span style="color:#a6e22e">then&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span> =&amp;gt; {&lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;æˆåŠŸè³‡æ–™&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">data&lt;/span>)})
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½¿ç”¨ catch æ–¹æ³•ï¼Œä¸¦å°‡éŒ¯èª¤è¨Šæ¯å°å‡ºä¾†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> .&lt;span style="color:#66d9ef">catch&lt;/span>(&lt;span style="color:#a6e22e">error&lt;/span> =&amp;gt; &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;éŒ¯èª¤è¨Šæ¯&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">error&lt;/span>))&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸€æ¨£ä»¥å‰›å‰›å’–å•¡åº—çš„ä¾‹å­ä¾†çœ‹ï¼Œ &lt;code>catch()&lt;/code> æ–¹æ³•å°±åƒä½ æœƒå»è½å’–å•¡åº—åº—å“¡æ˜¯å¦æœ‰å‘ŠçŸ¥å’–å•¡åšä¸å‡ºä¾†çš„è¨Šæ¯ï¼Œå¦‚æœæœ‰ï¼Œä½ å°±æœƒå»æ«ƒæª¯é€€éŒ¢æˆ–æ˜¯æ”¹å…¶ä»–ç”¢å“ä»£æ›¿ã€‚&lt;/p>
&lt;br>
&lt;h5>ä¸²æ¥ then() æ–¹æ³•&lt;span class="hx-absolute -hx-mt-20" id="ä¸²æ¥-then-æ–¹æ³•">&lt;/span>
&lt;a href="#%e4%b8%b2%e6%8e%a5-then-%e6%96%b9%e6%b3%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>é‚„è¨˜å¾—ä¸Šé¢æˆ‘å€‘ç¤ºç¯„çš„ callback hell ï¼Œå› ç‚ºæˆ‘å€‘ä¾åºè¦å‘ä¸åŒçš„ä¼ºæœå™¨æˆ–è³‡æ–™åº«å–å¾—è³‡æ–™ï¼Œä¹Ÿè¦ä¾åºè™•ç†å¤šå€‹éåŒæ­¥çš„ä½œæ¥­ï¼Œæ‰€ä»¥æœƒæœ‰ä¸€å±¤ä¸€å±¤çš„ callback å»é”æˆã€‚&lt;/p>
&lt;p>å¾ä¸Šé¢ &lt;code>then()&lt;/code> å’Œ &lt;code>catch()&lt;/code> æ–¹æ³•ä¾‹å­ä¸­å¯ä»¥ç™¼ç¾ï¼ŒéåŒæ­¥ä½œæ¥­åŸ·è¡Œå®Œæˆå¾Œçš„è™•ç†æ­¥é©Ÿè¢«ç¨ç«‹é–‹ä¾†ï¼Œé€™æ¨£ç¨‹å¼ç¢¼çš„å¯è®€æ€§å°±æœƒé«˜å¾ˆå¤š - åœ¨ä¾åºè™•ç†å¤šå€‹éåŒæ­¥ä½œæ¥­æ™‚æœƒæ›´ç‚ºæ˜é¡¯ï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°ä¸‹é¢æˆ‘å€‘ç”¨ &lt;code>then()&lt;/code> æ–¹æ³•åšä¸²æ¥ï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">getData&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½¿ç”¨ then æ–¹æ³•ï¼Œä¸¦å°‡æˆåŠŸè¨Šæ¯å°å‡ºä¾†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> .&lt;span style="color:#a6e22e">then&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span> =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>.&lt;span style="color:#a6e22e">data1&lt;/span>) &lt;span style="color:#75715e">// abc
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">data&lt;/span>.&lt;span style="color:#a6e22e">data1&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;def&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç²å¾—å‰ä¸€å€‹ then() å›å‚³çš„çµæœ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> .&lt;span style="color:#a6e22e">then&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span> =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>) &lt;span style="color:#75715e">// abcdef
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">data&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ghi&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç²å¾—å‰ä¸€å€‹ then() å›å‚³çš„çµæœ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> .&lt;span style="color:#a6e22e">then&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span> =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>) &lt;span style="color:#75715e">// abcdefghi
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½¿ç”¨ catch æ–¹æ³•ï¼Œä¸¦å°‡éŒ¯èª¤è¨Šæ¯å°å‡ºä¾†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> .&lt;span style="color:#66d9ef">catch&lt;/span>(&lt;span style="color:#a6e22e">error&lt;/span> =&amp;gt; &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;éŒ¯èª¤è¨Šæ¯&amp;#39;&lt;/span>, &lt;span style="color:#a6e22e">error&lt;/span>))&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h5>Promise.all([&amp;hellip;.]) æ–¹æ³•&lt;span class="hx-absolute -hx-mt-20" id="promiseall-æ–¹æ³•">&lt;/span>
&lt;a href="#promiseall-%e6%96%b9%e6%b3%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>ç•¶åœ¨è™•ç†ã€Œå¤šå€‹éåŒæ­¥äº‹ä»¶ã€æ™‚ï¼ŒPromise.all() æ–¹æ³•æœƒç­‰æ‰€æœ‰ Promise éƒ½è¢«é †åˆ©å®Œæˆ (Resolved) å¾Œï¼Œæ‰æœƒåŸ·è¡Œæ¥ä¸‹å»çš„å‹•ä½œ ; ä¸€æ—¦æ”¶åˆ°æŸä¸€å€‹ Promise å›å‚³éŒ¯èª¤ (Rejected)ï¼Œå°±æœƒç«‹å³åŸ·è¡Œå¾ŒçºŒçš„éŒ¯èª¤è™•ç†æµç¨‹ã€‚&lt;/p>
&lt;p>æˆ‘å€‘ä»¥å‰›å‰›å’–å•¡åº—çš„ä¾‹å­ä¾†èªªï¼Œæˆ‘å€‘é»å®Œå’–å•¡å¾Œï¼Œåˆå› ç‚ºå˜´é¥ï¼Œå¤šè²·äº†ä¸€å€‹éºµåŒ…ä¾†åƒï¼Œé€™æ™‚æˆ‘å€‘æ‰‹ä¸Šå°±æœ‰å…©å€‹é ˜é¤è™Ÿç¢¼ï¼Œé‚£ &lt;code>Promise.all([...])&lt;/code> å°±æ˜¯ç•¶ä½ ç­‰åˆ°å…©å€‹è™Ÿç¢¼éƒ½è¢«å«åˆ°å¾Œï¼Œæ‰æœƒå»é ˜é¤ã€‚&lt;/p>
&lt;br>
&lt;p>é‚£ &lt;code>Promise.all([....])&lt;/code> çš„å¥½è™•ä»€éº¼å‘¢!? å®ƒå¯ä»¥ç¸®çŸ­ç­‰å¾…æ™‚é–“ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">oneSecond&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä¸€ç§’å¾Œå›å‚³è³‡æ–™
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">resolve&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;one second&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">1000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">twoSecond&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å…©ç§’å¾Œå›å‚³è³‡æ–™
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">resolve&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;two second&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">2000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">threeSecond&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä¸‰ç§’å¾Œå›å‚³è³‡æ–™
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">resolve&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;three second&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">3000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç­‰åˆ°ä¸‰å€‹ Promise éƒ½æˆåŠŸå›å‚³å¾Œï¼Œæ‰åŸ·è¡Œæ¥ä¸‹å»çš„æµç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>Promise.&lt;span style="color:#a6e22e">all&lt;/span>([&lt;span style="color:#a6e22e">oneSecond&lt;/span>, &lt;span style="color:#a6e22e">twoSecond&lt;/span>, &lt;span style="color:#a6e22e">threeSecond&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#a6e22e">then&lt;/span>(([&lt;span style="color:#a6e22e">oneSecond&lt;/span>, &lt;span style="color:#a6e22e">twoSecond&lt;/span>, &lt;span style="color:#a6e22e">threeSecond&lt;/span>]) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">oneSecond&lt;/span>, &lt;span style="color:#a6e22e">twoSecond&lt;/span>, &lt;span style="color:#a6e22e">threeSecond&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æˆ‘å€‘æ¨¡æ“¬ä¸€ä¸‹æˆ‘å€‘è¦åˆ†åˆ¥å‘ä¸‰å€‹è³‡æ–™åº«è«‹æ±‚è³‡æ–™ (æˆ‘å€‘ä»¥ &lt;code>setTimeout()&lt;/code> ç¤ºæ„éåŒæ­¥è™•ç†äº‹ä»¶)ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘å€‘è¦å…ˆç­‰ç¬¬ä¸€å€‹è³‡æ–™åº«æˆåŠŸå›å‚³è³‡æ–™å¾Œï¼Œæ‰å±•é–‹ç¬¬äºŒæ¬¡è«‹æ±‚ï¼Œç­‰åˆ°æˆåŠŸæ”¶åˆ°å›å‚³å¾Œæ‰é–‹å§‹ç¬¬ä¸‰æ¬¡è«‹æ±‚ã€‚è€Œä½¿ç”¨ &lt;code>Promise.all()&lt;/code> æ–¹æ³•ï¼Œæˆ‘å€‘èƒ½å…ˆä¾åºå‘è³‡æ–™åº«ç™¼å‡ºè«‹æ±‚ï¼Œä¸¦åœ¨æˆåŠŸç²å¾—å…¨éƒ¨å›å‚³è³‡æ–™å¾Œï¼Œæ‰æœƒåšå¾ŒçºŒçš„å‹•ä½œã€‚&lt;/p>
&lt;br>
&lt;h4>Async/Await&lt;span class="hx-absolute -hx-mt-20" id="asyncawait">&lt;/span>
&lt;a href="#asyncawait" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>é‚£æˆ‘å€‘å‰›å‰›é€é Promise åŒ…è£å’Œä½¿ç”¨ï¼Œçš„ç¢ºé¿å…äº† callback hell è®“æ•´å€‹æµç¨‹è®Šå¾—å¾ˆæ¸…æ¥šï¼Œæå‡äº†ç¨‹å¼ç¢¼çš„æ˜“è®€æ€§èˆ‡å¯ç¶­è­·æ€§ã€‚&lt;/p>
&lt;p>Async/Await æ˜¯æ‰€è¬‚çš„èªæ³•ç³–è¡£ï¼Œæ˜¯ä¸€ç¨®æ–°çš„èªæ³•æ’°å¯«æ–¹å¼ï¼Œä¾†è™•ç†ã€ŒéåŒæ­¥äº‹ä»¶ã€ï¼Œè®“éåŒæ­¥çš„ç¨‹å¼ç¢¼è®€èµ·ä¾†æ›´åƒåœ¨å¯«ã€ŒåŒæ­¥ç¨‹å¼ç¢¼ã€ã€‚&lt;/p>
&lt;p>Async/Await æ˜¯ç”¨ä¾†ç°¡å–®åŒ–å’Œæ¸…æ¥šåŒ– Promise ä¸²é€£ then é€™ç¨®ç›¸å°è¤‡é›œçš„çµæ§‹ï¼Œä»–å›å‚³çš„ä¸€æ¨£ä¹Ÿæ˜¯ Promise ç‰©ä»¶ï¼Œåªæ˜¯é‡å° promise-based å¯«æ³•é€²è¡ŒåŒ…è£ã€‚&lt;/p>
&lt;br>
&lt;p>Async é—œéµå­—&lt;/p>
&lt;p>&lt;code>async&lt;/code> é—œéµå­—å¯ä»¥æ”¾åœ¨ä»»æ„å‡½å¼å‰é¢ï¼Œå®ƒä»£è¡¨ã€Œæˆ‘å€‘æ­£å®£å‘Šä¸€å€‹éåŒæ­¥çš„å‡½å¼ï¼Œä¸”é€™å€‹å‡½å¼æœƒå›å‚³ä¸€å€‹ Promise ç‰©ä»¶ã€ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ä¸€èˆ¬å‡½å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getGroupInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">data&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ä½¿ç”¨ async å‡½å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getGroupInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">data&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>Await é—œéµå­—&lt;/p>
&lt;p>åœ¨ &lt;code>async&lt;/code> å‡½å¼ä¸­ä½¿ç”¨ &lt;code>await&lt;/code> é—œéµå­—ï¼Œä»£è¡¨ã€Œæˆ‘å€‘è«‹ JavaScript ç­‰å¾…é€™å€‹éåŒæ­¥çš„ä½œæ¥­å®Œæˆå¾Œï¼Œæ‰å±•é–‹å¾ŒçºŒçš„å‹•ä½œã€ï¼Œæ›å¥è©±èªªï¼šawait è®“ async å‡½å¼çš„åŸ·è¡Œå‹•ä½œæš«åœï¼Œç­‰åˆ°å®ƒç²å¾—å›å‚³çš„ Promise ç‰©ä»¶å¾Œ - ç„¡è«–åŸ·è¡ŒæˆåŠŸ (resolve) æˆ–æ˜¯å¤±æ•— (rejected) -æ‰æœƒæ¢å¾©åŸ·è¡Œ async å‡½å¼ã€‚&lt;/p>
&lt;ul>
&lt;li>å„ªé»ï¼šå¯ä»¥ç›´æ¥ä½¿ç”¨ await å¾Œç²å¾—çš„å›å‚³å€¼å­˜æ–¼ä¸€å€‹è®Šæ•¸ä¸­åšå¾ŒçºŒä½¿ç”¨ï¼Œè€Œä¸æ˜¯åœ¨å‘¼å« &lt;code>then()&lt;/code> æ–¹æ³•ä¸€å€‹ä¸€å€‹ä¸²ï¼Œè®“ç¨‹å¼ç¢¼çœ‹èµ·ä¾†åƒæ˜¯åœ¨è™•è£¡ä¸€èˆ¬çš„åŒæ­¥ç¨‹å¼ç¢¼ï¼Œæå‡äº†æ˜“è®€æ€§èˆ‡å¯ç¶­è­·æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h5>Async/Await ç¯„ä¾‹&lt;span class="hx-absolute -hx-mt-20" id="asyncawait-ç¯„ä¾‹">&lt;/span>
&lt;a href="#asyncawait-%e7%af%84%e4%be%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>æˆ‘å€‘åœ¨å¾ŒçºŒçš„ç¯„ä¾‹ï¼Œä¸€æ¨£ä½¿ç”¨ &lt;code>setTimeout()&lt;/code> ä¾†æ¨¡æ“¬è³‡æ–™åº«è«‹æ±‚å’Œç­‰å¾…è³‡æ–™çš„éåŒæ­¥ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getFirstInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">resolve&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;first data&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">1000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getSecondInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">resolve&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;second data&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">2000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getGroupInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä»£è¡¨ç­‰åˆ°ç¬¬ä¸€ç­†è³‡æ–™å›å‚³å¾Œï¼Œæ‰å°å‡ºçµæœå’Œè«‹æ±‚ç¬¬äºŒç­†è³‡æ–™
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">firstInfo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">getFirstInfo&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">firstInfo&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä»£è¡¨ç­‰åˆ°ç¬¬äºŒç­†è³‡æ–™å›å‚³å¾Œï¼Œæ‰å°å‡ºçµæœ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">secondInfo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> &lt;span style="color:#a6e22e">getSecondInfo&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">secondInfo&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">getGroupInfo&lt;/span>()&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åœ¨ &lt;code>getGroupInfo()&lt;/code> å‡½å¼å‰åŠ ä¸Š &lt;code>async&lt;/code> é—œéµå­—ï¼Œä¾†å‘ŠçŸ¥å€¼é€™æ˜¯ä¸€å€‹éåŒæ­¥å‡½ç¤ºï¼Œ &lt;code>getFirstInfo()&lt;/code> è·Ÿ &lt;code>getSecondInfo()&lt;/code> æ˜¯å…©å€‹è¦è™•ç†éåŒæ­¥çš„åœ°æ–¹ï¼Œå› æ­¤åˆ†åˆ¥åœ¨å…©å€‹å‘¼å«å‡½å¼å‰åŠ ä¸Š &lt;code>await&lt;/code> é—œéµå­—ã€‚&lt;/p>
&lt;br>
&lt;h5>await æ­é… Promise.all([&amp;hellip;]) æ–¹æ³•&lt;span class="hx-absolute -hx-mt-20" id="await-æ­é…-promiseall-æ–¹æ³•">&lt;/span>
&lt;a href="#await-%e6%90%ad%e9%85%8d-promiseall-%e6%96%b9%e6%b3%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getFirstInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// 1ç§’å¾Œå›å‚³çµæœ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">resolve&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;first data&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">1000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getSecondInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Promise((&lt;span style="color:#a6e22e">resolve&lt;/span>, &lt;span style="color:#a6e22e">reject&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// 2ç§’å¾Œå›å‚³çµæœ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">resolve&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;second data&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#ae81ff">2000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">getGroupInfo&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">firstInfo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">getFirstInfo&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">secondInfo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">getSecondInfo&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åŒæ­¥ç™¼å‡ºéåŒæ­¥è«‹æ±‚ï¼Œä¸¦ç­‰åˆ°å…©ç§’å¾Œï¼ˆéä¸‰ç§’ï¼‰æˆåŠŸç²å¾—å…©ç­†å›å‚³å¾Œï¼Œæ‰å°å‡ºçµæœ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> [&lt;span style="color:#a6e22e">firstData&lt;/span>, &lt;span style="color:#a6e22e">secondData&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> Promise.&lt;span style="color:#a6e22e">all&lt;/span>([&lt;span style="color:#a6e22e">firstInfo&lt;/span>, &lt;span style="color:#a6e22e">secondInfo&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">firstData&lt;/span>, &lt;span style="color:#a6e22e">secondData&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">catch&lt;/span> (&lt;span style="color:#a6e22e">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è™•ç†éŒ¯èª¤å›å‚³
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#a6e22e">error&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">getGroupInfo&lt;/span>()&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é€é &lt;code>await&lt;/code> é—œéµå­—æ­é… &lt;code>Promise.all()&lt;/code> æ–¹æ³•ï¼ŒåŒæ­¥å‘å…©å€‹è³‡æ–™åº«ç²å–è³‡æ–™ï¼Œä¸¦ç­‰åˆ°å…©ç­†è³‡æ–™éƒ½æˆåŠŸå›å‚³å¾Œï¼Œæ‰å°å‡ºçµæœ - çœæ™‚æ•ˆç‡æé«˜ï¼&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å¯ä»¥çœ‹åˆ°ä¸‹é¢é€™å¼µåœ–ï¼Œä»–æ˜¯ Node.js é‹è¡Œæ™‚çš„ç¸®åœ–ï¼Œä¸€æ—¦ä½ çš„ Node.js æ‡‰ç”¨ç¨‹åºå•Ÿå‹•ï¼Œå®ƒæœƒå…ˆé–‹å§‹ä¸€å€‹åˆå§‹åŒ–éšæ®µï¼Œé‹è¡Œå•Ÿå‹•è…³æœ¬ï¼ŒåŒ…æ‹¬è«‹æ±‚æ¨¡çµ„å’Œè¨»å†Šäº‹ä»¶ callbackã€‚ç„¶å¾Œæ‡‰ç”¨ç¨‹åºé€²å…¥äº‹ä»¶å¾ªç’°ï¼ˆä¹Ÿç¨±ç‚ºä¸»ç·šç¨‹ã€äº‹ä»¶ç·šç¨‹ç­‰ï¼‰ï¼Œå¾æ¦‚å¿µä¸Šè¬›ï¼Œå®ƒæ˜¯ç‚ºé€šéåŸ·è¡Œé©ç•¶çš„ JS callback ä¾†éŸ¿æ‡‰å‚³å…¥çš„å®¢æˆ¶ç«¯è«‹æ±‚è€Œæ§‹å»ºçš„ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-introduce/run-nodejs.png"
alt="Node.js é‹è¡Œæ™‚çš„åœ–ç¤º (An Intro to Node.js That You May Have Missed)" width="700">&lt;figcaption>
&lt;p>Node.js é‹è¡Œæ™‚çš„åœ–ç¤º (&lt;a href="https://itnext.io/an-intro-to-node-js-that-you-may-have-missed-b175ef4277f7" target="_blank" rel="noopener">An Intro to Node.js That You May Have Missed&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>libuv æ˜¯éåŒæ­¥è™•ç†çš„å‡½å¼åº«ï¼ˆä»¥ C èªè¨€ç‚ºä¸»)ï¼Œåœ¨é¢å°éåŒæ­¥ä½œæ¥­æ™‚ï¼Œæœƒé–‹å•ŸåŸ·è¡Œç·’æ±  (thread pool / worker pool) ï¼Œé è¨­å…±æœ‰å››å€‹åŸ·è¡Œç·’ (ä¹Ÿå°±æ˜¯ worker threads)ï¼Œé‹ç®—é€™äº› I/O ç”¨çš„æ–¹å¼æ˜¯äº‹ä»¶è¿´åœˆ (event loop)ã€‚&lt;/p>
&lt;p>æ‰€ä»¥å°±ç®— V8 è™•ç†ç¨‹å¼ç¢¼æ˜¯å–®åŸ·è¡Œç·’ï¼Œä¸€ä½†é€²å…¥åˆ° libuv æ‰‹ä¸Šï¼Œå®ƒé‚„æ˜¯æœƒå¹«ä½ æŠŠæœƒé˜»å¡çš„ I/O åˆ†å·¥åˆ°åŸ·è¡Œç·’æ± ä¸­äº¤çµ¦ä¸åŒçš„åŸ·è¡Œç·’å»è™•ç†ï¼Œç›´åˆ° callback ç™¼ç”Ÿæ‰æœƒä¸Ÿå›æ‡‰è®“ç¨‹å¼çŸ¥é“ã€‚&lt;/p>
&lt;p>é‚£æˆ‘å€‘ä¾†çœ‹çœ‹ libuv å¦‚ä½•é€éäº‹ä»¶è¿´åœˆæœ‰æ•ˆçš„è™•ç†éåŒæ­¥ I/Oã€‚&lt;/p>
&lt;br>
&lt;h3>äº‹ä»¶é©…å‹• (event-driven)&lt;span class="hx-absolute -hx-mt-20" id="äº‹ä»¶é©…å‹•-event-driven">&lt;/span>
&lt;a href="#%e4%ba%8b%e4%bb%b6%e9%a9%85%e5%8b%95-event-driven" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨è¬›äº‹ä»¶é©…å‹•å‰ï¼Œæˆ‘å€‘å…ˆä¾†äº†è§£ä¸€ä¸‹ä»€éº¼æ˜¯äº‹ä»¶ï¼š&lt;/p>
&lt;br>
&lt;h4>äº‹ä»¶ (event)&lt;span class="hx-absolute -hx-mt-20" id="äº‹ä»¶-event">&lt;/span>
&lt;a href="#%e4%ba%8b%e4%bb%b6-event" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>äº‹ä»¶æ˜¯æŒ‡ç”¨æˆ¶æˆ–æ˜¯ç³»çµ±ä½œå‡ºçš„å‹•ä½œï¼Œä¾‹å¦‚ä½¿ç”¨è€…é»é¸æŒ‰éˆ•ï¼Œæˆ–æ˜¯æª”æ¡ˆè®€å–å®Œæˆã€æŸç¨®éŒ¯èª¤ç”¢ç”Ÿç­‰ç­‰ï¼Œéƒ½å«åšäº‹ä»¶ã€‚&lt;/p>
&lt;br>
&lt;h4>äº‹ä»¶é©…å‹• (event-driven)&lt;span class="hx-absolute -hx-mt-20" id="äº‹ä»¶é©…å‹•-event-driven-1">&lt;/span>
&lt;a href="#%e4%ba%8b%e4%bb%b6%e9%a9%85%e5%8b%95-event-driven-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>äº‹ä»¶é©…å‹•æ˜¯ä¸€ç¨®ç¨‹å¼åŸ·è¡Œæ¨¡å‹ï¼Œè¡¨ç¤ºç¨‹å¼çš„é€²è¡Œæ˜¯ä¾æ“šäº‹ä»¶çš„ç™¼ç”Ÿè€Œå®šï¼Œç›£è½åˆ°äº‹ä»¶å°±è™•ç†ã€è™•ç†å®Œå°±åŸ·è¡Œ callback ï¼Œé€éä¸æ–·çš„ç›£è½è·Ÿå›æ‡‰äº‹ä»¶åŸ·è¡Œç¨‹å¼ã€‚&lt;/p>
&lt;p>è€Œäº‹ä»¶é©…å‹•åœ¨ä¸åŒçš„åœ°æ–¹æœ‰ä¸åŒçš„å¯¦ç¾ã€‚ç€è¦½å™¨ (å‰ç«¯) å’Œ Node.js (å¾Œç«¯) åŸºæ–¼ä¸åŒçš„æŠ€è¡“å¯¦ç¾äº†å„è‡ªçš„äº‹ä»¶è¿´åœˆã€‚å°± Ndoe.js ä¾†èªªï¼Œäº‹ä»¶å°±æ˜¯äº¤çµ¦ libuv å»è™•ç† ; è‡³æ–¼ç€è¦½å™¨çš„äº‹ä»¶è¿´åœˆåœ¨ HTML 5 çš„è¦ç¯„ä¸­æœ‰å®šç¾©ã€‚&lt;/p>
&lt;br>
&lt;h4>äº‹ä»¶è¿´åœˆ (event loop)&lt;span class="hx-absolute -hx-mt-20" id="äº‹ä»¶è¿´åœˆ-event-loop">&lt;/span>
&lt;a href="#%e4%ba%8b%e4%bb%b6%e8%bf%b4%e5%9c%88-event-loop" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>å› ç‚º Node.js åªæœ‰ä¸€å€‹åŸ·è¡Œç·’ï¼Œæ‰€ä»¥ç•¶ libuv æŠŠéåŒæ­¥äº‹ä»¶è™•ç†å®Œå¾Œï¼Œcallback è¦è¢«ä¸Ÿå›æ‡‰ç”¨ç¨‹å¼ä¸­æ’éšŠï¼Œç­‰å¾…ä¸»åŸ·è¡Œç·’çš„ stack ç‚ºç©ºçš„æ™‚å€™ï¼Œæ‰æœƒé–‹å§‹åŸ·è¡Œã€‚é€™å€‹æ’éšŠçš„åœ°æ–¹å°±æ˜¯äº‹ä»¶ä½‡åˆ— (event queue)ã€‚&lt;/p>
&lt;p>libuv æœƒä¸æ–·æª¢æŸ¥æœ‰æ²’æœ‰ callback éœ€è¦è¢«åŸ·è¡Œï¼Œæœ‰çš„è©±åˆ†é…åˆ°ä¸»åŸ·è¡Œç·’çµæŸæ‰‹é‚Šçš„ç¨‹å¼å¾Œè™•ç†ï¼Œå› æ­¤é€™å€‹éç¨‹ç¨±ç‚º ã€äº‹ä»¶è¿´åœˆã€ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-introduce/event-loop.png"
alt="äº‹ä»¶è¿´åœˆ(event loop) (Node.js 101 â€” å–®åŸ·è¡Œç·’ã€éåŒæ­¥ã€éé˜»å¡ I/O èˆ‡äº‹ä»¶è¿´åœˆ)" width="700">&lt;figcaption>
&lt;p>äº‹ä»¶è¿´åœˆ(event loop) (&lt;a href="https://medium.com/wenchin-rolls-around/node-js-101-%E5%96%AE%E5%9F%B7%E8%A1%8C%E7%B7%92-%E9%9D%9E%E5%90%8C%E6%AD%A5-%E9%9D%9E%E9%98%BB%E5%A1%9E-i-o-%E8%88%87%E4%BA%8B%E4%BB%B6%E8%BF%B4%E5%9C%88-ef94f8359eee" target="_blank" rel="noopener">Node.js 101 â€” å–®åŸ·è¡Œç·’ã€éåŒæ­¥ã€éé˜»å¡ I/O èˆ‡äº‹ä»¶è¿´åœˆ&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>libuv äº‹ä»¶è¿´åœˆæœ‰å“ªäº›éšæ®µå‘¢ï¼Ÿ&lt;/p>
&lt;figure>&lt;img src="https://pin-yi.me/nodejs/nodejs-introduce/libuv.png"
alt="libuv äº‹ä»¶è¿´åœˆ (nexocode)" width="700">&lt;figcaption>
&lt;p>libuv äº‹ä»¶è¿´åœˆ (&lt;a href="https://nexocode.com/blog/posts/behind-nodejs-event-loop/" target="_blank" rel="noopener">nexocode&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>libuv çš„äº‹ä»¶è¿´åœˆå…±æœ‰å…­å€‹éšæ®µï¼Œæ¯å€‹éšæ®µçš„ä½œç”¨å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Timersï¼šç­‰è¨ˆæ™‚å™¨ (setTimeoutã€setInterval) çš„æ™‚é–“ä¸€åˆ°ï¼ŒæœƒæŠŠä»–å€‘çš„ callback æ”¾åˆ°é€™è£¡ç­‰å¾…åŸ·è¡Œã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Pending callbacksï¼šæœƒæŠŠä½œæ¥­ç³»çµ±å±¤ç´šçš„éŒ¯èª¤çµ¦callback (TCP errorsã€sockets é€£ç·šè¢«æ‹’çµ•)ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Idle, prepareï¼šå…§éƒ¨ä½¿ç”¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Pollï¼šæœ€é‡è¦çš„ä¸€å€‹éšæ®µã€‚&lt;/p>
&lt;ol>
&lt;li>å¦‚æœ Queue ä¸ç‚ºç©ºï¼Œä¾æ¬¡å–å‡º callback å‡½æ•¸åŸ·è¡Œï¼Œç›´åˆ° Queue ç‚ºç©ºæˆ–æ˜¯æŠµé”ç³»çµ±æœ€å¤§é™åˆ¶ã€‚&lt;/li>
&lt;li>å¦‚æœ Queue ç‚ºç©ºä½†æœ‰è¨­ç½® ã€ŒsetImmediateã€ï¼Œå°±é€²å…¥ check éšæ®µã€‚&lt;/li>
&lt;li>å¦‚æœ Queue ç‚ºç©ºä½†æ²’æœ‰è¨­ç½® ã€ŒsetImmediateã€ï¼Œå°±æœƒåœ¨ Poll éšæ®µç­‰åˆ°ç›´åˆ° Queue æœ‰æ±è¥¿æˆ–æ˜¯ Timers æ™‚é–“æŠµé”ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>Checkï¼šè™•ç† setImmediate çš„ callbackã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Close callbacksï¼šåŸ·è¡Œ close äº‹ä»¶çš„ callbackï¼Œåˆ©å¦‚ socket.destroy()ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>äº‹ä»¶è¿´åœˆå°±æ˜¯ä¸æ–·é‡è¤‡ä»¥ä¸Šéšæ®µã€‚æ¯å€‹éšæ®µéƒ½æœ‰è‡ªå·±çš„ callback ä½‡åˆ—ï¼Œåœ¨é€²å…¥æŸå€‹éšæ®µæ™‚ï¼Œéƒ½æœƒå¾æ‰€å±¬çš„ä½‡åˆ—ä¸­å–å‡º callback ä¾†åŸ·è¡Œï¼Œç•¶ä½‡åˆ—ç‚ºç©ºæˆ–è€…è¢«åŸ·è¡Œ callback çš„æ•¸é‡é”åˆ°ç³»çµ±çš„æœ€å¤§æ•¸é‡æ™‚ï¼Œå°±æœƒé€²å…¥ä¸‹ä¸€éšæ®µã€‚&lt;/p>
&lt;br>
&lt;p>æ ¹æ“šä»¥ä¸Šæåˆ°äº‹ä»¶é©…å‹•ã€å–®åŸ·è¡Œç·’å’ŒéåŒæ­¥ã€éé˜»å¡çš„ I/O è™•ç†ç‰¹æ€§ï¼ŒNode.js å¾ˆé©åˆæ‹¿ä¾†é–‹ç™¼ I/O å¯†é›†å‹æ‡‰ç”¨ç¨‹å¼ï¼Œå¦‚å½±éŸ³ä¸²æµã€å³æ™‚äº’å‹•ã€åœ¨ç·šèŠå¤©ã€éŠæˆ²ã€å”ä½œå·¥å…·ã€è‚¡ç¥¨è¡Œæƒ…ç­‰è»Ÿé«”ã€‚&lt;/p>
&lt;br>
&lt;h2>NPM&lt;span class="hx-absolute -hx-mt-20" id="npm">&lt;/span>
&lt;a href="#npm" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>NPM æ˜¯è·Ÿ Node.js ä¸€èµ·å®‰è£çš„ç·šä¸Šå¥—ä»¶åº«ï¼Œå¯ä»¥ä¸‹è¼‰å„å¼å„æ¨£çš„ JavaScript å¥—ä»¶ä¾†ä½¿ç”¨ï¼Œèƒ½è§£æ±º Node.js ä»£ç¢¼éƒ¨ç½²ä¸Šçš„å¾ˆå¤šå•é¡Œã€‚&lt;/p>
&lt;br>
&lt;p>å®‰è£å¥½å¾Œï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>npm -v&lt;/code> ä¾†æª¢æŸ¥ç‰ˆæœ¬ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ npm -v
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>8.5.0&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>è·Ÿ NPM æ¯æ¯ç›¸é—œçš„æ˜¯ &lt;code>package.json&lt;/code> é€™å€‹æª”æ¡ˆï¼Œä»–æ˜¯æŒç®¡å°ˆæ¡ˆè³‡è¨Šçš„é‡è¦æª”æ¡ˆï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ &lt;code>init&lt;/code> æŒ‡ä»¤ä¾†è¨­å®š package.jsonï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ npm init
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>This utility will walk you through creating a package.json file.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>It only covers the most common items, and tries to guess sensible defaults.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.... çœç•¥ ....
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Press ^C at any time to quit.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>package name: &lt;span style="color:#f92672">(&lt;/span>message&lt;span style="color:#f92672">)&lt;/span> demo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>version: &lt;span style="color:#f92672">(&lt;/span>1.0.0&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>description:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>entry point: &lt;span style="color:#f92672">(&lt;/span>index.js&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>test command:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git repository:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>keywords:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>author: ian &amp;lt;880831ian@gmail.com&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>license: &lt;span style="color:#f92672">(&lt;/span>ISC&lt;span style="color:#f92672">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>name: å°±æ˜¯è©²å°ˆæ¡ˆçš„åå­—ï¼Œå®ƒé è¨­å°±æ˜¯è©²ç›®éŒ„åã€‚&lt;/li>
&lt;li>description: å°ˆæ¡ˆæè¿°ã€‚&lt;/li>
&lt;li>entry point: å°ˆæ¡ˆåˆ‡å…¥é»ï¼Œé€™æœ‰é»è¤‡é›œï¼Œä¹‹å¾Œå†èªªã€‚&lt;/li>
&lt;li>test command: å°ˆæ¡ˆæ¸¬è©¦æŒ‡ä»¤ï¼Œä¹‹å¾Œèªªã€‚&lt;/li>
&lt;li>git repository: å°ˆæ¡ˆåŸå§‹ç¢¼çš„ç‰ˆæœ¬æ§ç®¡ä½ç½®ã€‚&lt;/li>
&lt;li>keywoard: å°ˆæ¡ˆé—œéµå­—&lt;/li>
&lt;li>author: å°ˆæ¡ˆä½œè€…ï¼Œä»¥ author-name &lt;a href="mailto:author@email.com" >author@email.com&lt;/a> å¯«ä¹‹ã€‚&lt;/li>
&lt;li>license: å°ˆæ¡ˆç‰ˆæ¬Šã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>è¨­å®šå¥½å¾Œï¼Œå°ˆæ¡ˆè³‡æ–™å¤¾å°±æœƒå¤šä¸€å€‹ &lt;code>package.json&lt;/code> çš„æª”æ¡ˆï¼Œæ‰“é–‹å¾Œå¯ä»¥çœ‹åˆ°ï¼Œæ˜¯æˆ‘å€‘å‰›å‰›æ‰€è¨­å®šå¥½çš„è³‡è¨Šï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;demo&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;1.0.0&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;description&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;main&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;index.js&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;scripts&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;test&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;echo \&amp;#34;Error: no test specified\&amp;#34; &amp;amp;&amp;amp; exit 1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;author&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ian &amp;lt;880831ian@gmail.com&amp;gt;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;license&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ISC&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ¥ä¸‹ä¾†ï¼Œè¦å¦‚ä½•ä¸‹è¼‰ç¶²è·¯ä¸Šçš„æ¨¡çµ„ï¼Œè¦ä½¿ç”¨ &lt;code>install&lt;/code> æŒ‡ä»¤ä¾†ä¸‹è¼‰ï¼Œæˆ‘å€‘ä¸‹è¼‰ Node.js æœ€å°åˆéˆæ´»çš„ Web æ‡‰ç”¨ç¨‹å¼æ¡†æ¶ express ä¾†åšç¤ºç¯„ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ npm install express
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>added &lt;span style="color:#ae81ff">50&lt;/span> packages, and audited &lt;span style="color:#ae81ff">51&lt;/span> packages in 1s
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">2&lt;/span> packages are looking &lt;span style="color:#66d9ef">for&lt;/span> funding
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run &lt;span style="color:#e6db74">`&lt;/span>npm fund&lt;span style="color:#e6db74">`&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> details
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>found &lt;span style="color:#ae81ff">0&lt;/span> vulnerabilities&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ä¸‹è¼‰å¥½å¾Œï¼Œå¯ä»¥çœ‹åˆ°å‰›å‰› &lt;code>package.json&lt;/code> æª”æ¡ˆå¤šäº† &lt;code>dependencies&lt;/code> æ¬„ä½ï¼Œå®ƒè£¡é¢æœƒç´€éŒ„æˆ‘å€‘å®‰è£äº†å“ªäº›å¥—ä»¶ï¼Œæ‰€ä»¥æœªä¾†æˆ‘å€‘æƒ³çŸ¥é“å°ˆæ¡ˆä½¿ç”¨äº†å“ªäº›å¥—ä»¶ï¼Œæˆ‘å€‘å¯ä»¥å¾ &lt;code>dependencies&lt;/code> é€™å€‹æ¬„ä½çŸ¥é“ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;demo&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;1.0.0&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;description&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;main&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;index.js&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;scripts&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;test&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;echo \&amp;#34;Error: no test specified\&amp;#34; &amp;amp;&amp;amp; exit 1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;author&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ian &amp;lt;880831ian@gmail.com&amp;gt;&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;license&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ISC&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dependencies&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;express&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;^4.17.3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é™¤æ­¤ä¹‹å¤–ï¼Œé‚„æœƒå¤šä¸€å€‹ &lt;code>node_modules&lt;/code> è³‡æ–™å¤¾ï¼Œé€™å€‹è³‡æ–™å¤¾å°±æœƒå­˜æ”¾æˆ‘å€‘æ‰€ä¸‹è¼‰çš„å¥—ä»¶&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ls node_modules/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>accepts cookie-signature etag inherits mime-types qs setprototypeof
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>array-flatten debug express ipaddr.js ms range-parser statuses
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>body-parser depd finalhandler media-typer negotiator raw-body toidentifier
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>bytes destroy forwarded merge-descriptors on-finished safe-buffer type-is
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content-disposition ee-first fresh methods parseurl safer-buffer unpipe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content-type encodeurl http-errors mime path-to-regexp send utils-merge
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cookie escape-html iconv-lite mime-db proxy-addr serve-static vary&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ç•¶æˆ‘å€‘éƒ½å®‰è£å¥½å¾Œï¼Œexpress å·²ç¶“åŒ…åœ¨ &lt;code>node_modules&lt;/code> ç›®éŒ„å…§ï¼Œåœ¨å°ˆæ¡ˆè£¡é¢ï¼Œå°±å¯ä»¥ä½¿ç”¨ require(&amp;lsquo;å¥—ä»¶åç¨±â€˜) ä¾†ä½¿ç”¨å¥—ä»¶å›‰ï¼&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;express&amp;#39;&lt;/span>);&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å› ç‚ºé€™äº›å¥—ä»¶éƒ½å¯ä»¥ç›´æ¥åœ¨ç¶²è·¯ä¸Šä¸‹è¼‰åˆ°ï¼Œæ‰€ä»¥åœ¨æ¨é€ git å°ˆæ¡ˆæ™‚ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>.gitignore&lt;/code> ä¾†éš±è—ä¸æƒ³è¢« push çš„æª”æ¡ˆï¼Œç•¶æˆ‘å€‘æƒ³è¦ä¸‹è¼‰å¥—ä»¶å›ä¾†æ™‚ï¼Œåªè¦ä½¿ç”¨ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ npm install&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å°±å¯ä»¥ä¾ç…§ &lt;code>package.json&lt;/code> è£¡é¢çš„ &lt;code>dependencies&lt;/code> ä¾†ä¸‹è¼‰å¥—ä»¶ï¼&lt;/p>
&lt;h2>REPL&lt;span class="hx-absolute -hx-mt-20" id="repl">&lt;/span>
&lt;a href="#repl" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Node.js REPL (äº¤äº’å¼è§£é‡‹å™¨)ï¼šè¡¨ç¤ºä¸€å€‹é›»è…¦ç’°å¢ƒï¼Œé¡ä¼¼ Windoes ç³»çµ±çš„çµ‚ç«¯æˆ–æ˜¯ Unix/Linux çš„ Shellï¼Œæˆ‘å€‘å¯ä»¥åœ¨çµ‚ç«¯æ©Ÿä¸Šè¼¸å…¥å‘½ä»¤ï¼Œä¸¦æ¥æ”¶ç³»çµ±çš„éŸ¿æ‡‰ã€‚&lt;/p>
&lt;p>Node è‡ªå¸¶äº†äº¤äº’å¼è§£é‡‹å™¨ï¼Œå¯ä»¥åŸ·è¡Œä»¥ä¸‹ä»»å‹™ï¼š&lt;/p>
&lt;ul>
&lt;li>è®€å–ï¼šè®€å–ç”¨æˆ¶è¼¸å…¥ï¼Œè§£æè¼¸å…¥çš„ JavaScript æ•¸æ“šçµæ§‹ä¸¦å„²å­˜åœ¨å…§å­˜ä¸­ã€‚&lt;/li>
&lt;li>åŸ·è¡Œï¼šåŸ·è¡Œè¼¸å…¥çš„æ•¸æ“šçµæ§‹ã€‚&lt;/li>
&lt;li>é¡¯ç¤ºï¼šè¼¸å‡ºçµæœã€‚&lt;/li>
&lt;li>å¾ªç’°ï¼šå¾ªç’°ä»¥ä¸Šä»»å‹™ç›´åˆ°ç”¨æˆ¶æŒ‰ä¸‹å…©æ¬¡çš„ ctrl+c æŒ‰éˆ•é€€å‡ºã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>æˆ‘å€‘å¯ä»¥è¼¸å…¥ä»¥ä¸‹å‘½ä»¤ä¾†å•Ÿå‹• Node çš„çµ‚ç«¯ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ node
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Welcome to Node.js v16.14.2.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Type &lt;span style="color:#e6db74">&amp;#34;.help&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> more information.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å¯ä»¥åŸ·è¡Œç°¡å–®çš„æ•¸å­¸é‹ç®—ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ node
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Welcome to Node.js v16.14.2.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Type &lt;span style="color:#e6db74">&amp;#34;.help&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> more information.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; 1+4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; 5/2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2.5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; 3*7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">21&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; 4-3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; &lt;span style="color:#ae81ff">1&lt;/span> + &lt;span style="color:#f92672">(&lt;/span>2*4&lt;span style="color:#f92672">)&lt;/span> -5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ä¹Ÿå¯ä»¥å°‡æ•¸æ“šå­˜åœ¨è®Šæ•¸ä¸­ï¼Œåœ¨éœ€è¦æ™‚ä½¿ç”¨å®ƒã€‚è®Šæ•¸å®£å‘Šéœ€è¦ä½¿ç”¨ &lt;code>var&lt;/code> é—œéµå­—ï¼Œå¦‚æœæ²’æœ‰ä½¿ç”¨é—œéµå­—ï¼Œæœƒç›´æ¥é¡¯ç¤ºå‡ºä¾†ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;code>console.log()&lt;/code> ä¾†è¼¸å‡ºè®Šæ•¸&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ node
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Welcome to Node.js v16.14.2.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Type &lt;span style="color:#e6db74">&amp;#34;.help&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> more information.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; x &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">19&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">19&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; var y &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; x + y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">29&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; console.log&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Hello&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hello
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>Node REPL ä¹Ÿæ”¯æŒè¼¸å…¥å¤šè¡Œç¨‹å¼ï¼Œæˆ‘å€‘è©¦è‘—å¯«ä¸€å€‹ do-while è¿´åœˆï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>Welcome to Node.js v16.14.2.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Type &lt;span style="color:#e6db74">&amp;#34;.help&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> more information.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; var x &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; &lt;span style="color:#66d9ef">do&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>... x++;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>... console.log&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;x:&amp;#34;&lt;/span> + x&lt;span style="color:#f92672">)&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>... &lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#66d9ef">while&lt;/span> &lt;span style="color:#f92672">(&lt;/span>x&amp;lt;5&lt;span style="color:#f92672">)&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>x:1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>x:2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>x:3
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>x:4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>x:5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹åº•ç·š(_)ä¾†ç²å¾—ä¸Šä¸€å€‹ç¨‹å¼çš„é‹ç®—çµæœï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ node
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Welcome to Node.js v16.14.2.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Type &lt;span style="color:#e6db74">&amp;#34;.help&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> more information.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; var x &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; var y &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; x + y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">30&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; var sum &lt;span style="color:#f92672">=&lt;/span> _
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; console.log&lt;span style="color:#f92672">(&lt;/span>sum&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">30&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>undefined
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h2>Express æ¡†æ¶&lt;span class="hx-absolute -hx-mt-20" id="express-æ¡†æ¶">&lt;/span>
&lt;a href="#express-%e6%a1%86%e6%9e%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Node.js åœ¨å¯¦ä½œä¸Šä¸æœƒå–®ç¨ä½¿ç”¨ï¼Œé€šå¸¸æœƒæ­é…æ¡†æ¶å»ä½¿ç”¨ï¼Œåƒæ˜¯ &lt;a href="https://expressjs.com/" target="_blank" rel="noopener">Express JS å¾Œç«¯æ¡†æ¶&lt;/a>ï¼Œå¯ä»¥è®“é–‹ç™¼äººå“¡åœ¨å¯«åŒä¸€å€‹åŠŸèƒ½æ™‚ï¼Œå°‘å¯«å¾ˆå¤šç¨‹å¼çš„å·¥å…·ã€‚&lt;/p>
&lt;p>Express æ˜¯ Node.js ç’°å¢ƒä¸‹æä¾›çš„è¼•é‡å¾Œç«¯æ¶æ§‹ï¼Œè‡ªç”±åº¦æ¥µé«˜ï¼Œé€éè±å¯Œçš„ HTTP å·¥å…·ï¼Œèƒ½å¿«é€Ÿç™¼é–‹å¾Œç«¯æ‡‰ç”¨ç¨‹å¼ï¼Œå®ƒæä¾›ï¼š&lt;/p>
&lt;ul>
&lt;li>æ›¿ä¸åŒ HTTP Methodã€ä¸åŒ URL è·¯å¾‘çš„ requests ç·¨å¯«ä¸åŒçš„è™•ç†æ–¹æ³•ã€‚&lt;/li>
&lt;li>é€éæ•´åˆã€Œç•«é¢ã€çš„æ¸²æŸ“å¼•æ“ä¾†é”åˆ°æ’å…¥è³‡æ–™åˆ°æ¨£æ¿ç”¢ç”Ÿ responseã€‚&lt;/li>
&lt;li>è¨­å®šå¸¸è¦‹çš„ web æ‡‰ç”¨ç¨‹å¼ï¼Œä¾‹å¦‚ï¼šé€£ç·šç”¨çš„ Port å’Œç”¢ç”Ÿ response æ¨£æ¿çš„ä½ç½®ã€‚&lt;/li>
&lt;li>åœ¨ request çš„è™•ç†æµç¨‹ä¸­å¢åŠ è€Œå¤–çš„ä¸­é–“å±¤ (Middleware) é€²è¡Œè™•ç†ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>ç¬¬ä¸€å€‹ Express Hello world ç¨‹å¼ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">require&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;express&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">express&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">port&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">3000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span>, (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">send&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Hello World!&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">listen&lt;/span>(&lt;span style="color:#a6e22e">port&lt;/span>, () =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`Example app listening on port &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">port&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ node app.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Example app listening on port &lt;span style="color:#ae81ff">3000&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä½¿ç”¨ &lt;code>node&lt;/code> ä¾†å•Ÿå‹•ä¼ºæœå™¨ï¼Œä¸¦ä½¿ç”¨ Port 3000 ä¾†é€£ç·šã€‚æ‡‰ç”¨ç¨‹å¼æŒ‡å‘ URL (/) çš„è·¯ç”±ï¼Œä»¥ &amp;ldquo;Hello World!&amp;rdquo; å›æ‡‰å¦‚æœæ˜¯å…¶ä»–è·¯å¾‘ï¼Œres å°±æœƒå›æ‡‰ 404 æ‰¾ä¸åˆ°ã€‚&lt;/p>
&lt;br>
&lt;h3>ç•«é¢ (view)&lt;span class="hx-absolute -hx-mt-20" id="ç•«é¢-view">&lt;/span>
&lt;a href="#%e7%95%ab%e9%9d%a2-view" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å‰›å‰›æœ‰æåˆ°èªªå®ƒå¯ä»¥ä½¿ç”¨æ•´åˆã€Œç•«é¢ã€çš„æ¸²æŸ“å¼•æ“ä¾†é¡¯ç¤ºåˆ°æ¨£æ¿ï¼Œæˆ‘å€‘å¯ä»¥é€é &lt;code>--view&lt;/code> æŒ‡ä»¤ä¾†ç”¢ç”Ÿæ¨£æ¿ä»¥åŠæ‡‰ç”¨ç¨‹å¼çš„ç›®éŒ„ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ express --view&lt;span style="color:#f92672">=&lt;/span>pub
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : public/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : public/javascripts/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : public/images/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : public/stylesheets/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : public/stylesheets/style.css
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : routes/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : routes/index.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : routes/users.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : views/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : app.js
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : package.json
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : bin/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> create : bin/www&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>è·¯ç”± (router)&lt;span class="hx-absolute -hx-mt-20" id="è·¯ç”±-router">&lt;/span>
&lt;a href="#%e8%b7%af%e7%94%b1-router" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è·¯ç”±æ˜¯åˆ¤æ–·æ‡‰ç”¨ç¨‹å¼å¦‚ä½•å›æ‡‰ç”¨æˆ¶ç«¯å°ç‰¹å®šç«¯é»çš„è¦æ±‚ï¼Œè€Œç‰¹å®šç«¯é»æ˜¯ä¸€å€‹ URL æˆ–æ˜¯è·¯å¾‘ï¼Œèˆ‡ä¸€å€‹ç‰¹å®šçš„ HTTP è¦æ±‚æ–¹æ³• (GETã€POST) ç­‰ï¼Œè·¯ç”±å®šç¾©çš„çµæ§‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">METHOD&lt;/span>(&lt;span style="color:#a6e22e">PATH&lt;/span>, &lt;span style="color:#a6e22e">HANDLER&lt;/span>)&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å…¶ä¸­&lt;/p>
&lt;ul>
&lt;li>app æ˜¯ express çš„å¯¦ä¾‹ã€‚&lt;/li>
&lt;li>METHOD æ˜¯ HTTP è¦æ±‚çš„æ–¹æ³•ã€‚&lt;/li>
&lt;li>PATH æ˜¯ä¼ºæœå™¨ä¸Šçš„è·¯å¾‘ã€‚&lt;/li>
&lt;li>HANDLER æ˜¯ç•¶è·¯ç”±ç›¸ç¬¦æ™‚è¦åŸ·è¡Œçš„å‡½æ•¸ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>ä»¥ä¸‹ç¯„ä¾‹ç°¡å–®èªªæ˜ä¸åŒ HTTP è¦æ±‚çš„æ–¹æ³•ï¼š&lt;/p>
&lt;p>é¦–é ä¸­ä»¥ Hello World! å›æ‡‰ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">send&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Hello World!&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å°æ ¹è·¯ç”± (/)ï¼ˆæ‡‰ç”¨ç¨‹å¼çš„é¦–é ï¼‰ç™¼å‡º POST è¦æ±‚æ™‚çš„å›æ‡‰ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">post&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">send&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Got a POST request&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å° /user è·¯ç”±ç™¼å‡º PUT è¦æ±‚æ™‚çš„å›æ‡‰ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#a6e22e">put&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/user&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">send&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Got a PUT request at /user&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å° /user è·¯ç”±ç™¼å‡º DELETE è¦æ±‚æ™‚çš„å›æ‡‰ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">app&lt;/span>.&lt;span style="color:#66d9ef">delete&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;/user&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">function&lt;/span> (&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">res&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">res&lt;/span>.&lt;span style="color:#a6e22e">send&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Got a DELETE request at /user&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Node.js å®˜ç¶²ï¼š&lt;a href="https://nodejs.dev/learn/introduction-to-nodejs" target="_blank" rel="noopener">https://nodejs.dev/learn/introduction-to-nodejs&lt;/a>&lt;/p>
&lt;p>Node.js 101 â€” å–®åŸ·è¡Œç·’ã€éåŒæ­¥ã€éé˜»å¡ I/O èˆ‡äº‹ä»¶è¿´åœˆï¼š&lt;a href="https://medium.com/wenchin-rolls-around/node-js-101-%E5%96%AE%E5%9F%B7%E8%A1%8C%E7%B7%92-%E9%9D%9E%E5%90%8C%E6%AD%A5-%E9%9D%9E%E9%98%BB%E5%A1%9E-i-o-%E8%88%87%E4%BA%8B%E4%BB%B6%E8%BF%B4%E5%9C%88-ef94f8359eee" target="_blank" rel="noopener">https://medium.com/wenchin-rolls-around/node-js-101-%E5%96%AE%E5%9F%B7%E8%A1%8C%E7%B7%92-%E9%9D%9E%E5%90%8C%E6%AD%A5-%E9%9D%9E%E9%98%BB%E5%A1%9E-i-o-%E8%88%87%E4%BA%8B%E4%BB%B6%E8%BF%B4%E5%9C%88-ef94f8359eee&lt;/a>&lt;/p>
&lt;p>An Intro to Node.js That You May Have Missedï¼š&lt;a href="https://itnext.io/an-intro-to-node-js-that-you-may-have-missed-b175ef4277f7" target="_blank" rel="noopener">https://itnext.io/an-intro-to-node-js-that-you-may-have-missed-b175ef4277f7&lt;/a>&lt;/p>
&lt;p>Sequelizeï¼š&lt;a href="https://sequelize.org/v6/index.html" target="_blank" rel="noopener">https://sequelize.org/v6/index.html&lt;/a>&lt;/p>
&lt;p>é€é sequelize ä¾†é”æˆ DB Schema Migrationï¼š&lt;a href="https://hackmd.io/@TSMI_E7ORNeP8YBbWm-lFA/ryCtaVW_M?print-pdf#%E4%BD%BF%E7%94%A8sequelize%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%BC%B5user-table" target="_blank" rel="noopener">https://hackmd.io/@TSMI_E7ORNeP8YBbWm-lFA/ryCtaVW_M?print-pdf#%E4%BD%BF%E7%94%A8sequelize%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%BC%B5user-table&lt;/a>&lt;/p>
&lt;p>èªè­˜åŒæ­¥èˆ‡éåŒæ­¥ â€” Callback + Promise + Async/Awaitï¼š&lt;a href="https://medium.com/%E9%BA%A5%E5%85%8B%E7%9A%84%E5%8D%8A%E8%B7%AF%E5%87%BA%E5%AE%B6%E7%AD%86%E8%A8%98/%E5%BF%83%E5%BE%97-%E8%AA%8D%E8%AD%98%E5%90%8C%E6%AD%A5%E8%88%87%E9%9D%9E%E5%90%8C%E6%AD%A5-callback-promise-async-await-640ea491ea64" target="_blank" rel="noopener">https://medium.com/%E9%BA%A5%E5%85%8B%E7%9A%84%E5%8D%8A%E8%B7%AF%E5%87%BA%E5%AE%B6%E7%AD%86%E8%A8%98/%E5%BF%83%E5%BE%97-%E8%AA%8D%E8%AD%98%E5%90%8C%E6%AD%A5%E8%88%87%E9%9D%9E%E5%90%8C%E6%AD%A5-callback-promise-async-await-640ea491ea64&lt;/a>&lt;/p>
&lt;p>ä½ æ‡‚ JavaScript å—ï¼Ÿ#23 Callbackï¼š&lt;a href="https://ithelp.ithome.com.tw/articles/10206555" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10206555&lt;/a>&lt;/p>
&lt;p>How to create JOIN queries with Sequelizeï¼š&lt;a href="https://sebhastian.com/sequelize-join/" target="_blank" rel="noopener">https://sebhastian.com/sequelize-join/&lt;/a>&lt;/p></description></item></channel></rss>