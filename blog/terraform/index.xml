<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PIN-YI â€“ Terraform</title><link>https://pin-yi.me/blog/terraform/</link><description>Recent content in Terraform on PIN-YI</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><atom:link href="https://pin-yi.me/blog/terraform/index.xml" rel="self" type="application/rss+xml"/><item><title>ä»€éº¼æ˜¯ IaC ? Terraform åˆæ˜¯ä»€éº¼ï¼Ÿ</title><link>https://pin-yi.me/blog/terraform/terraform/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/terraform/terraform/</guid><description>
&lt;p>è·Ÿä¸Šä¸€ç¯‡ Snyk ä¸€æ¨£ï¼Œæœ¬ç³»åˆ—ä¹Ÿæ˜¯å»åƒåŠ  DevOpsDay Taipei 2022 æ´»å‹•è½åˆ°å„ä½ç”¢æ¥­å¤§ä½¬ç›®å‰åœ¨ä½¿ç”¨çš„åè©ä»¥åŠæŠ€è¡“ï¼Œæƒ³èªªå›å®¶ä¹Ÿå……å¯¦ä¸€ä¸‹è‡ªå·±ï¼Œäº†è§£ä¸€ä¸‹åœ¨ DevOpsDay æœ€å¸¸å‡ºç¾çš„ IaC æ˜¯ä»€éº¼ï¼Ÿä»¥åŠè½èªªå¾ˆæ–¹ä¾¿çš„ Terraform åˆæ˜¯ä»€éº¼ï¼Œå°‡å­¸ç¿’çš„éç¨‹æ‰“æˆæ­¤ç¯‡ç­†è¨˜ï¼Œæ­¡è¿å¤§å®¶å¤šäº¤æµï¼Œé‚£æˆ‘å€‘å°±é–‹å§‹å›‰ã€‚&lt;/p>
&lt;p>ç›®å‰æ‰“ç®—å¯«æœ¬ç¯‡ä»‹ç´¹ IaC ä»¥åŠ Terraform ä»¥å¤–ï¼Œä¹‹å¾Œé‚„æƒ³å¯«å¦å¤–å…©ç¯‡èªªæ˜ Terraform å¦‚ä½•å…±åŒç¶­è­·é–‹ç™¼(å°‡ .tfstate æª”æ¡ˆå­˜åœ¨ gitlab or gcs ä¸Š)ã€æ€éº¼æŠŠ Terraform è½‰æˆ moduleï¼Œæœ€å¾Œå°å…¥ Terragrunt é”åˆ° DRY ç­‰ç­‰ï¼Œä¹Ÿæœƒæœ‰ç”¨ Terraform å»ºç«‹ GCE ä»¥åŠ GKEã€‚å¤§å®¶å¯ä»¥æŒçºŒé—œæ³¨æ­¤ç¯‡æ–‡ç« ï¼Œæœ€å¾Œæœƒåœ¨æ–‡ç« å¾Œé™„ä¸Šé€£çµ ğŸ˜&lt;/p>
&lt;br>
&lt;h2>ä»€éº¼æ˜¯ IaC ?&lt;span class="hx-absolute -hx-mt-20" id="ä»€éº¼æ˜¯-iac-">&lt;/span>
&lt;a href="#%e4%bb%80%e9%ba%bc%e6%98%af-iac-" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>IaC å…¨åæ˜¯ Infrastructure as Code (åŸºç¤è¨­æ–½å³ä»£ç¢¼)ï¼Œå¾å­—é¢æ„æ€å°±å¯ä»¥ç•¥çŸ¥ä¸€äºŒï¼Œä¹Ÿå°±æ˜¯æŠŠåŸºç¤è¨­æ–½è®Šæˆç¨‹å¼ç¢¼ï¼Œåœ¨é‚„æ²’æœ‰é€™äº› IaC å·¥å…·ä¹‹å‰ï¼Œå¤§å®¶éƒ½æ˜¯é–‹å•Ÿ WEB UI ç•«é¢ä¾†é€²è¡Œå»ºç½®æˆ–è¨­å®šï¼Œé›–ç„¶ä½¿ç”¨ UI é»ä¸€é»å°±å»ºå¥½äº†ï¼Œä½†é€™äº›æ­¥é©Ÿéƒ½æ²’æœ‰è¢«ç´€éŒ„ä¸‹ä¾† (git)ï¼Œä¹Ÿæ²’æœ‰è¾¦æ³•é€éå…¶ä»–äººä¸€èµ· Review çš„æ–¹å¼ä¾†é¿å…äººç‚ºæ“ä½œéŒ¯èª¤ã€‚å› æ­¤æœ‰äº† IaC é€™äº›å·¥å…·ï¼Œå¯ä»¥å°‡å¯¦éš›çš„æ“ä½œæµç¨‹ï¼Œè½‰æ›æˆç¨‹å¼ç¢¼æˆ–æ˜¯å…¶ä»–åƒæ˜¯ JSONã€Yaml çš„æ–¹å¼çµ¦ç´€éŒ„ä¸‹ä¾†ï¼Œä»¥ä¸‹æ˜¯å°å…¥ IaC å¸¶ä¾†çš„å¥½è™•ï¼š&lt;/p>
&lt;br>
&lt;ol>
&lt;li>å»ºç½® CI/CD è‡ªå‹•åŒ– (ä¸éœ€è¦å†ä»°è³´ UI é€²è¡Œæ“ä½œ)&lt;/li>
&lt;li>ç‰ˆæœ¬æ§åˆ¶ (å¤§å®¶å¯ä»¥é€é MR è¦å®š code reviewï¼Œé¿å…å‡ºç¾äººç‚ºéŒ¯èª¤)&lt;/li>
&lt;li>é‡è¤‡ä½¿ç”¨ (å¯ä»¥å°‡å¸¸ç”¨çš„è®Šæˆåƒæ•¸ä»£å…¥ï¼Œæ¸›å°‘å»ºç½®æ™‚é–“)&lt;/li>
&lt;li>ç’°å¢ƒä¸€è‡´æ€§&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>(ä»¥ä¸Š IaC èªªæ˜ä¾†è‡ª &lt;a href="https://blog.wu-boy.com/2021/02/introduction-to-infrastructure-as-code-terraform-vs-pulumi/" target="_blank" rel="noopener">å°æƒ¡é­” - åˆæ¢ Infrastructure as Code å·¥å…· Terraform vs Pulumi &lt;/a>æ–‡ç« ï¼Œå¯«å¾—çœŸçš„å¾ˆå¥½ï¼Œæ¨æ¨)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/iac.png"
alt="Infrastructure as Code åˆå¿ƒä¼æœè¡Œç ”07ï¼šè®¤è¯†ã€ŒåŸºç¡€è®¾æ–½å³ä»£ç ã€(Infrastructure as Code) â€” åˆå¿ƒå†…å‚" width="800">&lt;figcaption>
&lt;p>Infrastructure as Code &lt;a href="https://www.36dianping.com/info/15473.html" target="_blank" rel="noopener">åˆå¿ƒä¼æœè¡Œç ”07ï¼šè®¤è¯†ã€ŒåŸºç¡€è®¾æ–½å³ä»£ç ã€(Infrastructure as Code) â€” åˆå¿ƒå†…å‚&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>Terraform åˆæ˜¯ä»€éº¼ï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="terraform-åˆæ˜¯ä»€éº¼">&lt;/span>
&lt;a href="#terraform-%e5%8f%88%e6%98%af%e4%bb%80%e9%ba%bc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>IaC çš„å·¥å…·æœ‰å¾ˆå¤šç¨®ï¼Œæ¥è‘—æˆ‘å€‘å°±ä¾†ä»‹ç´¹å…¶ä¸­ä¸€å€‹å·¥å…· - Terraformï¼ŒTerraform æ˜¯ä»€éº¼å‘¢ï¼Ÿæ ¹æ“šå®˜ç¶²çš„èªªæ˜å¯ä»¥çŸ¥é“ï¼ŒTerraform æ˜¯ &lt;a href="https://www.hashicorp.com/" target="_blank" rel="noopener">HashiCorp&lt;/a> æ‰€é–‹ç™¼çš„åŸºç¤è¨­æ–½å³ä»£ç¢¼å·¥å…·ã€‚å®ƒå¯ä»¥ä½¿ç”¨äººé¡æ–¹ä¾¿è®€çš„é…ç½®æ–‡ä»¶ä¾†å®šç¾©è³‡æºå’ŒåŸºç¤è¨­æ–½ï¼Œä»¥ä¸‹æœ‰ä½¿ç”¨ Terraform å¹¾å€‹å„ªé»ï¼š&lt;/p>
&lt;br>
&lt;ol>
&lt;li>Terraform å¯ä»¥ç®¡ç†å¤šå€‹é›²å¹³å°ä¸Šçš„åŸºç¤æ¶æ§‹&lt;/li>
&lt;li>ä½¿ç”¨äººé¡å¯è®€çš„é…ç½®èªè¨€ä¾†å¹«åŠ©æˆ‘å€‘å¿«é€Ÿç·¨å¯«åŸºç¤è¨­æ–½ä»£ç¢¼&lt;/li>
&lt;li>å¯ä»¥å°‡é…ç½®æäº¤çµ¦ç‰ˆæœ¬æ§åˆ¶ï¼Œå®‰å…¨åœ°åœ¨åŸºç¤æ¶æ§‹ä¸Šé€²è¡Œå”ä½œ&lt;/li>
&lt;/ol>
&lt;br>
&lt;h3>ç®¡ç†ä»»ä½•åŸºç¤è¨­æ–½&lt;span class="hx-absolute -hx-mt-20" id="ç®¡ç†ä»»ä½•åŸºç¤è¨­æ–½">&lt;/span>
&lt;a href="#%e7%ae%a1%e7%90%86%e4%bb%bb%e4%bd%95%e5%9f%ba%e7%a4%8e%e8%a8%ad%e6%96%bd" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Terraform æä¾›æ’ä»¶è®“ Terraform å¯ä»¥é€šéå…¶ API èˆ‡é›²å¹³å°å’Œå…¶ä»–æœå‹™é€²è¡Œäº¤äº’ã€‚HashiCorp å’Œ Terraform ç¤¾å€ç·¨å¯«äº† 3193 å¤šå€‹æä¾›å•†ä¾†ç®¡ç†åƒ AWSã€Azureã€GCPã€Kubernetesã€Helmã€GitHub ç­‰è³‡æºï¼Œå¯ä»¥åˆ° &lt;a href="https://registry.terraform.io/browse/providers?_gl=1*a2tlfj*_ga*MTc0NDA4ODQ5MC4xNjYzOTI0ODI5*_ga_P7S46ZYEKW*MTY2NDE4MjM4NC40LjEuMTY2NDE4Mjc5Ny4wLjAuMA.." target="_blank" rel="noopener">Terraform Registry&lt;/a> æŸ¥çœ‹æ›´å¤šå¹³å°æˆ–æœå‹™çš„æä¾›è€…ï¼Œç•¶ç„¶å¦‚æœæ²’æœ‰æ‰¾åˆ°æƒ³è¦çš„æä¾›è€…ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ç·¨å¯«è‡ªå·±çš„å¥—ä»¶ã€‚&lt;/p>
&lt;br>
&lt;h3>æ¨™æº–åŒ–éƒ¨ç½²å·¥ä½œæµç¨‹&lt;span class="hx-absolute -hx-mt-20" id="æ¨™æº–åŒ–éƒ¨ç½²å·¥ä½œæµç¨‹">&lt;/span>
&lt;a href="#%e6%a8%99%e6%ba%96%e5%8c%96%e9%83%a8%e7%bd%b2%e5%b7%a5%e4%bd%9c%e6%b5%81%e7%a8%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æä¾›å•†æœƒå°‡åŸºç¤è¨­æ–½çš„æ¯å€‹å–®å…ƒ (ä¾‹å¦‚å»ºç«‹ VM æˆ–æ˜¯ VPC) å®šç¾©ç‚ºè³‡æºã€‚ä½ å¯ä»¥å°‡ä¾†è‡ªä¸åŒæä¾›è€…çš„è³‡æºçµ„åˆï¼Œè®Šæˆæ¨¡çµ„ï¼Œè®“æˆ‘å€‘å¯ä»¥ç”¨ä¸€è‡´çš„èªè¨€å’Œå·¥ä½œæµç¨‹å»ç®¡ç†ä»–å€‘ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/terraform.jpg"
alt="Terraform ä»€éº¼æ˜¯ Terraform çš„åŸºç¤è¨­æ–½å³ä»£ç¢¼ï¼Ÿ" width="800">&lt;figcaption>
&lt;p>Terraform &lt;a href="https://learn.hashicorp.com/tutorials/terraform/infrastructure-as-code?in=terraform/aws-get-started" target="_blank" rel="noopener">ä»€éº¼æ˜¯ Terraform çš„åŸºç¤è¨­æ–½å³ä»£ç¢¼ï¼Ÿ&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>å®‰è£ Terraform&lt;span class="hx-absolute -hx-mt-20" id="å®‰è£-terraform">&lt;/span>
&lt;a href="#%e5%ae%89%e8%a3%9d-terraform" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å®‰è£ Terraform çš„æ–¹å¼æœ‰å¾ˆå¤šç¨®ï¼Œæˆ‘å°±ä»¥æˆ‘åœ¨ä½¿ç”¨çš„ Mac OS ç‚ºä¾‹ï¼Œå…¶ä»–å¯ä»¥åƒè€ƒ &lt;a href="https://learn.hashicorp.com/tutorials/terraform/install-cli?in=terraform/aws-get-started#install-terraform" target="_blank" rel="noopener">Install Terraform&lt;/a>ï¼š&lt;/p>
&lt;br>
&lt;h3>å®‰è£æ­¥é©Ÿ&lt;span class="hx-absolute -hx-mt-20" id="å®‰è£æ­¥é©Ÿ">&lt;/span>
&lt;a href="#%e5%ae%89%e8%a3%9d%e6%ad%a5%e9%a9%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>å…ˆå®‰è£ HashiCorp tapï¼Œé€™æ˜¯ HashiCorp åœ¨ Homebrew çš„å„²å­˜åº«ï¼š&lt;/li>
&lt;/ol>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew tap hashicorp/tap&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>ä½¿ç”¨ hashicorp/tap/terraform&lt;/li>
&lt;/ol>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install hashicorp/tap/terraform&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>å¦‚ä½•é©—è­‰æ˜¯å¦å®‰è£æˆåŠŸ&lt;span class="hx-absolute -hx-mt-20" id="å¦‚ä½•é©—è­‰æ˜¯å¦å®‰è£æˆåŠŸ">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e9%a9%97%e8%ad%89%e6%98%af%e5%90%a6%e5%ae%89%e8%a3%9d%e6%88%90%e5%8a%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ‰“é–‹ä¸€å€‹æ–°çš„ Terminalï¼Œä½¿ç”¨ &lt;code>terraform -help&lt;/code> æª¢æŸ¥æ˜¯å¦æœ‰å®‰è£æˆåŠŸï¼Œä¹Ÿå¯ä»¥åœ¨ &lt;code>-help&lt;/code> å¾Œé¢åŠ å…¥åƒæ•¸ä¾†æŸ¥çœ‹è©²åƒæ•¸çš„åŠŸèƒ½èˆ‡æ›´å¤šè¨Šæ¯&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/1.png"
alt="é©—è­‰ Terraform å®‰è£æˆåŠŸ Install Terraform" width="800">&lt;figcaption>
&lt;p>é©—è­‰ Terraform å®‰è£æˆåŠŸ &lt;a href="https://learn.hashicorp.com/tutorials/terraform/install-cli?in=terraform/aws-get-started#install-terraform" target="_blank" rel="noopener">Install Terraform&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è‡ªå‹•è£œå…¨æŒ‡ä»¤&lt;span class="hx-absolute -hx-mt-20" id="è‡ªå‹•è£œå…¨æŒ‡ä»¤">&lt;/span>
&lt;a href="#%e8%87%aa%e5%8b%95%e8%a3%9c%e5%85%a8%e6%8c%87%e4%bb%a4" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å¯ä»¥å•Ÿå‹•çµ‚ç«¯æ©Ÿä¸Šçš„ Tab è‡ªå‹•è£œå…¨åŠŸèƒ½ï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œå†é‡é–‹çµ‚ç«¯æ©Ÿï¼Œå°±æœƒå‡ºç¾äº†ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>terraform -install-autocomplete&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æƒ³è¦è§£é™¤è‡ªå‹•è£œå…¨ (é›–ç„¶æ‡‰è©²ä¸æœƒæ‹‰)ï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>terraform -uninstall-autocomplete&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/8.png"
alt="æ”¾ä¸Šæˆæœåœ–ç‰‡" width="800">&lt;figcaption>
&lt;p>æ”¾ä¸Šæˆæœåœ–ç‰‡&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>å¿«é€Ÿå…¥é–€&lt;span class="hx-absolute -hx-mt-20" id="å¿«é€Ÿå…¥é–€">&lt;/span>
&lt;a href="#%e5%bf%ab%e9%80%9f%e5%85%a5%e9%96%80" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç•¶æˆ‘å€‘å®‰è£å¥½ï¼Œæƒ³è¦æœ€å¿«çš„äº†è§£ Terraform ï¼Œç•¶ç„¶æ˜¯è‡ªå·±å‹•æ‰‹åšä¸€æ¬¡ï¼Œæˆ‘å€‘ä¾ç…§å®˜ç¶²çš„æ•™å­¸ï¼Œå¯ä»¥åœ¨ä¸€åˆ†é˜å…§ä½¿ç”¨ Docker é…ç½®å¥½ NGINX ä¼ºæœå™¨ï¼Œé‚£æˆ‘å€‘é–‹å§‹å›‰ï¼&lt;/p>
&lt;br>
&lt;ol>
&lt;li>é¦–å…ˆï¼Œæˆ‘å€‘å¿…é ˆè¦å…ˆå®‰è£å¥½ Dockerï¼Œä¸‹è¼‰ &lt;a href="https://docs.docker.com/desktop/install/mac-install/" target="_blank" rel="noopener">Mac ç‰ˆ Docker æ¡Œé¢&lt;/a>&lt;/li>
&lt;li>å»ºç«‹ä¸€å€‹è³‡æ–™å¤¾ï¼Œä¸¦é€²å…¥è©²è³‡æ–™å¤¾å…§&lt;/li>
&lt;li>å°‡ä»¥ä¸‹ Terraform é…ç½®æ–‡ä»¶è²¼åˆ°æª”æ¡ˆä¸­ï¼Œä¸¦å–å &lt;code>main.tf&lt;/code>ï¼š(&lt;a href="https://github.com/880831ian/terraform/tree/master/docker_container" target="_blank" rel="noopener">åŒæ­¥åˆ° GitHub éœ€è¦ç¨‹å¼ç¢¼çš„å¯ä»¥å‰å¾€æŸ¥çœ‹&lt;/a>)&lt;/li>
&lt;/ol>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">provider&lt;/span> &lt;span style="color:#e6db74">&amp;#34;docker&amp;#34;&lt;/span> {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;docker_image&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;nginx&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;nginx:1.23&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">keep_locally&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;docker_container&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;nginx&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image&lt;/span> = &lt;span style="color:#a6e22e">docker_image&lt;/span>.&lt;span style="color:#a6e22e">nginx&lt;/span>.&lt;span style="color:#a6e22e">name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;nginx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ports&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">internal&lt;/span> = &lt;span style="color:#ae81ff">80&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">external&lt;/span> = &lt;span style="color:#ae81ff">8000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="4">
&lt;li>å†é–‹ä¸€å€‹æª”æ¡ˆå–åç‚º &lt;code>provider.tf&lt;/code>ï¼Œå°‡ä»¥ä¸‹é…ç½®æ–‡ä»¶è²¼åˆ°æª”æ¡ˆä¸­ï¼š&lt;/li>
&lt;/ol>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">required_providers&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">docker&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;kreuzwerker/docker&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;~&amp;gt; 2.13.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>(ä»¥ä¸Šç¨‹å¼ç¢¼ä¾†è‡ªå®˜ç¶² &lt;a href="https://learn.hashicorp.com/tutorials/terraform/install-cli?in=terraform/aws-get-started#quick-start-tutorial" target="_blank" rel="noopener">å®‰è£ Terraform#å¿«é€Ÿå…¥é–€&lt;/a> åŠ ä¸Šå°ä¿®æ”¹)&lt;/p>
&lt;br>
&lt;p>å…ˆä¾†ç°¡å–®èªªæ˜ä¸€ä¸‹ Terraform ç¨‹å¼ç¢¼æ ¼å¼ï¼ŒTerraform çš„æª”æ¡ˆå‰¯æª”åæ˜¯ &lt;code>*.tf&lt;/code>ï¼Œæ¡ç”¨åç‚º HCL (HashiCorp Configuration Language) çš„çµ„æ…‹èªè¨€ä¾†æè¿°åŸºç¤æ¶æ§‹ã€‚&lt;/p>
&lt;p>(è£œå……èªªæ˜ï¼šåªè¦æ˜¯åŒä¸€å€‹ç›®éŒ„ä¸‹æœ‰ .tf æª”æ¡ˆçµå°¾çš„ï¼ŒTerraform éƒ½æœƒå»åŸ·è¡Œï¼Œæ‰€ä»¥æª”æ¡ˆåç¨±å¯ä»¥è‡ªå·±å–åï¼Œä½†ç‚ºäº†æ–¹ä¾¿ç®¡ç†éƒ½æœƒä½¿ç”¨ mainã€providerã€backendã€output çš„æª”æ¡ˆä¾†æ”¾ç½®å°æ‡‰çš„å…§å®¹)&lt;/p>
&lt;p>HCL æ˜¯ä¸€ç¨®å®£å‘Šå¼çš„èªè¨€ï¼Œè®“ä½ ç›´æ¥å¯«ä¸‹æœŸæœ›çš„åŸºç¤æ¶æ§‹ï¼Œè€Œä¸æ˜¯å¯«ä¸‹éç¨‹çš„æ¯ä¸€å€‹æ­¥é©Ÿã€‚&lt;/p>
&lt;br>
&lt;h4>æª”æ¡ˆä»‹ç´¹&lt;span class="hx-absolute -hx-mt-20" id="æª”æ¡ˆä»‹ç´¹">&lt;/span>
&lt;a href="#%e6%aa%94%e6%a1%88%e4%bb%8b%e7%b4%b9" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æˆ‘å€‘å…ˆçœ‹ &lt;code>provider.tf&lt;/code> æª”æ¡ˆï¼Œæª”æ¡ˆå…§æœƒå…ˆå¯«å¥½éœ€è¦çš„ä¾›æ‡‰å•†ä¾†æºä»¥åŠç‰ˆæœ¬ (ç‰ˆæœ¬æœ‰é»åƒæ˜¯å°æ‡‰ä¾›æ‡‰å•†æä¾›çš„ api ç‰ˆæœ¬)&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">required_providers&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#960050;background-color:#1e0010">ä¾›æ‡‰å•†åç¨±&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;ä¾›æ‡‰å•†ä¾†æº&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;~&amp;gt; æ‰€ä½¿ç”¨çš„ç‰ˆæœ¬&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>&lt;code>main.tf&lt;/code> æª”æ¡ˆå…§çš„ &lt;code>provider&lt;/code> å€å¡Šæœƒå¯«ä¾›æ‡‰å•†çš„ç›¸é—œè¨­å®šï¼Œå‡è¨­æˆ‘å€‘ä½¿ç”¨ google å°±æœƒåœ¨è£¡é¢å…ˆè¨­å®šå¥½ project id ç­‰ã€‚&lt;/p>
&lt;p>&lt;code>resource&lt;/code> å€å¡Šæœƒéœ€è¦å¯«é›²ç«¯è³‡æºåç¨±ä»¥åŠè‡ªå®šç¾©çš„åç¨±ï¼Œé›²ç«¯è³‡æºåç¨±é€™é …æ˜¯ä¸å¯ä»¥æ›´æ”¹çš„ï¼Œå‡è¨­æˆ‘å€‘è¦ä½¿ç”¨ docker çš„ container æœå‹™ï¼Œé€™é‚Šå°±éœ€è¦å¡«å¯« docker_containerã€‚è‡ªå®šç¾©çš„åç¨±å¯ä»¥æ˜¯ä½ æƒ³è¦ç‚ºä½¿ç”¨é€™å€‹é›²ç«¯è³‡æºå»å®šç¾©çš„åç¨±ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">provider&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ä¾›æ‡‰å•†åç¨±&amp;#34;&lt;/span> {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;é›²ç«¯è³‡æºåç¨±&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;è‡ªå®šç¾©çš„åç¨±&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#960050;background-color:#1e0010">å±¬æ€§&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">å€¼&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ‰€ä»¥æˆ‘å€‘å·²ä¸Šé¢çš„ Docker é…ç½®å¥½ NGINX ä¼ºæœå™¨ç‚ºä¾‹ï¼Œprovider æˆ‘å€‘é€™æ¬¡ä½¿ç”¨çš„æ˜¯ &lt;code>docker&lt;/code>ï¼Œ resource æˆ‘å€‘å¯ä»¥æ‹†é–‹ä¾†å¯«ï¼Œ&lt;/p>
&lt;p>åƒæ˜¯ç¬¬ä¸€å€‹ resource &lt;code>docker_image&lt;/code> æˆ‘å€‘å¹«ä»–å–å« nginxï¼Œè£¡é¢å°±æ˜¯æ”¾æœ‰é—œ image çš„è¨­å®šï¼Œè©³ç´°çš„ image è¨­å®šå¯ä»¥åƒè€ƒ &lt;a href="https://registry.terraform.io/providers/kreuzwerker/docker/latest/docs/resources/image" target="_blank" rel="noopener">Resource (docker_image)&lt;/a>ï¼Œ&lt;/p>
&lt;p>ç¬¬äºŒå€‹ resource &lt;code>docker_container&lt;/code> ä¸€æ¨£å« nginxï¼Œè£¡é¢ç”¨çš„ image æ˜¯æ‹¿å‰é¢çš„ docker_image resource name ä¾†ä½¿ç”¨ï¼Œä¸€æ¨£è©³ç´°å¯ä»¥åƒè€ƒ &lt;a href="https://registry.terraform.io/providers/kreuzwerker/docker/latest/docs/resources/container" target="_blank" rel="noopener">Resource (docker_container)&lt;/a>ã€‚&lt;/p>
&lt;br>
&lt;p>å°æé†’ï¼Œå¦‚æœä¸çŸ¥é“è¦æ€éº¼å¯« provider ä¾›æ‡‰å•†è¨­å®šï¼Œå¯ä»¥æ‰“é–‹ &lt;a href="https://registry.terraform.io/providers/kreuzwerker/docker/latest/docs/resources/container" target="_blank" rel="noopener">terraform å®˜ç¶²æ‰¾åˆ°è©²ä¾›æ‡‰å•†&lt;/a>ï¼Œé»é¸å³é‚Šçš„ USE PROVIDER&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/11.png"
alt="å®˜æ–¹æ•™å­¸" width="400">&lt;figcaption>
&lt;p>å®˜æ–¹æ•™å­¸&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°å®˜æ–¹æ•™å­¸è¦æ€éº¼ä½¿ç”¨é€™å€‹ä¾›æ‡‰å•†ã€‚&lt;/p>
&lt;br>
&lt;h4>æŒ‡ä»¤èªªæ˜&lt;span class="hx-absolute -hx-mt-20" id="æŒ‡ä»¤èªªæ˜">&lt;/span>
&lt;a href="#%e6%8c%87%e4%bb%a4%e8%aa%aa%e6%98%8e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æ¥è‘—æœ‰å¹¾å€‹æŒ‡ä»¤è¦å¸¶å¤§å®¶èªè­˜ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>terraform init&lt;/code>ï¼šåˆå§‹åŒ–é …ç›®ï¼Œä¸‹è¼‰ tf æª”æ¡ˆä¸­æ‰€éœ€è¦çš„å¤–æ›å¥—ä»¶&lt;/li>
&lt;li>&lt;code>terraform plan&lt;/code>ï¼šæœƒç”¢ç”Ÿä¸€ä»½åŸ·è¡Œè¨ˆåŠƒã€‚ä¸Šé¢æœƒå¯«è‘—å®ƒå°‡æœƒåšå“ªäº›äº‹ï¼Œä½ å¯ä»¥é©—è­‰æ˜¯å¦ç¬¦åˆä½ é æœŸçš„è¨­è¨ˆ&lt;/li>
&lt;li>&lt;code>terraform apply&lt;/code>ï¼šå¯¦éš›é‹ä½œï¼ŒæŠŠåŸºç¤æ¶æ§‹å»ºç½®å®Œæˆã€‚åœ¨å®Œæˆä¹‹å¾Œï¼ŒæœƒæŠŠç›®å‰çš„ç‹€æ…‹å„²å­˜åˆ°ä¸€ä»½æª”æ¡ˆä¸­ (*.tfstate)&lt;/li>
&lt;li>&lt;code>terraform destroy&lt;/code>ï¼šæœƒéŠ·æ¯€ç”¨ Terraform èµ·çš„æœå‹™&lt;/li>
&lt;li>&lt;code>terraform fmt&lt;/code>ï¼šå¹«ä½ æ•´ç†å¥½ tf æ–‡ä»¶&lt;/li>
&lt;li>&lt;code>terraform validate&lt;/code>ï¼šéœæ…‹æª¢æŸ¥ tf æ–‡ä»¶&lt;/li>
&lt;/ul>
&lt;p>é™„ä¸Šæ‡¶äººæŒ‡ä»¤&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>alias ti=&amp;#39;terraform init&amp;#39;
alias ta=&amp;#39;terraform apply&amp;#39;
alias tp=&amp;#39;terraform plan&amp;#39;
alias td=&amp;#39;terraform destroy&amp;#39;&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ç”±æ–¼åœ¨ apply çš„æ™‚å€™æœƒè·³å‡ºè©¢å•è¦–çª—ï¼Œå¦‚æœæ˜¯è¦å¯«æˆè…³æœ¬ï¼Œå¯ä»¥æŠŠæŒ‡ä»¤æ”¹æˆ &lt;code>terraform apply -auto-approve&lt;/code> å°±ä¸éœ€è¦è¼¸å…¥ yes äº†ï¼&lt;/p>
&lt;br>
&lt;h4>å¯¦éš›æ“ä½œ&lt;span class="hx-absolute -hx-mt-20" id="å¯¦éš›æ“ä½œ">&lt;/span>
&lt;a href="#%e5%af%a6%e9%9a%9b%e6%93%8d%e4%bd%9c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æœ‰ä¸Šé¢çš„æŒ‡ä»¤å¾Œï¼Œæˆ‘å€‘ä¾†å¯¦éš›æ“ä½œçœ‹çœ‹ï¼š&lt;/p>
&lt;br>
&lt;ol>
&lt;li>é¦–å…ˆåˆ°è©² &lt;code>main.tf&lt;/code> æª”æ¡ˆç›®éŒ„ä¸‹ï¼Œå…ˆä½¿ç”¨ &lt;code>terraform apply&lt;/code> ä¾†æ¸¬è©¦çœ‹çœ‹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/2.png"
alt="ç„¡æ³•ç›´æ¥åŸ·è¡Œ apply" width="900">&lt;figcaption>
&lt;p>ç„¡æ³•ç›´æ¥åŸ·è¡Œ apply&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æœƒç™¼ç¾æ²’æœ‰è¾¦æ³•ç›´æ¥ç”¨ &lt;code>terraform apply&lt;/code> æŒ‡ä»¤ä¾†å»ºç½®æœå‹™ï¼Œæˆ‘å€‘çœ‹ä¸€ä¸‹ä»–æç¤ºçš„èªªæ˜ï¼Œä»–èªªä»–æ‰¾ä¸åˆ° lock fileï¼Œéœ€è¦å…ˆé€²è¡Œåˆå§‹åŒ–æ‰å¯ä»¥åŸ·è¡Œï¼Œæ‰€ä»¥æˆ‘å€‘çš„å»ºç½®æµç¨‹æ˜¯å…ˆ init &amp;ndash;&amp;gt; apply&lt;/p>
&lt;br>
&lt;h5>terraform init&lt;span class="hx-absolute -hx-mt-20" id="terraform-init">&lt;/span>
&lt;a href="#terraform-init" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol start="2">
&lt;li>æˆ‘å€‘å…ˆåŸ·è¡Œ &lt;code>terraform init&lt;/code>ï¼Œå¯ä»¥çœ‹åˆ°ä»–æœƒä¸‹è¼‰ tf æª”æ¡ˆä¸­æ‰€éœ€è¦çš„å¤–æ›å¥—ä»¶ (docker)&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/3.png"
alt="terraform init" width="800">&lt;figcaption>
&lt;p>terraform init&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>ç•¶æˆ‘å€‘åˆå§‹åŒ–å¾Œï¼Œè³‡æ–™å¤¾æœƒå¤šä¸€å€‹æª”æ¡ˆ (.terraform.lock.hcl) ä»¥åŠè³‡æ–™å¤¾ (.terraform)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/9.png"
alt="init å‰å¾Œæª”æ¡ˆå·®ç•°" width="650">&lt;figcaption>
&lt;p>init å‰å¾Œæª”æ¡ˆå·®ç•°&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>&lt;code>.terraform.lock.hcl&lt;/code>ï¼šæ˜¯ Terraform ä¸­ç”¨æ–¼é–å®šå’Œç®¡ç†å¤–éƒ¨æä¾›è€…ï¼ˆprovidersï¼‰ç‰ˆæœ¬çš„æª”æ¡ˆã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ç¢ºä¿åœ¨ä¸åŒçš„ç’°å¢ƒä¸­ä½¿ç”¨ç›¸åŒçš„å¤–éƒ¨æä¾›è€…ç‰ˆæœ¬ï¼Œä»¥é¿å…åœ¨åœ˜éšŠåˆä½œæˆ–ä¸åŒç’°å¢ƒä¸­å¼•å…¥ä¸ä¸€è‡´æ€§å’Œå•é¡Œã€‚&lt;/p>
&lt;p>&lt;code>.terraform/&lt;/code>ï¼šè³‡æ–™å¤¾ä¸»è¦ç”¨æ–¼å­˜å„²åˆå§‹åŒ–å’Œç®¡ç†åŸºç¤æ¶æ§‹ç›¸é—œçš„è‡¨æ™‚æ–‡ä»¶ã€‚&lt;/p>
&lt;br>
&lt;h5>terraform plan&lt;span class="hx-absolute -hx-mt-20" id="terraform-plan">&lt;/span>
&lt;a href="#terraform-plan" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol start="3">
&lt;li>æ¥è‘—æˆ‘å€‘ä½¿ç”¨ &lt;code>terraform plan&lt;/code> ä¾†æŸ¥çœ‹æˆ‘å€‘çš„è¨ˆåŠƒï¼Œå¯ä»¥çœ‹åˆ°ä»–æœƒåˆ—å‡ºæˆ‘å€‘æ‰€å¯«çš„ tf è£¡é¢æœ‰ç”¨åˆ°çš„ resourceï¼Œé™¤äº†æˆ‘å€‘æœ‰è¨­å®šçš„å±¬æ€§ï¼Œå…¶ä»–çš„å±¬æ€§ä¹Ÿæœƒé¡¯ç¤ºå‡ºä¾†ï¼Œå¯ä»¥æ›´æ–¹ä¾¿åœ°è®“æˆ‘å€‘çŸ¥é“é€™å€‹ resource æœ‰å“ªäº›å±¬æ€§å¯ä»¥è¨­å®š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/4.png"
alt="terraform plan" width="600">&lt;figcaption>
&lt;p>terraform plan&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h5>terraform apply&lt;span class="hx-absolute -hx-mt-20" id="terraform-apply">&lt;/span>
&lt;a href="#terraform-apply" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol start="4">
&lt;li>æœ€å¾Œæˆ‘å€‘æª¢æŸ¥éƒ½æ²’æœ‰å•é¡Œï¼Œå°±å¯ä»¥ä½¿ç”¨ &lt;code>terraform apply&lt;/code> ä¾†å»ºç½®ï¼Œapply å…¶å¯¦è·Ÿ plan ä¸€æ¨£éƒ½æœƒå…ˆè®“æˆ‘å€‘çœ‹ä¸€ä¸‹è¨ˆåŠƒï¼Œä½†æœƒè·³å‡ºè©¢å•æ˜¯å¦è¦åŸ·è¡Œï¼Œé™¤éä½ è¼¸å…¥ &lt;code>yes&lt;/code>ï¼Œå¦å‰‡å°±è·Ÿ plan å–®ç´”é¡¯ç¤ºè¨ˆåŠƒå…§å®¹ï¼Œæœ€å¾Œæˆ‘å€‘å°±å¯ä»¥çœ‹åˆ°ä»–æˆåŠŸåœ¨ docker ä¸Šé¢å»ºç«‹ nginx æœå‹™&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/5.png"
alt="terraform apply" width="800">&lt;figcaption>
&lt;p>terraform apply&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/6.png"
alt="æŸ¥çœ‹ docker nginx ä»¥åŠæª¢æŸ¥å…¶æœå‹™" width="800">&lt;figcaption>
&lt;p>æŸ¥çœ‹ docker nginx ä»¥åŠæª¢æŸ¥å…¶æœå‹™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç•¶æˆ‘å€‘ apply å®Œï¼Œæœå‹™ä¹Ÿå»ºç«‹å¾Œï¼ŒæŸ¥çœ‹ä¸€ä¸‹è³‡æ–™å¤¾å¾Œæœƒç™¼ç¾ï¼Œåˆå¤šäº†ä¸€å€‹æª”æ¡ˆ &lt;code>terraform.tfstate&lt;/code>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/10.png"
alt="å¤šäº†ä¸€å€‹æª”æ¡ˆ terraform.tfstate" width="800">&lt;figcaption>
&lt;p>å¤šäº†ä¸€å€‹æª”æ¡ˆ terraform.tfstate&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>&lt;code>terraform.tfstate&lt;/code>ï¼š æ˜¯ Terraform çš„ç‹€æ…‹æª”æ¡ˆï¼Œå®ƒåŒ…å«äº†åŸºç¤æ¶æ§‹çš„ç‹€æ…‹å’Œè³‡æºçš„è©³ç´°ä¿¡æ¯ã€‚é è¨­æƒ…æ³ä¸‹ï¼Œé€™å€‹æª”æ¡ˆæ˜¯æœ¬åœ°çš„ä¸¦ä¸”åªå­˜åœ¨æ–¼ Terraform åˆå§‹åŒ–å’Œæ“ä½œçš„ç›®éŒ„ä¸­ã€‚(ä½†è¦å¦‚ä½•å¯¦ç¾å…±åŒç¶­è­·åŒä¸€å€‹ IaC å‘¢ï¼Œæ•¬å¾…å¾ŒçºŒåˆ†äº« ğŸ¤£)&lt;/p>
&lt;br>
&lt;h5>terraform destory&lt;span class="hx-absolute -hx-mt-20" id="terraform-destory">&lt;/span>
&lt;a href="#terraform-destory" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol start="5">
&lt;li>å¦å¤–ï¼Œç•¶ä½ æƒ³è¦ç§»é™¤æœå‹™æ™‚ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>terraform destroy&lt;/code> ä¾†å°‡æœå‹™çµ¦ç§»é™¤&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/7.png"
alt="terraform destroy" width="700">&lt;figcaption>
&lt;p>terraform destroy&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h5>terraform import&lt;span class="hx-absolute -hx-mt-20" id="terraform-import">&lt;/span>
&lt;a href="#terraform-import" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol start="6">
&lt;li>æœ€å¾Œé‚„æœ‰ä¸€å€‹è »é‡è¦çš„ï¼Œå°±æ˜¯æˆ‘å€‘å·²ç¶“æœ‰å¾ˆå¤šæœå‹™éƒ½æ˜¯ä½¿ç”¨ WEB UI æ–¹å¼å»ºç«‹çš„æœå‹™ï¼Œé‚£æˆ‘å€‘è¦æ€éº¼æŠŠå®ƒè®Šæˆ tf æª”æ¡ˆå‘¢ï¼Ÿ&lt;/li>
&lt;/ol>
&lt;p>è·Ÿæˆ‘å€‘å‰›å‰›èªªçš„ &lt;code>terraform.tfstate&lt;/code> æª”æ¡ˆæœ‰é—œï¼Œä»–æœƒå„²å­˜æˆ‘å€‘ IaC çš„ç‹€æ…‹ï¼Œæ‰€ä»¥æˆ‘å€‘æ‰å¯ä»¥é€éä»–çŸ¥é“ç¾åœ¨æ˜¯å°è³‡æºåšæ–°å¢ã€ä¿®æ”¹ã€åˆªé™¤å“ªå€‹æ“ä½œ&lt;/p>
&lt;p>é‚£ç•¶é€™å€‹æª”æ¡ˆä¸è¦‹æ™‚ï¼Œå¦‚æœå†é‡æ–°ä¸‹ &lt;code>terraform apply&lt;/code>ï¼Œä»–æœƒèªç‚ºä½ æ˜¯æ–°å¢ç‹€æ…‹ï¼Œä½†å¯¦éš›ä¸Š docker æœå‹™é‚„æ˜¯å•Ÿå‹•çš„ç‹€æ…‹ï¼Œæ‰€ä»¥å°±æœƒéŒ¯èª¤ï¼Œæœƒè·Ÿä½ èªªä»–å·²ç¶“å­˜åœ¨ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/12.png"
alt="æ¸¬è©¦æ²’æœ‰ terraform.tfstate ç›´æ¥ä¸‹ terraform apply" width="700">&lt;figcaption>
&lt;p>æ¸¬è©¦æ²’æœ‰ terraform.tfstate ç›´æ¥ä¸‹ terraform apply&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ‰€ä»¥é€™æ™‚å€™æˆ‘å€‘è¦æŠŠç·šä¸Šæœå‹™çš„è³‡æºè½‰æˆ tf ï¼Œç¬¬ä¸€æ­¥è¦å…ˆæŠŠ resource çš„æ¡†æ¶çµ¦å¯«å‡ºä¾†ï¼Œå…¶ä»–å¯ä»¥å…ˆç•™ç©ºç™½ï¼Œå¦‚ä¸‹ &lt;code>main.tf&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">provider&lt;/span> &lt;span style="color:#e6db74">&amp;#34;docker&amp;#34;&lt;/span> {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;docker_image&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;nginx&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;nginx:1.23&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">keep_locally&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;docker_container&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;nginx&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ¥è‘—ä½¿ç”¨ &lt;code>terraform import&lt;/code> ä¾†å°‡ç·šä¸Šæœå‹™çš„è³‡æºå¥—ç”¨åˆ°æˆ‘å€‘ main.tf è£¡é¢çš„ resourceï¼Œæ‰€ä»¥æœƒé•·å¾—åƒï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> &lt;span style="color:#a6e22e">import&lt;/span> &lt;span style="color:#a6e22e">docker_container&lt;/span>.&lt;span style="color:#a6e22e">nginx&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span>&lt;span style="color:#a6e22e">f363ea3f6a64b5432ae3627f490b3e297abf80f196bce9c028ec2eb82706f12&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>import å¾Œé¢æœƒåŠ ä¸Š main.tf resource åç¨± docker_containerï¼Œä»¥åŠæˆ‘å€‘å–åçš„ nginxï¼Œæœ€å¾Œå¸¶ container id (&lt;code>docker ps&lt;/code> æŸ¥è©¢)ï¼Œå°±å¯ä»¥åŒ¯å‡º terraform.tfstate æª”æ¡ˆå›‰ï¼Œè©³ç´°çš„ import å¯ä»¥åƒè€ƒ&lt;a href="https://registry.terraform.io/providers/kreuzwerker/docker/latest/docs/resources/container#import" target="_blank" rel="noopener">æ¯å€‹ä¾›æ‡‰å•†è³‡æºçš„ç¶²é (é€™é‚Šä»¥ docker ç‚ºä¾‹)&lt;/a>&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/13.png"
alt="terraform import åŒ¯å‡º terraform.tfstate" width="700">&lt;figcaption>
&lt;p>terraform import åŒ¯å‡º terraform.tfstate&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h5>terraform show&lt;span class="hx-absolute -hx-mt-20" id="terraform-show">&lt;/span>
&lt;a href="#terraform-show" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>ç•¶æˆ‘å€‘åŒ¯å‡ºå¾Œï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ terraform.tfstateï¼Œå®ƒæœƒæ˜¯ä¸€å€‹ json æ ¼å¼ï¼Œå¦‚æœè¦è½‰æˆ tf æ ¼å¼ï¼Œé‚„éœ€è¦ä½¿ç”¨ &lt;code>terraform show&lt;/code> ä¾†å°‡ terraform.tfstate æª”æ¡ˆè½‰æˆ tf æ ¼å¼ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/14.png"
alt="terraform show å°‡ terraform.tfstate è½‰æˆ tf" width="700">&lt;figcaption>
&lt;p>terraform show å°‡ terraform.tfstate è½‰æˆ tf&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¦‚æœé€éä¸Šè¿°çš„æ–¹å¼ä¾†è½‰æˆ tfï¼Œæœƒç™¼ç¾åœ¨é‡æ–° apply æ™‚ï¼Œæœƒå‡ºç¾éŒ¯èª¤ï¼Œé€™é‚Šä»¥ gce çš„ç•¶ç¯„ä¾‹ï¼Œè½‰å®Œçš„ tf è¨­å®šï¼Œæœ‰äº›æ˜¯ tf ä¸æ”¯æ´çš„åƒæ•¸ï¼Œåªæœƒé¡¯ç¤ºåœ¨ tfstateï¼Œæ‰€ä»¥é‚„éœ€è¦æ‰‹å‹•åˆªé™¤ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform/15.png"
alt="è½‰æ›å¾Œé‚„éœ€å°‡ä¸ç”¨çš„è¨­å®šçµ¦ç§»é™¤" width="700">&lt;figcaption>
&lt;p>è½‰æ›å¾Œé‚„éœ€å°‡ä¸ç”¨çš„è¨­å®šçµ¦ç§»é™¤&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åˆæ¢ Infrastructure as Code å·¥å…· Terraform vs Pulumiï¼š&lt;a href="https://blog.wu-boy.com/2021/02/introduction-to-infrastructure-as-code-terraform-vs-pulumi/" target="_blank" rel="noopener">https://blog.wu-boy.com/2021/02/introduction-to-infrastructure-as-code-terraform-vs-pulumi/&lt;/a>&lt;/p>
&lt;p>ä»Šæ™šæˆ‘æƒ³èªè­˜ Terraformï¼š&lt;a href="https://ithelp.ithome.com.tw/articles/10233759" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10233759&lt;/a>&lt;/p></description></item><item><title>ä½¿ç”¨ Terraform å»ºç«‹ Google Compute Engine</title><link>https://pin-yi.me/blog/terraform/terraform-gce/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/terraform/terraform-gce/</guid><description>
&lt;p>å—¨å—¨å¤§å®¶å¥½ï¼Œè·é›¢ä¸Šä¸€ç¯‡ç­†è¨˜åˆéš”äº† 3 å€‹æœˆï¼Œæœ€è¿‘å…¬å¸æœ‰å°ˆæ¡ˆåœ¨å¿™ï¼Œæ²’æ™‚é–“æŠŠä¸Šæ¬¡æåˆ°çš„ Terraform æ‡‰ç”¨ç­†è¨˜å¯«å®Œï¼Œç¾åœ¨ä»–ä¾†æ‹‰ï½ï½ï½ ğŸ˜‚ æˆ‘å€‘é€™æ¬¡çš„ä¸»é¡Œæ˜¯ä½¿ç”¨ Terraform ä¾†å»ºç«‹ Google Compute Engine çš„æ©Ÿå™¨ï¼Œæƒ³çŸ¥é“è¦æ€éº¼ç”¨ä¸€æ®µç¨‹å¼ç¢¼å°±å¯ä»¥å»ºç«‹ã€ä¿®æ”¹ã€åˆªé™¤ Google Compute Engine çš„æ©Ÿå™¨ä¸€å®šè¦ä¾†çœ‹é€™ä¸€ç¯‡ï½æˆ‘å€‘é–‹å§‹å›‰ ğŸ§‘â€ğŸ’»&lt;/p>
&lt;br>
&lt;h2>æ’°å¯« Google Compute Engine tf æª”æ¡ˆ&lt;span class="hx-absolute -hx-mt-20" id="æ’°å¯«-google-compute-engine-tf-æª”æ¡ˆ">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab-google-compute-engine-tf-%e6%aa%94%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç›¸ä¿¡å¤§å®¶æœ‰å…ˆçœ‹å®Œä¸Šä¸€ç¯‡ &lt;a href="https://blog.pin-yi.me/terraform/" target="_blank" rel="noopener">ä»€éº¼æ˜¯ IaC ? Terraform åˆæ˜¯ä»€éº¼ï¼Ÿ&lt;/a> æ‰ä¾†çœ‹é€™ä¸€ç¯‡çš„å°å§ ğŸ˜ï¼Œå°æ–¼ Terraform çš„ç¨‹å¼æ¶æ§‹åŠæŒ‡ä»¤ï¼Œæˆ‘å€‘é€™é‚Šå°±ä¸å¤šåšä»‹ç´¹ï¼Œæˆ‘å€‘ç›´æ¥ä¾†çœ‹ç¨‹å¼è¦æ€éº¼å¯«ï½(ç¨‹å¼ç¢¼ä¸»è¦æ˜¯åƒè€ƒ&lt;a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance" target="_blank" rel="noopener">å®˜æ–¹æ–‡ä»¶&lt;/a>ï¼ŒåŠ ä¸Šä¸€äº›å…¶ä»–çš„è¨­å®šä¾†åšä»‹ç´¹ï¼Œç¨‹å¼ç¢¼ä¹ŸæœƒåŒæ­¥åˆ° Github ï¼Œéœ€è¦çš„ä¹Ÿå¯ä»¥å» Clone ä¾†ä½¿ç”¨æ­ï¼ &lt;a href="https://github.com/880831ian/terraform-gce" target="_blank" rel="noopener">Github ç¨‹å¼ç¢¼é€£çµ&lt;/a> )&lt;/p>
&lt;br>
&lt;p>å°æé†’ï¼šç”±æ–¼ç¨‹å¼ç¢¼è¼ƒé•·ï¼Œæˆ‘å°‡ä»–æ‹†é–‹ä¾†èªªæ˜ ğŸ’–&lt;/p>
&lt;br>
&lt;h3>é¸æ“‡ä¾›æ‡‰è€…ä»¥åŠå°æ‡‰çš„å°ˆæ¡ˆ&lt;span class="hx-absolute -hx-mt-20" id="é¸æ“‡ä¾›æ‡‰è€…ä»¥åŠå°æ‡‰çš„å°ˆæ¡ˆ">&lt;/span>
&lt;a href="#%e9%81%b8%e6%93%87%e4%be%9b%e6%87%89%e8%80%85%e4%bb%a5%e5%8f%8a%e5%b0%8d%e6%87%89%e7%9a%84%e5%b0%88%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">provider&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;gcp-20210526-001&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç”±æ–¼æˆ‘å€‘è¦å»ºç«‹çš„ Google Compute Engine æ˜¯ç”± Google æ‰€æä¾›çš„ api ä¾†å»ºç«‹çš„ï¼Œæ‰€ä»¥ä¸€é–‹å§‹è¦å…ˆè¨­å®šå¥½æä¾›è€…çš„åç¨± google ä»¥åŠæˆ‘å€‘è¦åœ¨å“ªä¸€å€‹ GCP çš„å°ˆæ¡ˆ ID&lt;/p>
&lt;br>
&lt;h3>resource è¨­å®š&lt;span class="hx-absolute -hx-mt-20" id="resource-è¨­å®š">&lt;/span>
&lt;a href="#resource-%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ¥ä¸‹ä¾†çš„è¨­å®šéƒ½æœƒæ”¾åœ¨ä»¥ä¸‹çš„ google_compute_instance resource å…§ï¼Œç‚ºäº†æ–¹ä¾¿ä»‹ç´¹ï¼Œå°±ä¸æœƒæ¨™æ˜ google_compute_instanceï¼Œè©³ç´°å®Œæ•´ç¨‹å¼ç¢¼è«‹åƒè€ƒ GitLab &lt;a href="https://github.com/880831ian/terraform-gce" target="_blank" rel="noopener">Github ç¨‹å¼ç¢¼é€£çµ&lt;/a>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_instance&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;default&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h4>åŸºæœ¬è¨­å®š&lt;span class="hx-absolute -hx-mt-20" id="åŸºæœ¬è¨­å®š">&lt;/span>
&lt;a href="#%e5%9f%ba%e6%9c%ac%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;æˆ‘æ˜¯ test æ©Ÿå™¨&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;n2-standard-8&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">tags&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">labels&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">env&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">deletion_protection&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;true&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>nameï¼šGCE è¦æ±‚è³‡æºçš„å”¯ä¸€åç¨±ã€‚å¦‚æœæœ‰æ›´æ”¹æ­¤é …æœƒç›´æ¥å¼·åˆ¶å‰µå»ºçš„æ–°è³‡æº &lt;font color='red'>(å¿…å¡«)&lt;/font>&lt;/li>
&lt;li>descriptionï¼šå°æ­¤è³‡æºçš„ç°¡å–®èªªæ˜ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>machine_typeï¼šè¦å‰µå»ºçš„æ©Ÿå™¨é¡å‹ &lt;font color='red'>(å¿…å¡«)&lt;/font>&lt;/li>
&lt;li>zoneï¼šå‰µå»ºæ©Ÿå™¨çš„æ‰€åœ¨å€åŸŸï¼Œè‹¥æ²’æœ‰å¡«å¯«ï¼Œå‰‡æœƒä½¿ç”¨æä¾›è€…çš„å€åŸŸ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>tagsï¼šé™„åŠ åˆ°å¯¦é«”çš„ç¶²è·¯æ¨™ç±¤åˆ—è¡¨ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>labelsï¼šä¸€çµ„åˆ†é…çµ¦ disk çš„ key/value æ¨™ç±¤ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>deletion_protectionï¼šåˆªé™¤ä¿è­·ï¼Œé è¨­æ˜¯ &lt;code>false&lt;/code>ï¼Œç•¶æˆ‘å€‘ä½¿ç”¨ &lt;code>terraform destroy&lt;/code> åˆªé™¤ GCE æ™‚ï¼Œå¿…é ˆå…ˆæ”¹æˆ &lt;code>false&lt;/code>ï¼Œæ‰å¯ä»¥åˆªé™¤ï¼Œå¦å‰‡æœƒç„¡æ³•åˆªé™¤ä¸” Terraform é‹è¡Œä¹Ÿæœƒå¤±æ•—ï¼Œç®—æ˜¯ä¸€å€‹ä¿è­·æ©Ÿåˆ¶ï¼Œå¾Œé¢å†åˆªé™¤ Google Compute Engine æ™‚æœƒæ¸¬è©¦ç•«é¢ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>å•Ÿå‹• disk è¨­å®š&lt;span class="hx-absolute -hx-mt-20" id="å•Ÿå‹•-disk-è¨­å®š">&lt;/span>
&lt;a href="#%e5%95%9f%e5%8b%95-disk-%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">initialize_params&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;debian-cloud/debian-10-buster-v20210512&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;pd-balanced&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">size&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;50&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>imageï¼šåˆå§‹åŒ–æ­¤ disk çš„ image &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>typeï¼šGCE disk é¡å‹ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>sizeï¼šimage å¤§å°ï¼Œå·² &lt;code>GB&lt;/code> ç‚ºå–®ä½ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œå°‡æœƒç¹¼æ‰¿å…¶åˆå§‹åŒ– disk çš„ image å¤§å° &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>ç¶²è·¯è¨­å®š&lt;span class="hx-absolute -hx-mt-20" id="ç¶²è·¯è¨­å®š">&lt;/span>
&lt;a href="#%e7%b6%b2%e8%b7%af%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network_interface&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;projects/rd-gateway/global/networks/rd-common&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">subnetwork&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;projects/rd-gateway/regions/asia-east1/subnetworks/rd-common-asia-east1-pid-cicd&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">access_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">nat_ip&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>networkï¼šè¨­å®šé™„åŠ åˆ°çš„ç¶²è·¯åç¨±æˆ–æ˜¯ self_link &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>subnetworkï¼šè¨­å®šé™„åŠ åˆ°çš„å­ç¶²è·¯åç¨±æˆ–æ˜¯ self_link &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>nat_ipï¼šå¦‚æœæƒ³è¦æœ‰å¤–ç¶²çš„ ipï¼Œå¿…é ˆåŠ ä¸Šæ­¤åƒæ•¸ï¼Œæ‰æœƒç”¢ç”Ÿä¸€çµ„å¤–ç¶² ip &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>æ¬Šé™è¨­å®š&lt;span class="hx-absolute -hx-mt-20" id="æ¬Šé™è¨­å®š">&lt;/span>
&lt;a href="#%e6%ac%8a%e9%99%90%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">service_account&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">email&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;676962704505-compute@developer.gserviceaccount.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">scopes&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;storage-rw&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;logging-write&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;monitoring-write&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;service-control&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;service-management&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;trace&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>emailï¼šæœå‹™å¸³æˆ¶é›»å­éƒµä»¶åœ°å€ã€‚å¦‚æœæœªæä¾›ï¼Œå‰‡ä½¿ç”¨é è¨­çš„ Google Compute Engine æœå‹™å¸³æˆ¶ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>scopesï¼šæœå‹™ç¯„åœåˆ—è¡¨ï¼Œå¯ä»¥&lt;a href="https://cloud.google.com/sdk/gcloud/reference/alpha/compute/instances/set-scopes#--scopes" target="_blank" rel="noopener">é»æˆ‘æŸ¥çœ‹ç¯„åœ&lt;/a>çš„å®Œæ•´åˆ—è¡¨ &lt;font color='red'>(å¿…å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>ä»¥ä¸Šåªæ˜¯æˆ‘åœ¨å»ºç«‹ Google Compute Engine æœ€ç°¡å–®çš„è¨­å®šï¼Œç•¶ç„¶é‚„æœ‰å¾ˆå¤šå…¶ä»–çš„è¨­å®šï¼Œå¯ä»¥åƒè€ƒ &lt;a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance" target="_blank" rel="noopener">registry.terraform.io/providers (google_compute_instance)&lt;/a> è£¡é¢æœ‰æ›´å¤šçš„ resource è¨­å®šï¼Œæœ‰éœ€è¦çš„å°±è‡ªå·±ä¾†çœ‹çœ‹å§ ğŸ§&lt;/p>
&lt;br>
&lt;h2>å»ºç«‹ Google Compute Engine&lt;span class="hx-absolute -hx-mt-20" id="å»ºç«‹-google-compute-engine">&lt;/span>
&lt;a href="#%e5%bb%ba%e7%ab%8b-google-compute-engine" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç•¶æˆ‘å€‘å¯«å¥½ Google Compute Engine tf æª”æ¡ˆå¾Œï¼Œæˆ‘å€‘æ¥è‘—æŠŠä»–å»ºç«‹ï¼Œå»ºç«‹å‰è¦å…ˆä½¿ç”¨ &lt;code>terraform init&lt;/code> ä¾†åšåˆå§‹åŒ–&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/1.png"
alt="terraform init" width="700">&lt;figcaption>
&lt;p>terraform init&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ¥è‘—å¯ä»¥å…ˆä½¿ç”¨ &lt;code>terraform plan&lt;/code> ä¾†æŸ¥çœ‹æˆ‘å€‘çš„è¨­å®šæ˜¯å¦æ˜¯æˆ‘å€‘æƒ³è¦çš„ï¼Œæˆ–æ˜¯ç›´æ¥ç”¨ &lt;code>terraform apply&lt;/code> ä¾†å»ºç«‹ Google Compute Engine&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/2.png"
alt="terraform apply" width="700">&lt;figcaption>
&lt;p>terraform apply&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°æˆåŠŸå»ºç«‹æˆ‘å€‘çš„ test Google Compute Engineï¼ˆä¹Ÿå¯ä»¥çœ‹åˆ°å› ç‚ºæˆ‘å€‘æœ‰é–‹ nat_ip æ‰€ä»¥æœ‰å¤–éƒ¨ IPï¼‰&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/3.png"
alt="GCP Google Compute Engine" width="700">&lt;figcaption>
&lt;p>GCP Google Compute Engine&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>ä¿®æ”¹ Google Compute Engine&lt;span class="hx-absolute -hx-mt-20" id="ä¿®æ”¹-google-compute-engine">&lt;/span>
&lt;a href="#%e4%bf%ae%e6%94%b9-google-compute-engine" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç•¶æˆ‘å€‘ç™¼ç¾æˆ‘å€‘å»ºç«‹çš„ Google Compute Engine åƒæ•¸æœ‰éŒ¯ï¼Œæƒ³è¦ä¿®æ”¹æ™‚ï¼Œæˆ‘å€‘åªéœ€è¦ä¿®æ”¹ç¨‹å¼ç¢¼éƒ¨åˆ†ï¼Œä¸¦é‡æ–°ä¸‹ä¸€æ¬¡ &lt;code>terraform apply&lt;/code> ä¾†ä¿®æ”¹ Google Compute Engineï¼Œå°±æœƒçœ‹åˆ°ä»¥ä¸‹ç•«é¢ (æœ‰äº›è¨­å®šæª”æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œè‹¥ä¿®æ”¹ä»–æœƒé‡æ–°å‰µå»ºä¸€å€‹æ–°çš„æ©Ÿå™¨ï¼Œåƒæ˜¯ name ä¹‹é¡çš„ï¼Œä½¿ç”¨æ™‚è¦å°å¿ƒä¸€é» ğŸ˜‰)&lt;/p>
&lt;p>æˆ‘å€‘æ‹¿å‰›å‰›æåˆ°çš„ nat_ipï¼Œæˆ‘å€‘å…ˆæŠŠå®ƒè¨»è§£æ‰ï¼Œå†ä¸‹ &lt;code>terraform apply&lt;/code> çœ‹çœ‹æ©Ÿå™¨æœ‰ä»€éº¼è®ŠåŒ–ï½&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/4.png"
alt="terraform changed" width="700">&lt;figcaption>
&lt;p>terraform changed&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°ä»–æœƒæç¤ºèªªï¼Œä»–æœƒæ”¹è®Š network_interfaceï¼Œä¹Ÿç§»é™¤ access_config çš„è¨­å®šï¼ŒåŸ·è¡Œå¾Œçš„ Resources ä¹Ÿæœƒå¾å‰›å‰›çš„ added è®Šæˆ changedï¼Œæˆ‘å€‘çœ‹ä¸€ä¸‹ GCP æœ‰æ²’æœ‰æ”¹è®Šï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/5.png"
alt="terraform changed" width="700">&lt;figcaption>
&lt;p>terraform changed&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°åŸæœ¬çš„å¤–éƒ¨ IP ä½ç½®è¢«æ”¹æ‰äº†ï½ &lt;font color='red'>æœ€å¾Œæé†’&lt;/font>ï¼šå¦‚æœæœ‰ä½¿ç”¨ terraform ä¾†ä¿®æ”¹è³‡æºè¨­å®šï¼Œä¸èƒ½å‹•åˆ°ç‰¹å®šçš„é …ç›®ï¼Œä¸ç„¶ä»–çš„æµç¨‹æ˜¯å…ˆæŠŠåŸæœ¬çš„çµ¦åˆªæ‰ï¼Œå†é‡æ–°å»ºç«‹ä¸€å€‹æ–°çš„ï¼ŒåŸæœ¬çš„æ©Ÿå™¨æ²’æœ‰å‚™ä»½ï¼Œæ±è¥¿å°±æœƒä¸è¦‹æ­ï½&lt;/p>
&lt;br>
&lt;h2>åˆªé™¤ Google Compute Engine&lt;span class="hx-absolute -hx-mt-20" id="åˆªé™¤-google-compute-engine">&lt;/span>
&lt;a href="#%e5%88%aa%e9%99%a4-google-compute-engine" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æœ€å¾Œå‡å¦‚æˆ‘å€‘è¦åˆªé™¤ Google Compute Engineï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ terraform çš„æŒ‡ä»¤ä¾†åˆªé™¤ï¼Œæˆ‘å€‘é †ä¾¿ä¾†æ¸¬è©¦ä¸€ä¸‹ä¸Šé¢æœ‰è¨­å®šçš„ deletion_protection åˆªé™¤ä¿è­·æ©Ÿåˆ¶æ˜¯ä¸æ˜¯æ­£å¸¸ï½&lt;/p>
&lt;p>ç›®å‰ deletion_protection é‚„æ˜¯ &lt;code>true&lt;/code>ï¼Œæˆ‘å€‘ç›´æ¥ä¸‹ &lt;code>terraform destroy&lt;/code>ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥åˆªé™¤ Google Compute Engine&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/6.png"
alt="terraform destroy" width="900">&lt;figcaption>
&lt;p>terraform destroy&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°ä»–æœƒæé†’ä½ èªª Deletion Protection is enabledï¼Œå¿…é ˆå…ˆæŠŠä»–æ”¹æˆ &lt;code>false&lt;/code> terraform apply å¾Œæ‰å¯ä»¥åˆªé™¤ï½&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/7.png"
alt="æ”¹æˆ false åœ¨ä¸‹ terraform apply" width="900">&lt;figcaption>
&lt;p>æ”¹æˆ false åœ¨ä¸‹ terraform apply&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç¾åœ¨ deletion_protection æ˜¯ &lt;code>false&lt;/code>ï¼Œæˆ‘å€‘å°±å¯ä»¥ä¸‹ &lt;code>terraform destroy&lt;/code> ä¾†åˆªé™¤ Google Compute Engine ğŸ”ª&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/8.png"
alt="terraform destroy" width="700">&lt;figcaption>
&lt;p>terraform destroy&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-gce/9.png"
alt="Google Compute Engine åˆªé™¤ä¸­&amp;amp;hellip;" width="500">&lt;figcaption>
&lt;p>Google Compute Engine åˆªé™¤ä¸­&amp;hellip;&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä»¥ä¸Šå°±æ˜¯ç°¡å–®çš„ä½¿ç”¨ Terraform å»ºç«‹ Google Compute Engine ä»‹ç´¹å›‰ï½æ­¡è¿å¤§å®¶ç•™è¨€æŒ‡æ•™ï¼Œæ˜å¤©çš„æ–‡ç« æ˜¯ä»‹ç´¹å¦‚ä½•ä½¿ç”¨ Terraform å»ºç«‹ GKE ğŸ’•&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>registry.terraform.io/providers (google_compute_instance)ï¼š&lt;a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance" target="_blank" rel="noopener">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance&lt;/a>&lt;/p></description></item><item><title>ä½¿ç”¨ Terraform å»ºç«‹ Google Kubernetes Engine</title><link>https://pin-yi.me/blog/terraform/terraform-gke/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/terraform/terraform-gke/</guid><description>
&lt;p>æˆ‘å€‘æ¥çºŒæ˜¨å¤©çš„å»ºç«‹ Google Kubernetes Engine æ–‡ç« ï¼Œä»Šå¤©è¦ä¾†ä»‹ç´¹çš„æ˜¯å¦‚ä½•ç”¨ Terraform å»ºç«‹ Google Kubernetes Engineï¼Œç”±æ–¼ä½¿ç”¨ terraform å»å»ºç«‹ã€ä¿®æ”¹ã€åˆªé™¤çš„æŒ‡ä»¤å¤§å®¶æ‡‰è©²éƒ½æ¸…æ¥šäº†ï¼Œé‚£æˆ‘ä»Šå¤©çš„æ–‡ç« å°±ä¸åœ¨å¤šèªªï¼Œç›´æ¥ä¾†ä»‹ç´¹ä¸€ä¸‹è¦æ€éº¼æ’°å¯« Google Kubernetes Engine tf æª”æ¡ˆ ğŸ˜&lt;/p>
&lt;br>
&lt;h2>æ’°å¯« Google Kubernetes Engine tf æª”æ¡ˆ&lt;span class="hx-absolute -hx-mt-20" id="æ’°å¯«-google-kubernetes-engine-tf-æª”æ¡ˆ">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab-google-kubernetes-engine-tf-%e6%aa%94%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç¨‹å¼ç¢¼æœƒåŒæ­¥åˆ° Github ï¼Œéœ€è¦çš„ä¹Ÿå¯ä»¥å» Clone ä¾†ä½¿ç”¨æ­ï¼ &lt;a href="https://github.com/880831ian/terraform-gke" target="_blank" rel="noopener">Github ç¨‹å¼ç¢¼é€£çµ&lt;/a>ï¼Œå°æé†’ï¼šç”±æ–¼ç¨‹å¼ç¢¼è¼ƒé•·ï¼Œæˆ‘å°‡ä»–æ‹†é–‹ä¾†èªªæ˜ ğŸ’–&lt;/p>
&lt;p>ç”±æ–¼ç­‰ç­‰ç¨‹å¼ç¢¼è¼ƒé•·ï¼Œæ‰€ä»¥æˆ‘åœ¨å‰é¢é€™é‚Šå…ˆåšèªªæ˜ï¼ŒGKE çš„çµæ§‹æ˜¯ å¢é›†(cluster) &amp;gt; ç¯€é»æ± (node_pool) &amp;gt; ç¯€é»(node)ï¼Œæœ¬æ¬¡çš„ä»‹ç´¹ç¯„ä¾‹ï¼Œæœƒæœ‰ä¸€å€‹å¢é›†è£¡é¢æœ‰ä¸€å€‹ç¯€é»æ± ï¼Œç¯€é»æ± è£¡é¢æœ‰ 6 å€‹ç¯€é»æ•¸é‡ï¼Œç¯„ä¾‹è£¡é¢æœƒåŠ ä¸Šæˆ‘æ¯”è¼ƒå¸¸ç”¨åˆ°çš„ä¸€äº›è¨­å®šï¼Œä»¥åŠä¸€äº›æ–‡ä»¶è£¡é¢çš„ç”¨æ³•ï¼Œå¤§å®¶å¯ä»¥ä¾ç…§è‡ªå·±çš„éœ€æ±‚ä¾†ä½¿ç”¨åƒæ•¸ï¼š&lt;/p>
&lt;br>
&lt;h3>é™åˆ¶ä½¿ç”¨çš„ç‰ˆæœ¬&lt;span class="hx-absolute -hx-mt-20" id="é™åˆ¶ä½¿ç”¨çš„ç‰ˆæœ¬">&lt;/span>
&lt;a href="#%e9%99%90%e5%88%b6%e4%bd%bf%e7%94%a8%e7%9a%84%e7%89%88%e6%9c%ac" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨ä¸Šä¸€ç¯‡ &lt;a href="https://pin-yi.me/terraform-gce/" target="_blank" rel="noopener">ä½¿ç”¨ Terraform å»ºç«‹ Google Compute Engine&lt;/a>ï¼Œæˆ‘å€‘çŸ¥é“ Terraform å…¶å¯¦å°±æ˜¯å°æ‡‰çš„æä¾›å•†ï¼Œæä¾›å°æ‡‰çš„ api ä¾†è®“æˆ‘å€‘å¯ä»¥ç”¨ terraform å»å»ºç½®å¾ˆå¤š IaCï¼Œä½†ä¾›æ‡‰å•†æä¾›çš„ api æœƒéš¨è‘—ç‰ˆæœ¬è€Œæœ‰æ‰€æ›´å‹•ï¼Œå¯èƒ½æ›äº†ä¸€å€‹ç‰ˆæœ¬ï¼ŒåŸæœ¬å¯ä»¥ä½¿ç”¨çš„ resource åƒæ•¸å°±æœƒæœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åœ¨ä¸€é–‹å§‹ï¼Œå…ˆè¨­å®šå¥½é€™éš» tf è¦ä½¿ç”¨çš„ä¾›æ‡‰å•†åŠå°æ‡‰çš„ç‰ˆæœ¬ï¼Œå¯ä»¥åƒè€ƒä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">required_providers&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">google&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;hashicorp/google&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;~&amp;gt; 4.38.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘æŠŠ google é€™å€‹ä¾›æ‡‰å•†è£¡é¢è¨­å®šå¥½ä»–çš„ source ä»¥åŠ versionï¼Œé€™æ¨£å°±ç®—ä¹‹å¾Œ goolge æœ‰æ›´æ–° terraform çš„ apiï¼Œæˆ‘å€‘ä¹Ÿä¸éœ€è¦å»æ›´æ›åƒæ•¸å°±å¯ä»¥ä½¿ç”¨äº†ï½&lt;/p>
&lt;br>
&lt;h3>é¸æ“‡ä¾›æ‡‰è€…ä»¥åŠå°æ‡‰çš„å°ˆæ¡ˆ&lt;span class="hx-absolute -hx-mt-20" id="é¸æ“‡ä¾›æ‡‰è€…ä»¥åŠå°æ‡‰çš„å°ˆæ¡ˆ">&lt;/span>
&lt;a href="#%e9%81%b8%e6%93%87%e4%be%9b%e6%87%89%e8%80%85%e4%bb%a5%e5%8f%8a%e5%b0%8d%e6%87%89%e7%9a%84%e5%b0%88%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">provider&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;project&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é™¤äº†å¯ä»¥ä½¿ç”¨å°ˆæ¡ˆ ID ä»¥å¤–ï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å°ˆæ¡ˆçš„åç¨±æ‹‰ ğŸ¥³&lt;/p>
&lt;br>
&lt;h3>resource è¨­å®š&lt;span class="hx-absolute -hx-mt-20" id="resource-è¨­å®š">&lt;/span>
&lt;a href="#resource-%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;h4>google_container_cluster&lt;span class="hx-absolute -hx-mt-20" id="google_container_cluster">&lt;/span>
&lt;a href="#google_container_cluster" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_container_cluster&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;cluster&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">location&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-southeast1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">min_master_version&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;1.22.12-gke.300&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;projects/gcp-202011216-001/global/networks/XXXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">subnetwork&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;projects/gcp-202011216-001/regions/asia-southeast1/subnetworks/XXXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default_max_pods_per_node&lt;/span> = &lt;span style="color:#ae81ff">64&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">remove_default_node_pool&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">initial_node_count&lt;/span> = &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">enable_intranode_visibility&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ip_allocation_policy&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">cluster_secondary_range_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;gke-pods&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">services_secondary_range_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;gke-service&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">resource_labels&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;env&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">addons_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">http_load_balancing&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">disabled&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">horizontal_pod_autoscaling&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">disabled&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network_policy_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">disabled&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">master_auth&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">client_certificate_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">issue_client_certificate&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">private_cluster_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">enable_private_endpoint&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">enable_private_nodes&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">master_ipv4_cidr_block&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;172.16.0.0/28&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">logging_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">enable_components&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;SYSTEM_COMPONENTS&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;WORKLOADS&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">monitoring_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">enable_components&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;SYSTEM_COMPONENTS&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">node_config&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;e2-medium&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">disk_size_gb&lt;/span> = &lt;span style="color:#ae81ff">100&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">disk_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;pd-standard&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;COS_CONTAINERD&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">oauth_scopes&lt;/span> = [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/devstorage.read_only&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/logging.write&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/monitoring&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/servicecontrol&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/service.management.readonly&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/trace.append&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">metadata&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">disable&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#a6e22e">legacy&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#a6e22e">endpoints&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;true&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>nameï¼šå¢é›†çš„åç¨±ï¼Œåœ¨é€™å€‹å°ˆæ¡ˆåŠå€åŸŸå”¯ä¸€åç¨± &lt;font color='red'>(å¿…å¡«)&lt;/font>&lt;/li>
&lt;li>locationï¼šè¦å°‡æ­¤å¢é›†å»ºç«‹åœ¨å“ªä¸€å€‹å€åŸŸ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>min_master_versionï¼šmaster çš„æœ€ä½ç‰ˆæœ¬ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>networkï¼šå¢é›†é€£æ¥åˆ°çš„ Google Compute Engine ç¶²çµ¡çš„åç¨±æˆ– self_link &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>subnetworkï¼šå•Ÿå‹•å¢é›†çš„ Google Compute Engine å­ç¶²çš„åç¨±æˆ– self_link &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>default_max_pods_per_nodeï¼šæ­¤å¢é›†ä¸­æ¯å€‹ç¯€é»çš„é è¨­æœ€å¤§ pod æ•¸ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>remove_default_node_poolï¼šå¦‚æœè¨­å®šç‚º &lt;code>true&lt;/code>ï¼Œå‰‡åœ¨å‰µå»ºå¢é›†æ™‚æœƒå¹«æˆ‘å€‘åˆªé™¤é è¨­çš„ç¯€é»æ± ã€‚æœƒä½¿ç”¨åˆ°é€™å€‹çš„åŸå› æ˜¯å› ç‚º terraform æ²’è¾¦æ³•ä¿®æ”¹é è¨­ç¯€é»æ± çš„åç¨±ï¼Œæ‰€ä»¥æˆ‘çš„åšæ³•æ˜¯ï¼Œæœƒæ–°å¢è¦çš„ç¯€é»æ± ï¼Œåœ¨ä½¿ç”¨é€™å€‹åƒæ•¸æŠŠé è¨­çš„çµ¦åˆªæ‰&lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>initial_node_countï¼šè¦åœ¨æ­¤å¢é›†çš„é è¨­ç¯€é»æ± ä¸­å‰µå»ºçš„ç¯€é»æ•¸ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>enable_intranode_visibilityï¼šæ˜¯å¦ç‚ºæ­¤å¢é›†å•Ÿç”¨äº†ç¯€é»å…§å¯è¦‹æ€§ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>ip_allocation_policyï¼šç‚º VPC åŸç”Ÿå¢é›†åˆ†é…å¢é›† IP &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>resource_labelsï¼šæ‡‰ç”¨æ–¼å¢é›†çš„ GCE è³‡æºæ¨™ç±¤ key/value &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>addons_config
&lt;ul>
&lt;li>http_load_balancingï¼šæ˜¯å¦è¦å•Ÿç”¨ HTTP (L7) çš„è² è¼‰å¹³è¡¡ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>horizontal_pod_autoscalingï¼šæ˜¯å¦è¦å•Ÿç”¨ HPA æ°´å¹³ Pod è‡ªå‹•æ“´å±• &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>network_policy_configï¼šæ˜¯å¦è¦å•Ÿç”¨ç¶²è·¯ç­–ç•¥ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>master_auth
&lt;ul>
&lt;li>client_certificate_configï¼šæ˜¯å¦è¦å•Ÿç”¨è©²å¢é›†å®¢æˆ¶ç«¯è­‰æ›¸æˆæ¬Š &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>private_cluster_config
&lt;ul>
&lt;li>enable_private_endpointï¼šæ˜¯å¦è¦å•Ÿç”¨å¢é›†å°ˆç”¨çš„ç§æœ‰ç«¯é»ï¼Œç¦æ­¢å…¬å…±ç«¯é»çš„è¨ªå• &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>enable_private_nodesï¼šæ˜¯å¦è¦å•Ÿç”¨ç§æœ‰å¢é›†åŠŸèƒ½ï¼Œåœ¨å¢é›†å‰µå»ºç§æœ‰ç«¯é» &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>master_ipv4_cidr_blockï¼šç§æœ‰ç«¯é» IP ç¯„åœ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>logging_configï¼šå¢é›†çš„æ—¥èªŒè¨˜éŒ„é…ç½®
&lt;ul>
&lt;li>enable_components (å…¬é–‹æ—¥èªŒçš„ GKE çµ„ä»¶) è¨­å®šï¼ŒåŒ…å«ï¼š&lt;code>SYSTEM_COMPONENTS&lt;/code>ã€&lt;code>APISERVER&lt;/code>ã€&lt;code>CONTROLLER_MANAGER&lt;/code>ã€&lt;code>SCHEDULER&lt;/code>ã€&lt;code>WORKLOADS&lt;/code> &lt;font color='red'>(å¿…å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>monitoring_configï¼šå¢é›†çš„ç›£æ§é…ç½®
&lt;ul>
&lt;li>enable_components (GKE çµ„ä»¶å…¬é–‹æŒ‡æ¨™) è¨­å®šï¼ŒåŒ…å«ï¼š&lt;code>SYSTEM_COMPONENTS&lt;/code>ã€&lt;code>APISERVER&lt;/code>ã€&lt;code>CONTROLLER_MANAGER&lt;/code>ã€&lt;code>SCHEDULER&lt;/code> &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>node_configï¼šå‰µå»ºé è¨­ç¯€é»æ± åƒæ•¸
&lt;ul>
&lt;li>machine_typeï¼šGoogle Compute Engine æ©Ÿå™¨é¡å‹ï¼Œé è¨­ç‚º &lt;code>e2-medium&lt;/code> &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>disk_size_gbï¼šæ¯å€‹ç¯€é»çš„ disk å¤§å°ï¼Œä»¥ GB ç‚ºå–®ä½ã€‚å…è¨±æœ€å°ç‚º 10 GBï¼Œé è¨­ç‚º 100 GB &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>disk_typeï¼šé€£æ¥åˆ°æ¯å€‹ç¯€é»çš„ disk é¡å‹ï¼Œæœ‰ &lt;code>pd-standard&lt;/code>ã€&lt;code>pd-balanced&lt;/code> æˆ– &lt;code>pd-ssd&lt;/code>ï¼Œé è¨­ç‚º &lt;code>pd-standard&lt;/code> &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>image_typeï¼šå‰µå»ºæ–°ç¯€é»æ± å¾Œ NAP ä½¿ç”¨çš„é è¨­ image é¡å‹ã€‚è©²å€¼å¿…é ˆæ˜¯ [&lt;code>COS_CONTAINERD&lt;/code>ã€&lt;code>COS&lt;/code>ã€&lt;code>UBUNTU_CONTAINERD&lt;/code>ã€&lt;code>UBUNTU&lt;/code>] ä¹‹ä¸€ã€‚&lt;code>COS&lt;/code> å’Œ &lt;code>UBUNTU&lt;/code> å·²æ–¼ GKE 1.24 æ£„ç”¨ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>oauth_scopesï¼šåœ¨é è¨­æœå‹™å¸³æˆ¶ä¸‹çš„æ‰€æœ‰ç¯€é»è™›æ“¬æ©Ÿä¸Šå¯ç”¨çš„ä¸€çµ„ Google API ç¯„åœã€‚ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>metadataï¼šåˆ†é…çµ¦å¢é›†ä¸­å¯¦ä¾‹çš„ key/value &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>google_container_node_pool&lt;span class="hx-absolute -hx-mt-20" id="google_container_node_pool">&lt;/span>
&lt;a href="#google_container_node_pool" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_container_node_pool&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;aaa&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;aaa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;project&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">location&lt;/span> = &lt;span style="color:#a6e22e">google_container_cluster&lt;/span>.&lt;span style="color:#a6e22e">cluster&lt;/span>.&lt;span style="color:#a6e22e">location&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">cluster&lt;/span> = &lt;span style="color:#a6e22e">google_container_cluster&lt;/span>.&lt;span style="color:#a6e22e">cluster&lt;/span>.&lt;span style="color:#a6e22e">name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">node_count&lt;/span> = &lt;span style="color:#ae81ff">6&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">node_locations&lt;/span> = [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">google_container_cluster&lt;/span>.&lt;span style="color:#a6e22e">cluster&lt;/span>.&lt;span style="color:#a6e22e">location&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">node_config&lt;/span> {&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"> # çœç•¥ ... èˆ‡ä¸Šé¢çš„ google_container_cluster ç›¸åŒ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">management&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">auto_repair&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">auto_upgrade&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">upgrade_settings&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">max_surge&lt;/span> = &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">max_unavailable&lt;/span> = &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>nameï¼šç¯€é»æ± åç¨± &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>projectï¼šå‰µå»ºç¯€é»æ± çš„é …ç›® ID &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>locationï¼šå¢é›†æ‰€åœ¨ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨è³‡æºåç¨± (google_container_node_pool) +å‘½å (cluster) + åƒæ•¸ (location) ä¾†ä»£è¡¨ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>clusterï¼šå¢é›†åç¨±ï¼Œå¯ä»¥ä½¿ç”¨è³‡æºåç¨± (google_container_node_pool) +å‘½å (cluster) + åƒæ•¸ (name) ä¾†ä»£è¡¨ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>node_countï¼šç¯€é»æ•¸é‡ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>node_locationsï¼šç¯€é»å€åŸŸ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>managementï¼šç¯€é»ç®¡ç†é…ç½®
&lt;ul>
&lt;li>auto_repairï¼šæ˜¯å¦è¦è‡ªå‹•ä¿®å¾© &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>auto_upgradeï¼šæ˜¯å¦è¦è‡ªå‹•å‡ç´š &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>upgrade_settingsï¼šæŒ‡å®šç¯€é»å‡ç´šè¨­å®šåŠæ–¹å¼
&lt;ul>
&lt;li>max_surgeï¼šå‡ç´šæœŸé–“å¯ä»¥æ·»åŠ åˆ°ç¯€é»æ± çš„é¡å¤–ç¯€é»æ•¸ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;li>max_unavailableï¼šå‡ç´šæœŸé–“å¯ä»¥åŒæ™‚ä¸å¯ç”¨çš„ç¯€é»æ•¸ &lt;font color='blue'>(é¸å¡«)&lt;/font>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šè¨­å®šéƒ½æ˜¯é¸å¡«çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦åƒæˆ‘ç¯„ä¾‹ä¸€æ¨£ï¼ŒæŠŠæ‰€æœ‰çš„éƒ½æ‰“å‡ºä¾†ï¼Œå¯ä»¥åƒè€ƒå®˜æ–¹æ–‡ä»¶ï¼Œå°‡è‡ªå·±æƒ³è¦çš„è¨­å®šå¯«å‡ºä¾†ï¼Œä¸¦æ³¨æ„å…¶ä»–åƒæ•¸çš„é è¨­å€¼æ˜¯å¤šå°‘ï¼Œå°±å¯ä»¥æ‰“é€ å±¬æ–¼è‡ªå·±çš„ Terraform å»ºç«‹ Google Kubernetes Engine IaC ç¨‹å¼å›‰ï½&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>registry.terraform.io/providers (google_container_cluster)ï¼š&lt;a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster" target="_blank" rel="noopener">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster&lt;/a>&lt;/p>
&lt;p>registry.terraform.io/providers (google_container_node_pool)ï¼š&lt;a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool" target="_blank" rel="noopener">https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool&lt;/a>&lt;/p></description></item><item><title>Terraform å¦‚ä½•å¤šäººå…±åŒé–‹ç™¼ (å°‡ tfstate å­˜åœ¨å¾Œç«¯)</title><link>https://pin-yi.me/blog/terraform/terraform-tfstate/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/terraform/terraform-tfstate/</guid><description>
&lt;p>æ­¤ç¯‡æ˜¯æ¥çºŒä¸Šä¸€ç¯‡ &lt;a href="https://pin-yi.me/terraform/" target="_blank" rel="noopener">ä»€éº¼æ˜¯ IaC ? Terraform åˆæ˜¯ä»€éº¼ï¼Ÿ&lt;/a>çš„ Terraform æ–‡ç« ï¼Œæˆ‘å€‘åœ¨ä¸Šä¸€ç¯‡æœ‰æåˆ° &lt;code>terraform apply&lt;/code> å®Œå¾Œï¼Œæœƒå¤šä¸€å€‹æª”æ¡ˆ &lt;code>*.tfstate&lt;/code>ï¼Œé€™å€‹æª”æ¡ˆæ˜¯ç”¨ä¾†å­˜æ”¾æœå‹™ç‹€æ…‹çš„æª”æ¡ˆï¼Œå®ƒåŒ…å«åŸºç¤æ¶æ§‹çš„ç‹€æ…‹å’Œè³‡æºçš„è©³ç´°ä¿¡æ¯ã€‚å‡è¨­å¤§å®¶éƒ½åœ¨è‡ªå·±çš„æœ¬åœ°å» apply åŒä¸€å€‹æœå‹™ï¼Œæœƒå°è‡´æ¯å€‹äººçš„ tfstate æª”æ¡ˆå…§å®¹ä¸åŒï¼Œæœ‰å¯èƒ½å»è¦†è“‹æ‰å…¶ä»–äººå·²ç¶“èª¿æ•´çš„å…§å®¹ï¼Œå› æ­¤æˆ‘å€‘å¿…é ˆå°‡æ­¤ tfstate æª”æ¡ˆå­˜æ”¾åœ¨ä¸€å€‹åœ°æ–¹ï¼Œè®“å¤§å®¶éƒ½å»ä½¿ç”¨åŒä¸€ä»½æª”æ¡ˆä¾†èª¿æ•´è³‡æºã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å¸¸ç”¨çš„å„²å­˜æ–¹å¼æœƒå°‡ tfstate å­˜åœ¨ &lt;code>gitlab&lt;/code> æˆ– &lt;code>gcs&lt;/code> (gcp æ¶æ§‹ç‚ºä¾‹)ï¼Œä»¥ä¸‹æœƒç°¡å–®èªªæ˜è¦å¦‚ä½•æŠŠ tfstate å­˜åˆ°å¾Œç«¯ä»¥åŠå„é é¢çš„åŠŸèƒ½ï¼š&lt;/p>
&lt;br>
&lt;h2>gitlab&lt;span class="hx-absolute -hx-mt-20" id="gitlab">&lt;/span>
&lt;a href="#gitlab" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é‚£æˆ‘å€‘è¦æ€éº¼æŠŠ tfstate å­˜åˆ° gitlab å‘¢ï¼Ÿé¦–å…ˆè·Ÿä¹‹å‰ä¸€æ¨£ï¼Œå…ˆæ–°å¢ &lt;code>provider.tf&lt;/code> ä¾†æ”¾ä¾›æ‡‰å•†çš„ä¾†æºä»¥åŠç‰ˆæœ¬ï¼Œä»¥åŠ &lt;code>main.tf&lt;/code> ä¾†æ”¾ gce ç›¸é—œè¨­å®šï¼Œæœ€å¾Œé‚„è¦å¤šä¸€å€‹ &lt;code>backend.tf&lt;/code> ä¾†æ”¾æˆ‘å€‘è¦å„²å­˜ tfstate çš„ä½ç½®è¨­å®šï¼Œå¦‚ä¸‹ï¼š(&lt;a href="https://github.com/880831ian/terraform-tfstate" target="_blank" rel="noopener">åŒæ­¥åˆ° GitHub éœ€è¦ç¨‹å¼ç¢¼çš„å¯ä»¥å‰å¾€æŸ¥çœ‹&lt;/a>)&lt;/p>
&lt;p>(é€™æ¬¡ç¯„ä¾‹æœƒä½¿ç”¨ gceï¼Œæ­¤é …æœƒéœ€è¦ gitlab å…ˆå•Ÿç”¨ Infrastructure åŠŸèƒ½ä»¥åŠå»ºç«‹è‡ªå·±çš„ gitlab token)&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">provider.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">required_providers&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">google&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;hashicorp/google&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">version&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;~&amp;gt; 4.48.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">main.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">provider&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;XXXXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_instance&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;e2-small&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">labels&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">env&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;11&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">initialize_params&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;debian-cloud/debian-10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network_interface&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;projects/XXXX/global/networks/test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">subnetwork&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;projects/XXXX/regions/asia-east1/subnetworks/testtest&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ul>
&lt;li>backend.tf &amp;laquo; æ–°çš„&lt;/li>
&lt;/ul>
&lt;p>å°ˆæ¡ˆ ID è¦å¯«æˆ‘å€‘æƒ³è¦æ”¾ terraform state çš„ GitLab Project IDï¼Œæœå‹™åç¨±æ˜¯æŒ‡é¡¯ç¤ºåœ¨ GitLab terraform state çš„åç¨±&lt;/p>
&lt;p>gitlab å€‹äºº token æ˜¯æŒ‡å€‹äººå­˜å–æ¬Šæ–ï¼Œå¤§å®¶å†ä¾ç…§è‡ªå·±çš„ä¾†åšè¨­å®š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">backend.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">backend&lt;/span> &lt;span style="color:#e6db74">&amp;#34;http&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">address&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;[Gitlab ç¶²å€]/api/v4/projects/[å°ˆæ¡ˆID]/terraform/state/[æœå‹™åç¨±]&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lock_address&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;[Gitlab ç¶²å€]/api/v4/projects/[å°ˆæ¡ˆID]/terraform/state/[æœå‹™åç¨±]/lock&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">unlock_address&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;[Gitlab ç¶²å€]/api/v4/projects/[å°ˆæ¡ˆID]/terraform/state/[æœå‹™åç¨±]/lock&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">username&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;[Gitlab å¸³è™Ÿ]&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">password&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;[Gitlab å€‹äºº token]&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">lock_method&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;POST&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">unlock_method&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;DELETE&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">retry_wait_min&lt;/span> = &lt;span style="color:#ae81ff">5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ç•¶æˆ‘å€‘æ–°å¢å¥½å¾Œï¼Œå°±è·Ÿä¹‹å‰æ­¥é©Ÿä¸€æ¨£ï¼Œå…ˆ init &amp;gt; plan &amp;gt; apply ä¾†åšæ¸¬è©¦ï¼Œåœ¨ init æ™‚æœƒç™¼ç¾ï¼Œèˆ‡ä¹‹å‰ä¸å¤ªä¸€æ¨£çš„æ˜¯ï¼Œåœ¨ Initializing the backend çš„ä¸‹æ–¹æœ‰å¤šäº†ç¶ è‰²çš„æˆåŠŸè¨­å®šå¾Œç«¯å­—æ¨£ï¼Œä»£è¡¨ä»–ä¹Ÿæœƒå°‡å¾Œç«¯çš„ç›¸é—œè³‡è¨Šå­˜é€² .terraform è³‡æ–™å¤¾ä¸­ï¼Œæ‰€ä»¥æœ‰è®Šæ›´å¾Œç«¯å„²å­˜ä½ç½®ï¼Œè¦è¨˜å¾—é‡æ–° init æ­&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/1.png"
alt="init åˆå§‹åŒ–å¾Œï¼Œæœƒå°‡å¾Œç«¯è³‡è¨Šä¹Ÿå­˜åˆ° .terraform è³‡æ–™å¤¾" width="700">&lt;figcaption>
&lt;p>init åˆå§‹åŒ–å¾Œï¼Œæœƒå°‡å¾Œç«¯è³‡è¨Šä¹Ÿå­˜åˆ° .terraform è³‡æ–™å¤¾&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç•¶æˆ‘å€‘ plan &amp;gt; apply å®Œæˆå¾Œï¼Œå¯ä»¥è§€å¯Ÿä¸€ä¸‹ï¼Œç™¼ç¾åŸæœ¬æœƒç”¢ç”Ÿçš„ terraform.tfstate æª”æ¡ˆæ²’æœ‰å‡ºç¾åœ¨è©²ç›®éŒ„ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/2.png"
alt="apply å®Œï¼Œæ²’æœ‰åœ¨æœ¬åœ°ç”¢ç”Ÿ .tfstate æª”æ¡ˆ" width="700">&lt;figcaption>
&lt;p>apply å®Œï¼Œæ²’æœ‰åœ¨æœ¬åœ°ç”¢ç”Ÿ .tfstate æª”æ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é€™æ™‚å€™ï¼Œæˆ‘å€‘å¯ä»¥åˆ°å‰›å‰›åœ¨ä¸Šé¢è¨­å®šçš„å°ˆæ¡ˆ ID å…§çš„æœ‰ä¸€å€‹ Infrastructure / Terraformï¼Œè£¡é¢å°±æœƒå­˜æ”¾ Terraform state æª”æ¡ˆï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/3.png"
alt="gitlab/Infrastructure/Terraform" width="500">&lt;figcaption>
&lt;p>gitlab/Infrastructure/Terraform&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æœƒé¡¯ç¤ºç‹€æ…‹åç¨±ã€æ›´æ–°è³‡è¨Šã€ä»¥åŠ Actions ç­‰æ¬„ä½ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/4.png"
alt="gitlab terraform tfstate ç¶²é " width="1000">&lt;figcaption>
&lt;p>gitlab terraform tfstate ç¶²é &lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>åŠŸèƒ½éƒ¨åˆ†å¯ä»¥çœ‹å¾Œé¢çš„ Actions æ¬„ä½åº•ä¸‹æœ‰ä¸‰å€‹é»é»ï¼Œå¯ä»¥ä¸‹è¼‰å°æ‡‰çš„ tfstate æª”æ¡ˆã€Lock è®“å…¶ä»–äººä¸èƒ½å°æ­¤é€²è¡Œ applyï¼Œæˆ–æ˜¯åˆªé™¤æ­¤ tfstate æª”æ¡ˆç­‰&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/5.png"
alt="gitlab terraform tfstate åŠŸèƒ½èªªæ˜" width="500">&lt;figcaption>
&lt;p>gitlab terraform tfstate åŠŸèƒ½èªªæ˜&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é€™æ¨£æˆ‘å€‘å°±å¯ä»¥é€éåŒä¸€ä»½çš„ tfstate æª”æ¡ˆä¾†åšç®¡ç†ï¼Œä½†æœ‰å€‹å‰ææ˜¯ï¼Œä¹‹å¾Œå°è©²è³‡æºçš„è®Šæ›´éƒ½åªèƒ½ä½¿ç”¨ tfï¼Œå¦‚æœé‚„æœ‰ç”¨ WEB UI å»èª¿æ•´ï¼Œå°±æœƒé‡åˆ°ç·šä¸Šæœå‹™èˆ‡ tfstate å„²å­˜ç‹€æ…‹ä¸åŒçš„å•é¡Œã€‚&lt;/p>
&lt;br>
&lt;h3>Lock&lt;span class="hx-absolute -hx-mt-20" id="lock">&lt;/span>
&lt;a href="#lock" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é‚£ç•¶æˆ‘å€‘å·²ç¶“æœ‰äº†å…±åŒå„²å­˜çš„åœ°æ–¹ï¼Œä¹Ÿæºé€šå¥½ï¼Œä¸æœƒä½¿ç”¨ WEB UI å»èª¿æ•´ï¼Œä½†å¦‚æœæœ‰å…©å€‹äººåŒæ™‚å»ä¸‹ apply çš„è©±ï¼Œç¬¬ä¸€å€‹äººçš„ apply é‚„åœ¨åŸ·è¡Œï¼Œå¾Œé¢é‚£å€‹äººçš„ apply æ˜¯ä¸æ˜¯å°±æœƒè“‹æ‰å‰ä¸€å€‹äººçš„è¨­å®šå‘¢ï¼Ÿ&lt;/p>
&lt;p>æ‰€ä»¥ Terraform åœ¨ 0.14 ç‰ˆæœ¬æ¨å‡ºäº† Lock åŠŸèƒ½ï¼Œç•¶æœ‰äººåœ¨ plan or apply çš„æ™‚å€™ï¼Œæˆ‘å€‘å»æŸ¥çœ‹ gitlab Terraform stateï¼Œæœƒçœ‹åˆ°æˆ‘å€‘çš„ tfstate æª”æ¡ˆæœƒè¢« Lock èµ·ä¾†&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/6.png"
alt="GitLab Lock é–ä½" width="1000">&lt;figcaption>
&lt;p>GitLab Lock é–ä½&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ­¤æ™‚é™¤äº†ç¬¬ä¸€å€‹æ“ä½œè€…ï¼Œå…¶ä»–äººå†å» plan or apply å°±æœƒå‡ºç¾éŒ¯èª¤ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯èª°æ­£åœ¨ä½¿ç”¨ï¼Œä»¥åŠæ“ä½œçš„å‹•ä½œæ˜¯ plan or apply&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/7.png"
alt="åœ¨ Lock ä¸‹ï¼Œå…¶ä»–äººæ²’è¾¦æ³•å» plan or apply" width="700">&lt;figcaption>
&lt;p>åœ¨ Lock ä¸‹ï¼Œå…¶ä»–äººæ²’è¾¦æ³•å» plan or apply&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>åœ¨ CI æ™‚ï¼Œéœ€è¦åœ¨ plan æ™‚å°±å°‡å®ƒçµ¦ lockï¼Œé¿å…ç¬¬ä¸€å€‹äºº plan å®Œï¼Œæ²’æœ‰åŠæ™‚çš„å»åŸ·è¡Œ applyï¼Œå¾Œä¾†æœ‰å…¶ä»–äººæ¯”ç¬¬ä¸€å€‹äººå…ˆèª¿æ•´äº†è³‡æºï¼Œç¬¬ä¸€å€‹äººå†ä¾†åŸ·è¡Œ applyï¼Œå°±æœƒå°è‡´ç¬¬ä¸€å€‹äºº apply çš„å…§å®¹èˆ‡è‡ªå·±åŸå…ˆçœ‹ plan çš„å…§å®¹æœƒä¸åŒï¼Œä¹Ÿæœ‰å¯èƒ½æœƒå°‡ä¸Šä¸€å€‹äººèª¿æ•´çš„è¨­å®šçµ¦è¦†è“‹ï¼Œç•¶ç¬¬ä¸€å€‹æ“ä½œè€…çµæŸå‹•ä½œå¾Œï¼Œè©² Lock æ‰æœƒè¢«è§£é–ã€‚&lt;/p>
&lt;br>
&lt;p>å…¶ä»– gitlab terraform state è©³ç´°å…§å®¹å¯ä»¥åƒè€ƒï¼š&lt;a href="https://docs.gitlab.com/ee/user/infrastructure/iac/terraform_state.html" target="_blank" rel="noopener">https://docs.gitlab.com/ee/user/infrastructure/iac/terraform_state.html&lt;/a>&lt;/p>
&lt;br>
&lt;h2>gcs&lt;span class="hx-absolute -hx-mt-20" id="gcs">&lt;/span>
&lt;a href="#gcs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>gcs å„²å­˜æ¯”è¼ƒç°¡å–®ä¸€é»ï¼Œå› ç‚ºä»–å°±æ˜¯ä¸€å€‹ bucketï¼Œæ‰€ä»¥é é¢å°±è·Ÿä¸€èˆ¬çš„ gcs ä¸€æ¨£ï¼Œæœƒé¡¯ç¤ºæª”æ¡ˆåç¨±ã€å¤§å°ã€é¡å‹ç­‰ï¼Œå¦‚æœéœ€è¦æŸ¥çœ‹ tfstateï¼Œå¯ä»¥é»æ“Šæœ€å¾Œçš„ä¸‹è¼‰æŒ‰éˆ•ä¾†æŸ¥çœ‹&lt;/p>
&lt;p>é‚£æˆ‘å€‘æ¥è‘—ä½¿ç”¨ä¸Šé¢ gitlab çš„ç¯„ä¾‹æª”æ¡ˆï¼Œåªæ˜¯è¦å°‡ backend.tf å…§å®¹æ”¹ç‚ºä»¥ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">backend.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">backend&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcs&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">bucket&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;pid-terraform-state&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">prefix&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;/aaa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ä¸Šé¢çš„è¨­å®šæ˜¯æŒ‡ï¼Œæˆ‘å€‘å°‡ backend å¾Œç«¯è¨­å®šæ”¹æˆ gcsï¼Œä¸¦ä¸”é¸æ“‡åç‚º pid-terraform-state çš„ bucketï¼Œæ­¤ bucket éœ€è¦å…ˆæ‰‹å‹•å»ºç«‹(å› ç‚º bucket åç¨±æ˜¯å…¨åŸŸä¸é‡è¤‡ï¼Œæ‰€ä»¥ä¸éœ€è¦ç‰¹åˆ¥è¨­å®šå…¶ project_idï¼Œåªè¦æœ‰æ¬Šé™æ­£ç¢ºéƒ½å¯ä»¥è·¨å°ˆæ¡ˆä½¿ç”¨)ï¼Œä»¥åŠæˆ‘å€‘è¦å°‡æ­¤ tfstate å­˜åœ¨ aaa è³‡æ–™å¤¾å…§ã€‚&lt;/p>
&lt;br>
&lt;p>æ¥è‘—æˆ‘å€‘é‡æ–°åˆªé™¤å‰›å‰› gitlab å·²ç”¢ç”Ÿçš„ .terraform/ è·Ÿ .terraform.lock.hcl æª”æ¡ˆï¼Œé‡æ–°ä¸‹ initï¼Œå°±å¯ä»¥åˆ° gcs å°æ‡‰è³‡æ–™å¤¾ä¸‹ï¼Œæ–°å¢äº† defaulte.tfstate æª”æ¡ˆã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/8.png"
alt="ç”¢ç”Ÿ defaulte.tfstate" width="700">&lt;figcaption>
&lt;p>ç”¢ç”Ÿ defaulte.tfstate&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>Lock&lt;span class="hx-absolute -hx-mt-20" id="lock-1">&lt;/span>
&lt;a href="#lock-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘ä¸€æ¨£ä¾†çœ‹ä¸€ä¸‹ gcs çš„ lock æœƒé•·ä»€éº¼æ¨£å­ï¼Œgcs lock æœƒç”¢ç”Ÿä¸€å€‹ default.tflock æª”æ¡ˆï¼Œç”±ä»–å»åˆ¤æ–·ç¾åœ¨æ˜¯å¦æ˜¯ Lock ç‹€æ…‹&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/9.png"
alt="gcs Lock æœƒå‡ºç¾ .tflock æª”æ¡ˆ" width="700">&lt;figcaption>
&lt;p>gcs Lock æœƒå‡ºç¾ .tflock æª”æ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç•¶æœ‰å…¶ä»–äººä¹ŸåŸ·è¡Œ plan or apply å¾Œï¼Œå°±æœƒé¡¯ç¤ºä»¥ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-tfstate/10.png"
alt="gcs Lock å…¶ä»–äººä¸èƒ½æ“ä½œ" width="700">&lt;figcaption>
&lt;p>gcs Lock å…¶ä»–äººä¸èƒ½æ“ä½œ&lt;/p>
&lt;/figcaption>
&lt;/figure></description></item><item><title>å¦‚ä½•å°‡ Terraform æ”¹å¯«æˆ module ?</title><link>https://pin-yi.me/blog/terraform/terraform-module/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/terraform/terraform-module/</guid><description>
&lt;p>ç•¶æˆ‘å€‘è¦ç®¡ç†çš„è³‡æºè¶Šä¾†è¶Šå¤šå¾Œï¼Œæœƒç”¢ç”Ÿå¾ˆå¤šçš„ tf æª”æ¡ˆï¼Œå‡è¨­æˆ‘å€‘ç¾åœ¨æœ‰ä¸‰å€‹ gce æœå‹™ï¼Œæœƒåœ¨ä»¥ä¸‹ä¸‰å€‹ä¸åŒç’°å¢ƒä¸Šé¢é‹ä½œï¼Œæ¯å€‹ç’°å¢ƒéƒ½æœƒæœ‰æˆ‘å€‘ä¹‹å‰å­¸æœƒçš„åŸºæœ¬ tf æª”æ¡ˆ(åŒ…å« provider.tf ã€main.tfã€backend.tf)ï¼Œä¸”å…¶ä¸­çš„ main.tf æª”æ¡ˆå…§æœ‰äº›è¨­å®šæœƒä¸å¤ªä¸€æ¨£ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-filetree hx-mt-6 hx-select-none hx-text-sm hx-text-gray-800 dark:hx-text-gray-300 not-prose">
&lt;div class="hx-inline-block hx-rounded-lg hx-border hx-px-4 hx-py-2 dark:hx-border-neutral-800">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">dev&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">prod&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">qa&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/div>
&lt;/div>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">dev/main.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_instance&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;é¦¬è³½å…‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test-dev&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;e2-small&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">initialize_params&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;debian-cloud/debian-10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">size&lt;/span> = &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.... &lt;span style="color:#960050;background-color:#1e0010">å…¶ä»–çœç•¥ä¸å¯«&lt;/span> ....
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">qa/main.tf (å¤šäº† tags)&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_instance&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;é¦¬è³½å…‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test-qa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;e2-small&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">tags&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;for-qa&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">initialize_params&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;debian-cloud/debian-10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">size&lt;/span> = &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.... &lt;span style="color:#960050;background-color:#1e0010">å…¶ä»–çœç•¥ä¸å¯«&lt;/span> ....
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">prod/main.tf (å¤šäº† labels)&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_instance&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;é¦¬è³½å…‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test-prod&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;e2-small&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">labels&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">aaa&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">bbb&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ccc&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">initialize_params&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;debian-cloud/debian-10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">size&lt;/span> = &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.... &lt;span style="color:#960050;background-color:#1e0010">å…¶ä»–çœç•¥ä¸å¯«&lt;/span> ....
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°ä¸‰å€‹ main.tf æª”æ¡ˆé™¤äº† name ä»¥å¤–ï¼Œåœ¨ qa é‚„å¤šäº† tagsã€prod å¤šäº† labels ç­‰è¨­å®šï¼Œç­‰æ–¼æˆ‘å€‘æœƒä¾ç…§æ¯å€‹ä¸åŒç’°å¢ƒä¸åŒæœå‹™å»å®¢è£½åŒ–ä»–çš„ tf è³‡æºè¨­å®šï¼Œé›–ç„¶éå¸¸ç›´è¦ºï¼Œä½†å¾€å¾Œçš„ç¶­è­·ä»¥åŠèª¿æ•´å»éå¸¸ä¸æ–¹ä¾¿ ( å‡è¨­æˆ‘å€‘ç¾åœ¨è¦å…¨éƒ¨éƒ½åŠ ä¸Š labelsï¼Œå°±å¿…é ˆä¸€å€‹ä¸€å€‹æª¢æŸ¥ä¸¦èª¿æ•´ )ã€‚&lt;/p>
&lt;br>
&lt;p>ç‚ºäº†æ–¹ä¾¿æˆ‘å€‘ç¶­è­·ä»¥åŠé‡è¤‡ä½¿ç”¨ï¼Œå› æ­¤æœ‰äº† moduleï¼Œå¯ä»¥å…ˆå°‡å…¨éƒ¨æœƒä½¿ç”¨åˆ°çš„è¨­å®šå¯«æˆæ¨¡æ¿ï¼Œé€éåƒæ•¸çš„æ–¹å¼å¸¶å…¥å³å¯ï¼Œmodule æœ‰ä»¥ä¸‹å¹¾å€‹å„ªé»ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>é‡è¤‡ä½¿ç”¨æ€§ï¼š module è®“ç¨‹å¼ç¢¼æ›´æ˜“æ–¼é‡è¤‡ä½¿ç”¨ã€‚ç•¶æˆ‘å€‘éœ€è¦åœ¨å¤šå€‹é …ç›®ä¸­ä½¿ç”¨ç›¸åŒçš„åŸºç¤æ¶æ§‹æˆ–é…ç½®æ™‚ï¼Œå¯ä»¥å…ˆå°‡å…¶å°è£ç‚ºä¸€å€‹ moduleã€‚é€™æ¨£ï¼Œæˆ‘å€‘åªéœ€è¦åœ¨ä¸åŒçš„é …ç›®ä¸­å¼•ç”¨ä¸¦èª¿æ•´æ¨¡çµ„çš„åƒæ•¸ï¼Œè€Œä¸éœ€è¦é‡æ–°å¯«æ•´å€‹ tf æª”ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŠ½è±¡åŒ–ï¼šå°‡ Terraform ä»£ç¢¼è½‰æ›ç‚º module å¯ä»¥å°‡è©³ç´°çš„å¯¦ç¾ç´°ç¯€æŠ½è±¡åŒ–ï¼Œåƒ…å¯«å¿…è¦çš„åƒæ•¸ã€‚é€™æ¨£åšå¯ä»¥æé«˜ç¨‹å¼ç¢¼çš„å¯è®€æ€§å’Œå¯ç¶­è­·æ€§ï¼Œä¸¦é™ä½ä½¿ç”¨è€…å­¸ç¿’å’Œä½¿ç”¨çš„é–€æª»ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åƒæ•¸åŒ–é…ç½®ï¼šmodule å¯ä»¥ä½¿ç”¨è¼¸å…¥åƒæ•¸ä¾†æ¥æ”¶ä¸åŒçš„é…ç½®å€¼ã€‚é€™æ„å‘³è‘—æ‚¨å¯ä»¥æ ¹æ“šéœ€è¦å‹•æ…‹æ›´æ”¹æ¨¡çµ„çš„è¡Œç‚ºï¼Œè€Œä¸éœ€è¦ç›´æ¥ä¿®æ”¹æ¨¡çµ„çš„å…§éƒ¨ç¨‹å¼ã€‚é€™ä½¿å¾—é…ç½®æ›´éˆæ´»ä¸¦æ”¯æŒä¸åŒç’°å¢ƒçš„éƒ¨ç½²ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>module ç‰ˆæœ¬æ§åˆ¶ï¼šå°‡ Terraform ç¨‹å¼å°è£ç‚º module å¾Œï¼Œå¯ä»¥ä½¿ç”¨ git å°å…¶é€²è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚å¯ä»¥æ›´è¼•é¬†åœ°å”ä½œå’Œå…±äº« module (å¯ä»¥å°‡ module èˆ‡ Terraform åˆ†åˆ¥å­˜æ”¾ï¼Œä¸¦ä½¿ç”¨å°æ‡‰ tag or åˆ†æ”¯ä¾†åšé–‹ç™¼ )ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;br>
&lt;h2>æª”æ¡ˆèªªæ˜&lt;span class="hx-absolute -hx-mt-20" id="æª”æ¡ˆèªªæ˜">&lt;/span>
&lt;a href="#%e6%aa%94%e6%a1%88%e8%aa%aa%e6%98%8e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;br>
&lt;p>é¦–å…ˆæˆ‘å€‘è¦å…ˆå®šç¾©æˆ‘å€‘çš„ moduleï¼Œæˆ‘å€‘å…ˆå»ºç«‹ä»¥ä¸‹è³‡æ–™å¤¾çµæ§‹ä»¥åŠå°æ‡‰æª”æ¡ˆï¼š(&lt;a href="https://github.com/880831ian/terraform-module" target="_blank" rel="noopener">åŒæ­¥åˆ° GitHub éœ€è¦ç¨‹å¼ç¢¼çš„å¯ä»¥å‰å¾€æŸ¥çœ‹&lt;/a>)&lt;/p>
&lt;p>(å†æ¬¡æé†’ï¼Œæœƒå€åˆ†æª”æ¡ˆåç¨±æ˜¯å› ç‚ºæ–¹ä¾¿èª¿æ•´è·Ÿç¶­è­·ï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒå…¨éƒ¨å¯«åœ¨åŒä¸€å€‹ tf æª”æ¡ˆå…§æ­)&lt;/p>
&lt;br>
&lt;div class="hextra-filetree hx-mt-6 hx-select-none hx-text-sm hx-text-gray-800 dark:hx-text-gray-300 not-prose">
&lt;div class="hx-inline-block hx-rounded-lg hx-border hx-px-4 hx-py-2 dark:hx-border-neutral-800">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">module&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">google_compute_instance&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">outputs.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">variables.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">projects&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">dev&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">prod&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">qa&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/div>
&lt;/div>
&lt;p>module è³‡æ–™å¤¾ï¼šæ”¾æˆ‘å€‘ module è¨­å®š (é€™é‚Šç¯„ä¾‹æ˜¯æ”¾ gce)&lt;/p>
&lt;p>projects è³‡æ–™å¤¾ï¼šæ”¾æˆ‘å€‘ä¸åŒæœå‹™ã€ä¸åŒç’°å¢ƒè¨­å®š (é€™é‚Šç‚ºäº†ç°¡åŒ–ï¼Œç¯„ä¾‹åªä»¥ä¸åŒç’°å¢ƒç‚ºä¾‹)&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">module/google_compute_instance/main.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">provider&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = var.&lt;span style="color:#a6e22e">project_id&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = var.&lt;span style="color:#a6e22e">instance_zone&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_instance&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = var.&lt;span style="color:#a6e22e">instance_name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = var.&lt;span style="color:#a6e22e">machine_type&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">zone&lt;/span> = var.&lt;span style="color:#a6e22e">instance_zone&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">tags&lt;/span> = var.&lt;span style="color:#a6e22e">instance_tags&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">labels&lt;/span> = var.&lt;span style="color:#a6e22e">instance_labels&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">auto_delete&lt;/span> = var.&lt;span style="color:#a6e22e">boot_disk_auto_delete&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">initialize_params&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">image&lt;/span> = var.&lt;span style="color:#a6e22e">boot_disk_image_name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">size&lt;/span> = var.&lt;span style="color:#a6e22e">boot_disk_size&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">dynamic&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attached_disk&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">for_each&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_enabled&lt;/span> &lt;span style="color:#f92672">?&lt;/span> [&lt;span style="color:#ae81ff">1&lt;/span>] &lt;span style="color:#f92672">:&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">device_name&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">mode&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_mode&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_source&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network_interface&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network&lt;/span> = var.&lt;span style="color:#a6e22e">network_name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">subnetwork&lt;/span> = var.&lt;span style="color:#a6e22e">subnetwork_name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">dynamic&lt;/span> &lt;span style="color:#e6db74">&amp;#34;access_config&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">for_each&lt;/span> = var.&lt;span style="color:#a6e22e">nat_ip_enabled&lt;/span> &lt;span style="color:#f92672">?&lt;/span> [&lt;span style="color:#ae81ff">1&lt;/span>] &lt;span style="color:#f92672">:&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">metadata&lt;/span> = var.&lt;span style="color:#a6e22e">metadata&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">enable_display&lt;/span> = var.&lt;span style="color:#a6e22e">enable_display&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">resource_policies&lt;/span> = var.&lt;span style="color:#a6e22e">resource_policies&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">service_account&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">email&lt;/span> = var.&lt;span style="color:#a6e22e">service_account_email&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">scopes&lt;/span> = var.&lt;span style="color:#a6e22e">service_account_scopes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">timeouts&lt;/span> {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">deletion_protection&lt;/span> = var.&lt;span style="color:#a6e22e">deletion_protection&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">allow_stopping_for_update&lt;/span> = var.&lt;span style="color:#a6e22e">allow_stopping_for_update&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æˆ‘å€‘éœ€è¦æŠŠæ‰€æœ‰è¨­å®šçš„å€¼éƒ½æŒ–æ´ï¼Œä½¿ç”¨ var çš„æ–¹å¼ä¾†å¸¶å…¥åƒæ•¸ï¼Œé€™é‚Šè¦æ³¨æ„çš„æ˜¯ç­‰è™Ÿå‰é¢çš„å€¼æˆ–æ˜¯ block åç¨±éƒ½æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œä»–æ˜¯ google å®šç¾©çš„ api è®Šæ•¸ï¼Œä½† var å¾Œçš„åƒæ•¸åç¨±æˆ‘å€‘å¯ä»¥è‡ªè¨‚ (å¾Œé¢ variable.tf æœƒåœ¨è©³ç´°èªªæ˜)ï¼Œé‚£é€™é‚Šæ¯”è¼ƒç‰¹åˆ¥çš„ç”¨æ³•æ˜¯ dynamicï¼Œä»¥ä¸‹èªªæ˜ï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">dynamic&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attached_disk&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">for_each&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_enabled&lt;/span> &lt;span style="color:#f92672">?&lt;/span> [&lt;span style="color:#ae81ff">1&lt;/span>] &lt;span style="color:#f92672">:&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">content&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">device_name&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">mode&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_mode&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = var.&lt;span style="color:#a6e22e">attached_disk_source&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æˆ‘å€‘æœ‰äº› block åªæœ‰åœ¨ç‰¹å®šæœå‹™æ™‚æ‰éœ€ä½¿ç”¨ï¼Œä¾‹å¦‚ä¸Šé¢çš„ attached_disk ä»–æ˜¯ gce å¦å¤–æ›è¼‰å…¶ä»–ç£ç¢Ÿçš„è¨­å®šï¼Œå¦‚æœæœ‰éœ€è¦æˆ‘å€‘æ‰æœƒå¤šè¨­å®šé€™å€‹ blockï¼Œæ²’æœ‰å‰‡ä¸éœ€è¦åŠ ï¼Œå› æ­¤é ˆä½¿ç”¨ dynamic ä¾†å‹•æ…‹ç”¢ç”Ÿ blockï¼Œé€™é‚Šçš„è¨­å®šæ˜¯æˆ‘å€‘è¦åœ¨åƒæ•¸è¦å¸¶å…¥ &lt;code>attached_disk_enabled&lt;/code> ç”¨ &lt;code>for_each&lt;/code> ä¾†åˆ¤æ–·æ˜¯å¦éœ€è¦é€™å€‹ blockï¼Œå¦‚æœæ˜¯ trueï¼Œå°±æœƒç”¢ç”Ÿ &lt;code>attached_disk&lt;/code> blockï¼Œä¸”éœ€è¦è¼¸å…¥ &lt;code>attached_disk_name&lt;/code>ã€&lt;code>attached_disk_mode&lt;/code>ã€&lt;code>attached_disk_source&lt;/code>ã€‚&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">module/google_compute_instance/variables.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;project_id&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCP å°ˆæ¡ˆ ID&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance_name&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE åç¨±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;machine_type&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE é¡å‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance_zone&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE æ‰€åœ¨å€åŸŸ&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance_tags&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = list(&lt;span style="color:#a6e22e">string&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE ç¶²è·¯æ¨™è¨˜&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance_labels&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = map(&lt;span style="color:#a6e22e">string&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE æ¨™ç±¤&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;boot_disk_auto_delete&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">bool&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;æ˜¯å¦åˆªé™¤ instance æ™‚ï¼Œè‡ªå‹•åˆªé™¤é–‹æ©Ÿç£ç¢Ÿ&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;boot_disk_image_name&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE æ˜ åƒæª”åç¨±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;boot_disk_size&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">number&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE é–‹æ©Ÿç£ç¢Ÿå¤§å° (å–®ä½: GB)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attached_disk_enabled&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">bool&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;æ˜¯å¦å•Ÿç”¨é™„åŠ ç£ç¢Ÿ&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attached_disk_name&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE é™„åŠ ç£ç¢Ÿåç¨±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attached_disk_mode&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE é™„åŠ ç£ç¢Ÿæ¨¡å¼&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;READ_ONLY&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">validation&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">condition&lt;/span> = contains([&lt;span style="color:#e6db74">&amp;#34;READ_WRITE&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;READ_ONLY&amp;#34;&lt;/span>], var.&lt;span style="color:#a6e22e">attached_disk_mode&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">error_message&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;ä¸ç¬¦åˆé™„åŠ ç£ç¢Ÿæ¨¡å¼çš„å€¼ï¼Œè«‹è¼¸å…¥ READ_WRITE æˆ– READ_ONLY&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attached_disk_source&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE é™„åŠ ç£ç¢Ÿä¾†æº&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;network_name&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE ç¶²è·¯åç¨±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;subnetwork_name&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE å­ç¶²è·¯åç¨±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;nat_ip_enabled&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">bool&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;æ˜¯å¦å•Ÿç”¨ NAT IP&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;metadata&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = map(&lt;span style="color:#a6e22e">string&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE ä¸­ç¹¼è³‡æ–™&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;enable_display&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">bool&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;æ˜¯å¦å•Ÿç”¨è™›æ“¬é¡¯ç¤º&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;resource_policies&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = list(&lt;span style="color:#a6e22e">string&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE è³‡æºåŸå‰‡&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;service_account_email&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE æœå‹™å¸³æˆ¶é›»å­éƒµä»¶&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;service_account_scopes&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = list(&lt;span style="color:#a6e22e">string&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE æœå‹™å¸³æˆ¶ç¯„åœ&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;deletion_protection&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">bool&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;æ˜¯å¦å•Ÿç”¨åˆªé™¤ä¿è­·&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;allow_stopping_for_update&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">bool&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;æ˜¯å¦å…è¨±è‡ªå‹•åœæ­¢å¾Œæ›´æ–°&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™å€‹æª”æ¡ˆæœƒå®šç¾©æ¯å€‹è®Šæ•¸çš„åç¨±ä»¥åŠè³‡æ–™å‹æ…‹ï¼Œä¹Ÿå¯ä»¥å¯«èªªæ˜ä»¥åŠé è¨­çš„å€¼ï¼Œé€™é‚Šæ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯ &lt;code>validation&lt;/code> ï¼Œä»–å¯ä»¥é©—è­‰å¸¶å…¥çš„åƒæ•¸æ˜¯å¦ç¬¦åˆ &lt;code>condition&lt;/code> å…§å®¹ï¼Œä¹Ÿå¯ä»¥è‡ªå®šç¾©éŒ¯èª¤çš„è¨Šæ¯ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">variable&lt;/span> &lt;span style="color:#e6db74">&amp;#34;attached_disk_mode&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">type&lt;/span> = &lt;span style="color:#a6e22e">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">description&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;GCE é™„åŠ ç£ç¢Ÿæ¨¡å¼&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">default&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;READ_ONLY&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">validation&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">condition&lt;/span> = contains([&lt;span style="color:#e6db74">&amp;#34;READ_WRITE&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;READ_ONLY&amp;#34;&lt;/span>], var.&lt;span style="color:#a6e22e">attached_disk_mode&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">error_message&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;ä¸ç¬¦åˆé™„åŠ ç£ç¢Ÿæ¨¡å¼çš„å€¼ï¼Œè«‹è¼¸å…¥ READ_WRITE æˆ– READ_ONLY&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é€™é‚Šé™åˆ¶ &lt;code>attached_disk_mode&lt;/code> è¼¸å…¥å¿…é ˆç¬¦åˆ &lt;code>READ_WRITE&lt;/code> or &lt;code>READ_ONLY&lt;/code> çš„å€¼ï¼Œå¦‚æœè¼¸å…¥å…¶ä»–ä¸ç¬¦åˆçš„æœƒé¡¯ç¤º error_message å…§å®¹ã€‚&lt;/p>
&lt;br>
&lt;p>å¦å¤– &lt;code>variable&lt;/code> é€™é‚Šæœ‰å¹¾å€‹è³‡æ–™å‹æ…‹å¯ä»¥é¸æ“‡ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>stringï¼šå­—ä¸²ï¼Œä¸çŸ¥é“è¦é¸ä»€éº¼å°±é¸ä»–æ²’éŒ¯ xD&lt;/p>
&lt;/li>
&lt;li>
&lt;p>boolï¼šå¸ƒæ—å€¼ï¼Œåªæœ‰ trueã€false å…©ç¨®é¸é …ï¼Œé©ç”¨æ–¼åˆ¤æ–·çš„å…§å®¹ï¼Œä¾‹å¦‚å‰›å‰›ä¸Šé¢èªªçš„ &lt;code>attached_disk_enabled&lt;/code> å°±æ˜¯ä½¿ç”¨ bool&lt;/p>
&lt;/li>
&lt;li>
&lt;p>numberï¼šæ•¸å­—ï¼Œåªèƒ½è¼¸å…¥æ•¸å­—&lt;/p>
&lt;/li>
&lt;li>
&lt;p>list (tuple)ï¼šæ¸…å–®ï¼Œå…§å®¹å¯ä»¥æ”¾ç½®é¡ä¼¼ &lt;code>[&amp;quot;us-west-1a&amp;quot;, &amp;quot;us-west-1c&amp;quot;]&lt;/code> çš„è³‡æ–™&lt;/p>
&lt;/li>
&lt;li>
&lt;p>map (object)ï¼š key value å­˜æ”¾æ¨¡å¼ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;aaa&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;test1&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;bbb&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;test2&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;ccc&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;test3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">module/google_compute_instance/outputs.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">output&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance_id&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">value&lt;/span> = &lt;span style="color:#a6e22e">google_compute_instance&lt;/span>.&lt;span style="color:#a6e22e">instance&lt;/span>.&lt;span style="color:#a6e22e">instance_id&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™é‚Šä¸»è¦æ”¾ç½®è¦è¼¸å‡ºçš„å…§å®¹ï¼Œåƒæˆ‘å€‘é€™é‚Šå°±æœƒæŠŠ &lt;code>instance_id&lt;/code> çµ¦é¡¯ç¤ºå‡ºä¾†ã€‚&lt;/p>
&lt;br>
&lt;p>projects æˆ‘é€™é‚Šåªç¤ºç¯„ prod çš„éƒ¨åˆ†&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">projects/prod/main.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">module&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ian-test&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;../../module/google_compute_instance&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project_id&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;é¦¬è³½å…‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;test-prod&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;e2-small&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_tags&lt;/span> = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_labels&lt;/span> = {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;aaa&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;test1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;bbb&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;test2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ccc&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;test3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk_image_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;debian-cloud/debian-10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk_size&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;50&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">attached_disk_enabled&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;é¦¬è³½å…‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">subnetwork_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;é¦¬è³½å…‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">nat_ip_enabled&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">metadata&lt;/span> = {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">resource_policies&lt;/span> = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">service_account_email&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;é¦¬è³½å…‹&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">service_account_scopes&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;storage-ro&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;logging-write&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;monitoring-write&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;service-control&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;service-management&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;trace&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™é‚Šæˆ‘å€‘å¯ä»¥å®šç¾©è¦ä½¿ç”¨ module çš„å«ä»€éº¼ï¼Œé€™é‚Šæˆ‘å°±å–å google_compute_instanceï¼Œç„¶å¾Œä»–æœƒå» &lt;code>source &amp;quot;../../module/ian-test&amp;quot;&lt;/code>ï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘å‰›å‰›åœ¨ä¸Šé¢å…ˆæŒ–æ´çš„æ¨¡æ¿ï¼Œåº•ä¸‹å°±é–‹å§‹å¸¶å…¥æˆ‘å€‘åœ¨ variables.tf æœ‰è¨­å®šçš„åƒæ•¸ã€‚é€™é‚Šæ¯”è¼ƒè¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ main.tfã€variables.tf æœ‰ä½¿ç”¨çš„è®Šæ•¸è¨­å®šï¼Œéƒ½å¿…é ˆè¦å¯«åœ¨å€‹åˆ¥è³‡æº tf çš„æª”æ¡ˆè£¡é¢ï¼Œæ²’æœ‰çš„å°±å¸¶å…¥å°æ‡‰è³‡æ–™å‹æ…‹çš„ç©ºå€¼ï¼Œä¾‹å¦‚ &lt;code>instance_tags&lt;/code>ã€&lt;code>metadata&lt;/code>ã€&lt;code>resource_policies&lt;/code> ç­‰ç­‰ã€‚&lt;/p>
&lt;br>
&lt;h2>å¯¦ä½œ&lt;span class="hx-absolute -hx-mt-20" id="å¯¦ä½œ">&lt;/span>
&lt;a href="#%e5%af%a6%e4%bd%9c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç•¶æˆ‘å€‘å®Œæˆä¸Šé¢çš„æ¶æ§‹å¾Œï¼Œæˆ‘å€‘é€²å…¥ projects/prod/main.tf è·¯å¾‘ä¸‹ï¼Œé–‹å§‹ç”¨ module çš„æ–¹å¼å»ºç«‹è³‡æºï¼Œå»ºç«‹è³‡æºçš„æµç¨‹èˆ‡åŸæœ¬çš„ç›¸åŒï¼Œä¸€æ¨£æ˜¯ init &amp;gt; plan &amp;gt; apply é€™ä¸‰å€‹æ­¥é©Ÿï¼Œé‚£æˆ‘å€‘ä¸€å€‹ä¸€å€‹ä¾†çœ‹ï¼Œèˆ‡åŸæœ¬çš„å»ºç«‹æ–¹å¼æœ‰å“ªäº›ä¸åŒä¹‹è™•å§ï½&lt;/p>
&lt;br>
&lt;h3>init&lt;span class="hx-absolute -hx-mt-20" id="init">&lt;/span>
&lt;a href="#init" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘ä½¿ç”¨ &lt;code>terraform init&lt;/code> ä¾†çœ‹çœ‹åŸæœ¬ init èˆ‡ä½¿ç”¨æ¨¡çµ„ init å¾Œå·®åœ¨å“ªè£¡ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/1.png"
alt="åŸå…ˆ terraform init çµæœ" width="700">&lt;figcaption>
&lt;p>åŸå…ˆ terraform init çµæœ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/2.png"
alt="ä½¿ç”¨ module init çµæœ" width="700">&lt;figcaption>
&lt;p>ä½¿ç”¨ module init çµæœ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°æœ‰ä½¿ç”¨ module åœ¨åˆå§‹åŒ–çš„æ™‚å€™ï¼Œæœƒé€£åŒ module ä¹Ÿä¸€ä½µåˆå§‹åŒ–ï¼Œæ¥è‘—æˆ‘å€‘é€²åˆ° .terraform è³‡æ–™å¤¾å…§ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ moduels è³‡æ–™å¤¾ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/3.png"
alt=".terraform æª”æ¡ˆå·®ç•°" width="700">&lt;figcaption>
&lt;p>.terraform æª”æ¡ˆå·®ç•°&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>åœ¨é€²å»çœ‹æœƒçœ‹æœ‰ä¸€å€‹ modules.json æª”æ¡ˆï¼Œæœƒç´€éŒ„ module ä½¿ç”¨çš„è·¯å¾‘ï¼Œå› æ­¤ç•¶æˆ‘å€‘ä½¿ç”¨çš„ module æœ‰æ”¹è®Šæ™‚ï¼Œè¦è¨˜å¾—é‡æ–° init æ‰å¯ä»¥ç¢ºä¿ä½¿ç”¨çš„ module æ˜¯æ­£ç¢ºçš„ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/4.png"
alt="ä½¿ç”¨ module æœƒå¤šä¸€å€‹ modules.json æª”æ¡ˆ" width="700">&lt;figcaption>
&lt;p>ä½¿ç”¨ module æœƒå¤šä¸€å€‹ modules.json æª”æ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>plan&lt;span class="hx-absolute -hx-mt-20" id="plan">&lt;/span>
&lt;a href="#plan" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘ä¸€æ¨£ä¸‹ &lt;code>terraform plan&lt;/code> æŒ‡ä»¤ï¼Œä¾†çœ‹çœ‹å…©è€…é¡¯ç¤ºçš„å·®ç•°ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/5.png"
alt="åŸå…ˆ terraform plan çµæœ" width="700">&lt;figcaption>
&lt;p>åŸå…ˆ terraform plan çµæœ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/6.png"
alt="ä½¿ç”¨ module plan çµæœ" width="700">&lt;figcaption>
&lt;p>ä½¿ç”¨ module plan çµæœ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨ module åœ¨ plan æ™‚ï¼Œé è¦½å‰µå»ºçš„è³‡æºæ ¼å¼ä¸åŒï¼Œä¹Ÿå°±ä»£è¡¨ä»–å­˜åœ¨ tfstate æª”æ¡ˆçš„æ ¼å¼ä¹Ÿæœƒä¸åŒ (é€™å€‹å¾Œé¢æœƒåœ¨æåˆ°ï¼Œèˆ‡ import ä¹Ÿæœ‰é—œä¿‚)&lt;/p>
&lt;br>
&lt;h3>apply&lt;span class="hx-absolute -hx-mt-20" id="apply">&lt;/span>
&lt;a href="#apply" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä½¿ç”¨ &lt;code>terraform apply&lt;/code> ä¾†çœ‹å»ºç«‹è³‡æºå¾Œçš„çµæœæœ‰ä»€éº¼ä¸åŒï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/7.png"
alt="åŸå…ˆ terraform apply çµæœ" width="700">&lt;figcaption>
&lt;p>åŸå…ˆ terraform apply çµæœ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/8.png"
alt="ä½¿ç”¨ module apply çµæœ" width="700">&lt;figcaption>
&lt;p>ä½¿ç”¨ module apply çµæœ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>apply çœ‹åˆ°çš„èˆ‡ plan é¡¯ç¤ºçš„ä¸€æ¨£ï¼Œä½¿ç”¨ module å»ºç«‹çš„è³‡æ–™æ ¼å¼æœƒä¸å¤ªä¸€æ¨£ï¼Œæ‰€ä»¥æˆ‘å€‘ä¾†çœ‹çœ‹å…©è€… tfstate æª”æ¡ˆçš„å·®ç•°ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/9.png"
alt="åŸå…ˆ terraform å»ºç«‹çš„ tfstate æª”æ¡ˆ" width="800">&lt;figcaption>
&lt;p>åŸå…ˆ terraform å»ºç«‹çš„ tfstate æª”æ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/10.png"
alt="ä½¿ç”¨ module å»ºç«‹çš„ tfstate æª”æ¡ˆ" width="800">&lt;figcaption>
&lt;p>ä½¿ç”¨ module å»ºç«‹çš„ tfstate æª”æ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>import&lt;span class="hx-absolute -hx-mt-20" id="import">&lt;/span>
&lt;a href="#import" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>import çš„åŠŸç”¨æ˜¯å¯ä»¥å¾é›²ä¸Šæœå‹™è½‰æˆ tfï¼Œåœ¨ä¹‹å‰åŸæœ¬çš„ terraform æ˜¯è¦å…ˆå»ºç«‹ä¸€å€‹ç©ºçš„ resourceï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_instance&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;instance&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å†ä½¿ç”¨ &lt;code>terraform import google_compute_instance.instance å°ˆæ¡ˆID/æ©Ÿå™¨åœ°å€/æ©Ÿå™¨åç¨±&lt;/code> ä¾†åŒ¯å…¥é›²ä¸Šæœå‹™çš„ç‹€æ…‹åˆ°å¾Œç«¯å­˜åˆ° tfstate çš„ä½å­ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/11.png"
alt="åŸå…ˆ terraform import ç·šä¸Šæœå‹™" width="700">&lt;figcaption>
&lt;p>åŸå…ˆ terraform import ç·šä¸Šæœå‹™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é‚£æˆ‘å€‘ç¾åœ¨æ”¹æˆ moduleï¼Œæœƒæ¯”è¼ƒéº»ç…©ä¸€é»ï¼Œå› ç‚ºæˆ‘å€‘æœ‰åœ¨ variables.tf è¨­å®šæˆ‘å€‘çš„è®Šæ•¸ï¼Œè‹¥æ˜¯æ²’æœ‰è¨­å®šé è¨­å€¼ï¼Œå°±å¿…é ˆä¸€å®šè¦è¼¸å…¥ï¼Œæ‰€ä»¥æˆ‘å€‘åœ¨å»ºç«‹æ™‚ï¼Œè¦å…ˆæŠŠè®Šæ•¸çš„ç©ºå€¼ä¹Ÿè£œä¸Šï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">module&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ian-test&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;../../module/google_compute_instance&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project_id&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">machine_type&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_zone&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_tags&lt;/span> = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">instance_labels&lt;/span> = {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk_image_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">boot_disk_size&lt;/span> = &lt;span style="color:#ae81ff">50&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">attached_disk_enabled&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">subnetwork_name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">nat_ip_enabled&lt;/span> = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">metadata&lt;/span> = {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">resource_policies&lt;/span> = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">service_account_email&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">service_account_scopes&lt;/span> = []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&amp;quot; &amp;quot; æ˜¯ string æ ¼å¼çš„ç©ºå€¼ï¼Œ[ ] æ˜¯ list æ ¼å¼çš„ç©ºå€¼ï¼Œ{ } æ˜¯ map æ ¼å¼çš„ç©ºå€¼ï¼Œå…¶ä»–çš„ bool æˆ‘é è¨­æœƒçµ¦ä»– falseï¼Œnumber æˆ‘æœƒéš¨ä¾¿çµ¦ä»–ä¸€å€‹æ•¸å­— xDã€‚é€™é‚Šå¸¶å…¥çš„å…§å®¹ä¸æ˜¯å¾ˆé‡è¦ï¼Œä¸»è¦æ˜¯è®“ä»–å¯ä»¥å»æŠ“åˆ°ä»–çš„æ¶æ§‹ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥åœ¨ variables.tf è¨­å®šæ™‚éƒ½è£œä¸Šé è¨­å€¼ã€‚&lt;/p>
&lt;br>
&lt;p>å†ä½¿ç”¨ &lt;code>terraform import module.ian-test.google_compute_instance.instance å°ˆæ¡ˆID/æ©Ÿå™¨åœ°å€/æ©Ÿå™¨åç¨±&lt;/code> ä¾†åŒ¯å…¥ç‹€æ…‹æª”æ¡ˆã€‚(é€™é‚Šè¦è¨˜å¾—ä¾ç…§ä½  module è¨­å®šçš„åç¨±å¸¶å…¥)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terraform-module/12.png"
alt="ä½¿ç”¨ module import ç·šä¸Šæœå‹™" width="700">&lt;figcaption>
&lt;p>ä½¿ç”¨ module import ç·šä¸Šæœå‹™&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Types and Valuesï¼š&lt;a href="https://developer.hashicorp.com/terraform/language/expressions/types" target="_blank" rel="noopener">https://developer.hashicorp.com/terraform/language/expressions/types&lt;/a>&lt;/p></description></item><item><title>å¦‚ä½•å°å…¥ Terragruntï¼ŒTerragrunt å¥½è™•æ˜¯ä»€éº¼ï¼Ÿ</title><link>https://pin-yi.me/blog/terraform/terragrunt/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/terraform/terragrunt/</guid><description>
&lt;p>æˆ‘å€‘æ¥çºŒä¸Šä¸€ç¯‡çš„ &lt;a href="https://pin-yi.me/terraform-module/" target="_blank" rel="noopener">å¦‚ä½•å°‡ Terraform æ”¹å¯«æˆ module ?&lt;/a> ï¼Œæˆ‘å€‘å·²ç¶“å°‡ Terraform æ”¹æˆ module çš„æ–¹å¼ä¾†é€²è¡Œç®¡ç†ï¼Œä½†ç•¶æˆ‘å€‘è¦ç®¡ç†çš„è³‡æºè¶Šä¾†è¶Šå¤šï¼Œä¸”æœ‰åˆ†ä¸åŒçš„å°ˆæ¡ˆæ™‚ï¼Œæ•´å€‹æœå‹™æ¶æ§‹æœƒé•·çš„åƒä»¥ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;div class="hextra-filetree hx-mt-6 hx-select-none hx-text-sm hx-text-gray-800 dark:hx-text-gray-300 not-prose">
&lt;div class="hx-inline-block hx-rounded-lg hx-border hx-px-4 hx-py-2 dark:hx-border-neutral-800">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">modules&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">google_compute_instance&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">outputs.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">variables.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">projects&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">gcp-1234&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">aaa&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">bbb&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">ccc&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="closed" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="closed" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">gcp-2345&lt;/span>
&lt;/button>
&lt;ul data-state="closed" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">aaa&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">bbb&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">ccc&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="closed" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="closed" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">gcp-3456&lt;/span>
&lt;/button>
&lt;ul data-state="closed" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">aaa&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">bbb&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">ccc&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">backend.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">provider.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™é‚Šçš„ç¯„ä¾‹æ˜¯ä»¥ä¸åŒå°ˆæ¡ˆä¾†åˆ†ï¼Œå†åˆ†å€ä¸åŒçš„æœå‹™ï¼Œæ¯å€‹æœå‹™è£¡é¢éƒ½æœƒæœ‰ &lt;code>backend.tf&lt;/code>ã€&lt;code>main.tf&lt;/code>ã€&lt;code>provider.tf&lt;/code> æª”æ¡ˆæ‰€çµ„æˆï¼Œæˆ‘å€‘å¯ä»¥ä¾†æ¯”è¼ƒä¸€ä¸‹ gcp-1234 çš„ aaa æœå‹™ä»¥åŠ gcp-2345 çš„ aaa æœå‹™å·®ç•°ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terragrunt/1.png"
alt="æª”æ¡ˆå·®ç•°" width="800">&lt;figcaption>
&lt;p>æª”æ¡ˆå·®ç•°&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°åœ¨ &lt;code>backend.tf&lt;/code> é™¤äº† prefix è·¯å¾‘ä»¥å¤–ï¼Œå…¶ä»–è¨­å®šä¹Ÿéƒ½ä¸€æ¨£ï¼Œä½†å› ç‚º Terraform æœ¬èº«æ²’è¾¦æ³•é€éå¸¶å…¥åƒæ•¸çš„æ–¹å¼ä¾†è¨­å®š &lt;code>backend.tf&lt;/code> å¾Œç«¯éƒ¨åˆ†ï¼Œæ‰€ä»¥å¿…é ˆè¦å…ˆå¯«å¥½æ¯å€‹æœå‹™æ‰€å­˜æ”¾çš„å¾Œç«¯ä½ç½®ï¼Œååˆ†çš„ä¸æ–¹ä¾¿ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">backend.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">backend&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcs&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">bucket&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;terragrunt-tfstate&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">prefix&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;/gcp-1234-aaa&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ç‚ºäº†æ¸›å°‘ä¸Šè¿°é€™äº›éœ€è¦ä¸€ç›´é‡è¤‡å¯«å·®ä¸å¤šæª”æ¡ˆçš„å·¥ä½œå…§å®¹ï¼Œå› æ­¤æœ‰äº† Terragrunt é€™å€‹å·¥å…·ï¼ŒTerragrunt æ˜¯ Terraform çš„åŒ…è£å™¨ï¼Œå¯ä»¥å½Œè£œ Terraform ä¸Šçš„ä¸€äº›ç¼ºé™·ï¼Œä¸¦ä¸”è®“æˆ‘å€‘çš„ IaC æ›´è²¼è¿‘ &lt;a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" target="_blank" rel="noopener">DRY åŸå‰‡&lt;/a>ã€‚&lt;/p>
&lt;br>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-rounded-lg hx-border hx-py-2 ltr:hx-pr-4 rtl:hx-pl-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-orange-100 hx-bg-orange-50 hx-text-orange-800 dark:hx-border-orange-400/30 dark:hx-bg-orange-400/20 dark:hx-text-orange-300">
&lt;div class="ltr:hx-pl-3 ltr:hx-pr-2 rtl:hx-pr-3 rtl:hx-pl-2">&lt;/div>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;p>é€™é‚Šèªªæ˜ä¸€ä¸‹ DRY åŸå‰‡&lt;/p>
&lt;p>DRY å…¨åæ˜¯ Donâ€™t repeat yourselfï¼Œä¹Ÿå°±æ˜¯ä¸è¦åšé‡è¤‡çš„äº‹æƒ…ï¼Œèƒ½å¤ ä¸€æ¬¡åšå®Œçš„å°±ä¸è¦é‡è¤‡çš„å»åšã€‚&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h2>Terragrunt å®‰è£æ–¹å¼&lt;span class="hx-absolute -hx-mt-20" id="terragrunt-å®‰è£æ–¹å¼">&lt;/span>
&lt;a href="#terragrunt-%e5%ae%89%e8%a3%9d%e6%96%b9%e5%bc%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é‚£è¦æ€éº¼ä½¿ç”¨ Terragrunt å‘¢ï¼ï¼Ÿ&lt;/p>
&lt;p>ç¬¬ä¸€æ­¥ç•¶ç„¶æ˜¯å®‰è£å®ƒå›‰ï¼Œæˆ‘å€‘ç³»çµ±æ˜¯ macOSï¼Œæ‰€ä»¥æˆ‘å€‘å®‰è£æ–¹å¼æ˜¯ &lt;a href="https://brew.sh/" target="_blank" rel="noopener">Homebrew&lt;/a> ä¾†é€²è¡Œå®‰è£ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install terragrunt&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ¥è‘—æˆ‘å€‘çš„æŒ‡ä»¤æœƒå¾ &lt;code>terraform XXX&lt;/code> è®Šæˆä»¥ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>terragrunt plan
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>terragrunt apply
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>terragrunt output
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>terragrunt destroy&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Terragrunt æœƒå°‡æ‰€æœ‰å‘½ä»¤ã€åƒæ•¸å’Œé¸é …ç›´æ¥è½‰ç™¼åˆ° Terraformã€‚(æ‰€ä»¥æˆ‘å€‘ä¹Ÿéœ€è¦ä¸‹è¼‰ Terraform)&lt;/p>
&lt;p>Terragrunt çš„é è¨­æª”æ¡ˆåç¨±æ˜¯ terragrunt.hcl ï¼ŒTerragrunt çš„è¨­å®šæª”æ¡ˆåŸºæœ¬ä¸Šèˆ‡ Module å·®ä¸å¤šï¼Œåªæ˜¯æœ‰æ›´å¤šæ›´æ–¹ä¾¿çš„è®Šæ•¸å¯ä»¥ä½¿ç”¨ã€‚&lt;/p>
&lt;br>
&lt;h2>Terragrunt å¥½è™•&lt;span class="hx-absolute -hx-mt-20" id="terragrunt-å¥½è™•">&lt;/span>
&lt;a href="#terragrunt-%e5%a5%bd%e8%99%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;br>
&lt;p>æ¥è‘—ä»‹ç´¹ä¸€ä¸‹ Terragrunt çš„å¥½è™•ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æ–¹ä¾¿ç®¡ç†å¾Œç«¯ç‹€æ…‹è¨­å®š&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°‡å¾Œç«¯å­˜å„²æ¡¶ç´å…¥ç®¡ç†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä½¿ç”¨ generate è‡ªå‹•ç”Ÿæˆæª”æ¡ˆ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä½¿ç”¨ include æª”æ¡ˆä¾†é”åˆ° DRY åŸå‰‡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç®¡ç† Module ä¹‹é–“çš„ä¾è³´æ€§&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¢ç”Ÿä¾è³´é—œè¯åœ–&lt;/p>
&lt;/li>
&lt;/ol>
&lt;br>
&lt;h3>æ–¹ä¾¿ç®¡ç†å¾Œç«¯ç‹€æ…‹è¨­å®š&lt;span class="hx-absolute -hx-mt-20" id="æ–¹ä¾¿ç®¡ç†å¾Œç«¯ç‹€æ…‹è¨­å®š">&lt;/span>
&lt;a href="#%e6%96%b9%e4%be%bf%e7%ae%a1%e7%90%86%e5%be%8c%e7%ab%af%e7%8b%80%e6%85%8b%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;br>
&lt;p>é¦–å…ˆç¬¬ä¸€å€‹æ–¹ä¾¿ç®¡ç†å¾Œç«¯ç‹€æ…‹è¨­å®šï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘ä¸Šé¢æåˆ°çš„ &lt;code>backend.tf&lt;/code> è¨­å®šã€‚åœ¨ Terraform åŸç”Ÿç‚ºäº†å€åˆ¥ä¸åŒå°ˆæ¡ˆä¸åŒæœå‹™çš„ç‹€æ…‹æª”ï¼Œå°±å¿…é ˆå…ˆå¯«å¥½æ¯å€‹å„²å­˜çš„è·¯å¾‘ï¼Œä½†ä½¿ç”¨ Terragruntï¼Œå¯ä»¥å…ˆåœ¨è©²ç›®éŒ„ä¸‹ï¼Œä¹Ÿå°±æ˜¯ gcp-3456 ç›®éŒ„ä¸‹å…ˆå¯«ä¸€å€‹è¨­å®šæª”æ¡ˆ (æˆ‘å€‘ä»¥ gcp-3456 å°ˆæ¡ˆç‚ºä¾‹)ï¼Œè®“åº•ä¸‹çš„ aaaã€bbbã€ccc æœå‹™å¯ä»¥å» include å®ƒï¼Œæˆ‘å€‘å°±ä¸éœ€è¦æ¯å€‹æœå‹™éƒ½å¯«å¹¾ä¹å·®ä¸å¤šçš„è¨­å®šæª”ï¼Œæ¥è‘—æˆ‘å€‘åœ¨ gcp-3456 è³‡æ–™å¤¾ä¸‹æ–°å¢ terragrunt.hcl æª”æ¡ˆä¾†èªªæ˜ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">terragrunt.hcl&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">remote_state&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> backend &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> generate &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;backend.tf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if_exists &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;overwrite&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bucket &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;terragrunt-tfstate&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> prefix &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;${path_relative_to_include()}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™é‚Šçš„è¨­å®šå…¶å¯¦è·Ÿä¹‹å‰çš„ &lt;code>backend.tf&lt;/code> å·®ä¸å¤šï¼Œåªæ˜¯å¾Œç«¯ç¾åœ¨å„²å­˜çš„ block æ”¹å«åš &lt;code>remote_state&lt;/code>ï¼Œå¯ä»¥çœ‹åˆ° backend è¨­å®šæˆ‘å€‘ä¸€æ¨£æ˜¯å­˜åœ¨ gcs ä¸Šï¼Œ&lt;code>generate&lt;/code> é€™å€‹ block å®ƒæœƒåˆ¤æ–· backend.tf æª”æ¡ˆæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ²’æœ‰å®ƒå°±æœƒå¹«æˆ‘å€‘å»ºç«‹ï¼Œå…¶ä¸­è¨­å®šæª”æ¡ˆå…§å®¹æ˜¯å°‡ç‹€æ…‹æª”æ¡ˆå­˜åœ¨ &lt;code>terragrunt-tfstate&lt;/code> é€™å€‹ bucketï¼Œä¸¦é€é&lt;code>${path_relative_to_include()}&lt;/code> é€™å€‹è®Šæ•¸ä¾†è‡ªå‹•å¸¶å…¥æœ‰ include é€™ä»½æª”æ¡ˆçš„è·¯å¾‘ï¼Œä¸¦åœ¨ç›¸å°è·¯å¾‘ç”¢ç”Ÿ &lt;code>backend.tf&lt;/code> æª”æ¡ˆã€‚&lt;/p>
&lt;br>
&lt;p>æœ‰é»æŠ½è±¡ï¼Œæ‰€ä»¥æˆ‘ç•«ä¸€å€‹æ¯”è¼ƒç°¡å–®çš„æ¶æ§‹åœ–ä¾†åšèªªæ˜ä¸€ä¸‹ï¼Œå‡è¨­ç¾åœ¨æœ‰ä¸‰å€‹æœå‹™ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-filetree hx-mt-6 hx-select-none hx-text-sm hx-text-gray-800 dark:hx-text-gray-300 not-prose">
&lt;div class="hx-inline-block hx-rounded-lg hx-border hx-px-4 hx-py-2 dark:hx-border-neutral-800">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">aaa&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">terragrunt.hcl&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">bbb&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">terragrunt.hcl&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">ccc&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">terragrunt.hcl&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">terragrunt.hcl&lt;/span>
&lt;/span>
&lt;/li>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æˆ‘å€‘å‰›å‰›çš„å¾Œç«¯è¨­å®šæ˜¯å¯«åœ¨æ­¤æ ¹ç›®éŒ„çš„ terragrunt.hcl æª”æ¡ˆ(ç¬¬ 8 è¡Œ)ï¼Œç„¶å¾Œ ccc é€™å€‹æœå‹™å» include æ ¹ç›®éŒ„çš„ terragrunt.hcl æª”æ¡ˆï¼Œ Terragrunt å°±æœƒè‡ªå‹•å¹«ä½ ç”¢ç”Ÿä»¥ä¸‹çš„ &lt;code>backend.tf&lt;/code> æª”æ¡ˆï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">backend.tf&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tf" data-lang="tf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">backend&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcs&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">bucket&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;terragrunt-tfstate&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">prefix&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;/ccc&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é€™æ¨£å°±å¯ä»¥çœä¸‹æˆ‘å€‘è¦é‡è¤‡å¯« &lt;code>backend.tf&lt;/code> çš„æ™‚é–“ï¼Œåœ¨ç¶­è­·ä¸Šä¹Ÿæœƒæ›´åŠ çš„æ–¹ä¾¿ã€‚&lt;/p>
&lt;br>
&lt;h3>å°‡å¾Œç«¯å­˜å„²æ¡¶ç´å…¥ç®¡ç†&lt;span class="hx-absolute -hx-mt-20" id="å°‡å¾Œç«¯å­˜å„²æ¡¶ç´å…¥ç®¡ç†">&lt;/span>
&lt;a href="#%e5%b0%87%e5%be%8c%e7%ab%af%e5%ad%98%e5%84%b2%e6%a1%b6%e7%b4%8d%e5%85%a5%e7%ae%a1%e7%90%86" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ¥è‘—ï¼Œå¤§å®¶æœ‰æ²’æœ‰æƒ³éï¼Œæˆ‘å€‘éƒ½å·²ç¶“ä½¿ç”¨ Terraform ä¾†ç®¡ç† IaC ï¼Œä¸¦æŠŠç‹€æ…‹æª”æ¡ˆæ”¾åˆ° gcs ä¸Šé¢ä¾†ä¿å­˜ï¼Œä½†ä¸€é–‹å§‹é‚„æ²’æœ‰ç”¨ Terraform ç®¡ç† gcs çš„è³‡æºï¼Œæˆ‘å€‘é‚„éœ€è¦åœ¨è¨­å®š &lt;code>backend.tf&lt;/code> å‰ï¼Œå…ˆæ‰‹å‹•å»æ–°å¢ä¸€å€‹ gcs ï¼Œæ‰èƒ½ä¾†å­˜æ”¾ tfstate ç‹€æ…‹æª”æ¡ˆå‘¢ï¼Ÿ&lt;/p>
&lt;br>
&lt;p>å› æ­¤åœ¨ Terragrunt &lt;code>remote_state&lt;/code> çš„ config æ™‚ï¼Œå¯ä»¥å¤šè¨­å®š gcs çš„ project id ä»¥åŠ locationï¼ŒTerragrunt åœ¨åˆå§‹åŒ–å¾Œç«¯æ™‚ï¼Œæœƒæª¢æŸ¥æ˜¯å¦æœ‰è©² gcs bucketï¼Œå¦‚æœæ²’æœ‰å°±æœƒè‡ªå‹•å»ºç«‹ï¼Œè¨­å®šæª”å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">terragrunt.hcl&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">remote_state&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> backend &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> generate &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;backend.tf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if_exists &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;overwrite&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> project &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcp-xxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> location &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;asia&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bucket &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;terragrunt-tfstate&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> prefix &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;${path_relative_to_include()}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>ä½¿ç”¨ generate è‡ªå‹•ç”Ÿæˆæª”æ¡ˆ&lt;span class="hx-absolute -hx-mt-20" id="ä½¿ç”¨-generate-è‡ªå‹•ç”Ÿæˆæª”æ¡ˆ">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8-generate-%e8%87%aa%e5%8b%95%e7%94%9f%e6%88%90%e6%aa%94%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨å‰›å‰›æˆ‘å€‘å¯ä»¥ä½¿ç”¨ generate ä¾†è‡ªå‹• &lt;code>backend.tf&lt;/code> æª”æ¡ˆï¼Œé‚£ä»£è¡¨æˆ‘å€‘ä¹Ÿå¯ä»¥æŠŠæ¯å€‹ &lt;code>provider.tf&lt;/code> çš„å…§å®¹ï¼Œä¹Ÿé€é generate ä¾†ç”Ÿæˆï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">terragrunt.hcl&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">generate&lt;/span> &lt;span style="color:#e6db74">&amp;#34;provider&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;provider.tf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> if_exists &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;overwrite&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> contents &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">&amp;lt;&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">required_providers&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> google &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> source &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;hashicorp/google&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> version &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;~&amp;gt; 4.48.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é€™æ¨£å­æ¯å€‹ include é€™ä»½è¨­å®šæª”çš„æœå‹™é™¤äº† &lt;code>backend.tf&lt;/code> æª”æ¡ˆä»¥å¤–ï¼Œé‚„æœƒè‡ªå‹•ç”¢ç”Ÿ &lt;code>provider.tf&lt;/code> æª”æ¡ˆã€‚&lt;/p>
&lt;br>
&lt;h3>ä½¿ç”¨ include æª”æ¡ˆä¾†é”åˆ° DRY åŸå‰‡&lt;span class="hx-absolute -hx-mt-20" id="ä½¿ç”¨-include-æª”æ¡ˆä¾†é”åˆ°-dry-åŸå‰‡">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8-include-%e6%aa%94%e6%a1%88%e4%be%86%e9%81%94%e5%88%b0-dry-%e5%8e%9f%e5%89%87" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘æå®šäº† &lt;code>backend.tf&lt;/code> è·Ÿ &lt;code>provider.tf&lt;/code> å¾Œï¼Œé‚„å‰©ä¸‹ &lt;code>main.tf&lt;/code>ï¼Œæ‰€ä»¥æˆ‘å€‘ä¹Ÿå°‡å®ƒæ”¹æˆ Terragrunt çš„æ ¼å¼å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">terragrunt.hcl&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> source &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;${get_path_to_repo_root()}/modules/google_compute_instance&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">include&lt;/span> &lt;span style="color:#e6db74">&amp;#34;root&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">find_in_parent_folders&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputs &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> instance_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcp-3456-ccc&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> machine_type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;e2-small&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> instance_zone &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> instance_tags &lt;span style="color:#f92672">=&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> instance_labels &lt;span style="color:#f92672">=&lt;/span> {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> boot_disk_auto_delete &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> boot_disk_image_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;debian-cloud/debian-10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ... &lt;span style="color:#66d9ef">è¨­å®šéƒ¨åˆ†çœç•¥&lt;/span> ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™é‚Šå¯ä»¥çœ‹åˆ° terraform &lt;code>source&lt;/code> å®ƒå°±æ˜¯æˆ‘å€‘ä½¿ç”¨ module çš„è·¯å¾‘ï¼Œä¹Ÿå¯ä»¥ç”¨ &lt;code>${get_path_to_repo_root()}&lt;/code> é€™å€‹è®Šæ•¸ä»–æœƒè‡ªå‹•æŠ“è©²å°ˆæ¡ˆçš„æ ¹ç›®éŒ„ï¼Œæˆ‘å€‘å°±ä¸éœ€è¦å»ç‰¹åˆ¥è¨­å®šã€‚&lt;/p>
&lt;br>
&lt;p>æ­¤å¤–ä¹Ÿå¯ä»¥å°‡ module ç¨ç«‹æˆä¸€å€‹å°ˆæ¡ˆï¼Œæˆ–æ˜¯ä½¿ç”¨å…¶ä»–äººå¯«å¥½çš„ moduleï¼Œåœ¨ &lt;code>source&lt;/code> çš„æ™‚å€™å¯ä»¥ä½¿ç”¨ &lt;code>git::https://[gitlab-ç¶²å€]/sre/terraform/module.git//google_compute_address&lt;/code> çš„æ–¹å¼ä¾†å–å¾— moduleï¼Œå¯ä»¥è¨­å®šè¦ä½¿ç”¨å“ªå€‹åˆ†æ”¯æˆ–æ˜¯ tagï¼Œåªéœ€è¦åœ¨ç¶²å€å¾Œé¢åŠ ä¸Šï¼Œ&lt;code>?ref=[åˆ†ä¹‹ or tag åç¨±]&lt;/code> å³å¯ï¼Œé€™æ¨£å¯ä»¥è®“é–‹ç™¼ä¸­çš„ module ä¸æœƒå½±éŸ¿åˆ°ç·šä¸Šå…¶ä»–æ­£åœ¨ä½¿ç”¨ä¸­çš„ module è¨­å®šã€‚&lt;/p>
&lt;p>(&lt;code>module.git&lt;/code> å¾Œé¢çš„ &lt;code>//&lt;/code> æ˜¯ Terraform module source çš„è¦å‰‡ï¼Œå¦‚æœä¸åŠ æœƒè·³è­¦å‘Šè¨Šæ¯)&lt;/p>
&lt;br>
&lt;p>æ¥è‘—æˆ‘å€‘å¯ä»¥çœ‹åˆ° &lt;code>include &amp;quot;root&amp;quot; {}&lt;/code> é€™æ®µï¼Œè£¡é¢æœ‰ä½¿ç”¨ &lt;code>find_in_parent_folders&lt;/code> é€™é‚Šè®Šæ•¸ï¼Œä»–å°±æ˜¯ä¸Šé¢çš„æåˆ°æœƒè‡ªå‹•å»æŠ“æ”¾åœ¨çˆ¶è³‡æ–™å¤¾çš„ &lt;code>remote_state&lt;/code> è·Ÿ &lt;code>generate&lt;/code> terragrunt.hcl æª”æ¡ˆã€‚&lt;/p>
&lt;br>
&lt;p>å¾Œé¢çš„ input å°±è·Ÿä½¿ç”¨ module æ™‚ä¸€æ¨£ï¼Œå°‡ module çš„åƒæ•¸å¸¶å…¥å³å¯ã€‚&lt;/p>
&lt;p>è£œå……ï¼šæ‰€ä»¥æˆ‘å€‘ä¹Ÿå¯ä»¥æŠŠä¸€äº›é€šç”¨çš„è¨­å®šå¯«åœ¨æ ¹ç›®éŒ„çš„ terragrunt.hcl æª”æ¡ˆï¼Œä¾‹å¦‚å°ˆæ¡ˆçš„ idï¼Œå¯ä»¥å¯«ä»¥ä¸‹å…§å®¹ä¾†è®“ include å®ƒçš„æª”æ¡ˆåƒåˆ°åŒä¸€å€‹åƒæ•¸è¨­å®šï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">terragrunt.hcl&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="display:flex;">&lt;span>inputs &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> project_id &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gcp-3456&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>ç®¡ç† Module ä¹‹é–“çš„ä¾è³´æ€§&lt;span class="hx-absolute -hx-mt-20" id="ç®¡ç†-module-ä¹‹é–“çš„ä¾è³´æ€§">&lt;/span>
&lt;a href="#%e7%ae%a1%e7%90%86-module-%e4%b9%8b%e9%96%93%e7%9a%84%e4%be%9d%e8%b3%b4%e6%80%a7" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç”±æ–¼ Terragrunt æ˜¯æŠŠæ¯å€‹æœå‹™æ‹†åˆ†æˆæœ€å°åŒ–ï¼Œæ²’è¾¦æ³•æŠŠä½¿ç”¨ä¸åŒ module çš„è³‡æºæ”¾åœ¨ä¸€èµ·(å–®ç´”ä½¿ç”¨ module çš„è©±ï¼Œå¯ä»¥ä¸€æ¬¡ source å¤šäº† moduleï¼Œä¸¦æŠŠä»–æ”¾åœ¨åŒä¸€å€‹ tf æª”æ¡ˆä¸­)ï¼Œé‚£åƒæ˜¯æˆ‘å€‘å»ºç«‹ k8s æœƒä½¿ç”¨åˆ° &lt;code>google_container_cluster&lt;/code>ã€&lt;code>google_container_node_pool&lt;/code> å…©ç¨®ä¸åŒçš„ module è©²æ€éº¼è¾¦å‘¢ï¼Ÿ&lt;/p>
&lt;br>
&lt;p>é¦–å…ˆæˆ‘å€‘å…ˆåœ¨ modules è³‡æ–™å¤¾æ”¾ä¸Š &lt;code>google_container_cluster&lt;/code>ã€&lt;code>google_container_node_pool&lt;/code> å…©å€‹ module çš„è¨­å®šæª”æ¡ˆï¼Œè©³ç´°ç¨‹å¼å¯ä»¥&lt;a href="https://github.com/880831ian/terragrunt" target="_blank" rel="noopener">é»æˆ‘å‰å¾€&lt;/a>&lt;/p>
&lt;div class="hextra-filetree hx-mt-6 hx-select-none hx-text-sm hx-text-gray-800 dark:hx-text-gray-300 not-prose">
&lt;div class="hx-inline-block hx-rounded-lg hx-border hx-px-4 hx-py-2 dark:hx-border-neutral-800">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">modules&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">google_container_cluster&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">outputs.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">variables.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">google_container_node_pool&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">main.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">variables.tf&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>åœ¨ projects åº•ä¸‹æ–°å¢ gke è³‡æ–™å¤¾ï¼Œæ–°å¢ terragrunt.hcl ä¾†æ”¾ &lt;code>remote_state provider&lt;/code> çš„è¨­å®šï¼Œä¸¦å€åˆ†å…©å€‹è³‡æ–™å¤¾ï¼Œåˆ†åˆ¥æ˜¯ cluster è³‡æ–™å¤¾ä¾†å­˜æ”¾ cluster è³‡è¨Šï¼Œä»¥åŠ test è³‡æ–™å¤¾ä¾†å­˜æ”¾ test node-pool è³‡è¨Šï¼š&lt;/p>
&lt;div class="hextra-filetree hx-mt-6 hx-select-none hx-text-sm hx-text-gray-800 dark:hx-text-gray-300 not-prose">
&lt;div class="hx-inline-block hx-rounded-lg hx-border hx-px-4 hx-py-2 dark:hx-border-neutral-800">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">projects&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">gke&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">cluster&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">terragrunt.hcl&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">terragrunt.hcl&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">test&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">terragrunt.hcl&lt;/span>
&lt;/span>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>cluster çš„ terragrunt.hcl æª”æ¡ˆå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">terragrunt.hcl&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> source &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;${get_path_to_repo_root()}/modules/google_container_cluster&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">include&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">find_in_parent_folders&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputs &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;tf-test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_location &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;asia-east1-b&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_locations &lt;span style="color:#f92672">=&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_version &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;1.24.12-gke.500&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> network_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;projects/gcp-202011216-001/global/networks/bbin-testdev&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> subnetwork_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;projects/gcp-202011216-001/regions/asia-east1/subnetworks/bbin-testdev-dev-platform&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_max_pods &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">64&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> remove_default_node_pool &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> initial_node_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enable_shielded_nodes &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> resource_labels &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;dept&amp;#34; : &amp;#34;pid&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;env&amp;#34; : &amp;#34;dev&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;product&amp;#34; : &amp;#34;bbin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dns_enabled &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_dns &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;PROVIDER_UNSPECIFIED&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_dns_scope &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;DNS_SCOPE_UNSPECIFIED&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> private_cluster_ipv4_cidr &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;172.16.0.176/28&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> binary_authorization_enabled &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> binary_authorization &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;DISABLED&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>test node-pool æª”æ¡ˆå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div class="filename not-prose" dir="auto">terragrunt.hcl&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-hcl" data-lang="hcl">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">terraform&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> source &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;${get_path_to_repo_root()}/modules/google_container_node_pool&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">include&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">find_in_parent_folders&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">dependency&lt;/span> &lt;span style="color:#e6db74">&amp;#34;cluster&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config_path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;../cluster&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inputs &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">dependency&lt;/span>.&lt;span style="color:#66d9ef">cluster&lt;/span>.&lt;span style="color:#66d9ef">outputs&lt;/span>.&lt;span style="color:#66d9ef">cluster_name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_location &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">dependency&lt;/span>.&lt;span style="color:#66d9ef">cluster&lt;/span>.&lt;span style="color:#66d9ef">outputs&lt;/span>.&lt;span style="color:#66d9ef">cluster_location&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cluster_version &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">dependency&lt;/span>.&lt;span style="color:#66d9ef">cluster&lt;/span>.&lt;span style="color:#66d9ef">outputs&lt;/span>.&lt;span style="color:#66d9ef">cluster_version&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_pool_name &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_machine_type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;e2-small&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_disk_size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_disk_type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;pd-standard&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_image_type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;COS_CONTAINERD&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_oauth_scopes &lt;span style="color:#f92672">=&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/devstorage.read_only&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/logging.write&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/monitoring&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/service.management.readonly&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/servicecontrol&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://www.googleapis.com/auth/trace.append&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_tags &lt;span style="color:#f92672">=&lt;/span> []
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_taint_enabled &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_taint_key &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_taint_value &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node_taint_effect &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> auto_repair &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> auto_upgrade &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> upgrade_max_surge &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> upgrade_max_unavailable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> upgrade_strategy &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;SURGE&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> autoscaling_enabled &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> autoscaling_max_node_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> autoscaling_min_node_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> autoscaling_total_max_node_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> autoscaling_total_min_node_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ä¸Šé¢å…©å€‹æª”æ¡ˆåˆ†åˆ¥æ˜¯ cluster çš„è¨­å®šï¼Œä»¥åŠ test node-pool çš„è¨­å®šï¼Œè£¡é¢çš„è¨­å®šï¼Œä¸Šé¢åŸºæœ¬éƒ½æœ‰æéï¼Œé€™é‚Šè¦æçš„æ˜¯ &lt;code>dependency&lt;/code>ï¼Œ&lt;code>dependency&lt;/code> ä»–æ˜¯ Terragrunt æä¾›è®“æˆ‘å€‘å¯ä»¥æ–¹ä¾¿åœ°å»ç®¡ç† IaC ä¹‹é–“çš„ç›¸ä¾æ€§ï¼Œåƒæ˜¯æˆ‘å€‘é€™é‚Šï¼Œéœ€è¦å…ˆå»ºç«‹å¥½ cluster æ‰èƒ½å»ºç«‹ node_poolï¼Œæ­¤æ™‚å°±å¯ä»¥ä¾é  dependency block ä¾†å®Œæˆéœ€æ±‚ã€‚&lt;/p>
&lt;p>( é  dependency ä¾†å–å¾— cluster çš„è³‡è¨Šï¼Œä¸¦å¸¶å…¥ node_pool ä¸­ )&lt;/p>
&lt;br>
&lt;p>æ­¤æ™‚çš„åŸ·è¡ŒæŒ‡ä»¤æ˜¯åœ¨ gke ç›®éŒ„ä¸‹ï¼Œä½¿ç”¨ &lt;code>terragrunt run-all [åƒæ•¸]&lt;/code> ä¾†è·‘æ•´å€‹ç›¸ä¾çš„ moduleï¼Œæˆ‘å€‘é€™é‚Šå°±å»ºç«‹ä¸€å€‹åç‚º tf-test çš„ clusterï¼Œä¸¦ä¸”æœ‰ä¸€å€‹åç‚º test çš„ node_pool ï¼Œå…¶ä»–è¨­å®šè«‹åƒè€ƒä¸Šé¢ç¨‹å¼ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terragrunt/2.png"
alt="æ¸¬è©¦ terragrunt run-all" width="700">&lt;figcaption>
&lt;p>æ¸¬è©¦ terragrunt run-all&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>(é»ƒè‰²çš„ WARN æ˜¯å› ç‚º gcs ä¸Šé‚„æ²’æœ‰å­˜éè©²ç‹€æ…‹æª”æ¡ˆï¼Œæ‰€ä»¥æœƒè·³å‡ºæç¤º)&lt;/p>
&lt;br>
&lt;p>ç­‰åˆ° cluster å»ºç«‹å®Œæˆå¾Œï¼Œæœƒå°‡ cluster çš„è³‡è¨Šå¸¶å…¥ node_poolï¼Œæ‰é–‹å§‹å»ºç«‹ node_pool çš„è³‡æºï¼š&lt;/p>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terragrunt/3.png"
alt="æ¸¬è©¦ terragrunt run-all" width="700">&lt;figcaption>
&lt;p>æ¸¬è©¦ terragrunt run-all&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>ç”¢ç”Ÿä¾è³´é—œè¯åœ–&lt;span class="hx-absolute -hx-mt-20" id="ç”¢ç”Ÿä¾è³´é—œè¯åœ–">&lt;/span>
&lt;a href="#%e7%94%a2%e7%94%9f%e4%be%9d%e8%b3%b4%e9%97%9c%e8%81%af%e5%9c%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç•¶æˆ‘å€‘æœå‹™ä½¿ç”¨åˆ°å¾ˆå¤šä¾è³´é—œä¿‚ï¼Œæƒ³è¦é‡æ¸…æ˜¯èª°ä¾è³´èª°ï¼Œå¦‚æœå–®ç´”çœ‹ç¨‹å¼æœƒæ¯”è¼ƒéº»ç…©ï¼Œåœ¨ Terragrunt é‚„æœ‰ä¸€å€‹å¥½ç”¨çš„æŒ‡ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ï¼Œç”¢ç”Ÿå°æ‡‰çš„ä¾è³´é—œä¿‚åœ–ï¼Œåœ¨æª¢è¦–æ™‚å¯ä»¥æ›´æ¸…æ¥šçŸ¥é“é—œä¿‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>terragrunt graph-dependencies | dot -Tpng &amp;gt; graph.png&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>( é€™å€‹ dot æŒ‡ä»¤æ˜¯å¦å¤–çš„å¥—ä»¶ï¼Œæœƒå°‡é—œä¿‚åœ–ç¨‹å¼ç¢¼è½‰æˆåœ–æª”ï¼Œè«‹å…ˆå®‰è£ &lt;code>brew install graphviz&lt;/code> )&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/terraform/terragrunt/4.png"
alt="é—œè¯åœ–" width="100">&lt;figcaption>
&lt;p>é—œè¯åœ–&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>äº‹åŠåŠŸå€ â€” ä½¿ç”¨ Terragrunt æ­é… Terraform ç®¡ç†åŸºç¤è¨­ç½®ï¼š&lt;a href="https://medium.com/act-as-a-software-engineer/%E4%BA%8B%E5%8D%8A%E5%8A%9F%E5%80%8D-%E4%BD%BF%E7%94%A8-terragrunt-%E6%90%AD%E9%85%8D-terraform-%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A4%8E%E8%A8%AD%E6%96%BD-f70c30166639" target="_blank" rel="noopener">https://medium.com/act-as-a-software-engineer/%E4%BA%8B%E5%8D%8A%E5%8A%9F%E5%80%8D-%E4%BD%BF%E7%94%A8-terragrunt-%E6%90%AD%E9%85%8D-terraform-%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A4%8E%E8%A8%AD%E6%96%BD-f70c30166639&lt;/a>&lt;/p></description></item></channel></rss>