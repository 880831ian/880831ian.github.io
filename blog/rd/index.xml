<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PIN-YI â€“ RD ä½¿ç”¨çš„ç›¸é—œå·¥å…·</title><link>https://pin-yi.me/blog/rd/</link><description>Recent content in RD ä½¿ç”¨çš„ç›¸é—œå·¥å…· on PIN-YI</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><atom:link href="https://pin-yi.me/blog/rd/index.xml" rel="self" type="application/rss+xml"/><item><title>Fluentd-Server å‡ºç¾ Fluent::Plugin::Elasticsearch Error 400 - Rejected by Elasticsearch éŒ¯èª¤è§£æ±º</title><link>https://pin-yi.me/blog/rd/fluentd-server-show-fluent-plugin-elasticsearch-error400/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/rd/fluentd-server-show-fluent-plugin-elasticsearch-error400/</guid><description>
&lt;p>å…ˆèªªçµè«– &amp;hellip; &lt;del>EFK çœŸçš„å¥½å¤šé›· ğŸ˜†&lt;/del> æˆ‘å€‘ä»Šå¤©åˆå†åº¦è¸©é›·æ‹‰ï¼Œé€™æ¬¡åˆæ˜¯ç‚¸çš„åˆ†èº«ç¢éª¨ï¼ŒèŠ±äº† 4 å€‹å¤šå°æ™‚æ‰æ‰¾åˆ°åŸå› ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å°å¼Ÿæˆ‘è·Ÿ EFK ä¸æ˜¯å¾ˆç†Ÿ XDã€‚å°±å¦‚æ¨™é¡Œæ‰€èªªï¼Œæˆ‘åœ¨æŠ½ Log çš„æ™‚å€™ç™¼ç¾æœ‰éƒ¨åˆ†çš„ Log é€ä¸åˆ° Kibanaï¼Œæª¢æŸ¥ Fluentd-Server çš„ Log ç™¼ç¾è£¡é¢æœ‰ &lt;code>Fluent::Plugin::Elasticsearch Error 400 - Rejected by Elasticsearch&lt;/code> çš„éŒ¯èª¤è¨Šæ¯ï¼Œåˆ°åº•é€™å€‹ Error 400 æ˜¯ä»€éº¼å’§ï¼Œå°±è·Ÿè‘—æˆ‘ä¸€èµ·é‡æº«æ‰¾å•é¡Œçš„è‹¦é›£å§ XD&lt;/p>
&lt;br>
&lt;h2>EFK çµæ§‹&lt;span class="absolute -mt-20" id="efk-çµæ§‹">&lt;/span>
&lt;a href="#efk-%e7%b5%90%e6%a7%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åœ¨é–‹å§‹ä¹‹å‰æˆ‘å…ˆç°¡å–®èªªä¸€ä¸‹æˆ‘ç¾åœ¨çš„ EFK çµæ§‹ï¼š&lt;/p>
&lt;figure>&lt;img src="https://pin-yi.me/rd/fluentd-server-show-fluent-plugin-elasticsearch-error400/1.png"
alt="EFK çµæ§‹" width="900">&lt;figcaption>
&lt;p>EFK çµæ§‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>ç¾åœ¨çš„ EFK çµæ§‹å¦‚ä¸Šåœ–ï¼Œæˆ‘åœ¨è¦æŠ½ Log çš„ Pod ä¸­å¤šå¡ä¸€å€‹ fluentd-bit containerï¼Œå°‡ fluentd-bit èˆ‡æœå‹™(ä¾‹å¦‚ nginx) çš„ log æ›ç›¸åŒè·¯å¾‘ï¼Œè®“ fluentd-bit å¯ä»¥æŠ½åˆ°æœå‹™ logï¼Œæ¥è‘—å°±é€é fluentd-server-svc æ‰“åˆ° fluentd-server podï¼Œå¾Œé¢å°±æ˜¯å¸¸è¦‹çš„ EFK çµæ§‹ï¼Œå°±ä¸å¤šåšèªªæ˜ã€‚&lt;/p>
&lt;br>
&lt;h2>å•é¡Œçš„å‡ºç¾&lt;span class="absolute -mt-20" id="å•é¡Œçš„å‡ºç¾">&lt;/span>
&lt;a href="#%e5%95%8f%e9%a1%8c%e7%9a%84%e5%87%ba%e7%8f%be" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘å€‘å°±åƒå¹³å¸¸ä¸€æ¨£å¯«å¥½æ•´å€‹ EFK çš„ yamlï¼Œrun çš„æ™‚å€™ä¹Ÿæ­£å¸¸ï¼Œå¯ä»¥æ”¶åˆ° logï¼Œä½†å¾ˆå¥‡æ€ªçš„æ˜¯æˆ‘å€‘å…ˆé€ &lt;code>log_false&lt;/code> çš„ log å¯ä»¥æ­£å¸¸æ”¶åˆ°ï¼Œä½†å†æ¥è‘—é€ &lt;code>log_true &lt;/code> å°±æ”¶ä¸åˆ°ï¼Œæˆ‘å€‘ä¹Ÿå˜—è©¦åéä¾†é€ï¼Œå…ˆé€ &lt;code>log_true&lt;/code>ï¼Œå†é€ &lt;code>log_false&lt;/code>ï¼Œç™¼ç¾æ›æ”¶ä¸åˆ° &lt;code>log_false&lt;/code> çš„ log&lt;/p>
&lt;br>
&lt;ul>
&lt;li>log_false&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;result&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;æˆ‘æ˜¯é¦¬è³½å…‹&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;code&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">11223344&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;data&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;end_at&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;2022-12-19 04:09:00&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;response_code&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;326dgf241geh1596489&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;job_name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;å®å®å™¹å™¹è–èª•ç¯€&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;method&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;url.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ul>
&lt;li>log_true&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;result&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;data&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;response_code&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;wkCJl1dfr45671607965&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ¥è‘—åœ¨ Fluentd-Server Log ä¸­ç™¼ç¾ Fluent::Plugin::Elasticsearch Error 400 - Rejected by Elasticsearch éŒ¯èª¤&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/fluentd-server-show-fluent-plugin-elasticsearch-error400/2.png"
alt="fluentd-server è·³å‡ºéŒ¯èª¤ LOG" width="1000">&lt;figcaption>
&lt;p>fluentd-server è·³å‡ºéŒ¯èª¤ LOG&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘åˆ°ç¶²è·¯ä¸Šæœå°‹ï¼Œçœ‹çœ‹æœ‰æ²’æœ‰äººæœ‰é‡åˆ°è·Ÿæˆ‘ä¸€æ¨£çš„å•é¡Œï¼Œç™¼ç¾åœ¨ &lt;a href="https://github.com/uken/fluent-plugin-elasticsearch/issues/467" target="_blank" rel="noopener">uken/fluent-plugin-elasticsearch&lt;/a> ä¹Ÿæœ‰å…¶ä»–äººæœ‰é‡åˆ°åŒæ¨£çš„å•é¡Œ&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/fluentd-server-show-fluent-plugin-elasticsearch-error400/3.png"
alt="uken/fluent-plugin-elasticsearch issus è©¢å•" width="1000">&lt;figcaption>
&lt;p>uken/fluent-plugin-elasticsearch issus è©¢å•&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>æœ‰äººèªªå¯èƒ½æ˜¯ Elasticsearch çš„ disk æ»¿äº†ï¼Œä¹Ÿæœ‰äººèªªæ˜¯è£åœ¨ Fluentd-Server çš„å¥—ä»¶ fluent-plugin-elasticsearch ç‰ˆæœ¬æœ‰å•é¡Œï¼Œæˆ–æ˜¯å°‡ Elasticsearch è·Ÿ Kibana index åˆªé™¤å°±å¯ä»¥ï¼Œæˆ‘æœ‰ç æ‰ index å†é‡æ–°å€’å…¥ Logï¼Œé‚„æ˜¯æœƒæœ‰å•é¡Œã€‚&lt;/p>
&lt;p>ä¸€é–‹å§‹ä»¥ç‚ºæ˜¯ &lt;code>log_false&lt;/code> è·Ÿ &lt;code>log_true&lt;/code> çš„æ¬„ä½ä¸åŒï¼Œæ‰€ä»¥æ‰æœƒæœ‰é€™å€‹å•é¡Œç™¼ç”Ÿï¼ˆä½ çœ‹å°±çŸ¥é“æˆ‘è·Ÿ EFK ä¸ç†Ÿå§ï¼¸ï¼¤ï¼‰ï¼Œæ‰€ä»¥æœ‰å¦å¤–å€’ä¸€äº›å…¶ä»–æœå‹™(æ¬„ä½ä¹Ÿä¸åŒ)çš„ log é€²å»æ¸¬è©¦ï¼Œç™¼ç¾æ˜¯å¯ä»¥æ­£å¸¸æŠ½åˆ°ï¼Œä¸” kibana é‚£é‚Šæœƒä¾ç…§ es æä¾›çš„æ¬„ä½è‡ªå‹•æ–°å¢ï¼Œæ‰€ä»¥ä¹Ÿä¸æ˜¯æ¬„ä½çš„å•é¡Œï¼Œé‚£æœ€å¾Œçš„å•é¡Œæ˜¯ä»€éº¼å‘¢ï¼Ÿ&lt;/p>
&lt;br>
&lt;h2>å¦‚ä½•è§£æ±ºå•é¡Œ&lt;span class="absolute -mt-20" id="å¦‚ä½•è§£æ±ºå•é¡Œ">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e8%a7%a3%e6%b1%ba%e5%95%8f%e9%a1%8c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æœ€å¾Œåœ¨æˆ‘å€‘ä»”ç´°æª¢æŸ¥å¾Œç™¼ç¾ï¼Œ&lt;code>log_false&lt;/code> è·Ÿ &lt;code>log_true&lt;/code> çš„æ¬„ä½å…¶ä¸­ä¸€æ¨£å­˜çš„è³‡æ–™å‹æ…‹ä¸å¤ªä¸€æ¨£ï¼Œç™¼ç¾å…¶ä¸­çš„ &lt;code>data&lt;/code> æ¬„ä½åœ¨ &lt;code>log_false&lt;/code> çš„è³‡æ–™å‹æ…‹æ˜¯ arrayï¼Œåœ¨ &lt;code>log_true&lt;/code> å­˜çš„æ™‚å€™æ˜¯å­—ä¸²ï¼Œæ‰€ä»¥å°è‡´ç•¶å…¶ä¸­ä¸€å€‹ log å¯«å…¥å¾Œï¼Œå¦ä¸€å€‹ log å°±æœƒå› ç‚ºåŒæ¬„ä½çš„è³‡æ–™å‹æ…‹æœ‰æ‰€ä¸åŒï¼Œè€Œç„¡æ³•å¯«å…¥ logï¼Œä¸”åœ¨ Fluentd-Server æœƒå‡ºç¾æ¨™é¡Œçš„ Error 400 åŸå› æ‹‰ï½&lt;/p>
&lt;p>æœ€å¾Œé‡æ–°èª¿æ•´æ¬„ä½çš„è³‡æ–™å‹æ…‹ï¼Œå°±é †åˆ©è§£æ±ºæ­¤æ¬¡å•é¡Œ âœŒï¸âœŒï¸âœŒï¸&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Elasticsearch 400 error #467ï¼š&lt;a href="https://github.com/uken/fluent-plugin-elasticsearch/issues/467" target="_blank" rel="noopener">https://github.com/uken/fluent-plugin-elasticsearch/issues/467&lt;/a>&lt;/p></description></item><item><title>Kibana æ–°å¢ index ç´¢å¼•æ™‚ä¸€ç›´è½‰åœˆåœˆä»¥åŠé¡¯ç¤º HTTP 403 Forbidden</title><link>https://pin-yi.me/blog/rd/kibana-create-index-forbidden/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/rd/kibana-create-index-forbidden/</guid><description>
&lt;p>å‰å¹¾å¤©åœ¨å·¥ä½œä½¿ç”¨ Kibana æ™‚ï¼Œæƒ³è¦æ–°å¢ä¸€å€‹æ–°çš„ç´¢å¼•ï¼Œç™¼ç¾é¸æ“‡ç´¢å¼•ä¸¦æŒ‰ä¸‹æ–°å¢çš„æŒ‰éˆ•ï¼Œæœƒä¸€ç›´è½‰åœˆåœˆï¼Œç­‰äº†ä¸€é™£å­ï¼Œä½¿ç”¨é–‹ç™¼å·¥å…· F12 æŸ¥çœ‹ï¼Œè·³å‡ºäº† HTTP 403 Forbiddenï¼Œåˆ°åº•æ˜¯ä»€éº¼åŸå› å°è‡´çš„å‘¢ï¼ï¼Ÿæˆ‘å€‘ä¸€èµ·çœ‹ä¸‹å»å§ï¼Œæœƒå¾å•é¡Œçš„å‡ºç¾åˆ°å•é¡ŒåŸå› å†åˆ°å¦‚ä½•è§£æ±ºå•é¡Œï¼Œä¾†ä»”ç´°ä»‹ç´¹ï¼Œå¸Œæœ›å¤§å®¶ä¸è¦åƒæˆ‘ä¸€æ¨£è¸©åˆ°é›· ğŸ¤£&lt;/p>
&lt;br>
&lt;h2>å•é¡Œçš„å‡ºç¾&lt;span class="absolute -mt-20" id="å•é¡Œçš„å‡ºç¾">&lt;/span>
&lt;a href="#%e5%95%8f%e9%a1%8c%e7%9a%84%e5%87%ba%e7%8f%be" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;del>é‚£å¤©æ˜¯å€‹è®Šå†·çš„ 12 æœˆ&lt;/del>ï¼Œè¦å¹« RD åŒä»æ–°å¢ Kibana çš„ç´¢å¼•æ™‚ï¼Œç…§å¾€å¸¸ä¸€æ¨£è¼¸å…¥ Index patternï¼ŒæŒ‰ä¸‹ä¸€æ­¥ï¼Œé¸æ“‡ Configure settings ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/kibana-create-index-forbidden/1.png"
alt="è¼¸å…¥ Index pattern (åœ–ç‰‡ç‚ºç¯„ä¾‹ï¼Œæ­£å¸¸éƒ½æ˜¯ç”¨ -* )" width="800">&lt;figcaption>
&lt;p>è¼¸å…¥ Index pattern (åœ–ç‰‡ç‚ºç¯„ä¾‹ï¼Œæ­£å¸¸éƒ½æ˜¯ç”¨ -* )&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æŒ‰ä¸‹æ–°å¢ç´¢å¼•ï¼Œä»–å°±é–‹å§‹ç„¡é™çš„è½‰åœˆåœˆï¼Œæœ‰å»æŸ¥çœ‹ ElasticSearch çš„ logï¼Œç™¼ç¾ä¹Ÿæ²’æœ‰ç‰¹åˆ¥çš„éŒ¯èª¤è¨Šæ¯&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/kibana-create-index-forbidden/2.png"
alt="æ–°å¢ç´¢å¼•å¾Œï¼Œä¸€ç›´è½‰åœˆåœˆ" width="800">&lt;figcaption>
&lt;p>æ–°å¢ç´¢å¼•å¾Œï¼Œä¸€ç›´è½‰åœˆåœˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ¥è‘—æƒ³èªªæ‰“é–‹é–‹ç™¼è€…å·¥å…· F12 ä¾†çœ‹çœ‹ï¼Œæ˜¯å¡åœ¨å“ªä¸€å€‹é»ï¼Œå»ç™¼ç¾æœ‰å¹¾å€‹ç´…å­—å¯«è‘— HTTP 403 Forbidden&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/kibana-create-index-forbidden/3.png"
alt="é–‹ç™¼è€…å·¥å…·ç¶²é å…§å®¹é¡¯ç¤º HTTP 403 Forbidden" width="800">&lt;figcaption>
&lt;p>é–‹ç™¼è€…å·¥å…·ç¶²é å…§å®¹é¡¯ç¤º HTTP 403 Forbidden&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æƒ³èªªç‚ºä»€éº¼æœƒæœ‰ HTTP 403 Forbiddenï¼Œä¹‹å‰ä¹Ÿæ²’æœ‰çœ‹éé¡ä¼¼çš„éŒ¯èª¤è¨Šæ¯ï¼Œæ–¼æ˜¯å°±é–‹å§‹åœ¨ç¶²è·¯ä¸Šäº‚æ™ƒï¼Œæœ€å¾Œåœ¨åŒäº‹çš„å¹«åŠ©ä¸‹æ‰¾åˆ°äº†ä¸€å€‹è·Ÿæˆ‘å€‘æƒ…æ³å¾ˆç›¸ä¼¼çš„æ–‡ç«  &lt;a href="https://www.cnblogs.com/caoweixiong/p/10972120.html" target="_blank" rel="noopener">Kibana åˆ›å»ºç´¢å¼• POST 403 (forbidden) on create index&lt;/a>&lt;/p>
&lt;br>
&lt;h2>å•é¡ŒåŸå› &lt;span class="absolute -mt-20" id="å•é¡ŒåŸå› ">&lt;/span>
&lt;a href="#%e5%95%8f%e9%a1%8c%e5%8e%9f%e5%9b%a0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æ–‡ç« çš„èªªæ˜æ˜¯ç´¢å¼•è®Šæˆåªå…è¨±è®€å–çš„ç‹€æ…‹ï¼Œå…¶åŸå› æ˜¯å› ç‚ºå‡ºç¾é€™å€‹ HTTP 403 Forbidden å‰ï¼ŒElasticSearch çš„ç©ºé–“æ»¿äº†ï¼Œå°è‡´ Kibana æœƒè‡ªå‹•çš„å°‡ç´¢å¼•æ”¹æˆåªå…è¨±è®€å–çš„ç‹€æ…‹ï¼Œæˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹å‰›å‰›çš„ Index ç‹€æ…‹æ˜¯ä¸æ˜¯åƒä»–èªªçš„ä¸€æ¨£è®Šæˆåªå…è¨±è®€å–çš„ç‹€æ…‹å‘¢&lt;/p>
&lt;br>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
å¯ä»¥åˆ° kibana çš„ Dev Tools ä¸‹æŒ‡ä»¤ä¾†æŸ¥è©¢æ­ï¼Œè¼¸å…¥ &lt;code>GET _settings&lt;/code>ï¼Œå°±æœƒé¡¯ç¤ºä»¥ä¸‹åœ–ç‰‡çš„å…§å®¹å›‰
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/kibana-create-index-forbidden/4.png"
alt="ç´¢å¼•åªå…è¨±è®€å–çš„è¨­å®šè®Šæˆ" width="900">&lt;figcaption>
&lt;p>ç´¢å¼•åªå…è¨±è®€å–çš„è¨­å®šè®Šæˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç™¼ç¾æ­£å¦‚æ–‡ç« æ‰€èªªï¼Œæ˜¯å› ç‚º read_only_allow_delete çš„ç‹€æ…‹è®Šæˆäº† &lt;code>true&lt;/code>ï¼Œæ‰€ä»¥æ‰æ²’è¾¦æ³•æ–°å¢ç´¢å¼•ï½&lt;/p>
&lt;br>
&lt;h2>å¦‚ä½•è§£æ±ºå•é¡Œ&lt;span class="absolute -mt-20" id="å¦‚ä½•è§£æ±ºå•é¡Œ">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e8%a7%a3%e6%b1%ba%e5%95%8f%e9%a1%8c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘å€‘æŸ¥çœ‹æ–‡ç« çš„è§£æ±ºè¾¦æ³•ï¼Œæœ‰å…©ç¨®è¾¦æ³•ï¼Œä¸€å€‹æ˜¯æ“´å¤§ ElasticSearch çš„ç©ºé–“ï¼Œä»¥åŠä½¿ç”¨ kibana çš„ Dev Tools ä¸‹æŒ‡ä»¤ä¿®æ”¹ï¼Œé‚£æˆ‘å€‘å…©ç¨®éƒ½æœ‰åšï¼Œé€™é‚Šå°±ç›´æ¥ä»‹ç´¹ä¸‹æŒ‡ä»¤éœ€è¦è¼¸å…¥ä»€éº¼ï½&lt;/p>
&lt;p>éœ€è¦å† Dev Tools è¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼Œä¾†ä¿®æ”¹ Index çš„ç‹€æ…‹ï¼š&lt;/p>
&lt;br>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">PUT&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">_settings&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;index&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;blocks&amp;#34;&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;read_only_allow_delete&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;false&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/kibana-create-index-forbidden/5.png"
alt="Dev Tools ä¿®æ”¹ Index çš„ç‹€æ…‹" width="600">&lt;figcaption>
&lt;p>Dev Tools ä¿®æ”¹ Index çš„ç‹€æ…‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æœ€å¾Œæˆ‘å€‘ç”¨ &lt;code>GET _settings&lt;/code> æª¢æŸ¥ä¸€ä¸‹ç´¢å¼•ç‹€æ…‹æ˜¯ä¸æ˜¯å·²ç¶“è®Šå›åŸæœ¬çš„äº†ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/kibana-create-index-forbidden/6.png"
alt="ç´¢å¼•åªå…è¨±è®€å–çš„è¨­å®šè®Šæˆ false" width="900">&lt;figcaption>
&lt;p>ç´¢å¼•åªå…è¨±è®€å–çš„è¨­å®šè®Šæˆ false&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æœ€å¾Œå°±å¯ä»¥é †åˆ©æ–°å¢ç´¢å¼•æ‹‰ ğŸ‘ğŸ‘ğŸ‘&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/rd/kibana-create-index-forbidden/7.png"
alt="é †åˆ©æ–°å¢ç´¢å¼•" width="900">&lt;figcaption>
&lt;p>é †åˆ©æ–°å¢ç´¢å¼•&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Kibana åˆ›å»ºç´¢å¼• POST 403 (forbidden) on create indexï¼š&lt;a href="https://www.cnblogs.com/caoweixiong/p/10972120.html" target="_blank" rel="noopener">https://www.cnblogs.com/caoweixiong/p/10972120.html&lt;/a>&lt;/p></description></item><item><title>å¦‚ä½•å•Ÿç”¨ GitLab çš„ Package Registry ä»¥åŠå°‡å„²å­˜ä½ç½®å¾ä¼ºæœå™¨æ”¹åˆ° GCS ä¸Š</title><link>https://pin-yi.me/blog/rd/gitlab-package-registry-to-gcs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/rd/gitlab-package-registry-to-gcs/</guid><description>
&lt;p>ä»Šå¤©æ¥åˆ°ä¸€å€‹æ¡ˆå­ï¼ŒRD éƒ¨é–€ä¹‹å¾Œæƒ³è¦ä½¿ç”¨ GitLab çš„ Package Registry åŠŸèƒ½ä¾†ç™¼å¸ƒå¥—ä»¶ï¼Œä¸”ä¸æƒ³æŠŠå®ƒå­˜åœ¨ GitLab ä¼ºæœå™¨ä¸Šï¼Œå¸Œæœ›å¯ä»¥ç›´æ¥å­˜åˆ° GCP çš„ Google Cloud Storage ä¸Šï¼Œæ‰€ä»¥æ‰æœƒæœ‰äº†æ­¤ç¯‡ç­†è¨˜ä¾†è¨˜éŒ„ä¸€ä¸‹æ•´å€‹éç¨‹ã€‚&lt;/p>
&lt;br>
&lt;p>ç‰ˆæœ¬è³‡è¨Š&lt;/p>
&lt;ul>
&lt;li>GitLab 14.10 (æœ‰éƒ¨åˆ†è¨­å®šæœƒæ–¼æ–°ç‰ˆæœ¬æ£„ç”¨ï¼Œè«‹è¨˜å¾—ç¢ºèªå¥½è‡ªå·±çš„ç‰ˆæœ¬æ˜¯å¦æ”¯æ´)&lt;/li>
&lt;/ul>
&lt;p>å…ˆèªªä¸€ä¸‹ï¼Œæˆ‘å€‘çš„ GitLab æ˜¯ä½¿ç”¨ docker-compose ä¾†å»ºç½®ï¼Œæ‰€ä»¥å¾ŒçºŒçš„å¯¦ä½œå…§å®¹éƒ½æœƒä»¥ docker-compose çš„æ–¹å¼ä¾†ä»‹ç´¹ã€‚&lt;/p>
&lt;br>
&lt;h2>å•Ÿå‹• GitLab çš„ Package Registry&lt;span class="absolute -mt-20" id="å•Ÿå‹•-gitlab-çš„-package-registry">&lt;/span>
&lt;a href="#%e5%95%9f%e5%8b%95-gitlab-%e7%9a%84-package-registry" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é¦–å…ˆï¼Œæˆ‘å€‘ç•¶ç„¶è¦å…ˆå•Ÿå‹•é€™é … Package Registry åŠŸèƒ½ï¼Œæ‰å¯ä»¥å†ä¹‹å¾Œä½¿ç”¨å®ƒï¼Œæˆ‘å€‘å…ˆçœ‹ä¸€ä¸‹ GitLab å•Ÿå‹•çš„ docker-compose.yml æª”æ¡ˆï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">gitlab&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;gitlab/gitlab-ee:14.10.5-ee.0&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">restart&lt;/span>: &lt;span style="color:#ae81ff">always&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">gitlab&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hostname&lt;/span>: &lt;span style="color:#ae81ff">gitlab-pid&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">logging&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">driver&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;json-file&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">options&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">max-size&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;100m&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">max-file&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;50&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">GITLAB_OMNIBUS_CONFIG&lt;/span>: |&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> external_url &amp;#39;${GITLAB_DOMAIN}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> letsencrypt[&amp;#39;enable&amp;#39;] = false
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;initial_root_password&amp;#39;] = &amp;#39;${GITLAB_ROOT_PASSWORD}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;gitlab_shell_ssh_port&amp;#39;] = &amp;#39;${GITLAB_HOST_SSH_PORT}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;backup_keep_time&amp;#39;] = 79200
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_allow_single_sign_on&amp;#39;] = [&amp;#39;google_oauth2&amp;#39;]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_block_auto_created_users&amp;#39;] = false
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_sync_profile_from_provider&amp;#39;] = [&amp;#39;google_oauth2&amp;#39;]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_sync_profile_attributes&amp;#39;] = [&amp;#39;name&amp;#39;, &amp;#39;email&amp;#39;]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_providers&amp;#39;] = [
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">ç•¥éï¼ï¼ï¼&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;${GITLAB_HOST_SSH_PORT}:22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;${GITLAB_HOST_HTTP_PORT}:80&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;${GITLAB_HOST_HTTPS_PORT}:443&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;./config:/etc/gitlab&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;./logs:/var/log/gitlab&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;./data:/var/opt/gitlab&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æœ‰äº›è¨­å®šæœ‰ç•¥éæˆ–æ˜¯çœç•¥ä¸å¯«ï¼Œå¤§å®¶å°±ä¾ç…§è‡ªå·±çš„è¨­å®šä¾†çœ‹å°±å¥½ï½&lt;/p>
&lt;br>
&lt;h2>æ–°å¢ Package Registry è¨­å®š&lt;span class="absolute -mt-20" id="æ–°å¢-package-registry-è¨­å®š">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e-package-registry-%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘å€‘åœ¨ä¸Šæ–¹çš„ &lt;code>gitlab_rails['omniauth_providers'] = [ ... ç•¥ ... ] &lt;/code> ä¹‹å¾ŒåŠ ä¸Šæ–°å¢ Package Registry è¨­å®šå…§å®¹ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_enabled&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_enabled&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_remote_directory&amp;#39;] = &amp;#34;GCS åç¨±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_direct_upload&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_background_upload&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_proxy_download&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_connection&amp;#39;] = {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;provider&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">=&amp;gt; &amp;#39;Google&amp;#39;,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;google_project&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">=&amp;gt; &amp;#39;å°ˆæ¡ˆ ID&amp;#39;,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;google_json_key_location&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">=&amp;gt; &amp;#39;/etc/gitlab/google_key.json&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>packages_enabledï¼šå•Ÿå‹• packages&lt;/li>
&lt;li>packages_object_store_enabledï¼šå•Ÿå‹• packages å°è±¡å­˜å„²&lt;/li>
&lt;li>packages_object_store_remote_directoryï¼šè¨­å®š packages å°è±¡å­˜å„²ä½ç½®ï¼Œé€™é‚Šè¦è¼¸å…¥ GCS çš„åç¨±&lt;/li>
&lt;li>packages_object_store_direct_uploadï¼šè¨­å®šæ˜¯å¦å¯ä»¥ç›´æ¥ä¸Šå‚³åˆ°å°è±¡å­˜å„²ä½ç½®&lt;/li>
&lt;li>packages_object_store_background_uploadï¼šè¨­å®šæ˜¯å¦ä»¥å¾Œå°æ–¹å¼ä¸Šå‚³åˆ°å°è±¡å­˜å„²ä½ç½®&lt;/li>
&lt;li>packages_object_store_proxy_downloadï¼šè¨­å®šæ˜¯å¦å¯ä»¥é€éä»£ç†ä¼ºæœå™¨é€²è¡Œå¥—ä»¶ä¸‹è¼‰&lt;/li>
&lt;li>packages_object_store_connectionï¼šè¨­å®šé€£æ¥åˆ°å°è±¡å­˜å„²ï¼Œç”±æ–¼æˆ‘å€‘è¦å­˜åˆ° GCS ä¸Šé¢ï¼Œéœ€è¦æœ‰é€™ä¸‰é … providerã€google_projectã€google_json_key_location æ‰å¯ä»¥å°‡ packages å­˜åˆ° GCS ä¸Šã€‚å¦‚æœæƒ³ç”¨å…¶ä»–çš„å„²å­˜ä½ç½®ï¼Œä¾‹å¦‚ Amazon S3ã€Azure Blob storage å¯ä»¥åƒè€ƒ &lt;a href="https://docs.gitlab.com/ee/administration/object_storage.html" target="_blank" rel="noopener">Object storage è©³ç´°è¨­å®š&lt;/a> ( å…¶ä¸­çš„ google_json_key_location æ˜¯è¦æ”¾å¯ä»¥è®€å¯« GCS çš„ SA SECRET æª”æ¡ˆ )&lt;/li>
&lt;/ul>
&lt;br>
&lt;h2>å…ˆæŸ¥çœ‹å°šæœªé‡å•Ÿçš„ GitLab Package&lt;span class="absolute -mt-20" id="å…ˆæŸ¥çœ‹å°šæœªé‡å•Ÿçš„-gitlab-package">&lt;/span>
&lt;a href="#%e5%85%88%e6%9f%a5%e7%9c%8b%e5%b0%9a%e6%9c%aa%e9%87%8d%e5%95%9f%e7%9a%84-gitlab-package" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç”±æ–¼å…¬å¸ GitLab é è¨­æœ‰å…ˆé–‹å•Ÿ packages_enabledï¼Œæ‰€ä»¥æˆ‘å°±æ‹¿åŒäº‹ç”¨ Helm å¯«çš„ CIï¼Œä¾†åšæ¸¬è©¦ã€‚ç•¶æ›´æ–° value.yaml å¾Œæœƒè‡ªå‹•æ‰“åŒ… Package æ”¾åˆ° Package Registry ä¸­ï¼Œæˆ‘å€‘ç›´æ¥é€²å…¥åˆ°é è¨­ Package Registry çš„å„²å­˜ä½ç½®ï¼Œæ˜¯åœ¨ &lt;code>/var/opt/gitlab/gitlab-rails/shared/packages/&lt;/code>ï¼Œç”¨æŒ‡ä»¤ç™¼ç¾æ‰“åŒ…çš„ Package çš„ç¢ºå­˜æ”¾æ–¼æ­¤ ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/other/gitlab-package-registry-to-gcs/1.png"
alt="æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å°šæœªé·ç§»)" width="800">&lt;figcaption>
&lt;p>æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å°šæœªé·ç§»)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>é‡å•Ÿè¨­å®šå¾Œå†æ¬¡æª¢æŸ¥ GitLab Package&lt;span class="absolute -mt-20" id="é‡å•Ÿè¨­å®šå¾Œå†æ¬¡æª¢æŸ¥-gitlab-package">&lt;/span>
&lt;a href="#%e9%87%8d%e5%95%9f%e8%a8%ad%e5%ae%9a%e5%be%8c%e5%86%8d%e6%ac%a1%e6%aa%a2%e6%9f%a5-gitlab-package" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç•¶æˆ‘å€‘é‡å•Ÿè¨­å®šå¾Œï¼Œä¹Ÿæœ‰å»ºç«‹å¥½å¯ä¾›æˆ‘å€‘æ¬Šé™ SA çš„ GCS å¾Œï¼Œæœƒç™¼ç¾åŸæœ¬å­˜åœ¨é è¨­ &lt;code>/var/opt/gitlab/gitlab-rails/shared/packages/&lt;/code> æ²’æœ‰è‡ªå‹•è·‘åˆ° GCS ä¸Šï¼Œæ˜¯å› ç‚ºæˆ‘å€‘é‚„éœ€è¦æ‰‹å‹•ä¸‹æŒ‡ä»¤å°‡ä»–é·ç§»éå»ï¼ŒæŒ‡ä»¤æ˜¯ &lt;code>gitlab-rake &amp;quot;gitlab:packages:migrate&amp;quot;&lt;/code>ï¼Œæœ€å¾Œç­‰ä»–è·‘å®Œæˆ‘å€‘åœ¨æª¢æŸ¥ä¸€ä¸‹é è¨­å„²å­˜ä½ç½®å°±ç™¼ç¾å·²ç¶“æ²’æœ‰ Package äº†&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/other/gitlab-package-registry-to-gcs/2.png"
alt="æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å·²é·ç§»)" width="800">&lt;figcaption>
&lt;p>æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å·²é·ç§»)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é–‹ GCS ç¶²ç«™ä¾†çœ‹æœƒç™¼ç¾åŸå…ˆåœ¨é è¨­å„²å­˜ä½ç½®çš„ Package éƒ½å¯ä»¥è·‘åˆ° GCS ä¸Šï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/other/gitlab-package-registry-to-gcs/3.png"
alt="æŸ¥çœ‹å·²é·ç§»åˆ° Google Cloud Storage çš„ Package" width="800">&lt;figcaption>
&lt;p>æŸ¥çœ‹å·²é·ç§»åˆ° Google Cloud Storage çš„ Package&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>GitLab Package Registry administrationï¼š&lt;a href="https://docs.gitlab.com/14.10/ee/administration/packages/" target="_blank" rel="noopener">https://docs.gitlab.com/14.10/ee/administration/packages/&lt;/a>&lt;/p></description></item></channel></rss>