<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PIN-YI â€“ Git æˆ– CICD ç›¸é—œ</title><link>https://pin-yi.me/blog/git-or-cicd/</link><description>Recent content in Git æˆ– CICD ç›¸é—œ on PIN-YI</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><atom:link href="https://pin-yi.me/blog/git-or-cicd/index.xml" rel="self" type="application/rss+xml"/><item><title>å¦‚ä½•å•Ÿç”¨ GitLab çš„ Package Registry ä»¥åŠå°‡å„²å­˜ä½ç½®å¾ä¼ºæœå™¨æ”¹åˆ° GCS ä¸Š</title><link>https://pin-yi.me/blog/git-or-cicd/gitlab-package-registry-to-gcs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/git-or-cicd/gitlab-package-registry-to-gcs/</guid><description>
&lt;p>ä»Šå¤©æ¥åˆ°ä¸€å€‹æ¡ˆå­ï¼ŒRD éƒ¨é–€ä¹‹å¾Œæƒ³è¦ä½¿ç”¨ GitLab çš„ Package Registry åŠŸèƒ½ä¾†ç™¼å¸ƒå¥—ä»¶ï¼Œä¸”ä¸æƒ³æŠŠå®ƒå­˜åœ¨ GitLab ä¼ºæœå™¨ä¸Šï¼Œå¸Œæœ›å¯ä»¥ç›´æ¥å­˜åˆ° GCP çš„ Google Cloud Storage ä¸Šï¼Œæ‰€ä»¥æ‰æœƒæœ‰äº†æ­¤ç¯‡ç­†è¨˜ä¾†è¨˜éŒ„ä¸€ä¸‹æ•´å€‹éç¨‹ã€‚&lt;/p>
&lt;br>
&lt;p>ç‰ˆæœ¬è³‡è¨Š&lt;/p>
&lt;ul>
&lt;li>GitLab 14.10 (æœ‰éƒ¨åˆ†è¨­å®šæœƒæ–¼æ–°ç‰ˆæœ¬æ£„ç”¨ï¼Œè«‹è¨˜å¾—ç¢ºèªå¥½è‡ªå·±çš„ç‰ˆæœ¬æ˜¯å¦æ”¯æ´)&lt;/li>
&lt;/ul>
&lt;p>å…ˆèªªä¸€ä¸‹ï¼Œæˆ‘å€‘çš„ GitLab æ˜¯ä½¿ç”¨ docker-compose ä¾†å»ºç½®ï¼Œæ‰€ä»¥å¾ŒçºŒçš„å¯¦ä½œå…§å®¹éƒ½æœƒä»¥ docker-compose çš„æ–¹å¼ä¾†ä»‹ç´¹ã€‚&lt;/p>
&lt;br>
&lt;h2>å•Ÿå‹• GitLab çš„ Package Registry&lt;span class="absolute -mt-20" id="å•Ÿå‹•-gitlab-çš„-package-registry">&lt;/span>
&lt;a href="#%e5%95%9f%e5%8b%95-gitlab-%e7%9a%84-package-registry" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é¦–å…ˆï¼Œæˆ‘å€‘ç•¶ç„¶è¦å…ˆå•Ÿå‹•é€™é … Package Registry åŠŸèƒ½ï¼Œæ‰å¯ä»¥å†ä¹‹å¾Œä½¿ç”¨å®ƒï¼Œæˆ‘å€‘å…ˆçœ‹ä¸€ä¸‹ GitLab å•Ÿå‹•çš„ docker-compose.yml æª”æ¡ˆï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">gitlab&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;gitlab/gitlab-ee:14.10.5-ee.0&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">restart&lt;/span>: &lt;span style="color:#ae81ff">always&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">gitlab&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hostname&lt;/span>: &lt;span style="color:#ae81ff">gitlab-pid&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">logging&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">driver&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;json-file&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">options&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">max-size&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;100m&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">max-file&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;50&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">GITLAB_OMNIBUS_CONFIG&lt;/span>: |&lt;span style="color:#e6db74">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> external_url &amp;#39;${GITLAB_DOMAIN}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> letsencrypt[&amp;#39;enable&amp;#39;] = false
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;initial_root_password&amp;#39;] = &amp;#39;${GITLAB_ROOT_PASSWORD}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;gitlab_shell_ssh_port&amp;#39;] = &amp;#39;${GITLAB_HOST_SSH_PORT}&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;backup_keep_time&amp;#39;] = 79200
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_allow_single_sign_on&amp;#39;] = [&amp;#39;google_oauth2&amp;#39;]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_block_auto_created_users&amp;#39;] = false
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_sync_profile_from_provider&amp;#39;] = [&amp;#39;google_oauth2&amp;#39;]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_sync_profile_attributes&amp;#39;] = [&amp;#39;name&amp;#39;, &amp;#39;email&amp;#39;]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> gitlab_rails[&amp;#39;omniauth_providers&amp;#39;] = [
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">ç•¥éï¼ï¼ï¼&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;${GITLAB_HOST_SSH_PORT}:22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;${GITLAB_HOST_HTTP_PORT}:80&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;${GITLAB_HOST_HTTPS_PORT}:443&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;./config:/etc/gitlab&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;./logs:/var/log/gitlab&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#39;./data:/var/opt/gitlab&amp;#39;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æœ‰äº›è¨­å®šæœ‰ç•¥éæˆ–æ˜¯çœç•¥ä¸å¯«ï¼Œå¤§å®¶å°±ä¾ç…§è‡ªå·±çš„è¨­å®šä¾†çœ‹å°±å¥½ï½&lt;/p>
&lt;br>
&lt;h2>æ–°å¢ Package Registry è¨­å®š&lt;span class="absolute -mt-20" id="æ–°å¢-package-registry-è¨­å®š">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e-package-registry-%e8%a8%ad%e5%ae%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘å€‘åœ¨ä¸Šæ–¹çš„ &lt;code>gitlab_rails['omniauth_providers'] = [ ... ç•¥ ... ] &lt;/code> ä¹‹å¾ŒåŠ ä¸Šæ–°å¢ Package Registry è¨­å®šå…§å®¹ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_enabled&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_enabled&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_remote_directory&amp;#39;] = &amp;#34;GCS åç¨±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_direct_upload&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_background_upload&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_proxy_download&amp;#39;] = true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">gitlab_rails[&amp;#39;packages_object_store_connection&amp;#39;] = {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;provider&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">=&amp;gt; &amp;#39;Google&amp;#39;,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;google_project&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">=&amp;gt; &amp;#39;å°ˆæ¡ˆ ID&amp;#39;,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;google_json_key_location&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">=&amp;gt; &amp;#39;/etc/gitlab/google_key.json&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>packages_enabledï¼šå•Ÿå‹• packages&lt;/li>
&lt;li>packages_object_store_enabledï¼šå•Ÿå‹• packages å°è±¡å­˜å„²&lt;/li>
&lt;li>packages_object_store_remote_directoryï¼šè¨­å®š packages å°è±¡å­˜å„²ä½ç½®ï¼Œé€™é‚Šè¦è¼¸å…¥ GCS çš„åç¨±&lt;/li>
&lt;li>packages_object_store_direct_uploadï¼šè¨­å®šæ˜¯å¦å¯ä»¥ç›´æ¥ä¸Šå‚³åˆ°å°è±¡å­˜å„²ä½ç½®&lt;/li>
&lt;li>packages_object_store_background_uploadï¼šè¨­å®šæ˜¯å¦ä»¥å¾Œå°æ–¹å¼ä¸Šå‚³åˆ°å°è±¡å­˜å„²ä½ç½®&lt;/li>
&lt;li>packages_object_store_proxy_downloadï¼šè¨­å®šæ˜¯å¦å¯ä»¥é€éä»£ç†ä¼ºæœå™¨é€²è¡Œå¥—ä»¶ä¸‹è¼‰&lt;/li>
&lt;li>packages_object_store_connectionï¼šè¨­å®šé€£æ¥åˆ°å°è±¡å­˜å„²ï¼Œç”±æ–¼æˆ‘å€‘è¦å­˜åˆ° GCS ä¸Šé¢ï¼Œéœ€è¦æœ‰é€™ä¸‰é … providerã€google_projectã€google_json_key_location æ‰å¯ä»¥å°‡ packages å­˜åˆ° GCS ä¸Šã€‚å¦‚æœæƒ³ç”¨å…¶ä»–çš„å„²å­˜ä½ç½®ï¼Œä¾‹å¦‚ Amazon S3ã€Azure Blob storage å¯ä»¥åƒè€ƒ &lt;a href="https://docs.gitlab.com/ee/administration/object_storage.html" target="_blank" rel="noopener">Object storage è©³ç´°è¨­å®š&lt;/a> ( å…¶ä¸­çš„ google_json_key_location æ˜¯è¦æ”¾å¯ä»¥è®€å¯« GCS çš„ SA SECRET æª”æ¡ˆ )&lt;/li>
&lt;/ul>
&lt;br>
&lt;h2>å…ˆæŸ¥çœ‹å°šæœªé‡å•Ÿçš„ GitLab Package&lt;span class="absolute -mt-20" id="å…ˆæŸ¥çœ‹å°šæœªé‡å•Ÿçš„-gitlab-package">&lt;/span>
&lt;a href="#%e5%85%88%e6%9f%a5%e7%9c%8b%e5%b0%9a%e6%9c%aa%e9%87%8d%e5%95%9f%e7%9a%84-gitlab-package" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç”±æ–¼å…¬å¸ GitLab é è¨­æœ‰å…ˆé–‹å•Ÿ packages_enabledï¼Œæ‰€ä»¥æˆ‘å°±æ‹¿åŒäº‹ç”¨ Helm å¯«çš„ CIï¼Œä¾†åšæ¸¬è©¦ã€‚ç•¶æ›´æ–° value.yaml å¾Œæœƒè‡ªå‹•æ‰“åŒ… Package æ”¾åˆ° Package Registry ä¸­ï¼Œæˆ‘å€‘ç›´æ¥é€²å…¥åˆ°é è¨­ Package Registry çš„å„²å­˜ä½ç½®ï¼Œæ˜¯åœ¨ &lt;code>/var/opt/gitlab/gitlab-rails/shared/packages/&lt;/code>ï¼Œç”¨æŒ‡ä»¤ç™¼ç¾æ‰“åŒ…çš„ Package çš„ç¢ºå­˜æ”¾æ–¼æ­¤ ï¼Œå¦‚ä¸‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-package-registry-to-gcs/1.png"
alt="æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å°šæœªé·ç§»)" width="800">&lt;figcaption>
&lt;p>æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å°šæœªé·ç§»)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>é‡å•Ÿè¨­å®šå¾Œå†æ¬¡æª¢æŸ¥ GitLab Package&lt;span class="absolute -mt-20" id="é‡å•Ÿè¨­å®šå¾Œå†æ¬¡æª¢æŸ¥-gitlab-package">&lt;/span>
&lt;a href="#%e9%87%8d%e5%95%9f%e8%a8%ad%e5%ae%9a%e5%be%8c%e5%86%8d%e6%ac%a1%e6%aa%a2%e6%9f%a5-gitlab-package" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç•¶æˆ‘å€‘é‡å•Ÿè¨­å®šå¾Œï¼Œä¹Ÿæœ‰å»ºç«‹å¥½å¯ä¾›æˆ‘å€‘æ¬Šé™ SA çš„ GCS å¾Œï¼Œæœƒç™¼ç¾åŸæœ¬å­˜åœ¨é è¨­ &lt;code>/var/opt/gitlab/gitlab-rails/shared/packages/&lt;/code> æ²’æœ‰è‡ªå‹•è·‘åˆ° GCS ä¸Šï¼Œæ˜¯å› ç‚ºæˆ‘å€‘é‚„éœ€è¦æ‰‹å‹•ä¸‹æŒ‡ä»¤å°‡ä»–é·ç§»éå»ï¼ŒæŒ‡ä»¤æ˜¯ &lt;code>gitlab-rake &amp;quot;gitlab:packages:migrate&amp;quot;&lt;/code>ï¼Œæœ€å¾Œç­‰ä»–è·‘å®Œæˆ‘å€‘åœ¨æª¢æŸ¥ä¸€ä¸‹é è¨­å„²å­˜ä½ç½®å°±ç™¼ç¾å·²ç¶“æ²’æœ‰ Package äº†&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-package-registry-to-gcs/2.png"
alt="æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å·²é·ç§»)" width="800">&lt;figcaption>
&lt;p>æª¢æŸ¥æ˜¯å¦é‚„æœ‰ Package åœ¨é è¨­å„²å­˜ä½ç½® (å·²é·ç§»)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é–‹ GCS ç¶²ç«™ä¾†çœ‹æœƒç™¼ç¾åŸå…ˆåœ¨é è¨­å„²å­˜ä½ç½®çš„ Package éƒ½å¯ä»¥è·‘åˆ° GCS ä¸Šï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-package-registry-to-gcs/3.png"
alt="æŸ¥çœ‹å·²é·ç§»åˆ° Google Cloud Storage çš„ Package" width="800">&lt;figcaption>
&lt;p>æŸ¥çœ‹å·²é·ç§»åˆ° Google Cloud Storage çš„ Package&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>GitLab Package Registry administrationï¼š&lt;a href="https://docs.gitlab.com/14.10/ee/administration/packages/" target="_blank" rel="noopener">https://docs.gitlab.com/14.10/ee/administration/packages/&lt;/a>&lt;/p></description></item><item><title>å¦‚ä½•åˆä½µå¤šå€‹ commitï¼Œä¸”æ¨åˆ°é ç«¯å‘¢ï¼Ÿ</title><link>https://pin-yi.me/blog/git-or-cicd/git-merge-multiple-commit/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/git-or-cicd/git-merge-multiple-commit/</guid><description>
&lt;p>ç•¶æˆ‘å€‘åœ¨ä½¿ç”¨ Git æ™‚ï¼Œå¸¸å¸¸ä¿®æ”¹å®Œå…§å®¹å¾Œï¼Œæœƒæ¨ commit åˆ° github or gitlabï¼Œåœ¨ä¸€å€‹åˆ†æ”¯ä¸Šé–‹ç™¼ä¹…äº†ï¼Œ commit æœƒç´¯ç©å¾ˆå¤šï¼Œå¾ˆé›œä¸”å¾ˆäº‚ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥è©¦è‘—å°‡ commit çµ¦åˆä½µã€‚&lt;/p>
&lt;br>
&lt;p>å¤§å®¶å¯ä»¥ä½¿ç”¨é€™å€‹æª”æ¡ˆä¾†åšç·´ç¿’ï¼š&lt;a href="https://github.com/880831ian/git-merge-multiple-commit" target="_blank" rel="noopener">é»æˆ‘ GoGo&lt;/a> ğŸ˜‰&lt;/p>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/git-merge-multiple-commit/1.png"
alt="git commit" width="400">&lt;figcaption>
&lt;p>git commit&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯ä»¥çœ‹åˆ°ä¸Šé¢é€™å¼µåœ–ï¼Œé€™å€‹èˆ‡&lt;a href="https://github.com/880831ian/git-merge-multiple-commit" target="_blank" rel="noopener">ç¯„ä¾‹æª”æ¡ˆ&lt;/a>çš„ commit ç›¸ä¼¼(ä¸åŒå°ˆæ¡ˆï¼Œæ‰€ä»¥ SHA-1 ä¹Ÿæœƒä¸åŒï¼Œç‚ºäº†æ¨¡æ“¬æ‰€ä»¥ commit ç›¸åŒè€Œå·²)ï¼Œæˆ‘å€‘æ¨¡æ“¬åœ¨åŒä¸€å€‹åˆ†æ”¯åº•ä¸‹ï¼Œæœ‰å¾ˆå¤šçš„ commitï¼Œé‚£æˆ‘å€‘è©¦è‘—æŠŠä»–çµ¦åˆä½µèµ·ä¾†ã€‚å…ˆèªªæ˜ä¸€ä¸‹ç›®å‰çš„ commit ç‹€æ³ï¼Œæˆ‘å€‘åœ¨ master åˆ†æ”¯ä¸Šæœ‰ 3 å€‹ commitï¼Œä¸”å·²ç¶“æ¨åˆ°é ç«¯ä¸Šã€‚æ‰€ä»¥æˆ‘å€‘æœ¬åœ°ä¿®æ”¹å¾Œï¼Œé‚„è¦è®“é ç«¯çš„ä¹Ÿåˆä½µï¼Œé€™å€‹æ­¥é©Ÿè¦æ€éº¼åšå‘¢ï¼Ÿå¤§å®¶å¯ä»¥å…ˆæƒ³æƒ³çœ‹ï¼Œå¾Œé¢æœƒå‘Šè¨´å¤§å®¶ç­”æ¡ˆ ğŸ¥°&lt;/p>
&lt;br>
&lt;h2>åˆä½µæœ¬åœ°ç«¯ commit&lt;span class="absolute -mt-20" id="åˆä½µæœ¬åœ°ç«¯-commit">&lt;/span>
&lt;a href="#%e5%90%88%e4%bd%b5%e6%9c%ac%e5%9c%b0%e7%ab%af-commit" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é¦–å…ˆæˆ‘å€‘ç›®çš„æ˜¯æƒ³è¦è®“ add 2.txt èˆ‡ add 3.txt çš„ commit åˆä½µæˆ add txtï¼Œå¯ä»¥å…ˆä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ä¾†æ‰¾åˆ°ä»–çš„ commit çš„ SHA-1ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>git log&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/git-merge-multiple-commit/2.png"
alt="git log æŸ¥çœ‹ commit çš„ SHA-1" width="600">&lt;figcaption>
&lt;p>git log æŸ¥çœ‹ commit çš„ SHA-1&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>è¦æ€éº¼åˆä½µå‘¢ï¼Ÿæˆ‘å€‘å…ˆä½¿ç”¨ rebase åˆ°ä¸æœƒè®Šå‹•çš„ commitï¼Œä¹Ÿå°±æ˜¯ add 1.txt é€™å€‹ commitï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>git rebase -i 3b5bab9d5fb65b965ae55236734103b178f9daf2&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/git-merge-multiple-commit/3.png"
alt="git rebase" width="600">&lt;figcaption>
&lt;p>git rebase&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä¸‹å®Œå¾Œï¼Œæœƒè·³å‡ºä¸Šé¢åœ–ç‰‡å…§å®¹ï¼Œå¯ä»¥çœ‹åˆ°ä¸Šé¢æ˜¯ rebase interactive (-i) è¦åŸ·è¡Œçš„æŒ‡ä»¤ï¼Œä¸‹é¢æ˜¯æ¯å€‹æŒ‡ä»¤çš„ç°¡å–®èªªæ˜ï¼Œæˆ‘å€‘æœ¬æ¬¡æœƒä½¿ç”¨çš„åªæœ‰ &lt;code>pick&lt;/code> ä»¥åŠ &lt;code>squash&lt;/code>ï¼Œåˆ†åˆ¥çš„æ„æ€æ˜¯ï¼š&lt;/p>
&lt;ul>
&lt;li>pickï¼šæœƒåŸ·è¡Œè©² commitã€‚&lt;/li>
&lt;li>squashï¼šæœƒæŠŠé€™å€‹ç‰ˆæœ¬çš„ commit åˆä½µåˆ°å‰ä¸€å€‹ commitã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>æ‰€ä»¥æˆ‘å€‘è¦å°‡å®ƒæ”¹æˆä»¥ä¸‹ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>pick f8e5882 add 2.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>squash 3eb0ef4 add 3.txt&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>ä¹Ÿå°±æ˜¯å°‡ 3eb0ef4 é€™å€‹ç‰ˆæœ¬çš„ commit åˆä½µåˆ° f8e5882 çš„ commitï¼Œå°æ‡‰æˆ‘å€‘çš„ä¾‹å­ï¼Œå°‡ add 3.txt åˆä½µåˆ° add 2.txt é€™å€‹ commitã€‚&lt;/p>
&lt;p>å„²å­˜é›¢é–‹å¾Œï¼Œæœƒè·³å‡ºä»¥ä¸‹çš„ç•«é¢ï¼Œä»–æœƒå‘Šè¨´ä½ åŸæœ¬å…©å€‹çš„ commit message åˆ†åˆ¥æ˜¯ add 2.txt ä»¥åŠ add 3.txtï¼Œé€™æ™‚å€™æˆ‘å€‘è¦è¼¸å…¥æ–°çš„ commit messageï¼Œä¹Ÿå°±æ˜¯ add txtï¼Œå»ºè­°å¯ä»¥æŠŠåŸæœ¬çš„è¨Šæ¯è¨»è§£æ‰ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/git-merge-multiple-commit/4.png"
alt="è¼¸å…¥æ–°çš„ commit" width="600">&lt;figcaption>
&lt;p>è¼¸å…¥æ–°çš„ commit&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å„²å­˜å¾Œï¼Œæˆ‘å€‘æŸ¥çœ‹ &lt;code>git log&lt;/code>ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘å€‘å°‡ add 2.txt è·Ÿ add 3.txt åˆä½µæˆ add txt ğŸ˜&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/git-merge-multiple-commit/5.png"
alt="æŸ¥çœ‹ç›®å‰åˆä½µç‹€æ…‹çš„ git log" width="600">&lt;figcaption>
&lt;p>æŸ¥çœ‹ç›®å‰åˆä½µç‹€æ…‹çš„ git log&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åˆä½µé ç«¯ commit&lt;span class="absolute -mt-20" id="åˆä½µé ç«¯-commit">&lt;/span>
&lt;a href="#%e5%90%88%e4%bd%b5%e9%81%a0%e7%ab%af-commit" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å¯ä»¥çœ‹åˆ°ä¸‹æ–¹æ˜¯æˆ‘å€‘å·²ç¶“å°‡æœ¬æ©Ÿç«¯çš„ commit çµ¦åˆä½µï¼Œä½†é ç«¯é‚„æ˜¯ä¸€æ¨£æœ‰ 3 å€‹ commitï¼Œå¦‚æœæˆ‘å€‘å°±é€™æ¨£ç›´æ¥æ¨ä¸Šå»ï¼Œåªæœƒå¤šä¸€æ¬¡çš„ commitï¼Œæ‰€ä»¥æˆ‘å€‘è©²æ€è¾¦å‘¢ ?&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/git-merge-multiple-commit/6.png"
alt="é ç«¯èˆ‡æœ¬åœ°ç«¯çš„ commit ä¸åŒ" width="450">&lt;figcaption>
&lt;p>é ç«¯èˆ‡æœ¬åœ°ç«¯çš„ commit ä¸åŒ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘å°±æ˜¯è¦ä½¿ç”¨å¤§å®¶éƒ½å®³æ€•çš„ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>git push -f&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¼·åˆ¶è¦†è“‹æ‰åˆ†æ”¯ä¸Šçš„å…§å®¹ï¼Œä½†&lt;strong>åˆ‡è¨˜åˆ‡è¨˜&lt;/strong>ï¼Œé€™å€‹åªé©ç”¨æ–¼è‡ªå·±çš„åˆ†æ”¯ä¸Šæ­ï½ä¸ç„¶æœƒç›´æ¥å¤§çˆ†ç‚¸ ğŸ’£&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/git-merge-multiple-commit/7.png"
alt="ä½¿ç”¨ git push -f å¾Œçš„ commit" width="450">&lt;figcaption>
&lt;p>ä½¿ç”¨ git push -f å¾Œçš„ commit&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å¦‚ä½•åˆä½µå¤šå€‹ commitsï¼š&lt;a href="https://zerodie.github.io/blog/2012/01/19/git-rebase-i/" target="_blank" rel="noopener">https://zerodie.github.io/blog/2012/01/19/git-rebase-i/&lt;/a>&lt;/p>
&lt;p>ã€ç‹€æ³é¡Œã€‘è½èªª git push -f é€™å€‹æŒ‡ä»¤å¾ˆå¯æ€•ï¼Œä»€éº¼æƒ…æ³å¯ä»¥ä½¿ç”¨å®ƒå‘¢ï¼Ÿï¼š&lt;a href="https://gitbook.tw/chapters/github/using-force-push" target="_blank" rel="noopener">https://gitbook.tw/chapters/github/using-force-push&lt;/a>&lt;/p></description></item><item><title>éƒ¨ç½² Laravel æ–¼ Heroku æ­é… GitLab CI/CD</title><link>https://pin-yi.me/blog/git-or-cicd/laravel-gitlab-cicd-heroku/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/git-or-cicd/laravel-gitlab-cicd-heroku/</guid><description>
&lt;p>ç¶“éä¸Šä¸€ç¯‡æ–‡ç«  &lt;a href="../../git-or-cicd/gitlab-cicd/" >å¦‚ä½•å¾é ­æ‰“é€ å°ˆå±¬çš„ GitLab CI/CD&lt;/a> çš„å­¸ç¿’ï¼Œè®“æˆ‘å€‘äº†è§£åˆ° GitLab CI/CD çš„æ•´å€‹æµç¨‹ï¼Œæ¥è‘—æˆ‘å€‘æœ¬æ¬¡è¦æŠŠ Laravel çµ¦éƒ¨ç½²åˆ° Heroku é€é GitLab çš„ CI/CD å»é”æˆï¼Œä¸éœ€è¦é€éä»»ä½•äººå·¥å»æ¸¬è©¦ï¼Œä¸¦ä¸Šæ¶ç¨‹å¼åˆ° HeroKu ä¸Šï¼Œå…¨éƒ¨éƒ½ä¾è³´ GitLab CI/CDï¼Œè®“æˆ‘å€‘æ¥è‘—çœ‹ä¸‹å»å§ï¼&lt;/p>
&lt;br>
&lt;p>ç•¶ç„¶ï¼Œæ­¤æ–‡ç« ç¨‹å¼ç¢¼ä¹ŸæœƒåŒæ­¥åˆ° Github ï¼Œéœ€è¦çš„ä¹Ÿå¯ä»¥å»æŸ¥çœ‹æ­ï¼è¦è¨˜å¾—å…ˆç¢ºå®šä¸€ä¸‹è‡ªå·±çš„ç‰ˆæœ¬ &lt;a href="https://github.com/880831ian/Laravel-GitLab-CICD-Heroku" target="_blank" rel="noopener">Github ç¨‹å¼ç¢¼é€£çµ&lt;/a> ğŸ˜&lt;/p>
&lt;h2>ç‰ˆæœ¬è³‡è¨Š&lt;span class="absolute -mt-20" id="ç‰ˆæœ¬è³‡è¨Š">&lt;/span>
&lt;a href="#%e7%89%88%e6%9c%ac%e8%b3%87%e8%a8%8a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>macOSï¼š11.6&lt;/li>
&lt;li>Dockerï¼šDocker version 20.10.14, build a224086&lt;/li>
&lt;li>Laravel Installerï¼š2.3.0&lt;/li>
&lt;li>Laravel Frameworkï¼š9.14.1&lt;/li>
&lt;li>gitlab.comï¼šGitLab Enterprise Edition 15.1.0-pre&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>é¦–å…ˆï¼Œæˆ‘å€‘ç¬¬ä¸€æ­¥é©Ÿå°±æ˜¯å…ˆå»ºç«‹ä¸€å€‹ Laravel å°ˆæ¡ˆï¼Œè‡³æ–¼ç‚ºä»€éº¼è¦é¸æ“‡ç”¨ Laravel ä¾†ç•¶ä½œ GitLab CI/CD çš„ç¯„ä¾‹å‘¢ï¼Ÿå› ç‚º Laravel å…§å»ºæœ‰ PHPUnit çš„æ¸¬è©¦è…³æœ¬ï¼Œå¯ä»¥è®“æˆ‘å€‘åœ¨ CI æ¸¬è©¦æ™‚ï¼Œæ›´å¥½çš„å±•ç¾ CI çš„åŠŸèƒ½ï¼ï¼Œæœ‰é—œæ–¼ Laravel ç›¸é—œå…§å®¹ï¼Œé€™é‚Šä¸€æ¨£æ¨è–¦å…©ç¯‡æ–‡ç« çµ¦å¤§å®¶é–±è®€ï¼šğŸ¤£&lt;/p>
&lt;ul>
&lt;li>&lt;a href="../../code/laravel/" >Laravel ä»‹ç´¹ (ä½¿ç”¨ Laravel å¾é›¶åˆ°æœ‰é–‹ç™¼å‡ºä¸€å€‹ç•™è¨€æ¿åŠŸèƒ½ä¸¦æ­é… RESTful API ä¾†å¯¦ç¾ CRUD)&lt;/a>&lt;/li>
&lt;li>&lt;a href="../../code/laravel-advanced/" >Laravel é€²éš (å…§å»ºæœƒå“¡ç³»çµ±ã€é©—è­‰ RESTful API æ˜¯å¦ç™»å…¥ã€ä½¿ç”¨ Repository è¨­è¨ˆæ¨¡å¼)&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>åˆå·¥å•†äº†ä¸€æ³¢ XD&lt;/p>
&lt;br>
&lt;h2>å»ºç«‹ Laravel å°ˆæ¡ˆ&lt;span class="absolute -mt-20" id="å»ºç«‹-laravel-å°ˆæ¡ˆ">&lt;/span>
&lt;a href="#%e5%bb%ba%e7%ab%8b-laravel-%e5%b0%88%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>è«‹å¤§å®¶ä¾ç…§ Laravel å®˜æ–¹æ–‡ä»¶ä¾†å»ºç«‹ Laravel ç’°å¢ƒï¼Œä¹Ÿå¯ä»¥çœ‹å°å¼Ÿæˆ‘çš„æ–‡ç« æ‹‰ ğŸ‘†ğŸ‘†ğŸ‘†ï¼Œè«‹è¨˜å¾—è¦å…ˆå®‰è£å¥½ php ä»¥åŠ composerï¼Œæ¥è‘—æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿä¾†å»ºç«‹ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/create.png"
alt="æ–°å»ºä¸€å€‹ Laravel æ–°å°ˆæ¡ˆ" width="900">&lt;figcaption>
&lt;p>æ–°å»ºä¸€å€‹ Laravel æ–°å°ˆæ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é€™æ™‚å€™ç€è¦½ &lt;code>http://127.0.0.1:8000&lt;/code>ï¼Œå¦‚æœéƒ½æ­£ç¢ºï¼Œæ‡‰è©²æœƒçœ‹åˆ° Laravel çš„é¦–é &lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/laravel.png"
alt="Laravel é¦–é " width="900">&lt;figcaption>
&lt;p>Laravel é¦–é &lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>æ¸¬è©¦æœ¬åœ° Unit Test&lt;span class="absolute -mt-20" id="æ¸¬è©¦æœ¬åœ°-unit-test">&lt;/span>
&lt;a href="#%e6%b8%ac%e8%a9%a6%e6%9c%ac%e5%9c%b0-unit-test" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æ¥è‘—æˆ‘å€‘å‰›å‰›æœ‰æåˆ°é¸ç”¨ Laravel çš„åŸå› æ˜¯ Laravel æœ‰ PHPUnit å–®å…ƒæ¸¬è©¦å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘å€‘ç¾åœ¨å…ˆåœ¨æœ¬åœ°ç«¯ä¾†æ¸¬è©¦ Unit Testï¼Œå°ˆæ¡ˆé è¨­æœ‰æ”¾ä¸€å€‹å–®å…ƒæ¸¬è©¦åœ¨ &lt;code>tests/Unit/ExampleTest.php&lt;/code>ã€‚æˆ‘å€‘å…ˆå†æ¬¡ç¢ºèªç’°å¢ƒæ˜¯å¦æœ‰å®‰è£å¥½ï¼Œå†ä¾†åŸ·è¡Œå–®å…ƒæ¸¬è©¦ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/unittest.png"
alt="åœ¨æœ¬åœ°ç«¯åŸ·è¡Œå–®å…ƒæ¸¬è©¦" width="900">&lt;figcaption>
&lt;p>åœ¨æœ¬åœ°ç«¯åŸ·è¡Œå–®å…ƒæ¸¬è©¦&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>åŸ·è¡Œå¾Œï¼Œæ‡‰è©²éƒ½æœƒæ˜¯é€šéçš„ç•«é¢ï¼Œå¦‚ä¸‹åœ–ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/demo_test.png"
alt="åŸ·è¡Œå–®å…ƒæ¸¬è©¦çµæœ" width="900">&lt;figcaption>
&lt;p>åŸ·è¡Œå–®å…ƒæ¸¬è©¦çµæœ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>GitLab CI å»ºç½®&lt;span class="absolute -mt-20" id="gitlab-ci-å»ºç½®">&lt;/span>
&lt;a href="#gitlab-ci-%e5%bb%ba%e7%bd%ae" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>ä¸Šå‚³ Laravel å°ˆæ¡ˆ&lt;span class="absolute -mt-20" id="ä¸Šå‚³-laravel-å°ˆæ¡ˆ">&lt;/span>
&lt;a href="#%e4%b8%8a%e5%82%b3-laravel-%e5%b0%88%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ¥ä¸‹ä¾†æˆ‘å€‘è¦ä¸Šå‚³å«æœ‰ Unit Test å°ˆæ¡ˆåˆ° GitLab ä¸Šï¼Œæ­¥é©Ÿå¦‚ä¸‹ï¼Œå¦‚æœå·²ç¶“ç†Ÿæ‚‰å¦‚ä½•å°‡å°ˆæ¡ˆæ¨åˆ° GitLabï¼Œå¯ä»¥ç›´æ¥è·³åˆ° &lt;a href="#%e5%9c%a8-gitlab-%e4%b8%8a%e5%9f%b7%e8%a1%8c%e5%96%ae%e5%85%83%e6%b8%ac%e8%a9%a6" >åœ¨ GitLab ä¸ŠåŸ·è¡Œå–®å…ƒæ¸¬è©¦&lt;/a>&lt;/p>
&lt;ol>
&lt;li>åœ¨ &lt;a href="https://gitlab.com" target="_blank" rel="noopener">gitlab.com&lt;/a> ä¸Šé»é¸å»ºç«‹å°ˆæ¡ˆï¼Œé¸æ“‡ &lt;strong>Create blank project&lt;/strong>ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç€è¦½è©²ç¶²å€ &lt;code>https://gitlab.com/projects/new#blank_project&lt;/code>ã€‚&lt;/li>
&lt;li>è¼¸å…¥å°ˆæ¡ˆåç¨±å¯ä»¥é¸æ“‡ Project deployment target ç‚º &lt;strong>Heroko&lt;/strong>ï¼Œé¸æ“‡ Publicï¼Œæœ€å¾ŒæŒ‰ä¸‹ &lt;strong>Create project&lt;/strong>&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/gitlab.png"
alt="åœ¨ GitLab ä¸Šå»ºç«‹æ–°å°ˆæ¡ˆ" width="800">&lt;figcaption>
&lt;p>åœ¨ GitLab ä¸Šå»ºç«‹æ–°å°ˆæ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>æ–¼å°ˆæ¡ˆè³‡æ–™å¤¾ä¸‹åŠ å…¥ remote é ç«¯ GitLabï¼Œä¸¦ Push å°‡å°ˆæ¡ˆæ¨ä¸Šå»ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/gitlab_push.png"
alt="å°‡ Laravel å°ˆæ¡ˆæ¨åˆ° GitLab ä¸Š" width="800">&lt;figcaption>
&lt;p>å°‡ Laravel å°ˆæ¡ˆæ¨åˆ° GitLab ä¸Š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆåŠŸæ¨ä¸Šå»ï¼Œå¯ä»¥åˆ° GitLab ä¸Šï¼Œçœ‹åˆ°æˆ‘å€‘å‰›å‰›çš„å°ˆæ¡ˆï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/gitlab_show.png"
alt="æˆåŠŸæ¨åˆ° GitLab ä¸Š" width="800">&lt;figcaption>
&lt;p>æˆåŠŸæ¨åˆ° GitLab ä¸Š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>åœ¨ GitLab ä¸ŠåŸ·è¡Œå–®å…ƒæ¸¬è©¦&lt;span class="absolute -mt-20" id="åœ¨-gitlab-ä¸ŠåŸ·è¡Œå–®å…ƒæ¸¬è©¦">&lt;/span>
&lt;a href="#%e5%9c%a8-gitlab-%e4%b8%8a%e5%9f%b7%e8%a1%8c%e5%96%ae%e5%85%83%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è¦åœ¨ GitLab ä¸ŠåŸ·è¡Œ CI/CD å°±éœ€è¦æœ‰ Runnerï¼Œé€™æ¬¡æˆ‘å€‘é¸æ“‡ä½¿ç”¨ &lt;a href="https://gitlab.com" target="_blank" rel="noopener">gitlab.com&lt;/a> çš„ Shared runnersï¼Œæƒ³è¦ä½¿ç”¨ Specific runnersï¼Œå¯ä»¥æŸ¥çœ‹ä¸Šä¸€ç¯‡ &lt;a href="../../git-or-cicd/gitlab-cicd/#%E8%87%AA%E6%9E%B6-runner-specific-runners" >å¦‚ä½•å¾é ­æ‰“é€ å°ˆå±¬çš„ GitLab CI/CD&lt;/a> æ–‡ç« &lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/runner.png"
alt="æœ¬æ¬¡ä½¿ç”¨ Share runners" width="800">&lt;figcaption>
&lt;p>æœ¬æ¬¡ä½¿ç”¨ Share runners&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ¥ä¸‹ä¾†åœ¨å°ˆæ¡ˆçš„æ ¹ç›®éŒ„æ’°å¯«æˆ‘å€‘çš„ &lt;code>.gitlab-ci.yml&lt;/code> æª”æ¡ˆï¼Œä¹‹å¾Œå†æ¬¡ä¸Šå‚³ GitLabï¼Œç•¶æˆ‘å€‘æ ¹ç›®éŒ„æœ‰æ­¤æª”æ¡ˆï¼ŒGitLab-CI å°±æœƒè®€å–ä¸¦ä¾ç…§å…§å®¹å•Ÿå‹• Runner ä¾†åŸ·è¡Œå·¥ä½œï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div class="filename">.gitlab-ci.yml&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">lorisleiva/laravel-docker:latest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">Unit_test&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">before_script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">composer install --prefer-dist --no-ansi --no-interaction --no-progress --no-scripts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./vendor/bin/phpunit --testsuit Unit --coverage-text --colors=never&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-8">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>èªªæ˜ä¸€ä¸‹é€™å€‹ &lt;code>yml&lt;/code> æª”å…§çš„è¨­å®šæ˜¯åœ¨åšä»€éº¼ï¼š&lt;/p>
&lt;ul>
&lt;li>imageï¼šå› ç‚ºæˆ‘å€‘åŸ·è¡Œ CI/CD éç¨‹ä¸­ï¼Œéœ€è¦æœ‰ PHPã€Composeã€NPM ç­‰å·¥å…·ï¼Œæœ‰é€™äº›å¥—ä»¶ç®¡ç†å·¥å…·å°±å¯ä»¥å»¶ä¼¸å»å®‰è£æ›´å¤šå¥—ä»¶ï¼Œå¦‚æœä¸€é–‹å§‹æ²’æœ‰å®‰è£ï¼Œå°±æœƒå¾ˆéº»ç…©ï¼Œå…¶ä¸­ä¸€å€‹è¾¦æ³•å°±æ˜¯å» Runner ç’°å¢ƒä¿®æ”¹ä¸¦å®‰è£ï¼Œä½†å› ç‚ºæ–¹ä¾¿ä»¥åŠæˆ‘å€‘é€™æ¬¡ä½¿ç”¨ Share runnersï¼Œæ‰€ä»¥ä¸èƒ½ä¿®æ”¹åˆ¥äººçš„ Runnerï¼Œå¦ä¸€å€‹è¾¦æ³•æ˜¯å¯ä»¥ä½¿ç”¨ &lt;code>image&lt;/code> é—œéµå­—ï¼Œå¯ä»¥è®“ Runner åˆ‡æ›åˆ°å¦ä¸€å€‹ç’°å¢ƒå»åŸ·è¡Œå·¥ä½œ (Job)ï¼Œæˆ‘å€‘é€™é‚Šä½¿ç”¨ &lt;a href="https://github.com/lorisleiva/laravel-docker" target="_blank" rel="noopener">lorisleiva/laravel-docker:latest&lt;/a> ï¼Œä»–è£¡é¢å·²ç¶“å¹«æˆ‘å€‘å®‰è£å¥½ä¸Šè¿°çš„å·¥å…·äº†ï¼&lt;/li>
&lt;li>Unit_testï¼šé€™é‚Šä¹Ÿæ˜¯æˆ‘å€‘çš„ Jobï¼Œé‚£è£¡é¢ä¸»è¦æ˜¯å…ˆç”¨ composer install å»å®‰è£æˆ‘å€‘éœ€è¦çš„å¥—ä»¶ï¼Œæœ€å¾Œåœ¨åŸ·è¡Œ phpunit ä¾†åšå–®å…ƒæ¸¬è©¦ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h3>ä¸Šå‚³ .gitlab-ci.yml&lt;span class="absolute -mt-20" id="ä¸Šå‚³-gitlab-ciyml">&lt;/span>
&lt;a href="#%e4%b8%8a%e5%82%b3-gitlab-ciyml" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ¥è‘—æˆ‘å€‘ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å°‡å«æœ‰ &lt;code>.gitlab-ci.yml&lt;/code> çš„å°ˆæ¡ˆä¸Šå‚³åˆ° GitLabï¼Œä¸¦å›åˆ° GitLab é¸æ“‡ CI/CDï¼Œå¯ä»¥æŸ¥çœ‹ç›®å‰çš„ Pipelinesï¼Œæœƒæœ‰æˆ‘å€‘å‰›å‰›æ‰€æ–°å¢çš„ Runnerã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/gitlab-ci.png"
alt="å°‡ .gitlab-ci.yml æ¨åˆ° GitLab" width="600">&lt;figcaption>
&lt;p>å°‡ &lt;code>.gitlab-ci.yml&lt;/code> æ¨åˆ° GitLab&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/pipeline.png"
alt="æŸ¥çœ‹ Runner å·²ç¶“é€²è¡ŒåŸ·è¡Œå–®å…ƒæ¸¬è©¦æª¢æ¸¬" width="700">&lt;figcaption>
&lt;p>æŸ¥çœ‹ Runner å·²ç¶“é€²è¡ŒåŸ·è¡Œå–®å…ƒæ¸¬è©¦æª¢æ¸¬&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/runner-cicd.png"
alt="å¯ä»¥çœ‹åˆ° Runner å…ˆå®‰è£æˆ‘å€‘çš„ç’°å¢ƒï¼Œå†åŸ·è¡Œå–®å…ƒæ¸¬è©¦çš„è…³æœ¬" width="700">&lt;figcaption>
&lt;p>å¯ä»¥çœ‹åˆ° Runner å…ˆå®‰è£æˆ‘å€‘çš„ç’°å¢ƒï¼Œå†åŸ·è¡Œå–®å…ƒæ¸¬è©¦çš„è…³æœ¬&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨­ç½®é ˆé€šéæ¸¬è©¦æ‰å¯ä»¥åˆä½µ&lt;span class="absolute -mt-20" id="è¨­ç½®é ˆé€šéæ¸¬è©¦æ‰å¯ä»¥åˆä½µ">&lt;/span>
&lt;a href="#%e8%a8%ad%e7%bd%ae%e9%a0%88%e9%80%9a%e9%81%8e%e6%b8%ac%e8%a9%a6%e6%89%8d%e5%8f%af%e4%bb%a5%e5%90%88%e4%bd%b5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç•¶æˆ‘å€‘æœ‰äº†æ¸¬è©¦é‚„ä¸å¤ ï¼Œè¦æ€éº¼ç¢ºä¿æ¯éš»è¦ä¸Šç·š (åˆä½µåˆ°ä¸»åˆ†æ”¯) çš„ç¨‹å¼éƒ½æœ‰ç¶“éæ¸¬è©¦æ‰ä¸Šç·šå‘¢ï¼Ÿ&lt;/p>
&lt;p>æ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥åœ¨ GitLab è£¡é¢åšé€™äº›è¨­å®šï¼Œå…ˆåˆ°å°ˆæ¡ˆçš„ Setting â†’ General â†’ Merge requests â†’ Merge checks é»é¸ &lt;strong>Pipelines must succeed&lt;/strong>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/mergechecks.png"
alt="é»é¸ Pipelines must succeed ä¾†ç¢ºä¿ç¨‹å¼åˆä½µå‰éƒ½å¿…é ˆç¶“éæ¸¬è©¦" width="700">&lt;figcaption>
&lt;p>é»é¸ &lt;strong>Pipelines must succeed&lt;/strong> ä¾†ç¢ºä¿ç¨‹å¼åˆä½µå‰éƒ½å¿…é ˆç¶“éæ¸¬è©¦&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ¸¬è©¦æ˜¯å¦å¯ä»¥é˜»æ“‹æœªæˆåŠŸæƒ…æ³&lt;span class="absolute -mt-20" id="æ¸¬è©¦æ˜¯å¦å¯ä»¥é˜»æ“‹æœªæˆåŠŸæƒ…æ³">&lt;/span>
&lt;a href="#%e6%b8%ac%e8%a9%a6%e6%98%af%e5%90%a6%e5%8f%af%e4%bb%a5%e9%98%bb%e6%93%8b%e6%9c%aa%e6%88%90%e5%8a%9f%e6%83%85%e6%b3%81" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘å…ˆæ¨¡æ“¬è¦é–‹ç™¼æ–°åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨ master æœ€æ–° commit ä¸‹ï¼Œå»ºç«‹ä¸€å€‹æ–°åˆ†æ”¯ &lt;code>new&lt;/code>&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>git checkout -b &lt;span style="color:#e6db74">&amp;#34;new&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ¥è‘—ä¿®æ”¹å–®å…ƒæ¸¬è©¦ï¼Œæ•…æ„æ–°å¢éŒ¯èª¤çš„æ¸¬è©¦ï¼Œé–‹å•Ÿå°ˆæ¡ˆçš„ &lt;code>tests/Unit/ExampleTest.php&lt;/code>ï¼Œæœ€ä¸‹é¢åŠ ä¸Šç´…è‰²æ¡†æ¡†ç¨‹å¼ç¢¼ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/exampletest.png"
alt="æ–°å¢éŒ¯èª¤æ¸¬è©¦ï¼Œé‚„æ¨¡æ“¬çœ‹çœ‹æ˜¯å¦èƒ½æˆåŠŸæ“‹ä½" width="500">&lt;figcaption>
&lt;p>æ–°å¢éŒ¯èª¤æ¸¬è©¦ï¼Œé‚„æ¨¡æ“¬çœ‹çœ‹æ˜¯å¦èƒ½æˆåŠŸæ“‹ä½&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>&lt;code>assertEquals&lt;/code> æœƒæª¢æŸ¥é€™å…©å€‹å€¼æ˜¯å¦ç›¸åŒï¼Œä¸åŒçš„è©±ï¼Œå°±æœƒè·³å‡ºéŒ¯èª¤ï¼Œæ‰€ä»¥æˆ‘å€‘æ•…æ„è¼¸å…¥ 1 å’Œ 2ã€‚&lt;/p>
&lt;br>
&lt;p>ä¸¦å°‡å®ƒä¸Šå‚³åˆ° GitLabï¼Œä¸¦ç™¼å‡º Merge Request çœ‹çœ‹æœƒæœ‰ä»€éº¼çµæœï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/gitlab-test.png"
alt="å°‡æ–°å¢éŒ¯èª¤çš„ ExampleTest åŠ å…¥æš«å­˜ï¼Œæ¨åˆ° GitLab" width="600">&lt;figcaption>
&lt;p>å°‡æ–°å¢éŒ¯èª¤çš„ ExampleTest åŠ å…¥æš«å­˜ï¼Œæ¨åˆ° GitLab&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/mergerequest.png"
alt="ä¸¦å°‡ new åˆ†æ”¯é€é Merge Request ä¾†åˆä½µåˆ° master" width="1000">&lt;figcaption>
&lt;p>ä¸¦å°‡ new åˆ†æ”¯é€é Merge Request ä¾†åˆä½µåˆ° master&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘åˆä½µåœ¨ Pipeline æ¸¬è©¦æ™‚ï¼Œå› ç‚º new æ²’æœ‰é€šéæ¸¬è©¦ï¼Œæ‰€ä»¥ä¹Ÿæ²’æœ‰è¾¦æ³•é€²è¡Œåˆä½µï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/mergeerror.png"
alt="åˆ†æ”¯ new æ²’æœ‰é€šéæ¸¬è©¦ï¼Œæ‰€ä»¥æ²’æœ‰é€²è¡Œ Merge" width="700">&lt;figcaption>
&lt;p>åˆ†æ”¯ new æ²’æœ‰é€šéæ¸¬è©¦ï¼Œæ‰€ä»¥æ²’æœ‰é€²è¡Œ Merge&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>GitLab CD å»ºç½®&lt;span class="absolute -mt-20" id="gitlab-cd-å»ºç½®">&lt;/span>
&lt;a href="#gitlab-cd-%e5%bb%ba%e7%bd%ae" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘å€‘ç©å®Œ CI å¾Œï¼Œæ¥è‘—è¦æŠŠç¨‹å¼éƒ¨ç½²åˆ°ä¼ºæœå™¨æˆ–æ˜¯é›²ç«¯ä¸Šï¼Œé€™æ™‚å€™æˆ‘å€‘ä¸éœ€è¦é€éäººå·¥æ‰‹å‹•çš„æ–¹å¼ï¼Œåªéœ€è¦æœ‰ CD ä¾†å¹«æˆ‘å€‘è‡ªå‹•åŒ–éƒ¨ç½²å°±å¯ä»¥æ‹‰ï¼å¦‚æœä¸å¤ªæ¸…æ¥šï¼Œå¯ä»¥åƒè€ƒé€™å¼µåœ–ç‰‡ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/gitlab_workflow.png"
alt="GitLab CI/CD workflow (åœ–ç‰‡ä¾†æºï¼šGitLab)" width="900">&lt;figcaption>
&lt;p>GitLab CI/CD workflow (åœ–ç‰‡ä¾†æºï¼š&lt;a href="https://docs.gitlab.com/ee/ci/introduction/" target="_blank" rel="noopener">GitLab&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>ç•¶æˆ‘å€‘å‰›å‰›é€²è¡Œ CI çš„æ•´åˆæ¸¬è©¦ï¼Œæœ€å¾Œç¶“é Review and approve åˆä½µåˆ°ä¸»åˆ†æ”¯ï¼Œé€™æ™‚å€™å¦‚æœæˆ‘å€‘æœ‰è¨­å®š CDï¼ŒCD å°±æœƒå¹«æˆ‘å€‘éƒ¨ç½²åˆ°æœå‹™ä¸Šï¼Œæˆ‘æŠŠ CD æµç¨‹è½‰æˆæ–‡å­—æ­¥é©Ÿèªªæ˜ï¼š&lt;/p>
&lt;br>
&lt;ol>
&lt;li>æŠŠæ–°åŠŸèƒ½åˆ†æ”¯åˆä½µåˆ° master åˆ†æ”¯ï¼Œä»£è¡¨åŠŸèƒ½å·²ç¶“å¯ä»¥ä¸Šç·š&lt;/li>
&lt;li>GitLab è§¸ç™¼ Gitlab-CI åŸ·è¡Œ pipeline&lt;/li>
&lt;li>Gitlab-CI åŸ·è¡Œè‡ªå‹•åŒ–æ¸¬è©¦&lt;/li>
&lt;li>Gitlab-CI æ¸¬è©¦æˆåŠŸå¾Œï¼ŒåŸ·è¡Œéƒ¨ç½²åˆ°æ­£å¼ä¼ºæœå™¨&lt;/li>
&lt;li>å›å‚³åŸ·è¡Œçµæœè‡³ GitLab&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>é‚£æƒ³è¦é”æˆè‡ªå‹•åŒ–éƒ¨ç½²ä¹‹å‰ï¼Œå¿…é ˆèƒ½åœ¨é ç«¯ç”¨æŒ‡ä»¤ä¸‹é”éƒ¨ç½²æ›´æ–°ï¼ç°¡å–®ä¾†èªªæœ‰å…©ä»¶äº‹æƒ…ï¼š&lt;/p>
&lt;ol>
&lt;li>è¦å…ˆæ•´ç†å†æ›´æ–°å°ˆæ¡ˆæ™‚éœ€è¦å“ªäº›æŒ‡ä»¤ï¼Œä¸¦å°‡å…¶å¯«æˆè…³æœ¬&lt;/li>
&lt;li>éœ€è¦ç²å¾—ä¼ºæœå™¨çš„æˆæ¬Šï¼Œå¯ä»¥å°ä¼ºæœå™¨ä¸‹é”æ›´æ–°å°ˆæ¡ˆçš„è…³æœ¬&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>æˆ‘å€‘ä»¥ç¾åœ¨ Laravel å°ˆæ¡ˆä¾†èªªï¼Œå¥—ç”¨ä¸Šé¢è¬›çš„å…©ä»¶äº‹æƒ…ï¼š&lt;/p>
&lt;ol>
&lt;li>è…³æœ¬è£½ä½œï¼šä¸Šç·šæ–°ç‰ˆæœ¬å¤§æ¦‚è¦åŸ·è¡Œä»¥ä¸‹åœ–ç‰‡çš„å…§å®¹&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/laravel_up.png"
alt="Laravel å°ˆæ¡ˆä¸Šç·šå‰æœƒä¸‹é”çš„æŒ‡ä»¤" width="800">&lt;figcaption>
&lt;p>Laravel å°ˆæ¡ˆä¸Šç·šå‰æœƒä¸‹é”çš„æŒ‡ä»¤&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>å°é ç«¯ä¼ºæœå™¨ä¸‹æŒ‡ä»¤ï¼šé€šå¸¸ä½¿ç”¨ ssh èˆ‡ ä¼ºæœå™¨åšæºé€šï¼Œæ‰€ä»¥å…ˆåœ¨ä¼ºæœå™¨ç”¢ç”Ÿæˆæ¬Šé‡‘é‘°çµ¦è¦é ç«¯æ§åˆ¶çš„é›»è…¦ï¼Œå¦‚æœè¦çµ¦ Gitlab-CI æ§åˆ¶çš„è©±ï¼Œä¹Ÿéœ€è¦æŠŠé‡‘é‘°å­˜åœ¨ GitLab ä¸Šï¼Œé€šå¸¸ä½¿ç”¨ &lt;code>ssh user@remote.server 'git pull'&lt;/code> ä¾†ä¸‹é”æ›´æ–°å°ˆæ¡ˆçš„æŒ‡ä»¤&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>æœ¬ç¯‡æˆ‘å€‘è¦éƒ¨ç½²çš„æ˜¯ PaaS çš„ HeroKuï¼Œå¯ä»¥æ¸›å°‘æ™‚é–“å»æ¶è¨­ç’°å¢ƒï¼Œå°±å¯ä»¥é”åˆ°æˆ‘å€‘æƒ³è¦çš„æ•ˆæœï¼Œé‚£æ¥è‘—æœƒå¸¶å¤§å®¶å¾ Heroku è¨­å®šé–‹å§‹æ­ï¼å…ˆç°¡å–®ä»‹ç´¹ä¸€ä¸‹ Herokuï¼š&lt;/p>
&lt;p>Heroku æ˜¯ä¸€å€‹æ”¯æ´å¤šç¨®ç¨‹å¼èªè¨€çš„é›²å¹³å°å³æ™‚æœå‹™(PaaS)ï¼Œ æ˜¯ä¸€ç¨®é›²ç«¯é‹ç®—æœå‹™ï¼Œæä¾›é‹ç®—å¹³å°èˆ‡è§£æ±ºæ–¹æ¡ˆæœå‹™ï¼ŒPaaS æä¾›ä½¿ç”¨è€…å°‡é›²ç«¯åŸºç¤è¨­æ–½éƒ¨ç½²èˆ‡å»ºç«‹è‡³ä½¿ç”¨è€…ç«¯ï¼Œæˆ–è€…è—‰æ­¤ç²å¾—ä½¿ç”¨ç¨‹å¼èªè¨€ã€ç¨‹å¼åº«èˆ‡æœå‹™ã€‚ä½¿ç”¨è€…ä¸éœ€è¦ç®¡ç†èˆ‡æ§åˆ¶é›²ç«¯åŸºç¤è¨­æ–½ï¼ˆåŒ…å«ç¶²è·¯ã€ä¼ºæœå™¨ã€ä½œæ¥­ç³»çµ±æˆ–å„²å­˜ï¼‰ï¼Œä½†éœ€è¦æ§åˆ¶ä¸Šå±¤çš„æ‡‰ç”¨ç¨‹å¼éƒ¨ç½²èˆ‡æ‡‰ç”¨ä»£ç®¡çš„ç’°å¢ƒã€‚&lt;/p>
&lt;br>
&lt;h3>å‰µå»º Heroku å°ˆæ¡ˆ&lt;span class="absolute -mt-20" id="å‰µå»º-heroku-å°ˆæ¡ˆ">&lt;/span>
&lt;a href="#%e5%89%b5%e5%bb%ba-heroku-%e5%b0%88%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é‚£è¦ä½¿ç”¨ Heroku ç•¶ç„¶éœ€è¦ä¸€çµ„å¸³è™Ÿæ‹‰ï¼Œå»ºç«‹å¸³è™Ÿæˆ‘æ‡‰è©²ä¸ç”¨å†å¤šä»‹ç´¹äº†å§ ğŸ¤¡ Â æˆ‘å€‘ç›´æ¥åˆ° Heroku é é¢ï¼Œå³ä¸Šè§’ Newï¼Œé»é¸ Create new appï¼Œè¼¸å…¥æœ¬æ¬¡å°ˆæ¡ˆåç¨±ï¼Œæˆ‘å°±å–å« &lt;code>laravel-gitlab-cicd-heroku&lt;/code> (é€™å€‹ä¸èƒ½èˆ‡åˆ¥äººé‡è¤‡ï¼Œå› ç‚ºä»–æœƒç”Ÿæˆå°ˆå±¬ç¶²é )ï¼Œ é€²å»å¾Œï¼Œé»é¸å³ä¸Šè§’æœ‰ä¸€å€‹ &lt;strong>Open app&lt;/strong>ï¼Œå°±æœƒè·³å‡ºé€™å€‹å°ˆæ¡ˆå°ˆå±¬çš„ç¶²é ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/herokuapp.png"
alt="Heroku å°ˆå±¬ç¶²é " width="1000">&lt;figcaption>
&lt;p>Heroku å°ˆå±¬ç¶²é &lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>è¨­å®š HeroKu èˆ‡ GitLab é€£ç·š&lt;span class="absolute -mt-20" id="è¨­å®š-heroku-èˆ‡-gitlab-é€£ç·š">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a-heroku-%e8%88%87-gitlab-%e9%80%a3%e7%b7%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å…ˆé»é¸å³ä¸Šè§’å€‹äººé ­åƒ â†’ Account setrtings â†’ åœ¨ Account å¾€ä¸‹æ»‘ â†’ API Keyï¼Œé»é¸ &lt;strong>Reveal&lt;/strong> ä¸¦å°‡è©² API è¨˜ä½ï¼Œé€™æ˜¯ç­‰ç­‰é€é GitLab éƒ¨ç½²æ™‚æœƒç”¨åˆ°çš„ API Tokenï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/token.png"
alt="å–å¾—éƒ¨ç½²çš„ API Token" width="1000">&lt;figcaption>
&lt;p>å–å¾—éƒ¨ç½²çš„ API Token&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å›åˆ° GitLab å°ˆæ¡ˆåº•ä¸‹ï¼ŒSettings â†’ CI/CD â†’ Variablesï¼Œä»–å¯ä»¥å°‡è®Šæ•¸è¨­å®šåœ¨é€™é‚Šï¼Œå†è®“ &lt;code>.gitlab-ci.yml&lt;/code> ä¾†æŠ“å–è®Šæ•¸ï¼Œè¨­å®šä»¥ä¸‹å…©å€‹è®Šæ•¸ï¼š(è©³ç´°å¯ä»¥åƒè€ƒ&lt;a href="https://docs.gitlab.com/ee/ci/variables/index.html#add-a-cicd-variable-to-a-project" target="_blank" rel="noopener">å®˜ç¶²&lt;/a>)&lt;/p>
&lt;ol>
&lt;li>Key åç¨±(HEROKU_PRODUCTION_PROJECT_NAME)ï¼ŒValue å€¼(è¨­å®šæˆ‘å€‘å‰›å‰›åœ¨ Heroku éƒ¨ç½²çš„å°ˆæ¡ˆåç¨±ï¼Œæˆ‘çš„æ˜¯ &lt;code>laravel-gitlab-cicd-heroku&lt;/code>)&lt;/li>
&lt;li>Key åç¨±(HEROKU_PRODUCTION_API_KEY)ï¼ŒValue å€¼(é€™å€‹å°±æ˜¯æˆ‘å€‘ä¸Šé¢çš„ API Keyï¼Œæ¯å€‹äººéƒ½è¦ç”¨è‡ªå·±çš„æ­ï¼ä¸Šé¢çš„æˆ‘å·²ç¶“é‡è¨­äº† ğŸ˜ Â )&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/variables.png"
alt="gitLab è¨­å®š Variables" width="800">&lt;figcaption>
&lt;p>gitLab è¨­å®š Variables&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>é€™é‚Šè¦æ³¨æ„å…ˆæŠŠé è¨­çš„ Protect variable çµ¦é—œé–‰ï¼Œä»–é è¨­æœƒåªèƒ½åœ¨å—ä¿è­·çš„åˆ†æ”¯æˆ–æ¨™ç±¤é‹è¡Œï¼Œä½†æˆ‘å€‘é€™æ­¤ä»¥ç°¡å–®ç‚ºä¸»ï¼Œæ‰€ä»¥é€™äº›è¨­å®šéƒ½å…ˆé—œæ‰ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h3>æ–°å¢ Heroku è­˜åˆ¥æª”æ¡ˆ&lt;span class="absolute -mt-20" id="æ–°å¢-heroku-è­˜åˆ¥æª”æ¡ˆ">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e-heroku-%e8%ad%98%e5%88%a5%e6%aa%94%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ¥ä¸‹ä¾†æˆ‘å€‘è¦æ–°å¢ä¸€å€‹æª”æ¡ˆåç‚º &lt;code>Procfile&lt;/code>ï¼Œå®ƒæ˜¯ Heroku éƒ¨ç½²æ›´æ–°æ™‚æœƒå•Ÿå‹•çš„å°è±¡ï¼Œæ³¨æ„ä»–æ²’æœ‰å‰¯æª”åï¼Œæˆ‘å€‘åœ¨è£¡é¢è¼¸å…¥ä»¥ä¸‹ï¼š(æˆ‘å€‘ä½¿ç”¨åˆä½µå¾Œçš„ master)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/procfile.png"
alt="æ–°å¢ HeroKu è­˜åˆ¥æª”æ¡ˆ" width="650">&lt;figcaption>
&lt;p>æ–°å¢ HeroKu è­˜åˆ¥æª”æ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>å®ƒä»£è¡¨æˆ‘å€‘ç¶²é æœå‹™ä½¿ç”¨ apache2 æŒ‡ä»¤é‹è¡Œä¸¦æŠŠå…¥å£æŒ‡å‘å°ˆæ¡ˆè³‡æ–™å¤¾ä¸­çš„ laravel å°ˆæ¡ˆçš„å…¥å£è³‡æ–™å¤¾ã€‚&lt;/p>
&lt;br>
&lt;h3>ä¿®æ”¹ .gitlab-ci.yml&lt;span class="absolute -mt-20" id="ä¿®æ”¹-gitlab-ciyml">&lt;/span>
&lt;a href="#%e4%bf%ae%e6%94%b9-gitlab-ciyml" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘ä¿®æ”¹åŸæœ¬ç”¨ä¾† CI çš„è…³æœ¬ï¼Œä¾†è¨­å®šè‡ªå‹•åŒ–éƒ¨ç½²çš„ä»»å‹™ Job åŠè…³æœ¬&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div class="filename">.gitlab-ci.yml&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">lorisleiva/laravel-docker:latest&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">Production_Deploy&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">stage&lt;/span>: &lt;span style="color:#ae81ff">Production_Deploy&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">before_script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">apk add ruby ruby-dev ruby-irb ruby-rake ruby-io-console ruby-bigdecimal ruby-json ruby-bundler yarn ruby-rdoc &amp;gt;&amp;gt; /dev/null&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">apk update&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">gem install dpl &amp;gt;&amp;gt; /dev/null&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">dpl --provider=heroku --app=$HEROKU_PRODUCTION_PROJECT_NAME --api-key=$HEROKU_PRODUCTION_API_KEY&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-8">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æœ€å¾Œä¸Šå‚³ GitLab ä¾†è§¸ç™¼ Gitlab-CI åŸ·è¡Œè‡ªå‹•åŒ–éƒ¨ç½² (ä¸Šå‚³æŒ‡ä»¤å°±ä¸å¤šèªªå›‰ï¼Œæƒ³å¿…å¤§å®¶éƒ½æœƒäº†å§ï¼ï¼Œä¸æœƒçš„è©±å¯ä»¥å»çœ‹ &lt;a href="../../git-or-cicd/git/" >Git ä»‹ç´¹&lt;/a>ï¼Œè£¡é¢æœ‰è©³ç´°çš„ä»‹ç´¹ ğŸ˜ Â )&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/cd_pass.png"
alt="è§¸ç™¼ Gitlab-CI åŸ·è¡Œè‡ªå‹•åŒ–éƒ¨ç½²" width="700">&lt;figcaption>
&lt;p>è§¸ç™¼ Gitlab-CI åŸ·è¡Œè‡ªå‹•åŒ–éƒ¨ç½²&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°éƒ¨ç½²æˆåŠŸï¼Œæˆ‘å€‘ä¹Ÿä¾†çœ‹çœ‹ Runner é‹ä½œç‹€æ³ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/cd_runner.png"
alt="Runner é‹ä½œç‹€æ³" width="800">&lt;figcaption>
&lt;p>Runner é‹ä½œç‹€æ³&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>çœ‹åˆ°ä»–æˆåŠŸå°‡æœå‹™çµ¦éƒ¨ç½²åˆ° &lt;code>https://laravel-gitlab-cicd-heroku.herokuapp.com/&lt;/code>ã€‚&lt;/p>
&lt;br>
&lt;p>æ—¢ç„¶å·²ç¶“éƒ¨ç½²å¥½äº†ï¼Œç•¶ç„¶è¦å»çœ‹ä¸€ä¸‹æˆ‘å€‘çš„ç¶²é å•Šï¼Œä½†ç•¶æˆ‘å€‘æ‰“é–‹éƒ¨ç½²å¥½çš„ç¶²é ï¼Œæœƒç™¼ç¾è·³å‡º 500 Errorï¼Œé›–ç„¶ä»–èˆ‡æˆ‘å€‘ CI/CD æ²’æœ‰é—œä¿‚ï¼Œä½†æˆ‘å€‘é‚„æ˜¯è©¦è‘—è§£æ±ºï¼Œé‚£é€™å€‹å•é¡Œæœƒç™¼ç”Ÿæ˜¯å› ç‚ºæˆ‘å€‘æ²’æœ‰çµ¦ç’°å¢ƒè®Šæ•¸çš„ APP_KEYï¼Œé€™å€‹ Key å¯ä»¥åœ¨å°ˆæ¡ˆçš„ .env å–å¾—ï¼Œæ‹¿åˆ°å¾Œé–‹å•Ÿ Heroku â†’ Setting â†’ Config vars å°‡ APP_KEY è¨­å®šä¸Šå»ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/key.png"
alt="Runner é‹ä½œç‹€æ³" width="900">&lt;figcaption>
&lt;p>Runner é‹ä½œç‹€æ³&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æœ€å¾Œé‡æ–°æ•´ç† &lt;code>https://laravel-gitlab-cicd-heroku.herokuapp.com/&lt;/code>ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘å€‘éƒ¨ç½²ä¸Šå»çš„ç¶²ç«™å›‰ï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/laravel-gitlab-cicd-heroku/laravel_show.png"
alt="é€é CD éƒ¨ç½²åˆ° Heroku çš„ Laravel é¦–é " width="1000">&lt;figcaption>
&lt;p>é€é CD éƒ¨ç½²åˆ° Heroku çš„ Laravel é¦–é &lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Gitlab-CI å…¥é–€å¯¦ä½œæ•™å­¸ - å–®å…ƒæ¸¬è©¦ç¯‡ï¼š&lt;a href="https://nick-chen.medium.com/gitlab-ci-%E5%85%A5%E9%96%80%E7%AD%86%E8%A8%98-%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6%E7%AF%87-156455e2ad9f" target="_blank" rel="noopener">https://nick-chen.medium.com/gitlab-ci-%E5%85%A5%E9%96%80%E7%AD%86%E8%A8%98-%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6%E7%AF%87-156455e2ad9f&lt;/a>&lt;/p>
&lt;p>Gitlab-CI è‡ªå‹•åŒ–éƒ¨å±¬éƒ¨ç½²ï¼š&lt;a href="https://medium.com/@nick03008/%E6%95%99%E5%AD%B8-gitlab-ci-%E5%85%A5%E9%96%80%E5%AF%A6%E4%BD%9C-%E8%87%AA%E5%8B%95%E5%8C%96%E9%83%A8%E7%BD%B2%E7%AF%87-ci-cd-%E7%B3%BB%E5%88%97%E5%88%86%E4%BA%AB%E6%96%87-cbb5100a73d4" target="_blank" rel="noopener">https://medium.com/@nick03008/%E6%95%99%E5%AD%B8-gitlab-ci-%E5%85%A5%E9%96%80%E5%AF%A6%E4%BD%9C-%E8%87%AA%E5%8B%95%E5%8C%96%E9%83%A8%E7%BD%B2%E7%AF%87-ci-cd-%E7%B3%BB%E5%88%97%E5%88%86%E4%BA%AB%E6%96%87-cbb5100a73d4&lt;/a>&lt;/p>
&lt;p>éƒ¨ç½² Laravel æ–¼ Heroku æ­é… Gitlab CI/CDï¼š&lt;a href="https://medium.com/@vip131430g/%E9%83%A8%E7%BD%B2-laravel-%E6%96%BC-heroku-%E6%90%AD%E9%85%8D-gitlab-ci-cd-6d59a66aebdb" target="_blank" rel="noopener">https://medium.com/@vip131430g/%E9%83%A8%E7%BD%B2-laravel-%E6%96%BC-heroku-%E6%90%AD%E9%85%8D-gitlab-ci-cd-6d59a66aebdb&lt;/a>&lt;/p></description></item><item><title>å¦‚ä½•å¾é ­æ‰“é€ å°ˆå±¬çš„ GitLab CI/CD</title><link>https://pin-yi.me/blog/git-or-cicd/gitlab-cicd/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/git-or-cicd/gitlab-cicd/</guid><description>
&lt;p>è‡ªå¾ä¸Šæ¬¡å­¸å®Œ Jenkins åŠ Ansible CI/CDï¼Œå°±è¦ºå¾— CI/CD å¯¦åœ¨å¤ªé…·äº†ï¼èƒ½å¤ è‡ªå‹•åŒ–çš„å»æŒçºŒæ•´åˆ (Continuous Integration, CI) ä»¥åŠæŒçºŒä½ˆç½² (Continuous Deployment,CD) å°ˆæ¡ˆï¼Œå†åŠ ä¸Šé€™å¹¾å¤©è¤‡ç¿’äº† Git çš„ä½¿ç”¨æ–¹æ³•ï¼Œçªç„¶æƒ³åˆ°ï¼Œè¦æ€éº¼è¨­å®šæˆ‘å€‘å°‡ç¨‹å¼æ¨åˆ°é ç«¯çš„ Git Repoï¼Œèƒ½å¤ å†æ­é… CI/CD å»åšæ¸¬è©¦ï¼Œä¸¦ä¸”æŠŠç¨‹å¼ç¢¼è‡ªå‹•éƒ¨ç½²åˆ°æ­£å¼çš„æœå‹™æ©Ÿå™¨è¨­å‚™ä¸Šå‘¢ï¼Ÿ&lt;/p>
&lt;br>
&lt;p>é‚£æˆ‘å€‘å°±é–‹å§‹å›‰ï¼æ­¤ç¯‡æœƒè¤‡ç¿’ä¸€ä¸‹ CI/CD ä¸¦ä¸”èªªæ˜ GitLab CI/CD é‹ä½œçš„åŸç†ï¼Œé—œæ–¼å¯¦ä½œéƒ¨åˆ†æœƒæ”¾åˆ°ä¸‹ä¸€ç¯‡æ–‡ç«  &lt;a href="../laravel-gitlab-cicd-heroku/" >éƒ¨ç½² Laravel æ–¼ Heroku æ­é… GitLab CI/CD&lt;/a>&lt;/p>
&lt;p>å°äº†å·¥å•†ä¸€ä¸‹ï¼Œå‰›å‰›æœ‰æåˆ°çš„ Jenkins åŠ Ansible CI/CD ç¸½å…±æœ‰ 3 ç¯‡æ–‡ç« ï¼Œé‚„æ²’çœ‹éçš„å¯ä»¥å…ˆé£›éå»çœ‹ä¸€ä¸‹æ­ ğŸ‘‡ğŸ‘‡ğŸ‘‡&lt;/p>
&lt;p>&lt;a href="../../rd/jenkins-ansible/" >Jenkins åŠ Ansible IT è‡ªå‹•åŒ– CI/CD ä»‹ç´¹&lt;/a>&lt;/p>
&lt;p>&lt;a href="../../rd/jenkins/" >ä½¿ç”¨ Jenkins è¨­å®š GitHub è§¸ç™¼ç¨‹åºä¸¦é€šçŸ¥ Telegram Bot&lt;/a>&lt;/p>
&lt;p>&lt;a href="../../rd/ansible/" >Ansible ä»‹ç´¹èˆ‡å¯¦ä½œ (Inventoryã€Playbooksã€Moduleã€Templateã€Handlers)&lt;/a>&lt;/p>
&lt;br>
&lt;p>è€æ¨£å­æ–‡ç« ä¹ŸæœƒåŒæ­¥åˆ° Githubï¼Œæœƒé™„ä¸Šç¯„ä¾‹ä¸­çš„ç¨‹å¼ç¢¼ï¼Œæœ‰éœ€è¦çš„ä¹Ÿå¯ä»¥å»æŸ¥çœ‹æ­ï¼ &lt;a href="https://github.com/880831ian/GitLab-CICD" target="_blank" rel="noopener">Github ç¨‹å¼ç¢¼é€£çµ&lt;/a> ğŸ’“&lt;/p>
&lt;br>
&lt;h2>GitLab CI/CD&lt;span class="absolute -mt-20" id="gitlab-cicd">&lt;/span>
&lt;a href="#gitlab-cicd" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>GitLab CI/CD æ˜¯ GitLab å…§å»ºå¼·å¤§çš„å·¥å…·ï¼Œåœ¨ GitHub è¢«ç¨±ç‚º Github Actionsï¼Œé€™å€‹ä¹‹å¾Œæœ‰ç©ºå†ä¾†ä»‹ç´¹ XDï¼Œå›æ­¸æ­£é¡Œï¼ŒGitLab CI/CD å¯ä»¥è®“æˆ‘å€‘æŒçºŒæ•´åˆå’Œéƒ¨ç½²ï¼Œä¸”ä¸éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„æ‡‰ç”¨ç¨‹å¼ä¾†æ•´åˆã€‚æˆ‘å€‘ä¾†è¤‡ç¿’ä¸€ä¸‹ &lt;code>æŒçºŒæ•´åˆ CI&lt;/code>ã€&lt;code>æŒçºŒéƒ¨ç½² CD &lt;/code> ä»–å€‘æ˜¯ä»€éº¼å§ï¼š&lt;/p>
&lt;br>
&lt;h3>æŒçºŒæ•´åˆ CI&lt;span class="absolute -mt-20" id="æŒçºŒæ•´åˆ-ci">&lt;/span>
&lt;a href="#%e6%8c%81%e7%ba%8c%e6%95%b4%e5%90%88-ci" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä¸€å€‹è™•æ–¼é–‹ç™¼éšæ®µçš„å°ˆæ¡ˆæˆ–æ˜¯è»Ÿé«”ï¼Œå®ƒè¢«æˆ‘å€‘æ”¾åœ¨ GitLab çš„ Repository è£¡ï¼Œé–‹ç™¼äººå“¡æ¯å¤©æœƒæ¨é€ä¸åŒçš„ç¨‹å¼ç¢¼åˆ° GitLab ä¸Šï¼ŒGitLab æŒçºŒæ•´åˆ CI æœƒåœ¨é–‹ç™¼äººå“¡æ¯æ¬¡æ¨é€å¾Œï¼Œè‡ªå‹•åŒ–çš„ä¾ç…§æˆ‘å€‘è¨­å®šå¥½çš„è…³æœ¬é€²è¡Œå»ºæ§‹èˆ‡æ¸¬è©¦ï¼Œå¾è€Œæ¸›å°‘é–‹ç™¼ä¸­çš„å°ˆæ¡ˆç™¼ç”ŸéŒ¯èª¤çš„å¯èƒ½æ€§ã€‚&lt;/p>
&lt;p>é€™ç¨®åšæ³•å°±è¢«ç¨±ä½œæŒçºŒæ•´åˆï¼Œå°æ–¼æˆ‘å€‘æäº¤çµ¦å°ˆæ¡ˆçš„æ¯ä¸€å€‹æ›´æ”¹ã€ç”šè‡³æ˜¯é–‹ç™¼åˆ†æ”¯ï¼Œå®ƒéƒ½æ˜¯è‡ªå‹•ä¸”æŒçºŒåœ°å»ºæ§‹å’Œæ¸¬è©¦ï¼Œç¢ºä¿æ–°åŠ å…¥çš„è®Šå‹•ï¼Œç¬¦åˆæˆ‘å€‘åœ¨å°ˆæ¡ˆä¸­æ‰€è¨­è¨ˆçš„æ‰€æœ‰æ¸¬è©¦ã€‚&lt;/p>
&lt;br>
&lt;h3>æŒçºŒéƒ¨ç½² CD&lt;span class="absolute -mt-20" id="æŒçºŒéƒ¨ç½²-cd">&lt;/span>
&lt;a href="#%e6%8c%81%e7%ba%8c%e9%83%a8%e7%bd%b2-cd" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æŒçºŒéƒ¨ç½²ï¼Œè®“æˆ‘å€‘ä¸å¤ªéœ€è¦æ‰‹å‹•çš„å»éƒ¨ç½²å°ˆæ¡ˆæœå‹™ï¼Œè€Œæ˜¯å°‡å…¶è¨­ç½®ç‚ºè‡ªå‹•åŒ–éƒ¨ç½²ï¼Œå®Œå…¨ä¸éœ€è¦æœ‰äººå·¥å»å¹²æ¶‰ï¼Œæ¸›å°‘äº†äººç‚ºçš„éƒ¨ç½²éŒ¯èª¤ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/cicd.jpg"
alt="GitLab CI/CD (åœ–ç‰‡ä¾†æºï¼šGitLab Agile Planning)" width="800">&lt;figcaption>
&lt;p>GitLab CI/CD (åœ–ç‰‡ä¾†æºï¼š&lt;a href="https://about.gitlab.com/solutions/agile-delivery/" target="_blank" rel="noopener">GitLab Agile Planning&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¤§è‡´äº†è§£æ˜¯å¦‚ä½•é‹ä½œä¹‹å¾Œï¼Œæˆ‘å€‘æ¥è‘—èŠèŠä¸Šé¢æœ‰æåˆ°çš„ &lt;code>è¨­å®šå¥½çš„è…³æœ¬&lt;/code>ï¼š&lt;/p>
&lt;h3>.gitlab-ci.yml&lt;span class="absolute -mt-20" id="gitlab-ciyml">&lt;/span>
&lt;a href="#gitlab-ciyml" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>GitLab CI/CD çš„å·¥ä½œåŸç†æ˜¯ï¼Œè¦åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æ–°å¢ä¸€å€‹åç‚º &lt;code>.gitlab-ci.yml&lt;/code> çš„æ–‡ä»¶ (è¨˜å¾—æ–‡ä»¶åç¨±é–‹é ­æœ‰ &lt;code>.&lt;/code> ï¼Œæˆ‘ä¸€é–‹å§‹å¿˜è¨˜è¦åŠ ï¼Œæƒ³èªªæ€éº¼éƒ½æ²’æœ‰åæ‡‰ ğŸ˜… )ï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘ä¸Šé¢èªªçš„ &lt;code>è¨­å®šå¥½çš„è…³æœ¬&lt;/code>ï¼Œå¯ä»¥å…ˆå°‡æ‰€éœ€å»ºæ§‹ã€æ¸¬è©¦å’Œéƒ¨ç½²çš„è…³æœ¬ç·¨å¯«å®Œæˆï¼Œä»¥åŠå®šç¾©å¾ˆå¤šè¦å‰‡ï¼Œä¾‹å¦‚åŸ·è¡Œå‘½ä»¤çš„å…ˆå¾Œé †åºã€éƒ¨ç½²æ‡‰ç”¨ç¨‹å¼çš„ä½ç½®ä»¥åŠæŒ‡å®šæ˜¯å¦è‡ªå‹•é‹è¡Œæˆ–æ˜¯æ‰‹å‹•è§¸ç™¼è…³æœ¬ç­‰ã€‚&lt;/p>
&lt;p>å°‡ &lt;code>.gitlab-ci.yml&lt;/code> æ–‡ä»¶æ”¾å…¥ Repository è£¡ï¼Œå°±æœƒè§¸ç™¼ CIï¼Œè² è²¬ç®¡ç†çš„ GitLab-CI å°±æœƒä¾ç…§ &lt;code>.gitlab-ci.yml&lt;/code> è¨­å®šæª”ä¾†å•Ÿå‹•åç‚º &lt;code>GitLab Runner&lt;/code> çš„å·¥å…·ä¾†é‹è¡Œè…³æœ¬ï¼Œé€™å€‹ &lt;code>GitLab Runner&lt;/code> æˆ‘å€‘æ”¾åˆ°å¾Œé¢ä¾†èªªï¼Œæˆ‘å€‘å…ˆä¾†èªªèªª &lt;code>.gitlab-ci.yml&lt;/code> é€™å€‹è¨­å®šæª”è¦æ€éº¼ç·¨å¯«ï¼Œä»¥åŠç·¨å¯«å¾Œçš„æµç¨‹ã€‚&lt;/p>
&lt;br>
&lt;p>é€™æ˜¯ä¸€å€‹ç¤ºç¯„çš„ &lt;code>.gitlab-ci.yml&lt;/code>ï¼Œé¸è‡ªå„ªè‰¯çš„ &lt;a href="https://docs.gitlab.com/ee/ci/quick_start/" target="_blank" rel="noopener">GitLab&lt;/a> XDï¼Œç‚ºäº†èªªæ˜æœ‰å°ä¿®æ”¹ç¨‹å¼ç¢¼ï¼Œç¨‹å¼ç¢¼ä¹Ÿæœƒæ”¾åœ¨ &lt;a href="https://github.com/880831ian/GitLab-CICD" target="_blank" rel="noopener">GitHub&lt;/a> ä¸Šæ­ï¼š&lt;/p>
&lt;ul>
&lt;li>.gitlab-ci.yml&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">stages&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">build&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">test&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">deploy&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">cache&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">paths&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">config/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">build-job&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">stage&lt;/span>: &lt;span style="color:#ae81ff">build&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">echo &amp;#34;Hello, $GITLAB_USER_LOGIN!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">test-job1&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">stage&lt;/span>: &lt;span style="color:#ae81ff">test&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">echo &amp;#34;This job tests something&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">test-job2&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">stage&lt;/span>: &lt;span style="color:#ae81ff">test&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">before_script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">echo &amp;#34;This job tests something, but takes more time than test-job1.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">echo &amp;#34;After the echo commands complete, it runs the sleep command for 20 seconds&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">echo &amp;#34;which simulates a test that runs 20 seconds longer than test-job1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">sleep 20&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">deploy-prod&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">stage&lt;/span>: &lt;span style="color:#ae81ff">deploy&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">script&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">echo &amp;#34;This job deploys something from the $CI_COMMIT_BRANCH branch.&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é‚£æˆ‘ä¾†ç°¡å–®èªªæ˜ä¸€ä¸‹ä¸Šé¢é€™äº›è¨­å®šæª”æ¡ˆçš„åŠŸèƒ½ï¼š&lt;/p>
&lt;ul>
&lt;li>stagesï¼šä»£è¡¨é€™å€‹ CI è¨­å®šæª”æœ‰ä¸‰å€‹ stage è¦è·‘ï¼Œä¸€å€‹æ˜¯ buildã€ä¸€å€‹ testã€ä¸€å€‹ deployï¼Œä»–å€‘çš„é †åºä¹Ÿæ±ºå®š CI é‹ä½œçš„é †åºï¼Œç”± build â†’ test â†’ deployï¼Œå‡å¦‚ test æ²’æœ‰é€šéï¼Œå°±ä¸æœƒåŸ·è¡Œ deployã€‚&lt;/li>
&lt;li>cacheï¼šæˆ‘å€‘åœ¨å¯« CI æ™‚ï¼Œå¸¸å¸¸éœ€è¦è£ packageï¼Œä½†æˆ‘ä¸æƒ³æ¯æ¬¡éƒ½é‡æ–°è·‘ä¸€æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥å¯«ä¸€å€‹ cacheï¼Œä¸è¦è®“ GitLab æ¯æ¬¡éƒ½é‡æ–°æ‹‰æ–°çš„ packageã€‚&lt;/li>
&lt;li>build-jobã€test-job1ã€test-job2ã€deploy-prodï¼šä»£è¡¨æˆ‘æœ‰ 4 å€‹ job è¦åŸ·è¡Œï¼Œæ¯å€‹ job è£¡é¢æœ‰ä¸åŒçš„ä»»å‹™ï¼Œä¹Ÿæ˜¯é¡¯ç¤ºåœ¨ Pipeline çš„åç¨±ã€‚&lt;/li>
&lt;li>stageï¼šä»–ç¾åœ¨è¦åŸ·è¡Œçš„éšæ®µï¼Œå°æ‡‰åˆ° stagesã€‚&lt;/li>
&lt;li>before_scriptï¼šå¯ä»¥æŠŠå®ƒç•¶å…ˆéœ€è¦å…ˆåŸ·è¡Œçš„æŒ‡ä»¤ï¼Œå¾Œé¢æ‰æœƒåŸ·è¡Œä¸»è¦çš„ script æŒ‡ä»¤ã€‚æ‰€ä»¥éœ€è¦å®‰è£çš„å¯ä»¥å…ˆå¯«åœ¨é€™è£¡é¢ã€‚&lt;/li>
&lt;li>scriptï¼šä¸»æŒ‡ä»¤ï¼Œåœ¨å¯¦éš›é‹è¡Œçš„è…³æœ¬ä¸­ï¼Œé€šå¸¸æœƒè¦‹åˆ°å¤šè¡Œçš„æŒ‡ä»¤è¢«ä¾åºåŸ·è¡Œã€‚&lt;/li>
&lt;li>$CI_COMMIT_BRANCï¼šç•¶ç„¶ &lt;code>.gitlab-ci.yml&lt;/code> æª”æ¡ˆä¹Ÿå¯ä»¥å¸¶å…¥åƒæ•¸ï¼Œé€™å€‹éƒ¨åˆ†æˆ‘å€‘ç•™åˆ° &lt;a href="../laravel-gitlab-cicd-heroku/" >éƒ¨ç½² Laravel æ–¼ Heroku æ­é… GitLab CI/CD&lt;/a> æ­é…å¯¦éš›æ“ä½œä¾†èªªæ˜ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>ç•¶ç„¶ &lt;code>.gitlab-ci.yml&lt;/code> æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œä¸Šé¢åªæ˜¯ç°¡å–®èªªæ˜æ¯”è¼ƒå¸¸ç”¨çš„ï¼Œç•¶ä½ ä¸ç¢ºå®šè‡ªå·±å¯«çš„ CI è¨­å®šæª”æœ‰æ²’æœ‰å•é¡Œï¼Œæ²’é—œä¿‚å°±ç›´æ¥æ¨ä¸Šå»ï¼ŒGitLab é‚„æœƒå…ˆæª¢æŸ¥ä¸€ä¸‹è¨­å®šæª”æ˜¯ä¸æ˜¯æ­£ç¢ºï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/error.png"
alt="GitLab CI/CD æª¢æŸ¥æ ¼å¼æœ‰éŒ¯" width="600">&lt;figcaption>
&lt;p>GitLab CI/CD æª¢æŸ¥æ ¼å¼æœ‰éŒ¯&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç•¶æˆ‘å€‘å°‡ &lt;code>.gitlab-ci.yml&lt;/code> é€£åŒå°ˆæ¡ˆä¸€èµ·æ¨åˆ° GitLab ä¸Šå¾Œï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°å®ƒæœƒé–‹å§‹åŸ·è¡Œæˆ‘å€‘æ‰€å¯«çš„è…³æœ¬ï¼Œæœƒé¡¯ç¤ºæ•´å€‹åŸ·è¡Œéç¨‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/ci.png"
alt="GitLab CI/CD åŸ·è¡Œéç¨‹" width="1000">&lt;figcaption>
&lt;p>GitLab CI/CD åŸ·è¡Œéç¨‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æŸ¥çœ‹åŸ·è¡Œçš„ç‹€æ…‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/status.png"
alt="GitLab CI/CD ç‹€æ…‹" width="800">&lt;figcaption>
&lt;p>GitLab CI/CD ç‹€æ…‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä¹Ÿå¯ä»¥åœ¨ GitLab Pipeline çœ‹åˆ°åŸ·è¡Œçš„æµç¨‹ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/pipeline.png"
alt="GitLab CI/CD Pipeline" width="800">&lt;figcaption>
&lt;p>GitLab CI/CD Pipeline&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>GitLab CI Runner&lt;span class="absolute -mt-20" id="gitlab-ci-runner">&lt;/span>
&lt;a href="#gitlab-ci-runner" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘ä¸Šé¢æœ‰æåˆ°ï¼Œæˆ‘å€‘åœ¨ CI è·‘è…³æœ¬ï¼Œéœ€è¦ä¸€å€‹ Server ä¾†ä»£æ›¿ GitLab ä¾†è®“æˆ‘å€‘åŸ·è¡Œï¼Œé€™å€‹ Server æˆ‘å€‘ç¨±ç‚º Runnerã€‚æˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹æ•´å€‹åŸ·è¡Œçš„åœ–ç‰‡ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/gitlab-cicd.png"
alt="Gitlab CI/CD å¯¦éš›åŸ·è¡Œæµç¨‹ (åœ–ç‰‡ä¾†æºï¼šGitlab-CI å…¥é–€å¯¦ä½œæ•™å­¸ - å–®å…ƒæ¸¬è©¦ç¯‡)" width="600">&lt;figcaption>
&lt;p>Gitlab CI/CD å¯¦éš›åŸ·è¡Œæµç¨‹ (åœ–ç‰‡ä¾†æºï¼š&lt;a href="https://nick-chen.medium.com/gitlab-ci-%E5%85%A5%E9%96%80%E7%AD%86%E8%A8%98-%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6%E7%AF%87-156455e2ad9f" target="_blank" rel="noopener">Gitlab-CI å…¥é–€å¯¦ä½œæ•™å­¸ - å–®å…ƒæ¸¬è©¦ç¯‡&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é‚£é€™å€‹ Runner æœ‰åˆ†æˆå…©ç¨®ï¼š&lt;/p>
&lt;ul>
&lt;li>å…±äº« Runner (Shared Runners)&lt;/li>
&lt;li>è‡ªæ¶ Runner (Specific Runners)&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>å…±äº« Runner (Shared Runners)&lt;span class="absolute -mt-20" id="å…±äº«-runner-shared-runners">&lt;/span>
&lt;a href="#%e5%85%b1%e4%ba%ab-runner-shared-runners" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>å› ç‚ºæœ¬æ–‡ç« ä»¥åŠå¾ŒçºŒ &lt;a href="../laravel-gitlab-cicd-heroku/" >éƒ¨ç½² Laravel æ–¼ Heroku æ­é… GitLab CI/CD&lt;/a> æ–‡ç« æ‰€ä½¿ç”¨çš„å¹³å°æ˜¯ &lt;a href="https://gitlab.com" target="_blank" rel="noopener">gitlab.com&lt;/a>ï¼Œç”±å®˜æ–¹æ‰€æä¾›ï¼Œæ‰€ä»¥æˆ‘å€‘ç›´æ¥ä½¿ç”¨å…±äº« Runnerï¼Œå¯ä»¥åœ¨ repository Settings â†’ CI / CD â†’ Runners ä¸­æ‰¾åˆ°ï¼Œæœ‰ä¸å°‘å®˜æ–¹æä¾›çš„å…±äº« Runner å¯ä»¥ä½¿ç”¨ï¼Œä¹Ÿä¸éœ€è¦åšä»»ä½•è¨­å®šã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/sharedrunners.png"
alt="GitLab CI/CD å…±äº« Runner" width="800">&lt;figcaption>
&lt;p>GitLab CI/CD å…±äº« Runner&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä½†ä¹Ÿæœ‰å¹¾å€‹ç¼ºé»ï¼š&lt;/p>
&lt;ul>
&lt;li>å› ç‚ºæ˜¯å…±äº«ï¼Œæ‰€ä»¥ Server è³‡æºä¹Ÿæœƒå…±äº«ï¼Œç†è«–ä¸Šå¤šäººä½¿ç”¨çš„é€Ÿåº¦é‚„æ˜¯æœƒæ¯”è¼ƒæ…¢ã€‚&lt;/li>
&lt;li>ä»¥åŠå¦‚æœæ˜¯é–‹æºå°ˆæ¡ˆï¼Œæ˜¯å®Œå…¨å…è²»ã€‚ä½†å¦‚æœæ˜¯ç§äººå°ˆæ¡ˆï¼Œä¸€å€‹æœˆæœ‰ 400 åˆ†é˜çš„ CI åŸ·è¡Œæ™‚é–“é™åˆ¶ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;h4>è‡ªæ¶ Runner (Specific Runners)&lt;span class="absolute -mt-20" id="è‡ªæ¶-runner-specific-runners">&lt;/span>
&lt;a href="#%e8%87%aa%e6%9e%b6-runner-specific-runners" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/gitlab-runner.jpg"
alt="GitLab CI/CD è‡ªæ¶ Runner (åœ–ç‰‡ä¾†æºï¼šBest Practice for DevOps on GitLab and GCP : GitLab Runner ç°¡ä»‹èˆ‡å®‰è£ - Day 7)" width="600">&lt;figcaption>
&lt;p>GitLab CI/CD è‡ªæ¶ Runner (åœ–ç‰‡ä¾†æºï¼š&lt;a href="https://ithelp.ithome.com.tw/articles/10214266" target="_blank" rel="noopener">Best Practice for DevOps on GitLab and GCP : GitLab Runner ç°¡ä»‹èˆ‡å®‰è£ - Day 7&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>GitLab Server å’Œ GitLab Runner æ˜¯ GitLab CI/CD ä¸­ä¸å¯æˆ–ç¼ºçš„å…©è€…ï¼Œä½†å¦‚æœåƒå…¬å¸æ˜¯è‡ªæ¶ GitLabï¼Œé¦–å…ˆè¦å…ˆæ‰¾ä¸€å°é›»è…¦æˆ–æ˜¯ Server åšç‚º Runnerï¼Œé‚£æˆ‘å€‘é€™é‚Šä»¥ Docker ä½œç¤ºç¯„ã€‚&lt;/p>
&lt;p>GitLab Runner çš„å»ºè­°å»ºç½®æ­¥é©Ÿå¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>æº–å‚™/å®‰è£ä¸€å€‹ GitLab Server (é€™é‚Šæˆ‘å€‘ç›´æ¥ä½¿ç”¨ &lt;a href="https://gitlab.com" target="_blank" rel="noopener">gitlab.com&lt;/a>)&lt;/li>
&lt;li>å®‰è£ä¸€å€‹èˆ‡ GitLab Server å°æ‡‰ç‰ˆæœ¬çš„ GitLab Runner&lt;/li>
&lt;li>åœ¨å®‰è£ GitLab Runner çš„è¨­å‚™ä¸Šè¨­å®š &lt;a href="https://docs.gitlab.com/runner/executors/" target="_blank" rel="noopener">Executor&lt;/a>&lt;/li>
&lt;/ol>
&lt;br>
&lt;p>ä»€éº¼æ˜¯ Executor ?&lt;/p>
&lt;p>å¦‚æœæŠŠ GitLab Runner ç•¶æˆä¸€å€‹å·¥å» ä¾†çœ‹ï¼Œé‚£ Executor å°±æ˜¯å·¥å» å…§ä¸€å€‹åˆä¸€å€‹çš„ç”¢ç·šï¼ŒåŒä¸€å€‹å·¥å» å…§å¯ä»¥æ“æœ‰ä¸åŒç¨®é¡çš„ç”¢ç·šï¼ŒRunner èˆ‡ Executor ä¹‹é–“çš„é—œä¿‚å°±æ˜¯å¦‚æ­¤ï¼Œé€™äº›ç”¢ç·šæœƒæ ¹æ“šå°ˆæ¡ˆä¸­ &lt;code>.gitlab-ci.yml&lt;/code> çš„å…§å®¹ï¼Œæ±ºå®šç”¢ç·šä»¥åŠå¦‚ä½•ç”¢å‡ºé–‹ç™¼è€…æœŸæœ›çš„ç”¢å“ã€‚&lt;/p>
&lt;p>å¦å¤– Executor çš„ç¨®é¡éå¸¸å¤šï¼Œå¯ä»¥çœ‹ä¸‹æ–¹é€™äº›åœ–ç‰‡ï¼Œå› ç‚ºæˆ‘å€‘æœ€å¸¸ä½¿ç”¨çš„å°±æ˜¯ Dockerï¼Œæ‰€ä»¥æˆ‘å€‘ç­‰ç­‰çš„ç¯„ä¾‹ï¼Œä¹Ÿæ˜¯å»ºç½®åœ¨ Docker ä¹‹ä¸Šï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/executor.png"
alt="GitLab Runner Executors" width="700">&lt;figcaption>
&lt;p>GitLab Runner Executors&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é‚£æˆ‘å€‘å°±é–‹å§‹ä¾†å¯¦ä½œæˆ‘å€‘çš„ GitLab Runner å§ï¼š&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆï¼Œæˆ‘å€‘å›å»å‰›å‰›åœ¨ repository Settings â†’ CI / CD â†’ Runners å·¦å´çš„ Specific runners&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/specificrunners.png"
alt="GitLab Runner Executors" width="700">&lt;figcaption>
&lt;p>GitLab Runner Executors&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯ä»¥çœ‹åˆ°ä¸€å€‹è¨»å†Šçš„ URL ä»¥åŠ Tokenï¼Œé€™å€‹æˆ‘å€‘åœ¨è¨­å®š Executor æœƒä½¿ç”¨åˆ°ï¼&lt;/p>
&lt;br>
&lt;ol start="2">
&lt;li>æ¥ä¸‹ä¾†é–‹å§‹å®‰è£ GitLab Runnerï¼Œæˆ‘å€‘ä½¿ç”¨ Dockerï¼Œä»¥ä¸‹æ˜¯ Docker åŸ·è¡Œçš„æŒ‡ä»¤ï¼šæœ¬æ­¤ä½¿ç”¨ &lt;a href="https://hub.docker.com/layers/gitlab-runner/gitlab/gitlab-runner/alpine-v15.0.0/images/sha256-f44b39d92aa31186b4d6b986d1c3ffbf8ef4228c2e070410a7a417fb0aa159ce?context=explore" target="_blank" rel="noopener">gitlab-runner&lt;/a> ç‰ˆæœ¬æ˜¯ alpine-v15.0.0&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>docker run -d --name gitlab-runner --restart always &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>-v ~/Shared/gitlab-runner/config:/etc/gitlab-runner &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>-v /var/run/docker.sock:/var/run/docker.sock &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>gitlab/gitlab-runner:alpine-v15.0.0&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>æ¥è‘—é€²å…¥å®¹å™¨è£¡é¢ï¼Œä½¿ç”¨ &lt;code>docker exec -it gitlab-runner gitlab-runner register&lt;/code> ä¾†è¨»å†Šï¼Œå¯ä»¥åƒè€ƒä¸‹æ–¹åœ–ç‰‡ï¼Œè¼¸å…¥ URL ä»¥åŠ è‡ªå·±çš„ Tokenï¼š&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/register_executor.png"
alt="GitLab Runner è¨»å†Š Executors" width="1000">&lt;figcaption>
&lt;p>GitLab Runner è¨»å†Š Executors&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>å¯ä»¥å›åˆ° gitlab.com æŸ¥çœ‹ Specific runners ä¸‹æ–¹æ˜¯å¦å¤šäº†æˆ‘å€‘å‰›å‰›æ‰€è¨»å†Šçš„ GitLab-Runner&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/gitlab-cicd/available_runners.png"
alt="GitLab Available specific runners" width="700">&lt;figcaption>
&lt;p>GitLab Available specific runners&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>GitLab CD&lt;span class="absolute -mt-20" id="gitlab-cd">&lt;/span>
&lt;a href="#gitlab-cd" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>GitLab CD å…¶å¯¦å°±æ˜¯åœ¨ &lt;code>.gitlab-ci.yml&lt;/code> å¾Œé¢åŠ ä¸Šæˆ‘å€‘è¦éƒ¨ç½²çš„è¨­å®šï¼Œé€é CI æ•´åˆå®Œï¼Œæˆ‘å€‘å¯ä»¥è¨­å®šä»–è¦éƒ¨ç½²åˆ°å“ªä¸€å°æ©Ÿå™¨æˆ–æ˜¯è¨­å‚™ä¸Šé€™éƒ¨åˆ†å°±æ”¾åˆ°ä¸‹ä¸€ç¯‡æ–‡ç« ç›´æ¥ç”¨å¯¦ä½œä¾†å‘Šè¨´å¤§å®¶è¦æ€éº¼ä½¿ç”¨å§ï¼ï¼Œè«‹å¤§å®¶æ¥çºŒçœ‹ä¸‹ä¸€ç¯‡ &lt;a href="../laravel-gitlab-cicd-heroku/" >éƒ¨ç½² Laravel æ–¼ Heroku æ­é… GitLab CI/CD&lt;/a> ï¼Œä¸€èµ·å­¸ç¿’å§ GoGo !&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Get started with GitLab CI/CDï¼š&lt;a href="https://docs.gitlab.com/ee/ci/quick_start/" target="_blank" rel="noopener">https://docs.gitlab.com/ee/ci/quick_start/&lt;/a>&lt;/p>
&lt;p>Best Practice for DevOps on GitLab and GCP : GitLab CI/CD - Day 6ï¼š&lt;a href="https://ithelp.ithome.com.tw/articles/10214114" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10214114&lt;/a>&lt;/p>
&lt;p>Gitlab-CI å…¥é–€å¯¦ä½œæ•™å­¸ - å–®å…ƒæ¸¬è©¦ç¯‡ï¼š&lt;a href="https://nick-chen.medium.com/gitlab-ci-%E5%85%A5%E9%96%80%E7%AD%86%E8%A8%98-%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6%E7%AF%87-156455e2ad9f" target="_blank" rel="noopener">https://nick-chen.medium.com/gitlab-ci-%E5%85%A5%E9%96%80%E7%AD%86%E8%A8%98-%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6%E7%AF%87-156455e2ad9f&lt;/a>&lt;/p>
&lt;p>å¦‚ä½•ä½¿ç”¨ GitLab CIï¼š&lt;a href="https://medium.com/@mvpdw06/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-gitlab-ci-ebf0b68ce24b" target="_blank" rel="noopener">https://medium.com/@mvpdw06/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-gitlab-ci-ebf0b68ce24b&lt;/a>&lt;/p></description></item><item><title>Ansible ä»‹ç´¹èˆ‡å¯¦ä½œ (Inventoryã€Playbooksã€Moduleã€Templateã€Handlers)</title><link>https://pin-yi.me/blog/git-or-cicd/ansible/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/git-or-cicd/ansible/</guid><description>
&lt;p>æœ¬ç¯‡æ–‡ç« æ˜¯æ¥çºŒå‰é¢å…©ç¯‡ &lt;a href="../jenkins-ansible/" >Jenkins åŠ Ansible IT è‡ªå‹•åŒ– CI/CD ä»‹ç´¹&lt;/a> è·Ÿ &lt;a href="../jenkins-github-tg-bot/" >ä½¿ç”¨ Jenkins è¨­å®š GitHub è§¸ç™¼ç¨‹åºä¸¦é€šçŸ¥ Telegram Bot&lt;/a> æ–‡ç« ï¼Œæ­¡è¿å¤§å®¶å…ˆå»è§€çœ‹å‰é¢å…©ç¯‡æ–‡ç«  ğŸ¤ª&lt;/p>
&lt;p>æœ¬ç¯‡æ‰€ä½¿ç”¨åˆ°çš„ç¨‹å¼ç¢¼éƒ½æœƒæ•´ç†æ–¼ &lt;a href="https://github.com/880831ian/Ansible" target="_blank" rel="noopener">GitHub é€£çµ&lt;/a>ï¼Œå¤§å®¶æœ‰èˆˆè¶£å¯ä»¥å»ç€è¦½çœ‹çœ‹æ­ï¼&lt;/p>
&lt;br>
&lt;h2>Ansible æ˜¯å¦‚ä½•é‹ä½œçš„ï¼Ÿ&lt;span class="absolute -mt-20" id="ansible-æ˜¯å¦‚ä½•é‹ä½œçš„">&lt;/span>
&lt;a href="#ansible-%e6%98%af%e5%a6%82%e4%bd%95%e9%81%8b%e4%bd%9c%e7%9a%84" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åœ¨ Ansible ä¸–ç•Œè£¡ï¼Œæˆ‘å€‘æœƒé€é &lt;code>Inventory æª”æ¡ˆ&lt;/code> ä¾†å®šç¾©æœ‰å“ªäº›çš„ &lt;code>Managed Node&lt;/code>ï¼Œä¸¦è—‰ç”± &lt;code>SSH&lt;/code> èˆ‡ &lt;code>Python&lt;/code> ä¾†é€²è¡Œæºé€šã€‚é‚£æˆ‘å€‘å…ˆä¾†çœ‹ä¸€å¼µåœ–ï¼š&lt;/p>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/run.png"
alt="Ansible é‹ä½œåŸç† (åœ–ç‰‡ä¾†æºï¼šä¸ƒåˆ†é˜æŒæ¡ Ansible æ ¸å¿ƒè§€å¿µ)" width="600">&lt;figcaption>
&lt;p>Ansible é‹ä½œåŸç† (åœ–ç‰‡ä¾†æºï¼š&lt;a href="https://school.soft-arch.net/courses/28546/lectures/655359" target="_blank" rel="noopener">ä¸ƒåˆ†é˜æŒæ¡ Ansible æ ¸å¿ƒè§€å¿µ&lt;/a>)&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>èª’ ğŸ˜± çªç„¶å¤šäº†å¾ˆå¤šæ–°åè©ï¼Œæ²’é—œä¿‚æˆ‘ä¾†ä¸€ä¸€è§£é‡‹ï¼Œé¦–å…ˆæˆ‘å€‘å…ˆå¾ &lt;code>Managed Node&lt;/code> æ˜¯ä»€éº¼ï¼Œä»¥åŠåœ–ç‰‡ä¸­çš„ &lt;code>Control machine&lt;/code> é–‹å§‹èªªèµ·å§ï¼&lt;/p>
&lt;h3>ä»€éº¼æ˜¯æ§åˆ¶ä¸»æ©ŸåŠè¢«æ§ç¯€é»ï¼Ÿ&lt;span class="absolute -mt-20" id="ä»€éº¼æ˜¯æ§åˆ¶ä¸»æ©ŸåŠè¢«æ§ç¯€é»">&lt;/span>
&lt;a href="#%e4%bb%80%e9%ba%bc%e6%98%af%e6%8e%a7%e5%88%b6%e4%b8%bb%e6%a9%9f%e5%8f%8a%e8%a2%ab%e6%8e%a7%e7%af%80%e9%bb%9e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨ Ansible è£¡ï¼Œæˆ‘å€‘æœƒæŠŠæ‰€æœ‰æ©Ÿå™¨çš„è§’è‰²åšä»¥ä¸‹çš„å€åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>æ§åˆ¶ä¸»æ©Ÿ (Control Machine)ï¼šé¡§åæ€ç¾©ï¼Œé€™é¡ä¸»æ©Ÿå¯ä»¥é€éé‹è¡Œ Ansible çš„åŠ‡æœ¬ (Playbooks) å°è¢«æ§ç¯€é»é€²è¡Œéƒ¨ç½²ã€‚&lt;/li>
&lt;li>è¢«æ§ç¯€é» (Managed Node)ï¼šä¹Ÿç¨±ç‚ºé™æ§ç¯€é» (Remote Node)ã€‚ç›¸å°æ–¼æ§åˆ¶ä¸»æ©Ÿï¼Œé€™é¡ç¯€é»å°±æ˜¯æˆ‘å€‘é€é Ansible é€²è¡Œéƒ¨ç½²çš„å°è±¡ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ‰€ä»¥ä»£è¡¨æˆ‘å€‘åœ¨æ“ä½œé€™é‚Šå°±æ˜¯ Control Machineï¼Œè¦éƒ¨ç½²çš„æ©Ÿå™¨å°±æ˜¯ Managed Nodeï¼Œé€é SSH ä¾†åšé€£ç·šã€‚ä½†ä»€éº½æ˜¯ &lt;code>Inventory&lt;/code> è·Ÿ &lt;code>Playbooks&lt;/code> å‘¢ï¼Ÿ&lt;/p>
&lt;br>
&lt;h3>ä»€éº¼æ˜¯ Ansible Inventory&lt;span class="absolute -mt-20" id="ä»€éº¼æ˜¯-ansible-inventory">&lt;/span>
&lt;a href="#%e4%bb%80%e9%ba%bc%e6%98%af-ansible-inventory" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>Inventory&lt;/code> é€™å€‹å–®å­—æœ¬èº«æœ‰&lt;strong>è©³ç´°ç›®éŒ„&lt;/strong>ã€&lt;strong>æ¸…å–®&lt;/strong>å’Œ&lt;strong>åˆ—è¡¨&lt;/strong>çš„æ„æ€ã€‚åœ¨é€™è£¡æˆ‘å€‘å¯ä»¥æŠŠå®ƒç†è§£æˆä¸€ä»½ä¸»æ©Ÿåˆ—è¡¨ï¼Œå¯ä»¥é€éå®ƒä¾†å®šç¾©æ¯å€‹ Managed Node çš„ä»£è™Ÿã€IP ä½å€ã€é€£ç·šè¨­å®šå’Œç¾¤çµ„ã€‚&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ vim hosts
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ansible_ssh_hostï¼šé ç«¯ SSH ä¸»æ©Ÿä½å€&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ansible_ssh_portï¼šé ç«¯ SSH Port&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ansible_ssh_userï¼šé ç«¯ SSH ä½¿ç”¨è€…åç¨±&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ansible_ssh_private_key_fileï¼šæœ¬æ©Ÿ SSH ç§é‘°æª”æ¡ˆè·¯å¾‘&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ansible_ssh_passï¼šé ç«¯ SSH å¯†ç¢¼ (å»ºè­°ä½¿ç”¨ç§é‘°)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>local&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 ansible_ssh_host&lt;span style="color:#f92672">=&lt;/span>127.0.0.1 ansible_ssh_port&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">55000&lt;/span> ansible_ssh_pass&lt;span style="color:#f92672">=&lt;/span>docker&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ‰€ä»¥æˆ‘å€‘å¯ä»¥åœ¨é€™é‚Šè¼¸å…¥å¾ˆå¤šå€‹ä¸»æ©Ÿä¾†åšç®¡ç†ï¼Œå¯ä»¥æŠŠå®ƒæƒ³æˆä¸€å€‹è¨­å®šæª”ã€‚&lt;/p>
&lt;br>
&lt;h3>ä»€éº¼æ˜¯ Ansible Playbooks&lt;span class="absolute -mt-20" id="ä»€éº¼æ˜¯-ansible-playbooks">&lt;/span>
&lt;a href="#%e4%bb%80%e9%ba%bc%e6%98%af-ansible-playbooks" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å†è«‡ Ansible Playbooks ä¹‹å‰ï¼Œå…ˆèªªæ˜æˆ‘å€‘è¦æ€éº¼å»æ“ä½œ Ansibleï¼Ÿä¸€èˆ¬ä¾†èªªï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ Ad-Hoc Commands å’Œ Playbooks å…©ç¨®æ–¹å¼ä¾†æ“ä½œ Ansibleã€‚&lt;/p>
&lt;br>
&lt;h4>Ad-Hoc Commands æ˜¯ä»€éº¼ï¼Ÿ&lt;span class="absolute -mt-20" id="ad-hoc-commands-æ˜¯ä»€éº¼">&lt;/span>
&lt;a href="#ad-hoc-commands-%e6%98%af%e4%bb%80%e9%ba%bc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Ad hoc å¯ä»¥ç¿»è­¯æˆ&lt;strong>ç°¡çŸ­åœ°æŒ‡ä»¤&lt;/strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘å¸¸ç”¨çš„æŒ‡ä»¤æ¨¡å¼ï¼Œæœ€å¸¸è¦‹çš„ &lt;code>ping&lt;/code>å’Œ&lt;code>echo&lt;/code> ç‚ºä¾‹ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>ping&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible all -m ping
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 | SUCCESS &lt;span style="color:#f92672">=&lt;/span>&amp;gt; &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_facts&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;discovered_interpreter_python&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/usr/bin/python&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">}&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;changed&amp;#34;&lt;/span>: false,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ping&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;pong&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ul>
&lt;li>&lt;code>echo&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible all -m command -a &lt;span style="color:#e6db74">&amp;#34;echo Hello World&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 | CHANGED | rc&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span> &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hello World&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¾ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ° Ad-Hoc Commands ä¸€æ¬¡åªèƒ½è™•ç†ä¸€ä»¶äº‹æƒ…ï¼Œé€™æ˜¯å®ƒèˆ‡ Playbooks æœ€å¤§çš„å·®ç•°ã€‚&lt;/p>
&lt;br>
&lt;h3>Playbooks æ˜¯ä»€éº¼ï¼Ÿ&lt;span class="absolute -mt-20" id="playbooks-æ˜¯ä»€éº¼">&lt;/span>
&lt;a href="#playbooks-%e6%98%af%e4%bb%80%e9%ba%bc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Playbooks å°±æ˜¯å­—é¢ä¸Šçš„æ„æ€ç‚º&lt;strong>åŠ‡æœ¬&lt;/strong>ï¼Œæˆ‘å€‘å¯ä»¥å…ˆé€éå¯«å¥½çš„&lt;strong>åŠ‡æœ¬ (Playbooks)&lt;/strong> ä¾†è®“å„å€‹ Managed Node é€²è¡ŒæŒ‡å®šçš„&lt;strong>å‹•ä½œ (Plays)&lt;/strong> å’Œ&lt;strong>ä»»å‹™ (Tasks)&lt;/strong>ã€‚&lt;/p>
&lt;p>ç°¡è€Œè¨€ä¹‹ï¼ŒPlaybooks å°±æ˜¯ Ansible çš„è…³æœ¬ (Script)ï¼Œè€Œä¸”æ¯”å‚³çµ± Shell Script é‚„è¦å¼·å¤§å¥½å¹¾ç™¾å€çš„è…³æœ¬ï¼æ­¤å¤–å®ƒæ˜¯ä½¿ç”¨ &lt;strong>YAML&lt;/strong> æ ¼å¼ï¼Œå¯« Code å°±å¦‚åŒå¯«æ–‡ä»¶ä¸€æ¨£ï¼Œç°¡å–®æ˜“è®€ã€‚&lt;/p>
&lt;p>æœ‰é—œè©³ç´°çš„&lt;strong>å‹•ä½œ (Plays)&lt;/strong> å’Œ&lt;strong>ä»»å‹™ (Tasks)&lt;/strong>ï¼Œç­‰æˆ‘å€‘å¯¦éš›å®‰è£å¥½å†ä¾†èªªæ˜ ğŸ˜†&lt;/p>
&lt;br>
&lt;h2>Ansible å®‰è£èˆ‡å¯¦ä½œ&lt;span class="absolute -mt-20" id="ansible-å®‰è£èˆ‡å¯¦ä½œ">&lt;/span>
&lt;a href="#ansible-%e5%ae%89%e8%a3%9d%e8%88%87%e5%af%a6%e4%bd%9c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å®‰è£ä¹‹å‰å…ˆè®“å¤§å®¶çœ‹ä¸€ä¸‹ç‰ˆæœ¬å§ï¼å¤§å®¶è¦è¨˜å¾—æª¢æŸ¥è‡ªå·±çš„ç‰ˆæœ¬èˆ‡æ•™å­¸æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸åŒï¼Œè¨˜å¾—è¦å…ˆæŸ¥çœ‹å®˜ç¶²æ˜¯å¦æœ‰ä¿®æ”¹å…§å®¹ã€‚&lt;/p>
&lt;h3>ç‰ˆæœ¬&lt;span class="absolute -mt-20" id="ç‰ˆæœ¬">&lt;/span>
&lt;a href="#%e7%89%88%e6%9c%ac" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>macOSï¼š11.6&lt;/li>
&lt;li>Dockerï¼šDocker version 20.10.14, build a224086&lt;/li>
&lt;li>Aansibleï¼šansible [core 2.12.5]&lt;/li>
&lt;/ul>
&lt;br>
&lt;h3>å¦‚ä½•å®‰è£ Ansible åœ¨æ§åˆ¶ä¸»æ©Ÿ&lt;span class="absolute -mt-20" id="å¦‚ä½•å®‰è£-ansible-åœ¨æ§åˆ¶ä¸»æ©Ÿ">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e5%ae%89%e8%a3%9d-ansible-%e5%9c%a8%e6%8e%a7%e5%88%b6%e4%b8%bb%e6%a9%9f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç”±æ–¼ Ansible æ˜¯ä¸€å¥—é–‹æºçš„è»Ÿé«”ï¼Œæ‰€ä»¥åœ¨ç›®å‰å¤§éƒ¨åˆ†ä¸»æµä½œæ¥­ç³»çµ±ä¸Šéƒ½å¯ä»¥é€éå°æ‡‰çš„å¥—ä»¶ç®¡ç† (package manager) é€²è¡Œå®‰è£ã€‚&lt;/p>
&lt;p>æœ¬äººä½¿ç”¨ macOS ï¼Œæ‰€ä»¥é€™é‚Šåƒ…åˆ—å‡º masOS å®‰è£æ–¹å¼ï¼Œå…¶ä»–çš„å¯ä»¥åƒè€ƒ&lt;a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html#installing-ansible-on-specific-operating-systems" target="_blank" rel="noopener">å®˜æ–¹çš„å®‰è£æŒ‡å—&lt;/a>ã€‚&lt;/p>
&lt;br>
&lt;p>macOS å®‰è£å¯ä»¥ä½¿ç”¨å…©ç¨®æ–¹å¼ï¼Œå®˜æ–¹è¼ƒæ¨è–¦ä½¿ç”¨ &lt;code>pip&lt;/code> ä¾†åšå®‰è£ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://pip.pypa.io/en/stable/#" target="_blank" rel="noopener">Pip Install Packages (pip å®˜æ–¹è¼ƒæ¨è–¦)&lt;/a>&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ sudo pip install ansible&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ul>
&lt;li>&lt;a href="https://formulae.brew.sh/formula/ansible#default" target="_blank" rel="noopener">Homebrew (brew)&lt;/a>&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ sudo brew install ansible&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å®‰è£å®Œå¾Œï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>--version&lt;/code> æŒ‡ä»¤ä¾†æª¢æŸ¥æ˜¯å¦å®‰è£å®Œæˆï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ansible &lt;span style="color:#f92672">[&lt;/span>core 2.12.5&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> config file &lt;span style="color:#f92672">=&lt;/span> None
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> configured module search path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#e6db74">&amp;#39;/Users/ian_zhuang/.ansible/plugins/modules&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;/usr/share/ansible/plugins/modules&amp;#39;&lt;/span>&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ansible python module location &lt;span style="color:#f92672">=&lt;/span> /usr/local/Cellar/ansible/5.7.1/libexec/lib/python3.10/site-packages/ansible
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ansible collection location &lt;span style="color:#f92672">=&lt;/span> /Users/ian_zhuang/.ansible/collections:/usr/share/ansible/collections
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> executable location &lt;span style="color:#f92672">=&lt;/span> /usr/local/bin/ansible
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python version &lt;span style="color:#f92672">=&lt;/span> 3.10.4 &lt;span style="color:#f92672">(&lt;/span>main, Apr &lt;span style="color:#ae81ff">26&lt;/span> 2022, 19:43:24&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Clang 13.0.0 &lt;span style="color:#f92672">(&lt;/span>clang-1300.0.29.30&lt;span style="color:#f92672">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> jinja version &lt;span style="color:#f92672">=&lt;/span> 3.1.2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> libyaml &lt;span style="color:#f92672">=&lt;/span> True&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>å¦‚ä½•å®‰è£ Ansible åœ¨è¢«æ§ç¯€é»&lt;span class="absolute -mt-20" id="å¦‚ä½•å®‰è£-ansible-åœ¨è¢«æ§ç¯€é»">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e5%ae%89%e8%a3%9d-ansible-%e5%9c%a8%e8%a2%ab%e6%8e%a7%e7%af%80%e9%bb%9e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä¸éœ€è¦ï¼ï¼ï¼ é€é Ansible é€²è¡Œç®¡ç†çš„è¢«æ§ç¯€é»å®Œå…¨ä¸éœ€è¦å®‰è£ Ansibleã€‚æˆ‘å€‘åªéœ€è¦ç¢ºä¿é€™å€‹ç¯€é»å¯ä»¥é€é SSH èˆ‡æ§åˆ¶ä¸»æ©Ÿåšæºé€šï¼Œä¸¦å®‰è£ Python 2.6 ä»¥ä¸Šç‰ˆæœ¬å°±å¯ä»¥é€éæ§åˆ¶ä¸»æ©Ÿä¾†é€²è¡Œéƒ¨ç½²åŠç®¡ç†äº†ã€‚&lt;/p>
&lt;br>
&lt;p>é‚£æˆ‘å€‘ç‚ºäº†è¦æ¨¡æ“¬ï¼Œæ‰€ä»¥æˆ‘å€‘ä½¿ç”¨ Docker ä¾†æ¨¡æ“¬ Managed Nodeï¼Œé¦–å…ˆè€æ¨£å­ï¼Œä¸€æ¨£å…ˆå¯«ä¸€å€‹ Dockerfile ä¾†å»ºç«‹æˆ‘å€‘çš„æ˜ åƒæª”ï¼Œæ­¤æ˜ åƒæª”æ˜¯å¾®èª¿ &lt;a href="https://github.com/chusiang/ansible-managed-node.dockerfile/blob/master/ubuntu-14.04/Dockerfile" target="_blank" rel="noopener">chusiang/ansible-managed-node.dockerfile&lt;/a> çš„å…§å®¹ï¼Œä¿®æ”¹ ubuntu ç‰ˆæœ¬ä»¥åŠå…§å®¹ä½œèª¿æ•´ï¼Œæˆ‘æœƒæŠŠç¨‹å¼ç¢¼æ”¾åœ¨ &lt;a href="https://github.com/880831ian/Ansible" target="_blank" rel="noopener">GitHub é€£çµ&lt;/a> ï¼Œä»¥åŠ &lt;a href="https://hub.docker.com/r/880831ian/ansible-ubuntu-server" target="_blank" rel="noopener">DockerHub é€£çµ&lt;/a>ï¼Œæ­¡è¿å¤§å®¶å‰å»ä¸‹è¼‰ä½¿ç”¨ã€‚&lt;/p>
&lt;br>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-dockerfile" data-lang="dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> ubuntu:22.10&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">LABEL&lt;/span> maintainer&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;880831ian@gmail.com&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Update the index of available packages.&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> apt-get update&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Install the requires package.&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> apt-get install -y openssh-server sudo curl wget bash-completion openssl &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> apt-get clean&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Setting the sshd.&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> mkdir /var/run/sshd&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> echo &lt;span style="color:#e6db74">&amp;#39;root:root&amp;#39;&lt;/span> | chpasswd&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> sed -i &lt;span style="color:#e6db74">&amp;#39;s/PermitRootLogin without-password/PermitRootLogin yes/&amp;#39;&lt;/span> /etc/ssh/sshd_config&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># SSH login fix. Otherwise user is kicked off after login&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> sed &lt;span style="color:#e6db74">&amp;#39;s@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g&amp;#39;&lt;/span> -i /etc/pam.d/sshd&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ENV&lt;/span> NOTVISIBLE &lt;span style="color:#e6db74">&amp;#34;in users profile&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> echo &lt;span style="color:#e6db74">&amp;#34;export VISIBLE=now&amp;#34;&lt;/span> &amp;gt;&amp;gt; /etc/profile&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Create a new user.&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e">#&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># - username: docker&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># - password: docker&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> useradd --create-home --shell /bin/bash &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --password &lt;span style="color:#66d9ef">$(&lt;/span>openssl passwd -1 docker&lt;span style="color:#66d9ef">)&lt;/span> docker&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Add sudo permission.&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> echo &lt;span style="color:#e6db74">&amp;#39;docker ALL=(ALL) NOPASSWD: ALL&amp;#39;&lt;/span> &amp;gt;&amp;gt; /etc/sudoers&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Setting ssh public key.&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> wget https://raw.githubusercontent.com/chusiang/ansible-jupyter.dockerfile/master/files/ssh/id_rsa.pub &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -O /tmp/authorized_keys &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> mkdir /home/docker/.ssh &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> mv /tmp/authorized_keys /home/docker/.ssh/ &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> chown -R docker:docker /home/docker/.ssh/ &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> chmod &lt;span style="color:#ae81ff">644&lt;/span> /home/docker/.ssh/authorized_keys &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> chmod &lt;span style="color:#ae81ff">700&lt;/span> /home/docker/.ssh&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">EXPOSE&lt;/span>&lt;span style="color:#e6db74"> 22&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># Run ssh server daemon.&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">CMD&lt;/span> [&lt;span style="color:#e6db74">&amp;#34;/usr/sbin/sshd&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;-D&amp;#34;&lt;/span>]&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æ¥ä¸‹ä¾†å°‡å®ƒåŒ…æˆ Image ä¸¦å•Ÿå‹•ä»–ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ docker build -t ansible-ubuntu-server . &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> docker run --name server1 -d -p 8888:22 ansible-ubuntu-server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>64c51235e34a7ba42c0c45e690201dd80248c9aac76c3b855c99cf63f7f0af7c&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å¯ä»¥ç”¨ &lt;code>exec&lt;/code> é€²å…¥å®¹å™¨ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>docker exec -it server1 /bin/bash&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>å¦‚ä½•è®“ Ansible æ“æ§ Docker å®¹å™¨ï¼Ÿ&lt;span class="absolute -mt-20" id="å¦‚ä½•è®“-ansible-æ“æ§-docker-å®¹å™¨">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e8%ae%93-ansible-%e6%93%8d%e6%8e%a7-docker-%e5%ae%b9%e5%99%a8" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘åœ¨å·¥ä½œç›®éŒ„ä¸‹ï¼Œæ–°å¢ä¸€å€‹ &lt;code>ansible.cfg&lt;/code>ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cfg" data-lang="cfg">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">[defaults]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">inventory&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">hosts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">remote_user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">host_key_checking&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">False&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>è¨­å®š inventory hostsï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>local&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 ansible_ssh_host&lt;span style="color:#f92672">=&lt;/span>127.0.0.1 ansible_ssh_port&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">8888&lt;/span> ansible_ssh_pass&lt;span style="color:#f92672">=&lt;/span>docker&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å…¶ä¸­ 8888 æ˜¯æˆ‘å€‘åœ¨å•Ÿå‹•æ™‚æ‰€é–‹æ”¾çš„ Portï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œæ›´æ”¹ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>ansible_ssh_host&lt;/code>ï¼šè¨­ç‚ºæœ¬æ©Ÿçš„ IPã€‚&lt;/li>
&lt;li>&lt;code>ansible_ssh_port&lt;/code>ï¼šè¨­ç‚º &lt;code>docker ps &lt;/code>å–å¾—çš„ SSH Port ä¹Ÿå°±æ˜¯æˆ‘å€‘çš„ 8888ã€‚&lt;/li>
&lt;li>&lt;code>ansible_ssh_pass&lt;/code>ï¼šå› ç‚ºæˆ‘å€‘æ²’æœ‰é€£ç·šç”¨çš„é‡‘é‘°ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨å¯†ç¢¼æ–¹å¼åšé€£çµã€‚(å»ºè­°åªç”¨æ–¼ç·´ç¿’ç’°å¢ƒä½¿ç”¨)&lt;/li>
&lt;/ul>
&lt;br>
&lt;h3>Hello World On Managed Node&lt;span class="absolute -mt-20" id="hello-world-on-managed-node">&lt;/span>
&lt;a href="#hello-world-on-managed-node" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç•¶æˆ‘å€‘éƒ½è¨­ç½®å®Œæˆå¾Œï¼Œå°±å¯ä»¥ä½¿ç”¨ Terminal ç”¨ Docker å»ºç«‹å¥½çš„ Ansible ä¾†ç·´ç¿’äº†ï¼&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible all -m command -a &lt;span style="color:#e6db74">&amp;#39;echo Hello World on Docker.&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 | CHANGED | rc&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span> &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hello World on Docker.&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
&lt;p>ansible å®‰è£æ™‚å¸¸è¦‹å•é¡Œ&lt;/p>
&lt;p>Q1. server1 | FAILED | rc=-1 &amp;raquo; to use the &amp;lsquo;ssh&amp;rsquo; connection type with passwords or pkcs11_provider, you must install the sshpass program&lt;/p>
&lt;p>Ans1. æœƒé‡åˆ°é€™å€‹å•é¡Œæ˜¯å› ç‚ºéœ€è¦å¤šå®‰è£ sshpassï¼Œä¸€èˆ¬ç³»çµ±å®‰è£ sshpass å¾ˆç°¡å–®ï¼Œä½†åœ¨ macOS ä¸Šç¨å¾®éº»ç…©ï¼Œè©³ç´°å¯ä»¥åƒè€ƒ&lt;a href="https://stackoverflow.com/questions/32255660/how-to-install-sshpass-on-mac" target="_blank" rel="noopener">é€™ç¯‡æ–‡ç« &lt;/a>ã€‚&lt;/p>
&lt;br>
&lt;p>Q2. ~paramiko/transport.py:236: CryptographyDeprecationWarning: Blowfish has been deprecated&lt;/p>
&lt;p>Ans2. åœ¨æˆ‘å®‰è£éç¨‹ä¸­ï¼Œç™¼ç¾ä¸Šå‰å¹¾å¤©æ‰å‡ºç¾é€™å€‹ Bug è©³ç´°æƒ…å½¢å¯ä»¥åƒè€ƒ &lt;a href="https://github.com/paramiko/paramiko/issues/2038" target="_blank" rel="noopener">GitHub issues&lt;/a>ï¼Œç›®å‰è§£æ±ºè¾¦æ³•æœ‰é™æ¿æˆ–æ˜¯å…ˆå°‡éŒ¯èª¤è¨Šæ¯çµ¦è¨»è§£æ‰ï¼Œä¹‹å¾Œå†ç­‰æ–°çš„ç‰ˆæœ¬å‡ºä¾†å†æ›´æ–°ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œé¸æ“‡ï¼Œæˆ‘é€™é‚Šæ˜¯ç›´æ¥æŠŠå‡ºç¾å•é¡Œçš„ &lt;code>transport.py&lt;/code> å…§å®¹è¨»è§£æ‰ï¼Œå¤§æ¦‚ä½æ–¼ 236 è¡Œï¼Œå¯ä»¥çœ‹ä¸‹æ–¹åœ–ç‰‡ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/blowfish.png"
alt="CryptographyDeprecationWarning éŒ¯èª¤è¨Šæ¯ä¿®æ­£" width="450">&lt;figcaption>
&lt;p>CryptographyDeprecationWarning éŒ¯èª¤è¨Šæ¯ä¿®æ­£&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h2>ç¬¬ä¸€å€‹ Playbook&lt;span class="absolute -mt-20" id="ç¬¬ä¸€å€‹-playbook">&lt;/span>
&lt;a href="#%e7%ac%ac%e4%b8%80%e5%80%8b-playbook" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åœ¨æˆ‘å€‘éƒ½å®‰è£å¥½å¾Œï¼Œè¦ä¾†èªªèªªæˆ‘å€‘å‰›å‰›æœ‰å·å·æåˆ°çš„ Playbooks çš„å‹•ä½œ (Plays) å’Œä»»å‹™ (Tasks)ã€‚åœ¨ä¸€ä»½ Playbooks è£¡é¢ï¼Œå¯ä»¥æœ‰å¤šå€‹ Playã€å¤šå€‹ Task å’Œå¤šå€‹ Moduleï¼š&lt;/p>
&lt;ul>
&lt;li>Playï¼šé€šå¸¸ç‚ºæŸå€‹ç‰¹å®šçš„ç›®çš„ï¼Œä¾‹å¦‚ï¼š
&lt;ul>
&lt;li>&lt;code>Setup a official website with Drupal&lt;/code> è—‰ç”± Drupal å»ºç½®å®˜ç¶²&lt;/li>
&lt;li>&lt;code>Restart the API Service&lt;/code> é‡é–‹ API æœå‹™&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Taskï¼šè¦å¯¦è¡Œ Play é€™å€‹ç›®çš„æ‰€éœ€åšçš„æ¯å€‹æ­¥é©Ÿï¼Œä¾‹å¦‚ï¼š
&lt;ul>
&lt;li>&lt;code>Install the Nginx&lt;/code> å®‰è£ Nginx&lt;/li>
&lt;li>&lt;code>Kill the djnago process&lt;/code> å¼·åˆ¶åœæ­¢ django çš„è¡Œç¨‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Moduleï¼šAnsible æ‰€æä¾›çš„å„ç¨®æ“ä½œæ–¹å¼ï¼Œä¾‹å¦‚ï¼š
&lt;ul>
&lt;li>&lt;code>apt: name=vim state=present&lt;/code> ä½¿ç”¨ apt å¥—ä»¶å®‰è£ vim&lt;/li>
&lt;li>&lt;code>command: /sbin/shutdown -r now&lt;/code> ä½¿ç”¨ shutdown çš„æŒ‡ä»¤é—œæ©Ÿ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>æœ‰é»è½ä¸æ‡‚å§ï¼æˆ‘ä¾†èˆ‰å€‹ä¾‹å­ï¼Œæˆ‘å€‘æœ€ç†Ÿæ‚‰çš„ Hello Worldï¼Œå…ˆå»ºç«‹ä¸€å€‹ &lt;code>helloworld.yaml&lt;/code> çš„æª”æ¡ˆï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div class="filename">helloworld.yaml&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">say &amp;#39;hello world&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">all&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">echo &amp;#39;hello world&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: &lt;span style="color:#ae81ff">echo &amp;#39;hello world&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">register&lt;/span>: &lt;span style="color:#ae81ff">result&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">print stdout&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">msg&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{ result.stdout }}&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-8">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°é€™æ•´å€‹å°±æ˜¯ Playï¼Œæˆ‘å€‘æƒ³è¦é”åˆ° say &amp;lsquo;hello world&amp;rsquo; çš„ç›®çš„ï¼Œå…¶ä¸­æœ‰å…©å€‹ name åˆ†åˆ¥ä»£è¡¨å…©å€‹ Taskï¼Œä¹Ÿå°±æ˜¯é”æˆ Play ç›®çš„æ‰€éœ€å¾—æ­¥é©Ÿã€‚æœ€å¾Œ command èˆ‡ debug å°±æ˜¯æˆ‘å€‘çš„ Module è¦æ€éº¼é”æˆé€™å…©å€‹æ­¥é©Ÿçš„æ“ä½œæ–¹å¼ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/playbooks.gif"
alt="Playbooks çµ„æˆçµæ§‹" width="800">&lt;figcaption>
&lt;p>Playbooks çµ„æˆçµæ§‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘ä½¿ç”¨ &lt;code>ansible-playbook&lt;/code> åŸ·è¡Œ Playbookï¼Œåœ¨é€™å€‹ç¯„ä¾‹ä¸­ï¼Œæˆ‘å€‘åŸ·è¡Œäº†ï¼‘å€‹ Playã€3 å€‹ Tasks å’Œ 2 å€‹ Modulesï¼š&lt;/p>
&lt;br>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible-playbook helloworld.yaml&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/helloworld.png"
alt="åŸ·è¡Œ Playbooks" width="1000">&lt;figcaption>
&lt;p>åŸ·è¡Œ Playbooks&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;div class="overflow-x-auto mt-6 flex rounded-lg border py-2 ltr:pr-4 rtl:pl-4 contrast-more:border-current contrast-more:dark:border-current border-orange-100 bg-orange-50 text-orange-800 dark:border-orange-400/30 dark:bg-orange-400/20 dark:text-orange-300">
&lt;div class="ltr:pl-3 ltr:pr-2 rtl:pr-3 rtl:pl-2">&lt;/div>
&lt;div class="w-full min-w-0 leading-7">
&lt;div class="mt-6 leading-7 first:mt-0">
&lt;p>æˆ‘å€‘å‰›å‰›æ˜æ˜åªå¯«å…©å€‹ tasksï¼Œç‚ºä»€éº¼åŸ·è¡Œå°±è®Šæˆä¸‰å€‹ tasksï¼Ÿ&lt;/p>
&lt;p>é€™æ˜¯å› ç‚º Ansible é è¨­æœƒä½¿ç”¨ &lt;code>Setup&lt;/code> task ä¾†å–å¾— Managed node çš„ factsã€‚é—œæ–¼ facts çš„è©³ç´°èªªæ˜ï¼Œè«‹æ»‘åˆ°å¾Œé¢ &lt;a href="#%e5%8f%96%e5%be%97-managed-node-%e7%9a%84-facts" >å–å¾—-managed-node-çš„-facts&lt;/a> è§€çœ‹ ğŸ˜¬&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é‚£å¦‚æœæ²’æœ‰ Ansible æ™‚ï¼Œæˆ‘å€‘æ˜¯æ€éº¼æ“ä½œçš„ï¼Ÿæˆ‘æœƒé™„ä¸Š Shell Script çš„åšæ³•ï¼Œæˆ‘å€‘ä¾†æ¯”è¼ƒçœ‹çœ‹å§ï¼&lt;/p>
&lt;br>
&lt;ul>
&lt;li>&lt;strong>Shell Script&lt;/strong> å»ºç«‹ &lt;code>helloworld.sh&lt;/code> æª”æ¡ˆ&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div class="filename">helloworld.sh&lt;/div>&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#! /bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>echo &lt;span style="color:#e6db74">&amp;#34;Hello World&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-8">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ul>
&lt;li>åŸ·è¡Œ &lt;code>helloworld.sh&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>./ helloworld.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hello World&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>çœ‹èµ·ä¾† Shell Script å·²ç¶“å¤ ç”¨äº†ï¼Œç‚ºä»€éº¼é‚„è¦å¯« Playbook å‘¢ï¼Ÿé€™é‚Šæ•´ç†å¹¾å€‹ç†ç”±çµ¦å¤§å®¶åƒè€ƒï¼š&lt;/p>
&lt;ol>
&lt;li>ç”¨ Ansible çš„ Module å¯ä»¥æŠŠå¾ˆå¤šè¤‡é›œçš„æŒ‡ä»¤çµ¦æ¨™æº–åŒ–ï¼Œä¾‹å¦‚ä¸åŒçš„ Linux ç™¼è¡Œç‰ˆæœ¬åœ¨å®‰è£å¥—ä»¶æ™‚éœ€ä»£å„ç¨®ä¸åŒçš„åƒæ•¸ã€‚&lt;/li>
&lt;li>åœ¨ç¾æœ‰çš„é›²åŸç”Ÿ (cloud native) çš„æ¶æ§‹ä¸‹ï¼Œå‚³çµ±çš„ Shell Script å·²ç¶“ä¸æ•·ä½¿ç”¨ï¼Œä¸€èˆ¬è€Œè¨€ Shell Script åªèƒ½å°ä¸€å°æ©Ÿå™¨ (instance) é€²è¡Œæ“ä½œã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;h2>å¸¸ç”¨çš„ Ansible Module æœ‰å“ªäº›ï¼Ÿ&lt;span class="absolute -mt-20" id="å¸¸ç”¨çš„-ansible-module-æœ‰å“ªäº›">&lt;/span>
&lt;a href="#%e5%b8%b8%e7%94%a8%e7%9a%84-ansible-module-%e6%9c%89%e5%93%aa%e4%ba%9b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æ¥ä¸‹ä¾†ç°¡å–®ä»‹ç´¹ä¸€ä¸‹æ¯”è¼ƒå¸¸ç”¨åˆ°çš„ 8 å€‹ Moduleï¼š&lt;/p>
&lt;h3>&lt;code>ansible.builtin.apt&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltinapt">&lt;/span>
&lt;a href="#ansiblebuiltinapt" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html#ansible-collections-ansible-builtin-apt-module" target="_blank" rel="noopener">apt module&lt;/a> æ˜¯çµ¦ Debian, Ubuntu ç­‰ä½œæ¥­ç³»çµ±ä½¿ç”¨çš„å¥—ä»¶æ¨¡çµ„ (Packing Modules)ï¼Œæˆ‘å€‘å¯ä»¥é€éå®ƒç®¡ç† apt å¥—ä»¶ã€‚é¡ä¼¼çš„æœ‰ &lt;code>apt-get&lt;/code>ã€&lt;code>dpkg&lt;/code>ç­‰ã€‚&lt;/p>
&lt;ol>
&lt;li>æ›´æ–°å¥—ä»¶ç´¢å¼•(å¿«å–)ï¼Œç­‰åŒæ–¼ &lt;code>apt-get update&lt;/code> æŒ‡ä»¤&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Update repositories cache&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.apt&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">update_cache&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>å®‰è£ vim å¥—ä»¶&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Install the package &amp;#34;vim&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.apt&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">vim&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">present&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>ç§»é™¤ nano å¥—ä»¶&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Remove &amp;#34;nano&amp;#34; package&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.apt&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">nano&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">absent&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>&lt;code>ansible.builtin.command&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltincommand">&lt;/span>
&lt;a href="#ansiblebuiltincommand" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/command_module.html#ansible-collections-ansible-builtin-command-module" target="_blank" rel="noopener">command module&lt;/a> æ˜¯å¯ä»¥åœ¨é ç«¯ä¸ŠåŸ·è¡ŒæŒ‡ä»¤çš„æŒ‡ä»¤æ¨¡çµ„ï¼Œä½†å®ƒä¸æ”¯æ´è®Šæ•¸ (variables) å’Œ &lt;code>&amp;lt;&lt;/code>ã€&lt;code>&amp;gt;&lt;/code>ã€&lt;code>|&lt;/code>ã€&lt;code>;&lt;/code>ã€&lt;code>&amp;amp;&lt;/code>ï¼Œè‹¥æœ‰é€™é¡éœ€æ±‚è¦æ”¹ç”¨ &lt;code>shell&lt;/code> moduleã€‚&lt;/p>
&lt;ol>
&lt;li>é‡æ–°é–‹æ©Ÿ&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Reboot at now&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.command&lt;/span>: &lt;span style="color:#ae81ff">/sbin/shutdown -r now&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>ç•¶æŸå€‹æª”æ¡ˆä¸å­˜åœ¨æ™‚æ‰åŸ·è¡ŒæŒ‡ä»¤&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">create .ssh directory&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.command&lt;/span>: &lt;span style="color:#ae81ff">mkdir .ssh creates=.ssh/&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>å…ˆåˆ‡æ›ç›®éŒ„å†åŸ·è¡ŒæŒ‡ä»¤&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">cat /etc/passwd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.command&lt;/span>: &lt;span style="color:#ae81ff">cat passwd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">chdir&lt;/span>: &lt;span style="color:#ae81ff">/etc&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>&lt;code>ansible.builtin.copy&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltincopy">&lt;/span>
&lt;a href="#ansiblebuiltincopy" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html#ansible-collections-ansible-builtin-copy-module" target="_blank" rel="noopener">copy moudule&lt;/a> æ˜¯å¾æœ¬åœ°è¤‡è£½æª”æ¡ˆåˆ°é ç«¯çš„æª”æ¡ˆæ¨¡çµ„ï¼Œè‹¥æœ‰ä½¿ç”¨è®Šæ•¸éœ€æ±‚ï¼Œå¯ä»¥æ”¹ç”¨ &lt;code>template&lt;/code>ã€‚å®ƒé¡ä¼¼ Linux æŒ‡ä»¤çš„ &lt;code>scp&lt;/code>ã€‚&lt;/p>
&lt;ol>
&lt;li>è¤‡è£½ ssh public key åˆ°é ç«¯ (chmod 644 /target/file)&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">copy ssh public key to remote node&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.copy&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">src&lt;/span>: &lt;span style="color:#ae81ff">files/id_rsa.pub&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/home/docker/.ssh/authorized_keys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#ae81ff">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#ae81ff">0644&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>è¤‡è£½ ssh public key åˆ°é ç«¯ (chmod u=rw,g=r,o=r /target/file)&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">copy ssh public key to remote node&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.copy&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">src&lt;/span>: &lt;span style="color:#ae81ff">files/id_rsa.pub&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/home/docker/.ssh/authorized_keys&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#ae81ff">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;u=rw,g=r,o=r&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>è¤‡è£½ nginx vhost è¨­å®šæª”åˆ°é ç«¯ï¼Œä¸¦å‚™ä»½åŸæœ‰çš„æª”æ¡ˆ&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">copy nginx vhost and backup the original&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.copy&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">src&lt;/span>: &lt;span style="color:#ae81ff">files/ironman.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/etc/nginx/sites-available/default&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">root&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#ae81ff">root&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#ae81ff">0644&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">backup&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>&lt;code>ansible.builtin.file&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltinfile">&lt;/span>
&lt;a href="#ansiblebuiltinfile" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html#ansible-collections-ansible-builtin-file-module" target="_blank" rel="noopener">file module&lt;/a> æ˜¯åœ¨é ç«¯å»ºç«‹å’Œåˆªé™¤æª”æ¡ˆ (file)ã€ç›®éŒ„ (directory) å’Œè»Ÿé€£çµ (symlinks) çš„æª”æ¡ˆæ¨¡çµ„ã€‚å®ƒé¡ä¼¼çš„ Linux æŒ‡ä»¤ç‚º &lt;code>chown&lt;/code>ã€&lt;code>mkdir&lt;/code> å’Œ &lt;code>touch&lt;/code>ã€‚&lt;/p>
&lt;ol>
&lt;li>å»ºç«‹æª”æ¡ˆ (touch)ï¼Œä¸¦è¨­å®šæ¬Šé™ç‚º 644&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">touch a file, and set the permissions&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/etc/motd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">touch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;u=rw,g=r,o=r&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>å»ºç«‹ç›®éŒ„ (mkdir)ï¼Œä¸¦è¨­å®šæª”æ¡ˆæ“æœ‰è€…ç‚º docker&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">create a directory, and set the permissions&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/home/docker/.ssh/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">directory&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;700&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>å»ºç«‹è»Ÿé€£çµ (ln)&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">create a symlink file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">src&lt;/span>: &lt;span style="color:#ae81ff">/tmp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/home/docker/tmp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">link&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>&lt;code>ansible.builtin.lineinfile&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltinlineinfile">&lt;/span>
&lt;a href="#ansiblebuiltinlineinfile" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html" target="_blank" rel="noopener">lineinfile&lt;/a> module æ˜¯å€‹å¯ç”¨æ­£è¦è¡¨ç¤ºæ³•å°æª”æ¡ˆé€²è¡Œæ’å…¥æˆ–å–ä»£æ–‡å­—çš„æª”æ¡ˆæ¨¡çµ„ã€‚å®ƒé¡ä¼¼çš„ Linux æŒ‡ä»¤æ˜¯ &lt;code>sed&lt;/code>ã€‚&lt;/p>
&lt;ol>
&lt;li>ç§»é™¤ docker ä½¿ç”¨è€…çš„ sudo æ¬Šé™&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">remove sudo permission of docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.lineinfile&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/etc/sudoers&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">absent&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">regexp&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;^docker&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>åœ¨ /etc/hosts æª”æ¡ˆè£¡ç”¨ 127.0.0.1 localhost å–ä»£é–‹é ­ç‚º 127.0.0.1 çš„ä¸€è¡Œ&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">set localhost as 127.0.0.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.lineinfile&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/etc/hosts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">regexp&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;^127\.0\.0\.1&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">line&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;127.0.0.1 localhost&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">root&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#ae81ff">root&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#ae81ff">0644&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>&lt;code>ansible.builtin.service&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltinservice">&lt;/span>
&lt;a href="#ansiblebuiltinservice" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html#ansible-collections-ansible-builtin-service-module" target="_blank" rel="noopener">service module&lt;/a> æ˜¯ç”¨ä¾†ç®¡ç†é ç«¯ç³»çµ±æœå‹™çš„ç³»çµ±æ¨¡çµ„ã€‚å®ƒé¡ä¼¼çš„ Linux æŒ‡ä»¤ç‚º &lt;code>service&lt;/code>ã€‚&lt;/p>
&lt;ol>
&lt;li>å•Ÿå‹• Nginx&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">start nginx service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.service&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">started&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>åœæ­¢ Nginx&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">stop nginx service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.service&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">stopped&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>é‡é–‹ç¶²è·¯æœå‹™&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">restart network service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.service&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">network&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">restarted&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>: &lt;span style="color:#ae81ff">eth0&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>&lt;code>ansible.builtin.shell&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltinshell">&lt;/span>
&lt;a href="#ansiblebuiltinshell" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/shell_module.html#ansible-collections-ansible-builtin-shell-module" target="_blank" rel="noopener">shell module&lt;/a> æ˜¯å¯ä»¥åœ¨é ç«¯ç”¨ &lt;code>/bin/sh&lt;/code> åŸ·è¡ŒæŒ‡ä»¤çš„æŒ‡ä»¤æ¨¡çµ„ï¼Œæ”¯æ´è®Šæ•¸ (variables) å’Œ &lt;code>&amp;lt;&lt;/code>ã€&lt;code>&amp;gt;&lt;/code>ã€&lt;code>|&lt;/code>ã€&lt;code>;&lt;/code> å’Œ &lt;code>&amp;amp;&lt;/code> ç­‰é‹ç®—ã€‚&lt;/p>
&lt;ol>
&lt;li>è—‰ç”± &lt;code>ls&lt;/code> å’Œ &lt;code>wc&lt;/code> æª¢æŸ¥æª”æ¡ˆæ•¸é‡&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">check files number&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.shell&lt;/span>: &lt;span style="color:#ae81ff">ls /home/docker/ | wc -l&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>æŠŠæ‰€æœ‰çš„ Python è¡Œç¨‹çµ¦ç æ‰&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">kill all python process&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.shell&lt;/span>: &lt;span style="color:#ae81ff">kill -9 $(ps aux | grep python | awk &amp;#39;{ print $2 }&amp;#39;)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>&lt;code>ansible.builtin.stat&lt;/code>&lt;span class="absolute -mt-20" id="ansiblebuiltinstat">&lt;/span>
&lt;a href="#ansiblebuiltinstat" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html#ansible-collections-ansible-builtin-stat-module" target="_blank" rel="noopener">stat module&lt;/a> æ˜¯ç”¨ä¾†æª¢æŸ¥æª”æ¡ˆç‹€æ…‹çš„æª”æ¡ˆæ¨¡çµ„ã€‚å…¶é¡ä¼¼çš„ Linux æŒ‡ä»¤ç‚º &lt;code>stat&lt;/code>ã€‚&lt;/p>
&lt;ol>
&lt;li>æª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨å‰‡å»ºç«‹ä»–ã€‚&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">check the &amp;#39;vimrc&amp;#39; target exists&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.stat&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/home/docker/.vimrc&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">register&lt;/span>: &lt;span style="color:#ae81ff">stat_vimrc&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">touch vimrc&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/home/docker/.vimrc&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.state&lt;/span>: &lt;span style="color:#ae81ff">touch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;u=rw,g=r,o=r&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">when&lt;/span>: &lt;span style="color:#ae81ff">stat_vimrc.stat.exists == false&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>å–çš„æŸæª”æ¡ˆçš„ md5sum&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Use md5sum to calculate checksum&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.stat&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/path/to/something&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">checksum_algorithm&lt;/span>: &lt;span style="color:#ae81ff">md5sum&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>å…¶ä»–&lt;span class="absolute -mt-20" id="å…¶ä»–">&lt;/span>
&lt;a href="#%e5%85%b6%e4%bb%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å…¶ä»–é‚„æœ‰å¾ˆå¤šå¯ä»¥ä½¿ç”¨çš„ Module ï¼Œè©³æƒ…å¯ä»¥æŸ¥çœ‹ &lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/index.html" target="_blank" rel="noopener">Ansible.Builtin&lt;/a>ã€‚&lt;/p>
&lt;br>
&lt;h2>Ansible ç™¼é€é€šçŸ¥åˆ° Telegram Bot&lt;span class="absolute -mt-20" id="ansible-ç™¼é€é€šçŸ¥åˆ°-telegram-bot">&lt;/span>
&lt;a href="#ansible-%e7%99%bc%e9%80%81%e9%80%9a%e7%9f%a5%e5%88%b0-telegram-bot" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å‰›å‰›çœ‹äº†å¾ˆå¤šå…§å»ºçš„æ¨¡çµ„ï¼Œç•¶ç„¶ Ansible é‚„æœ‰å¾ˆå¤šå¥½ç©çš„æ¨¡çµ„å¯ä»¥ä½¿ç”¨ï¼Œæˆ‘å€‘å°±è·Ÿ &lt;a href="../jenkins-github-tg-bot/" >ä½¿ç”¨ Jenkins è¨­å®š GitHub è§¸ç™¼ç¨‹åºä¸¦é€šçŸ¥ Telegram Bot æ–‡ç« &lt;/a> ä¸€æ¨£ï¼Œå°‡æˆ‘å€‘å–å¾—çš„å…§å®¹å‚³é€åˆ° Telegram Bot å§ï¼é‚£é¦–å…ˆæˆ‘å€‘è¦å…ˆå‰µé€ ä¸€å€‹ Telegram Botï¼Œåœ¨ Telegram æ‰¾åˆ°ä¸€å€‹æ©Ÿå™¨äººå« &lt;code>BotFather&lt;/code> çš„å®˜æ–¹æ©Ÿå™¨äººå¸³è™Ÿã€‚ä¸¦ä½¿ç”¨æŒ‡ä»¤ &lt;code>/newbot&lt;/code>ï¼Œæœƒçœ‹åˆ°ä¸€ä¸‹ç•«é¢ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/telegram_1.png"
alt="Telegram å‰µå»ºæ©Ÿå™¨äºº" width="600">&lt;figcaption>
&lt;p>Telegram å‰µå»ºæ©Ÿå™¨äºº&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä»–è©¢å•ä½ è¦å¹«æ©Ÿå™¨äººå–å«ä»€éº¼åç¨±ï¼Œå¯ä»¥ç›´æ¥åœ¨è¼¸å…¥æ¬„ä½è¼¸å…¥æƒ³è¦å–çš„åç¨±ï¼Œç•¶ç„¶ä¸èƒ½æ˜¯åˆ¥äººå·²ç¶“å–éçš„ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/telegram_2.png"
alt="Telegram å‰µå»ºæ©Ÿå™¨äºº" width="600">&lt;figcaption>
&lt;p>Telegram å‰µå»ºæ©Ÿå™¨äºº&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>çœ‹åˆ°å®ƒå›è¦†ä½  &lt;code>Done!&lt;/code> ä»£è¡¨æˆåŠŸäº†ï¼Œæ¥ä¸‹ä¾†ä½ æœƒæ‹¿åˆ°ä¸€çµ„ API Tokenï¼Œåƒæˆ‘çš„æ˜¯ &lt;code>5335968936:AAEDO_Tudhy0t577jtbF9TpgrzqOsL99h9c&lt;/code> (å·²æ›´æ›ï¼Œå¤§å®¶æ”¾å¿ƒ ğŸ˜‚ )ï¼Œæ¥ä¸‹ä¾†é–‹å•Ÿç€è¦½å™¨è¼¸å…¥ä»¥ä¸‹ç¶²å€ &lt;code>https://api.telegram.org/bot{API Token}/getupdates&lt;/code>ï¼Œå…¶ä¸­çš„ &lt;code>{API Token}&lt;/code> è«‹å¸¶å…¥è‡ªå·±çš„ Tokenï¼Œç›´åˆ°å‡ºç¾ &lt;code>{&amp;quot;ok&amp;quot;:true,&amp;quot;result&amp;quot;:[]}&lt;/code> ä»£è¡¨å®Œæˆã€‚&lt;/p>
&lt;br>
&lt;p>æ¥ä¸‹ä¾†é–‹å•Ÿä½ è‡ªå·±çš„ Bot ï¼Œæ‰“ä¸Š &lt;code>/start&lt;/code> æŒ‡ä»¤ï¼Œé‡æ–°æ•´ç†å‰›å‰›çš„ç¶²é å°±å¯ä»¥çœ‹åˆ°ä»¥ä¸‹é€™æ¨£çš„æ–‡å­—ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;ok&amp;#34;&lt;/span>:true,&lt;span style="color:#e6db74">&amp;#34;result&amp;#34;&lt;/span>:&lt;span style="color:#f92672">[{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;update_id&amp;#34;&lt;/span>:606594112,&lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>:&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;message_id&amp;#34;&lt;/span>:1,&lt;span style="color:#e6db74">&amp;#34;from&amp;#34;&lt;/span>:&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;id&amp;#34;&lt;/span>:493995679,&lt;span style="color:#e6db74">&amp;#34;is_bot&amp;#34;&lt;/span>:false,&lt;span style="color:#e6db74">&amp;#34;first_name&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;\u54c1\u6bc5&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;last_name&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;Ian&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;username&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;pinyichuchu&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;language_code&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;zh-hans&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;chat&amp;#34;&lt;/span>:&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;id&amp;#34;&lt;/span>:493995679,&lt;span style="color:#e6db74">&amp;#34;first_name&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;\u54c1\u6bc5&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;last_name&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;Ian&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;username&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;pinyichuchu&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;type&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;private&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;date&amp;#34;&lt;/span>:1652695148,&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;/start&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;entities&amp;#34;&lt;/span>:&lt;span style="color:#f92672">[{&lt;/span>&lt;span style="color:#e6db74">&amp;#34;offset&amp;#34;&lt;/span>:0,&lt;span style="color:#e6db74">&amp;#34;length&amp;#34;&lt;/span>:6,&lt;span style="color:#e6db74">&amp;#34;type&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;bot_command&amp;#34;&lt;/span>&lt;span style="color:#f92672">}]}}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é€™æ˜¯ä½ å‚³è¨Šæ¯çµ¦ Bot å®ƒæ‰€æ”¶åˆ°çš„ APIï¼Œè³‡æ–™å¾ˆå¤šæ²’é—œä¿‚ï¼Œæˆ‘å€‘æ‰¾åˆ° &lt;code>id&lt;/code>ï¼Œåƒæˆ‘çš„æ˜¯ &lt;code>493995679&lt;/code>ï¼Œé€™å€‹å°±æ˜¯æˆ‘è·Ÿæ©Ÿå™¨äººçš„èŠå¤©å®¤ï¼Œæˆ‘å€‘å°±å…ˆå›åˆ° Ansible é€™é‚Šå§ï¼&lt;/p>
&lt;br>
&lt;p>é–‹å•Ÿä¸€å€‹æ–°çš„æª”æ¡ˆå« &lt;code>send_notify_tg.yaml&lt;/code>ï¼Œæ‰“ä»¥ä¸‹å…§å®¹ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Send notify&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">all&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Send notify to Telegram&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">community.general.telegram&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">token&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;9999999:XXXXXXXXXXXXXXXXXXXXXXX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">api_args&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">chat_id&lt;/span>: &lt;span style="color:#ae81ff">000000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">parse_mode&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;markdown&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">text&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Your precious application has been deployed: https://example.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">disable_web_page_preview&lt;/span>: &lt;span style="color:#66d9ef">True&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">disable_notification&lt;/span>: &lt;span style="color:#66d9ef">True&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘ä½¿ç”¨çš„æ¨¡çµ„ä¸æ˜¯ Ansible å…§å»ºçš„ï¼Œè€Œæ˜¯ç¤¾ç¾¤åˆ¥äººå¯«çš„ï¼Œè©³ç´°å¯ä»¥åƒè€ƒ &lt;a href="https://docs.ansible.com/ansible/latest/collections/community/general/telegram_module.html#ansible-collections-community-general-telegram-module" target="_blank" rel="noopener">community.general.telegram module â€“ module for sending notifications via telegram&lt;/a>ï¼š&lt;/p>
&lt;br>
&lt;p>å…¶ä¸­ token å°±æ˜¯æˆ‘å€‘å‰›å‰›åœ¨ &lt;code>BotFather&lt;/code> é‚£é‚Šæ‰€æ‹¿åˆ°çš„ Tokenï¼Œchat_id å°±æ˜¯æˆ‘å€‘å‰›å‰›åœ¨ç¶²é ä¸Šçœ‹åˆ°çš„ idï¼ŒæŠŠè³‡æ–™éƒ½è¼¸å…¥é€²å»å¾Œï¼Œæˆ‘å€‘å¯ä»¥ä¿®æ”¹ text å…§å®¹ï¼Œæ”¹æˆ &amp;ldquo;Send notify to Telegram æ¸¬è©¦å‚³é€é€šçŸ¥&amp;rdquo;ï¼Œæ¥è‘—åŸ·è¡Œ &lt;code>ansible-ploybook send_notify_tg.yaml&lt;/code> ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ­£å¸¸æ”¶åˆ°é€šçŸ¥ï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/telegram_3.png"
alt="ç™¼é€é€šçŸ¥è‡³ Telegram Bot" width="600">&lt;figcaption>
&lt;p>ç™¼é€é€šçŸ¥è‡³ Telegram Bot&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>é€™æ¨£å­å°±æˆåŠŸé€é Ansible Module å‚³é€é€šçŸ¥çµ¦ Telegram å›‰ï¼&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å¯èƒ½éœ€è¦å°‡æ©Ÿå™¨äººåŠ å…¥ç¾¤çµ„å…§ï¼Œé€™æ™‚å€™éœ€è¦æ›´æ›ä¸€ä¸‹ chat_idï¼Œå…ˆå°‡æ©Ÿå™¨äººåŠ å…¥ç¾¤çµ„ï¼Œå†æ¬¡åˆ°å‰›å‰›ç€è¦½å™¨çš„ç¶²é åˆ·æ–°ï¼ŒæŸ¥çœ‹ chat å¾Œé¢çš„ id å¸¶æœ‰ &lt;code>-&lt;/code>ï¼Œåƒæ˜¯ &lt;code>-540226836&lt;/code> é€™æ¨£ï¼Œé€™å€‹å°±æ˜¯è©²ç¾¤çµ„çš„ IDï¼Œå°‡ send_notify_tg.yaml çš„ chat_id ä¿®æ”¹æˆ &lt;code>-540226836&lt;/code> åœ¨æ¸¬è©¦çœ‹çœ‹ï¼Œä»–å°±æœƒåœ¨ç¾¤çµ„ä¸­ç™¼é€é€šçŸ¥å›‰ï¼&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;pre>&lt;code>{&amp;#34;update_id&amp;#34;:606594124,&amp;#34;message&amp;#34;:{&amp;#34;message_id&amp;#34;:14,&amp;#34;from&amp;#34;:{&amp;#34;id&amp;#34;:493995679,&amp;#34;is_bot&amp;#34;:false,&amp;#34;first_name&amp;#34;:&amp;#34;\u54c1\u6bc5&amp;#34;,&amp;#34;last_name&amp;#34;:&amp;#34;Ian&amp;#34;,&amp;#34;username&amp;#34;:&amp;#34;pinyichuchu&amp;#34;,&amp;#34;language_code&amp;#34;:&amp;#34;zh-hans&amp;#34;},&amp;#34;chat&amp;#34;:{&amp;#34;id&amp;#34;:-540226836,&amp;#34;title&amp;#34;:&amp;#34;\u54c1\u6bc5 &amp;amp; AnsibleSendMessageBot&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;group&amp;#34;,&amp;#34;all_members_are_administrators&amp;#34;:true},&amp;#34;date&amp;#34;:1652696181,&amp;#34;group_chat_created&amp;#34;:true}}&lt;/code>&lt;/pre>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/telegram_4.png"
alt="ç™¼é€é€šçŸ¥è‡³ Telegram ç¾¤çµ„ Bot" width="600">&lt;figcaption>
&lt;p>ç™¼é€é€šçŸ¥è‡³ Telegram ç¾¤çµ„ Bot&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>å–å¾— Managed node çš„ facts&lt;span class="absolute -mt-20" id="å–å¾—-managed-node-çš„-facts">&lt;/span>
&lt;a href="#%e5%8f%96%e5%be%97-managed-node-%e7%9a%84-facts" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é‚„è¨˜å¾—æˆ‘å€‘åœ¨åŸ·è¡Œä»»å‹™ (Tasks) æ™‚ï¼Œæ˜æ˜åªæœ‰å…©å€‹ï¼Œä½†æœ€å¾Œçµæœé¡¯ç¤ºä¸‰å€‹å—ï¼Ÿæ˜¯å› ç‚ºåœ¨ä½¿ç”¨ Playbooks æ™‚ï¼ŒAnsible æœƒè‡ªå‹•åŸ·è¡Œ &lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/setup_module.html#ansible-collections-ansible-builtin-setup-module" target="_blank" rel="noopener">Setup module&lt;/a> ä»¥è’é›†å„å€‹ Managed node çš„ &lt;strong>facts&lt;/strong>ã€‚ é€™å€‹ facts å°±å¥½æ¯”æ˜¯ç³»çµ±è®Šæ•¸ä¸€æ¨£ï¼Œå¾ IP ä½å€ã€ä½œæ¥­ç³»çµ±ã€CPU ç­‰è³‡è¨Šæ‡‰æœ‰ç›¡æœ‰ã€‚&lt;/p>
&lt;br>
&lt;h3>Ad-Hoc Commands&lt;span class="absolute -mt-20" id="ad-hoc-commands">&lt;/span>
&lt;a href="#ad-hoc-commands" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é€šå¸¸æˆ‘å€‘éƒ½æœƒå…ˆä½¿ç”¨ Ad-Hoc Commands ä¾†å‘¼å« &lt;code>setup&lt;/code> çœ‹çœ‹æœ‰å“ªäº›å¯ç”¨çš„è³‡è¨Šï¼Œé€™å°æ–¼æˆ‘å€‘ç¨å¾Œæ’°å¯«è¼ƒç‚ºè¤‡é›œçš„ Playbooks æœƒå¾ˆæœ‰å¹«åŠ©ã€‚&lt;/p>
&lt;ol>
&lt;li>å¯ä»¥è—‰ç”± &lt;code>less&lt;/code> å¿«é€Ÿæœå°‹æ‰€æœ‰çš„è®Šæ•¸&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible all -m setup | less
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 | SUCCESS &lt;span style="color:#f92672">=&lt;/span>&amp;gt; &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_facts&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_apparmor&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;status&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;disabled&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">}&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_architecture&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;x86_64&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_bios_date&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;03/14/2014&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_bios_vendor&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;BHYVE&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_bios_version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;1.00&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_board_asset_tag&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;NA&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_board_name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;NA&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_board_serial&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;NA&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_board_vendor&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;NA&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_board_version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;NA&amp;#34;&lt;/span>,&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>æ­é… &lt;code>filter&lt;/code> å°‡ç™¼è¡Œç‰ˆæœ¬ (distribution) è³‡è¨Šçµ¦éæ¿¾å‡ºä¾†&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible all -m setup -a &lt;span style="color:#e6db74">&amp;#34;filter=ansible_distribution*&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 | SUCCESS &lt;span style="color:#f92672">=&lt;/span>&amp;gt; &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_facts&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_distribution&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Ubuntu&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_distribution_file_parsed&amp;#34;&lt;/span>: true,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_distribution_file_path&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/etc/os-release&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_distribution_file_variety&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Debian&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_distribution_major_version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;22&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_distribution_release&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;kinetic&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_distribution_version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;22.10&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;discovered_interpreter_python&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/usr/bin/python3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">}&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;changed&amp;#34;&lt;/span>: false
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>å–å¾—å¥—ä»¶ç®¡ç†å“¡çš„ç¨®é¡è³‡è¨Šï¼Œä¾‹å­ä¸­å–å¾—çš„å€¼æ˜¯ &lt;strong>apt&lt;/strong>&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ansible all -m setup -a &lt;span style="color:#e6db74">&amp;#34;filter=ansible_pkg_mgr&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server1 | SUCCESS &lt;span style="color:#f92672">=&lt;/span>&amp;gt; &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_facts&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ansible_pkg_mgr&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;apt&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;discovered_interpreter_python&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/usr/bin/python3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">}&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;changed&amp;#34;&lt;/span>: false
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>è½‰å¯« Playbooks&lt;span class="absolute -mt-20" id="è½‰å¯«-playbooks">&lt;/span>
&lt;a href="#%e8%bd%89%e5%af%ab-playbooks" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘ä¾†å‡ºå€‹é¡Œç›®ï¼Œæˆ‘æƒ³è¦çŸ¥é“ Ansible æ‰€ä½¿ç”¨çš„å…¬é‘°ï¼Œä¸¦é€é Telegram Bot ç™¼é€åˆ°ç¾¤çµ„ï¼Œè¦æ€éº¼åšå‘¢ï¼ï¼Ÿ&lt;/p>
&lt;p>é¦–å…ˆè¦åˆ©ç”¨å‰›å‰›çš„ Ad-Hoc Commands filterï¼Œæ‰¾åˆ°å…¬é‘°ï¼Œå†å°‡å…¬é‘°é€é Telegram Bot å‚³é€ï¼Œæ‰€ä»¥æˆ‘å€‘æœƒæœ‰å…©å€‹ Tasksï¼Œé‚£æˆ‘å€‘é–‹å§‹å¯¦ä½œå›‰ ğŸ¤“&lt;/p>
&lt;p>1.æ‰¾åˆ°å…¬é‘°&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Filter rsa_public &amp;amp; Send notify&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">all&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Filter setup rsa_public key&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.setup&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">filter&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;ansible_ssh_host_key_rsa_public&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">register&lt;/span>: &lt;span style="color:#ae81ff">result&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘å°‡ filter setup å¾ Ad-Hoc è½‰æˆ Playbooksï¼Œä¸¦ä½¿ç”¨ result ä¾†å­˜åœ¨æ‰¾åˆ°çš„å…¬é‘°ã€‚&lt;/p>
&lt;br>
&lt;ol start="2">
&lt;li>ç™¼é€é€šçŸ¥è‡³ Telegram Bot&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Send notify to Telegram&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">community.general.telegram&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">token&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;5335968936:AAFhxxMRJy-rucGKgSE80Xss7qPq2iOHWlc&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">api_args&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">chat_id&lt;/span>: -&lt;span style="color:#ae81ff">540226836&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">parse_mode&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;markdown&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">text&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{ result }}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">disable_web_page_preview&lt;/span>: &lt;span style="color:#66d9ef">True&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">disable_notification&lt;/span>: &lt;span style="color:#66d9ef">True&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è€æ¨£å­ï¼Œæˆ‘å€‘å°±ä½¿ç”¨ä¸Šæ¬¡ &lt;code>send_notify_tg.yaml&lt;/code> å…§çš„ Send notify to Telegram ä»»å‹™ä¾†å‚³é€é€šçŸ¥ã€‚&lt;/p>
&lt;br>
&lt;p>åŸ·è¡Œå¾Œï¼Œçœ‹çœ‹ç¾¤çµ„æ˜¯å¦æœ‰æ”¶åˆ°æˆ‘å€‘æ‰¾åˆ°çš„ ansible_ssh_host_key_rsa_public é€šçŸ¥ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/telegram_5.png"
alt="ç™¼é€é€šçŸ¥è‡³ Telegram ç¾¤çµ„ Bot" width="800">&lt;figcaption>
&lt;p>ç™¼é€é€šçŸ¥è‡³ Telegram ç¾¤çµ„ Bot&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>ä½¿ç”¨ Ansible çš„ Template ç³»çµ±&lt;span class="absolute -mt-20" id="ä½¿ç”¨-ansible-çš„-template-ç³»çµ±">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8-ansible-%e7%9a%84-template-%e7%b3%bb%e7%b5%b1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html#ansible-collections-ansible-builtin-template-module" target="_blank" rel="noopener">Template module&lt;/a> æ˜¯å¸¸ä½¿ç”¨çš„æª”æ¡ˆæ¨¡çµ„ä¹‹ä¸€ï¼Œæˆ‘å€‘åœ¨ &lt;a href="#%e5%b8%b8%e7%94%a8%e7%9a%84-ansible-module-%e6%9c%89%e5%93%aa%e4%ba%9b" >å¸¸ç”¨çš„ Ansible Module æœ‰å“ªäº›ï¼Ÿ&lt;/a> æ–‡ç« ä¸­æœ‰æåˆ°ï¼Œå¯ä»¥ç”¨å®ƒå’Œè®Šæ•¸ (Variables) ä¾†æ“ä½œæª”æ¡ˆã€‚&lt;/p>
&lt;p>æˆ‘å€‘åªéœ€è¦äº‹å…ˆå®šç¾©è®Šæ•¸å’Œæ¨¡æ¿ (Templates)ï¼Œå³å¯ç”¨å®ƒå‹•æ…‹ç”¢ç”Ÿé ç«¯çš„ Shell Scriptã€è¨­å®šæª” (Configure)ç­‰ã€‚æ›å¥è©±èªªï¼Œæˆ‘å€‘å¯ä»¥ç”¨ä¸€ä»½ template ä¾†é–‹ç™¼ (Development)ã€æ¸¬è©¦ (Test)ã€æ­£å¼ç’°å¢ƒ (Production) ç­‰ä¸åŒç’°å¢ƒè¨­å®šã€‚&lt;/p>
&lt;p>èˆ‰ä¾‹èªªæ˜ï¼š&lt;/p>
&lt;ol>
&lt;li>å»ºç«‹ template æª”æ¡ˆ&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ vim hello_world.txt.j2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Hello &lt;span style="color:#e6db74">&amp;#34;{{ dynamic_word }}&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>ç”±æ–¼ Ansible æ˜¯å°±ç”± &lt;a href="https://jinja.palletsprojects.com/en/3.1.x/" target="_blank" rel="noopener">Jinja2&lt;/a> ä¾†å¯¦ä½œ template ç³»çµ±ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ &lt;code>*.j2&lt;/code> çš„å‰¯æª”åã€‚&lt;/li>
&lt;li>ä¸Šé¢çš„ &lt;code>&amp;quot;{{ dynamic_word }}&amp;quot;&amp;quot;&lt;/code> ä»£è¡¨æˆ‘å€‘åœ¨ template è£¡ä½¿ç”¨äº†åç‚º &lt;code>dynameic_word&lt;/code> çš„è®Šæ•¸ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;ol start="2">
&lt;li>å»ºç«‹ playbookï¼Œä¸¦åŠ å…¥è®Šæ•¸ &lt;code>vim template_demo.yaml&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Play the template module&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">localhost&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">vars&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dynamic_word&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;World&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">generation the hello_world.txt file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.template&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">src&lt;/span>: &lt;span style="color:#ae81ff">hello_world.txt.j2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/tmp/hello_world.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">show file context&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: &lt;span style="color:#ae81ff">cat /tmp/hello_world.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">register&lt;/span>: &lt;span style="color:#ae81ff">result&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">print stdout&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">msg&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{ result.stdout_lines }}&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>åœ¨ç¬¬ 5 è¡Œï¼Œæˆ‘å€‘å¹« &lt;code>dynamic_word&lt;/code> è®Šæ•¸è¨­äº†ä¸€å€‹é è¨­å€¼ &lt;code>World&lt;/code>ã€‚&lt;/li>
&lt;li>åœ¨ 8 è¡Œçš„ç¬¬ 1 å€‹ task è£¡ï¼Œæˆ‘å€‘ä½¿ç”¨ template moduleï¼Œä¸¦æŒ‡å®šäº†æª”æ¡ˆçš„ä¾†æº (src) å’Œç›®çš„åœ° (dest)ã€‚&lt;/li>
&lt;li>ä¹‹å¾Œçš„ 2 å€‹ task å‰‡æ˜¯æŠŠ template module ç”¢ç”Ÿçš„æª”æ¡ˆçµ¦å°å‡ºä¾†ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;ol start="3">
&lt;li>ç›´æ¥ä½¿ç”¨ &lt;code>ansible-playbook template_demo.yaml&lt;/code> åŸ·è¡Œ Playbookã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/template.png"
alt="Template Module ç¯„ä¾‹" width="900">&lt;figcaption>
&lt;p>Template Module ç¯„ä¾‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ä¹Ÿå¯ä»¥é€é &lt;code>-e&lt;/code> åƒæ•¸å°‡ &lt;code>dynamic_word&lt;/code> è¦†å¯«æˆ &amp;ldquo;ansible&amp;rdquo;&lt;/p>
&lt;br>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span> $ ansible-playbook template_demo.yaml -e &lt;span style="color:#e6db74">&amp;#34;dynamic_word=ansible&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/template_1.png"
alt="Template Module ä½¿ç”¨ -e è¦†å¯«åƒæ•¸" width="900">&lt;figcaption>
&lt;p>Template Module ä½¿ç”¨ &lt;code>-e&lt;/code> è¦†å¯«åƒæ•¸&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>å¦‚ä½•åˆ‡æ›ä¸åŒç’°å¢ƒ&lt;span class="absolute -mt-20" id="å¦‚ä½•åˆ‡æ›ä¸åŒç’°å¢ƒ">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e5%88%87%e6%8f%9b%e4%b8%8d%e5%90%8c%e7%92%b0%e5%a2%83" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>é™¤äº†æˆ‘å€‘å‰›å‰›ç”¨ &lt;code>vars&lt;/code> ä¾†å®£å‘Šè®Šä»¥å¤–ï¼Œé‚„å¯ä»¥ä½¿ç”¨ &lt;code>vars_files&lt;/code> ä¾† include å…¶ä»–çš„è®Šæ•¸æª”ï¼š&lt;code>$ vim template_demo2.yaml&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Play the template module&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">localhost&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">vars&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;development&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">vars_files&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">vars/{{ env }}.yml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">generation the hello_world.txt file&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.template&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">src&lt;/span>: &lt;span style="color:#ae81ff">hello_world.txt.j2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/tmp/hello_world.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">show file context&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: &lt;span style="color:#ae81ff">cat /tmp/hello_world.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">register&lt;/span>: &lt;span style="color:#ae81ff">result&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">print stdout&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">msg&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{ result.stdout_lines }}&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°ä¸Šé¢ä¾‹å­ä¸­ç¬¬ 7 è¡Œï¼Œå°±æ˜¯æˆ‘å€‘ä½¿ç”¨ &lt;code>vars_files&lt;/code> ä¾† include å…¶ä»–çš„è®Šæ•¸æª”ã€‚&lt;/p>
&lt;br>
&lt;ol start="2">
&lt;li>å»ºç«‹ &lt;code>vars/development.yaml&lt;/code>ã€&lt;code>vars/test.yaml&lt;/code>ã€&lt;code>vars/production.yaml&lt;/code> æª”æ¡ˆï¼Œæ¥ä¸‹ä¾†å°‡ä¾ä¸åŒå¾—ç’°å¢ƒ include ä¸åŒçš„æª”æ¡ˆè®Šæ•¸æª”æ¡ˆ (vars files)ï¼Œé€™æ¨£å°±å¯ä»¥ç”¨ä¸€ä»½ Playbook åˆ‡æ›ç’°å¢ƒäº†ï¼&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>Development&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span> $ vim vars/development.yaml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dynamic_word: &lt;span style="color:#e6db74">&amp;#34;development&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>Test&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span> $ vim vars/test.yaml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dynamic_word: &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>Production&lt;/li>
&lt;/ul>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span> $ vim vars/production.yaml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dynamic_word: &lt;span style="color:#e6db74">&amp;#34;production&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>åŸ·è¡Œ &lt;code>ansible-playbook template_demo2.yaml -e &amp;quot;dynamic_word=Test&amp;quot;&lt;/code>ï¼Œä¸¦æœ‰ &lt;code>-e&lt;/code> å»ä¿®æ”¹å„å€‹ç’°å¢ƒã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/template_2.png"
alt="Template Module ç¯„ä¾‹" width="900">&lt;figcaption>
&lt;p>Template Module ç¯„ä¾‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>Template ç³»çµ±æ˜¯å¯¦å‹™ä¸Šå¾ˆå¸¸è¦‹çš„æ‰‹æ³•ä¹‹ä¸€ï¼Œè—‰ç”±å®ƒæˆ‘å€‘å¯ä»¥å¾ˆè¼•é¬†åœ°è®“é–‹ç™¼ã€æ¸¬è©¦ã€æ­£å¼ç’°å¢ƒç„¡ç¸«æ¥è»Œã€‚ä½†è‹¥æ˜¯åœ¨å¤§å‹çš„ Playbook è£¡åˆ‡æ›ç’°å¢ƒï¼Œå»ºè­°ä½¿ç”¨è¼ƒç‚ºé€²éšçš„ &lt;code>group_vars&lt;/code> è·Ÿ &lt;code>host_vars&lt;/code>ã€‚&lt;/p>
&lt;br>
&lt;h2>åœ¨ Playbooks ä½¿ç”¨ Handlers&lt;span class="absolute -mt-20" id="åœ¨-playbooks-ä½¿ç”¨-handlers">&lt;/span>
&lt;a href="#%e5%9c%a8-playbooks-%e4%bd%bf%e7%94%a8-handlers" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_handlers.html" target="_blank" rel="noopener">Handlers&lt;/a> æ˜¯æˆ‘å€‘åœ¨ Ansible Playbooks è£¡å¾ˆå¸¸ç”¨ä¾†é‡é–‹ç³»çµ±æœå‹™ (Service) çš„æ‰‹æ³•ï¼Œæˆ‘å€‘é€™é‚Šé€éå®‰è£ Nginx ä¾†ä»‹ç´¹å®ƒã€‚&lt;/p>
&lt;p>é‚£ä»€éº¼æ˜¯ Handlers å‘¢ï¼ŸHandler æœ¬èº«æ˜¯ä¸€ç¨®éåŒæ­¥çš„ callback function ; åœ¨é€™è£¡å‰‡æ˜¯æŒ‡é—œè¯æ–¼ç‰¹å®š tasks çš„äº‹ä»¶ (event) è§¸ç™¼æ©Ÿåˆ¶ã€‚ç•¶é€™äº›ç‰¹å®šçš„ tasks ç‹€æ…‹ç‚º &lt;strong>è¢«æ”¹è®Š (changed)&lt;/strong> ä¸”éƒ½å·²è¢«åŸ·è¡Œï¼Œæ‰æœƒè§¸ç™¼ä¸€æ¬¡çš„ eventã€‚&lt;/p>
&lt;br>
&lt;ol>
&lt;li>æˆ‘å€‘å»ºç«‹ setup_nginx.yaml&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">setup the nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">all&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">become&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">vars&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">username&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;PinYi&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mail&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;880831ian@gmail.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">blog&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;https://pin-yi.me&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># åŸ·è¡Œ &amp;#39;apt-get update&amp;#39; æŒ‡ä»¤ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">update apt repo cache&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">apt&lt;/span>: &lt;span style="color:#ae81ff">name=nginx update_cache=yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># åŸ·è¡Œ &amp;#39;apt-get install nginx&amp;#39; æŒ‡ä»¤ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">install nginx with apt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">apt&lt;/span>: &lt;span style="color:#ae81ff">name=nginx state=present&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># æ–¼ç¶²é æ ¹ç›®éŒ„ (DocumentRoot) ç·¨è¼¯ index.htmlã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">modify index.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.template&lt;/span>: &lt;span style="color:#ae81ff">src=templates/index.html.j2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">dest=/var/www/html/index.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">owner=www-data&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">group=www-data&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">mode=&amp;#34;644&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">backup=yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">notify&lt;/span>: &lt;span style="color:#ae81ff">restart nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># handlers&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># * ç•¶ç¢ºèªäº‹ä»¶æœ‰è¢«è§¸ç™¼æ‰æœƒå‹•ä½œã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># * ä¸€å€‹ handler å¯è¢«å¤šå€‹ task é€šçŸ¥ (notify)ï¼Œä¸¦æ–¼ tasks è·‘å®Œæ‰æœƒåŸ·è¡Œã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">handlers&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># åŸ·è¡Œ &amp;#39;sudo service nginx restart&amp;#39; æŒ‡ä»¤ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">restart nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">service&lt;/span>: &lt;span style="color:#ae81ff">name=nginx enabled=yes state=restarted&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># post_tasks:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># åœ¨ tasks ä¹‹å¾ŒåŸ·è¡Œçš„ tasksã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">post_tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># æª¢æŸ¥ç¶²é å…§å®¹ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">review http state&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;curl -s http://localhost&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">register&lt;/span>: &lt;span style="color:#ae81ff">web_context&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å°å‡ºæª¢æŸ¥çµæœã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">print http state&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">debug&lt;/span>: &lt;span style="color:#ae81ff">msg={{ web_context.stdout_lines }}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¾†èªªæ˜ä¸€ä¸‹ä¸Šé¢é€™å€‹ yaml æª”æ¡ˆï¼š&lt;/p>
&lt;ul>
&lt;li>é¦–å…ˆæˆ‘å€‘æƒ³è¦å®‰è£ Nginxï¼Œæˆ‘å€‘çµ¦äº†ä¸‰å€‹åƒæ•¸ï¼Œåˆ†åˆ¥æ˜¯ usernameã€mailã€blogï¼Œç­‰ç­‰æœƒå¸¶å…¥æˆ‘å€‘çš„ templateã€‚&lt;/li>
&lt;li>æˆ‘å€‘ä¸€é–‹å§‹æœ‰ 3 å€‹ taskï¼Œåˆ†åˆ¥ä»£è¡¨åŸ·è¡Œæ›´æ–°ã€å®‰è£ã€ç·¨è¼¯ index.html æª”æ¡ˆã€‚&lt;/li>
&lt;li>ä»¥åŠ 1 å€‹ handlers ä»–æœƒç­‰ &lt;code>modify index.html&lt;/code> æœ‰æ”¹è®Šä¸”åŸ·è¡Œå¾Œæ‰æœƒå‹•ä½œã€‚&lt;/li>
&lt;li>æœ€å¾Œæ˜¯ post_tasks ä»–æ˜¯ç­‰ tasks ä¹‹å¾ŒåŸ·è¡Œçš„ tasksã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;ol start="2">
&lt;li>æ¥ä¸‹å»ºç«‹ Nginx html çš„ templateï¼š&lt;code>vim templates/index.html.j2&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">_____________________________________&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">/ This is a ansible-playbook demo for \&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">\ automate-with-ansible at 2022/05/17./&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-------------------------------------
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">\ ^__^&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">\ (oo)\_______&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">(__)\ )\/\&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">||----w |&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">|| ||&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[ {{ &lt;span style="color:#ae81ff">username }}@automate-with-ansible ~ ]$&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[ {{ &lt;span style="color:#ae81ff">username }}@automate-with-ansible ~ ]$&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>[ {{ &lt;span style="color:#ae81ff">username }}@automate-with-ansible ~ ]$ cat .profile&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- {{ &lt;span style="color:#ae81ff">mail }}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- {{ &lt;span style="color:#ae81ff">blog }}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="3">
&lt;li>åŸ·è¡Œ Playbook&lt;/li>
&lt;/ol>
&lt;p>å¯ä»¥çœ‹åˆ°å› ç‚ºæˆ‘å€‘ &lt;code>modify index.html&lt;/code> æ²’æœ‰è¢«æ”¹è®Šï¼Œnotify æ²’æœ‰é€šçŸ¥ handlersï¼Œæ‰€ä»¥ä»–ä¸æœƒåŸ·è¡Œ handlers è©²æ®µç¨‹å¼ã€‚(æ­£å¸¸ä¾†èªªï¼Œä¿®æ”¹ html ä¸éœ€è¦é‡å•Ÿï¼Œæ­¤ç‚ºç¯„ä¾‹ ğŸ¤£ )&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/handlers_1.png"
alt="Handlers ç¯„ä¾‹" width="900">&lt;figcaption>
&lt;p>Handlers ç¯„ä¾‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>é‚£æˆ‘å€‘ä¿®æ”¹ä¸€ä¸‹ index.html ä¾†æ¸¬è©¦ä¸€ä¸‹æœƒä¸æœƒæŠŠ index.html çš„ç‹€æ…‹&lt;strong>è¢«æ”¹è®Š&lt;/strong>ï¼Œè€Œè®“ handlers åŸ·è¡Œå‘¢ï¼æˆ‘å€‘éš¨æ„ä¿®æ”¹ index.html å…§å®¹ï¼Œä¿®æ”¹æ—¥æœŸæ”¹æˆ 05/17ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/ansible/handlers_2.png"
alt="Handlers ç¯„ä¾‹" width="900">&lt;figcaption>
&lt;p>Handlers ç¯„ä¾‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘çš„ &lt;code>modify index.html&lt;/code> è¢«æ”¹è®Šäº†ï¼Œæ‰€ä»¥ notify é€šçŸ¥ handlers åŸ·è¡Œé‡æ–°å•Ÿå‹•ã€‚&lt;/p>
&lt;br>
&lt;h2>åœ¨ Playbooks ä½¿ç”¨ loops&lt;span class="absolute -mt-20" id="åœ¨-playbooks-ä½¿ç”¨-loops">&lt;/span>
&lt;a href="#%e5%9c%a8-playbooks-%e4%bd%bf%e7%94%a8-loops" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åœ¨ Shell Script ä¸­ï¼Œæˆ‘å€‘æœƒä½¿ç”¨ for å’Œ while ç­‰è¿´åœˆ (loop) ä¾†ç°¡åŒ–é‡è¤‡çš„ç¨‹å¼ç¢¼ï¼Œè€Œåœ¨ Ansible æˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ loop ä¾†ç°¡åŒ–&lt;strong>é‡è¤‡çš„ä»»å‹™ (Tasks)&lt;/strong>ã€‚&lt;/p>
&lt;h3>æ¨™æº–è¿´åœˆ&lt;span class="absolute -mt-20" id="æ¨™æº–è¿´åœˆ">&lt;/span>
&lt;a href="#%e6%a8%99%e6%ba%96%e8%bf%b4%e5%9c%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é¦–å…ˆæˆ‘å€‘å…ˆä»¥ç°¡å–®çš„æ–¹å¼é‡è¤‡å°å‡ºä¸‰ç­†è³‡æ–™ã€‚&lt;/p>
&lt;ul>
&lt;li>Shell Script&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>å»ºç«‹ for loop çš„ Script&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ vim bash_loop.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> x in &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> 2; &lt;span style="color:#66d9ef">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo Loop $x
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">done&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>åœ¨ç¬¬ 4 è¡Œï¼Œæˆ‘å€‘ç”¨ &lt;code>for&lt;/code>ï¼Œä¸¦  ä»£å…¥ 0,1,2 ä¸‰å€‹å€¼åˆ° &lt;code>$x&lt;/code> è®Šæ•¸&lt;/li>
&lt;li>åœ¨ç¬¬ 5 è¡Œï¼Œå‰‡ç”¨äº† &lt;code>echo&lt;/code>ï¼Œå°å‡ºè¨Šæ¯å’Œ &lt;code>$x&lt;/code> è®Šæ•¸&lt;/li>
&lt;/ul>
&lt;br>
&lt;ol start="2">
&lt;li>åŸ·è¡Œ Scriptï¼šå¯ä»¥çœ‹åˆ°åº•ä¸‹è·‘äº† 3 æ¬¡çš„ loop&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ chmod a+x bash_loop.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ ./bash_loop.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Loop &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Loop &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Loop &lt;span style="color:#ae81ff">2&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ul>
&lt;li>Ansible Playbooks&lt;/li>
&lt;/ul>
&lt;p>æˆ‘å€‘éœ€è¦é€é &lt;code>item&lt;/code> å’Œ &lt;code>with_items&lt;/code> ä¾†ä½¿ç”¨ Ansible çš„ loopï¼Œå…¶ &lt;code>item&lt;/code> ç‚ºé è¨­åã€‚åœ¨ Ansible 2.5 ä¸­æ·»åŠ äº† &lt;code>loop&lt;/code>ï¼Œæ‰€ä»¥æˆ‘å€‘å¾ŒçºŒå…©è€…éƒ½æœƒæåˆ° (ç›®å‰å…©è€…éƒ½å¯ä»¥ä½¿ç”¨ï¼)&lt;/p>
&lt;ol>
&lt;li>å»ºç«‹ loop çš„ playbook &lt;code>vim playbook_with_items.yaml&lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">a basic loop with playbook&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">localhost&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">print loop message&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">msg&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Loop {{ item }}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">with_items&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">2&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>åœ¨ç¬¬ 6ã€7 è¡Œè£¡ï¼Œæˆ‘å€‘ç”¨ &lt;code>debug&lt;/code> module ä¾†å°å‡ºè¨Šæ¯ï¼Œä¸¦å®šç¾© &lt;code>item&lt;/code>&lt;/li>
&lt;li>åœ¨ç¬¬ 8 ~ 11 è¡Œï¼Œå‰‡ç”¨äº† &lt;code>with_item&lt;/code> å°‡ 0,1,2 çš„å€¼å‚³å…¥ &lt;code>item&lt;/code>&lt;/li>
&lt;/ul>
&lt;br>
&lt;ol start="2">
&lt;li>åŸ·è¡Œ &lt;code>ansible-playbook playbook_with_items.yaml&lt;/code> å¾Œæœƒå¾—åˆ°ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">TASK [print loop message] *************************************************************************************************************&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">ok&lt;/span>: [&lt;span style="color:#ae81ff">server1] =&amp;gt; (item=0) =&amp;gt; {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;msg&amp;#34;: &lt;/span>&lt;span style="color:#e6db74">&amp;#34;Loop 0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">ok&lt;/span>: [&lt;span style="color:#ae81ff">server1] =&amp;gt; (item=1) =&amp;gt; {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;msg&amp;#34;: &lt;/span>&lt;span style="color:#e6db74">&amp;#34;Loop 1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">ok&lt;/span>: [&lt;span style="color:#ae81ff">server1] =&amp;gt; (item=2) =&amp;gt; {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;msg&amp;#34;: &lt;/span>&lt;span style="color:#e6db74">&amp;#34;Loop 2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>å¦ä¸€ç¨® åœ¨ Ansible æ–°å¢çš„ &lt;code>loop&lt;/code>&lt;/p>
&lt;ol>
&lt;li>å»ºç«‹ loop çš„ playbook &lt;code>vim playbook_loop.yaml &lt;/code>&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>---
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">a basic loop with playbook&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">hosts&lt;/span>: &lt;span style="color:#ae81ff">all&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">tasks&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">print loop message&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">msg&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{ item }} {{ my_idx }}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">loop&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">Loop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">Loop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">Loop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">loop_control&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index_var&lt;/span>: &lt;span style="color:#ae81ff">my_idx&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;ol start="2">
&lt;li>åŸ·è¡Œ &lt;code>ansible-playbook playbook_loop.yaml&lt;/code> å¾Œæœƒå¾—åˆ°ï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">TASK [print loop message] *************************************************************************************************************&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">ok&lt;/span>: [&lt;span style="color:#ae81ff">server1] =&amp;gt; (item=0) =&amp;gt; {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;msg&amp;#34;: &lt;/span>&lt;span style="color:#e6db74">&amp;#34;Loop 0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">ok&lt;/span>: [&lt;span style="color:#ae81ff">server1] =&amp;gt; (item=1) =&amp;gt; {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;msg&amp;#34;: &lt;/span>&lt;span style="color:#e6db74">&amp;#34;Loop 1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">ok&lt;/span>: [&lt;span style="color:#ae81ff">server1] =&amp;gt; (item=2) =&amp;gt; {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;msg&amp;#34;: &lt;/span>&lt;span style="color:#e6db74">&amp;#34;Loop 2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æœƒä½¿ç”¨ Loop å°±å¯ä»¥æ¸›å°‘æˆ‘å€‘åœ¨å¯«é‡è¤‡çš„ç¨‹å¼ç¢¼ï¼Œç•¶ç„¶ä¸Šé¢çš„åªæ˜¯ç°¡å–®çš„ç¯„ä¾‹ï¼Œè©³ç´°è«‹åƒè€ƒ &lt;a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html#query-vs-lookup" target="_blank" rel="noopener">Loops - Ansible Documentation&lt;/a>ã€‚&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç¾ä»£ IT äººä¸€å®šè¦çŸ¥é“çš„ Ansible è‡ªå‹•åŒ–çµ„æ…‹æŠ€å·§ï¼š&lt;a href="https://chusiang.gitbooks.io/automate-with-ansible/content/" target="_blank" rel="noopener">https://chusiang.gitbooks.io/automate-with-ansible/content/&lt;/a>&lt;/p>
&lt;p>Ansible å®‰è£ï¼š&lt;a href="https://tso-liang-wu.gitbook.io/learn-ansible-and-jenkins-in-30-days/ansible/ansible/ansible-installation" target="_blank" rel="noopener">https://tso-liang-wu.gitbook.io/learn-ansible-and-jenkins-in-30-days/ansible/ansible/ansible-installation&lt;/a>&lt;/p>
&lt;p>æ€éº¼ç”¨ Docker ç·´ç¿’ Ansibleï¼Ÿï¼š&lt;a href="https://chusiang.gitbooks.io/automate-with-ansible/content/05.how-to-practive-the-ansible-with-docker.html" target="_blank" rel="noopener">https://chusiang.gitbooks.io/automate-with-ansible/content/05.how-to-practive-the-ansible-with-docker.html&lt;/a>&lt;/p>
&lt;p>community.general.telegram module â€“ module for sending notifications via telegramï¼š&lt;a href="https://docs.ansible.com/ansible/latest/collections/community/general/telegram_module.html#ansible-collections-community-general-telegram-module" target="_blank" rel="noopener">https://docs.ansible.com/ansible/latest/collections/community/general/telegram_module.html#ansible-collections-community-general-telegram-module&lt;/a>&lt;/p></description></item><item><title>ä½¿ç”¨ Jenkins è¨­å®š GitHub è§¸ç™¼ç¨‹åºä¸¦é€šçŸ¥ Telegram Bot</title><link>https://pin-yi.me/blog/git-or-cicd/jenkins-github-tg-bot/</link><pubDate>Mon, 16 May 2022 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/git-or-cicd/jenkins-github-tg-bot/</guid><description>
&lt;p>æ­¤æ–‡ç« æ˜¯æ¥çºŒå‰é¢ &lt;a href="../jenkins-ansible/" >Jenkins åŠ Ansible IT è‡ªå‹•åŒ– CI/CD ä»‹ç´¹&lt;/a> æ–‡ç« ï¼Œæ­¤ç¯‡æœƒå¯¦éš›å®‰è£åŠå¯¦ä½œ Jenkinsï¼Œå¤§å®¶è¨˜å¾—åœ¨å­¸ç¿’å‰è¦å…ˆæª¢æŸ¥è‡ªå·±çš„ç‰ˆæœ¬æ˜¯å¦æœ‰æ–°çš„æ›´æ–°ï¼é‚£æˆ‘å€‘é–‹å§‹å›‰ ğŸ˜˜&lt;/p>
&lt;h2>Jenkins å®‰è£èˆ‡å¯¦ä½œ&lt;span class="absolute -mt-20" id="jenkins-å®‰è£èˆ‡å¯¦ä½œ">&lt;/span>
&lt;a href="#jenkins-%e5%ae%89%e8%a3%9d%e8%88%87%e5%af%a6%e4%bd%9c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘é€™æ¬¡æœƒä½¿ç”¨ Docker-compose ä¾†é€²è¡Œå®‰è£ï¼Œé™¤äº† Docker ä»¥å¤–ä¹Ÿæœ‰ä¸åŒçš„å®‰è£æ–¹å¼ï¼Œå¯ä»¥åƒè€ƒ &lt;a href="https://www.jenkins.io/download/" target="_blank" rel="noopener">Jenkins download and deployment&lt;/a>ï¼Œæœ¬æ¬¡ä½¿ç”¨çš„ç’°å¢ƒç‰ˆæœ¬å¦‚ä¸‹ï¼š&lt;/p>
&lt;h3>ç‰ˆæœ¬&lt;span class="absolute -mt-20" id="ç‰ˆæœ¬">&lt;/span>
&lt;a href="#%e7%89%88%e6%9c%ac" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>macOSï¼š11.6&lt;/li>
&lt;li>Dockerï¼šDocker version 20.10.14, build a224086&lt;/li>
&lt;li>Jenkinsï¼šjenkins/jenkins:lts-jdk11&lt;/li>
&lt;li>yamllintï¼š1.26.0&lt;/li>
&lt;/ul>
&lt;br>
&lt;h3>å®‰è£&lt;span class="absolute -mt-20" id="å®‰è£">&lt;/span>
&lt;a href="#%e5%ae%89%e8%a3%9d" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é€™é‚Šæœƒä½¿ç”¨ Jenkins æä¾›çš„ &lt;a href="https://hub.docker.com/layers/jenkins/jenkins/jenkins/lts-jdk11/images/sha256-ec98cb8b367b0f9426f71345efe11e001c901704cea0e61fd91beb37af34ef98?context=explore" target="_blank" rel="noopener">å®˜æ–¹ LTS æ˜ åƒæª”&lt;/a> ä¾†ä½œç‚ºåŸºåº•ï¼Œå› ç‚ºæˆ‘å€‘è¦å¤šå®‰è£æ¸¬è©¦ç¨‹å¼ &lt;a href="https://yamllint.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener">yamllint&lt;/a>ï¼Œæ‰€ä»¥å°±è‡ªå·±å¯«ä¸€å€‹ Docker-composeï¼š(åŒæ¨£çš„ç¨‹å¼ç¢¼æœƒæ”¾åœ¨ &lt;a href="https://github.com/880831ian/jenkins-github-tg-bot" target="_blank" rel="noopener">GitHub&lt;/a>ï¼Œä¹Ÿç›´æ¥åŒ…æˆæ˜ åƒæª”æ”¾åœ¨ &lt;a href="https://hub.docker.com/r/880831ian/jenkins" target="_blank" rel="noopener">DockerHub&lt;/a>ï¼Œæ­¡è¿å¤§å®¶è‡ªè¡Œå–ç”¨)&lt;/p>
&lt;br>
&lt;p>&lt;a href="https://github.com/adrienverge/yamllint" target="_blank" rel="noopener">yamlint&lt;/a>ï¼Œå®ƒæ˜¯èªæ³•æª¢æŸ¥å·¥å…·ï¼Œå¯ä»¥ç”¨ä¾†æª¢æŸ¥ yaml æª”æ¡ˆçš„èªæ³•æ˜¯å¦æ­£ç¢ºä»¥åŠç¬¦åˆè¦ç¯„ï¼Œæˆ‘å€‘çœ‹ä¸€ä¸‹å¯¦éš›æ“ä½œçš„ç•«é¢ï¼š&lt;/p>
&lt;br>
&lt;p>&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/yamllint.png"
alt="yamllint æ¸¬è©¦" width="800">&lt;figcaption>
&lt;p>yamllint æ¸¬è©¦&lt;/p>
&lt;/figcaption>
&lt;/figure>
å¯ä»¥çœ‹åˆ°å¦‚æœä¸ç¬¦åˆ yaml è¦ç¯„å°±æœƒè·³å‡ºéŒ¯èª¤è¨Šæ¯ã€‚&lt;/p>
&lt;br>
&lt;p>æ¥ä¸‹ä¾†å…ˆçœ‹ä¸€ä¸‹æ•´å€‹ Docker-compose çµæ§‹ä»¥åŠå„åƒæ•¸ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ Docker-compose.yaml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”œâ”€â”€ jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â”‚Â Â  â””â”€â”€ Dockerfile&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>&lt;strong>Docker-compose.yaml&lt;/strong>&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;3.8&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">jenkins&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>: &lt;span style="color:#ae81ff">./jenkins/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">jenkins&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">8080&lt;/span>:&lt;span style="color:#ae81ff">8080&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">50000&lt;/span>:&lt;span style="color:#ae81ff">50000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">restart&lt;/span>: &lt;span style="color:#ae81ff">always&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./jenkins_home:/var/jenkins_home&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åƒæ•¸èªªæ˜ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>build: ./jenkins/&lt;/code>ï¼šå› ç‚ºè¦å…ˆå®‰è£ yamllintï¼Œæ‰€ä»¥ä½¿ç”¨ Dockerfile å¦å¤–å¯«ã€‚&lt;/li>
&lt;li>&lt;code>container_name:jenkins&lt;/code>ï¼šå®¹å™¨çš„åç¨±ã€‚&lt;/li>
&lt;li>&lt;code>ports: -8080:8080 - 50000:50000&lt;/code>ï¼š8080 æ˜¯å¾…æœƒæˆ‘å€‘ç€è¦½å„€è¡¨æ¿æœƒä½¿ç”¨åˆ°çš„ Portï¼Œå¦‚æœæœ¬æ©Ÿä¸Š 8080 å·²ç¶“è¢«ä½”ç”¨ï¼Œå¯ä»¥è‡ªè¡Œæ›´æ›ï¼Œ50000 æ˜¯ Jenkins æ‰€ä½¿ç”¨çš„ Portã€‚&lt;/li>
&lt;li>&lt;code>restart: always&lt;/code>ï¼šç•¶å®¹å™¨åœæ­¢æ™‚ï¼Œæœƒè‡ªå‹•é‡æ–°å•Ÿå‹•å®¹å™¨ã€‚&lt;/li>
&lt;li>&lt;code>volumes: - ./jenkins_home:/var/jenkins_home&lt;/code>ï¼šæ›è¼‰ç›®éŒ„ï¼Œå°±ç®—åˆªé™¤å®¹å™¨ä¸€æ¨£å¯ä»¥ä¿ç•™å…¶ä»–è¨­å®šã€‚æˆ‘å°‡å•Ÿå‹• &lt;code>Docker-compose.yaml&lt;/code> çš„è³‡æ–™å¤¾ä¸‹å¤šä¸€å€‹ jenkins_home èˆ‡å®¹å™¨å…§ /var/jenkins_home åšæ˜ å°„ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å»èª¿æ•´ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>&lt;strong>jenkins/Dockerfile&lt;/strong>&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-dockerfile" data-lang="dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> jenkins/jenkins:lts-jdk11&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">LABEL&lt;/span> maintainer&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;880831ian@gmail.com&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">USER&lt;/span>&lt;span style="color:#e6db74"> root&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">RUN&lt;/span> apt-get upgrade -y&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> apt-get update -y&lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> apt-get install yamllint -y&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åƒæ•¸èªªæ˜ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>FROM&lt;/code>ï¼šæˆ‘å€‘ä½¿ç”¨ Jenkins å®˜æ–¹æä¾›çš„ LTS ç¶­è­·ç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>&lt;code>USER&lt;/code>ï¼šå› ç‚ºè¦å…ˆå®‰è£æ±è¥¿ï¼Œæ‰€ä»¥ç›´æ¥çµ¦ root æ¬Šé™ã€‚&lt;/li>
&lt;li>&lt;code>RUN&lt;/code>ï¼šå…ˆå‡ç´šå®Œå¾Œï¼Œå†æ›´æ–°ï¼Œæœ€å¾Œå†è£ &lt;a href="https://yamllint.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener">yamllint&lt;/a>ã€‚(-y æ˜¯åŒæ„æ‰€ä»¥è©¢å•)&lt;/li>
&lt;/ul>
&lt;br>
&lt;p>æœ€å¾Œä½¿ç”¨ &lt;code>docker-compose&lt;/code> ä¾†åŸ·è¡Œï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ docker-compose up -d&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¦åœ¨ Docker-compose.yaml è³‡æ–™å¤¾ä¸‹æŒ‡ä»¤æ‰æœ‰ç”¨ã€‚&lt;/p>
&lt;br>
&lt;p>ä¸‹å®ŒæŒ‡ä»¤å¾Œï¼Œä»–å°±æœƒåœ¨èƒŒæ™¯é–‹å§‹å®‰è£ï¼Œå¯ä»¥è©¦è‘—ç”¨ç€è¦½å™¨ç€è¦½ &lt;code>http://localhost:8080&lt;/code>ï¼ŒæŸ¥çœ‹æœ‰æ²’æœ‰è·³å‡ºä¸‹é¢é€™å€‹ç•«é¢ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/unlock.png"
alt="ç€è¦½å™¨è¨ªå• http://localhost:8080" width="800">&lt;figcaption>
&lt;p>ç€è¦½å™¨è¨ªå• &lt;code>http://localhost:8080&lt;/code>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘çœ‹åˆ°å®ƒéœ€è¦è¼¸å…¥ä¸€çµ„ Administrator passwordï¼Œæˆ‘å€‘è¦ä½¿ç”¨ &lt;code>docker logs&lt;/code> ä¾†æŸ¥çœ‹ï¼Œæœƒç™¼ç¾æœ€å¾Œæœƒæœ‰å¯« Please use the following password to proceed to installation çš„åœ°æ–¹ï¼š&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ docker logs jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>*************************************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>*************************************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>*************************************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Jenkins initial setup is required. An admin user has been created and a password generated.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Please use the following password to proceed to installation:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>70c0780f62a7441f90286be106908378
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>This may also be found at: /var/jenkins_home/secrets/initialAdminPassword
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>*************************************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>*************************************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>*************************************************************&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å…¶ä¸­çš„ &lt;code>70c0780f62a7441f90286be106908378&lt;/code> ï¼Œå°±æ˜¯æˆ‘å€‘çš„ Administrator passwordï¼Œç›´æ¥è¤‡è£½ä¸¦è²¼åˆ°æ¬„ä½å¾ŒæŒ‰ Continueã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å¯ä»¥çœ‹åˆ°å®ƒè©¢å•æ˜¯å¦è¦å®‰è£å¥—ä»¶ï¼Œæˆ‘å€‘é¸æ“‡å·¦é‚Š Install suggested plugins å®‰è£æ¨è–¦çš„å¥—ä»¶å³å¯ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/plugins.png"
alt="å®‰è£æ¨è–¦çš„å¥—ä»¶" width="800">&lt;figcaption>
&lt;p>å®‰è£æ¨è–¦çš„å¥—ä»¶&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>ç­‰å¾…å®ƒå®‰è£å¥—ä»¶ï¼Œå®‰è£å®Œå¾Œæœƒè‡ªå‹•è·³åˆ°è¨»å†Šç•«é¢ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/install.png"
alt="ç­‰å¾…å®‰è£&amp;amp;hellip;" width="800">&lt;figcaption>
&lt;p>ç­‰å¾…å®‰è£&amp;hellip;&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>è¼¸å…¥å®ŒåŸºæœ¬çš„è³‡æ–™å¾Œï¼ŒæŒ‰ Save and Continueï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/create_adminuser.png"
alt="å‰µå»º Admin ä½¿ç”¨è€…" width="800">&lt;figcaption>
&lt;p>å‰µå»º Admin ä½¿ç”¨è€…&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æœ€å¾Œçœ‹åˆ°ä¸‹é¢é€™å€‹ç•«é¢å°±ä»£è¡¨æˆ‘å€‘å®‰è£å¥½å›‰ï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/done.png"
alt="Jenkins å„€è¡¨æ¿" width="1200">&lt;figcaption>
&lt;p>Jenkins å„€è¡¨æ¿&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>å»ºç«‹ç¬¬ä¸€å€‹ Jenkins Job&lt;span class="absolute -mt-20" id="å»ºç«‹ç¬¬ä¸€å€‹-jenkins-job">&lt;/span>
&lt;a href="#%e5%bb%ba%e7%ab%8b%e7%ac%ac%e4%b8%80%e5%80%8b-jenkins-job" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘å·²ç¶“æˆåŠŸå®‰è£å¥½ä¸¦é€²å…¥åˆ° Jenkins å„€è¡¨æ¿ï¼Œæˆ‘å€‘å…ˆä¾†å»ºç«‹ç¬¬ä¸€å€‹ Jobï¼Œå®ƒçš„åŠŸç”¨æ˜¯å‘Šè¨´æˆ‘å€‘ç³»çµ±æª”æ¡ˆçš„å³æ™‚ä½¿ç”¨ç‹€æ³ï¼Œè®“æˆ‘å€‘å° Jenkins æœ‰åˆæ­¥çš„äº†è§£ï¼š&lt;/p>
&lt;ol>
&lt;li>é»é¸å„€è¡¨æ¿çš„æ–°å¢ä½œæ¥­æˆ–æ˜¯ Create a Jobï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/create_job.png"
alt="æ–°å¢ä½œæ¥­" width="1200">&lt;figcaption>
&lt;p>æ–°å¢ä½œæ¥­&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>è¼¸å…¥ Job å°ˆæ¡ˆåç¨±ä¸¦é¸æ“‡å»ºç«‹ Free-Style è»Ÿé«”å°ˆæ¡ˆï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/disk.png"
alt="è¨­å®š Job å°ˆæ¡ˆ" width="1200">&lt;figcaption>
&lt;p>è¨­å®š Job å°ˆæ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯ä»¥çœ‹åˆ°é€™é‚Šæœ‰ä¸åŒçš„å°ˆæ¡ˆé¡å‹å¯ä»¥é¸æ“‡ï¼Œ&lt;strong>Free-Style&lt;/strong> ä»¥åŠ &lt;strong>Pipeline&lt;/strong> é€™å…©ç¨®é¡å‹çš„å°ˆæ¡ˆåŸºæœ¬ä¸Šå°±æ¶µè“‹å¤§éƒ¨åˆ†çš„éœ€æ±‚ã€‚&lt;strong>Free-Style&lt;/strong> é¡å‹çš„å°ˆæ¡ˆæä¾›äº†éå¸¸å¤§çš„å½ˆæ€§è®“ä½¿ç”¨è€…ä¾†åšåŸå§‹ç¢¼ç®¡ç†ä»¥åŠå»ºç½®ã€‚å¦‚æœå»ºç½®æµç¨‹æ¶‰åŠå¤šå€‹å°ˆæ¡ˆï¼Œå‰‡å¯ä»¥ä½¿ç”¨ &lt;strong>Pipeline&lt;/strong> é¡å‹çš„å°ˆæ¡ˆä¾†çµ„åˆåŠå®šç¾©å»ºç½®é‚è¼¯ã€‚&lt;/p>
&lt;br>
&lt;ol start="3">
&lt;li>æ¥ä¸‹ä¾†è¨­å®šå°ˆæ¡ˆçµ„æ…‹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/describe.png"
alt="è¨­å®šå°ˆæ¡ˆçµ„æ…‹" width="1200">&lt;figcaption>
&lt;p>è¨­å®šå°ˆæ¡ˆçµ„æ…‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¦è¨˜å¾—å¹«æ¯ä¸€å€‹å°ˆæ¡ˆéƒ½åŠ ä¸Šæè¿°ï¼Œè®“å…¶ä»–äººçŸ¥é“è©²å°ˆæ¡ˆçš„ç”¨é€”æˆ–æ˜¯ä½¿ç”¨æ™‚æ©Ÿç­‰ã€‚&lt;/p>
&lt;br>
&lt;p>æ¥è‘—ï¼Œåœ¨&lt;strong>å»ºç½®&lt;/strong>çš„ä¸‹æ‹‰å¼æ¬„ä½é¸æ“‡ &lt;code>é¸æ“‡å»ºç½®æ­¥é©Ÿ &amp;gt; åŸ·è¡Œ Shell&lt;/code>&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/shell.png"
alt="è¨­å®šå°ˆæ¡ˆçµ„æ…‹" width="1200">&lt;figcaption>
&lt;p>è¨­å®šå°ˆæ¡ˆçµ„æ…‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>è¼¸å…¥ &lt;code>df -h&lt;/code> æŒ‡ä»¤ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/df-h.png"
alt="è¨­å®šå°ˆæ¡ˆçµ„æ…‹" width="1000">&lt;figcaption>
&lt;p>è¨­å®šå°ˆæ¡ˆçµ„æ…‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘é€™é‚Šé€éå»ºç½® &lt;code>åŸ·è¡Œ Shell&lt;/code> é€™å€‹å»ºç½®æ­¥é©Ÿä¾†å‘Šè¨´ Jenkinsï¼Œæœªä¾†é€™å€‹å°ˆæ¡ˆè¢«å»ºç½®ï¼Œå°±æœƒåŸ·è¡Œ &lt;code>df -h&lt;/code> é€™å€‹æŒ‡ä»¤ã€‚&lt;/p>
&lt;br>
&lt;ol start="4">
&lt;li>å°ˆæ¡ˆçµ„æ…‹è¨­ç½®å®Œå¾Œï¼Œæˆ‘å€‘é»é¸å·¦é‚Šçš„&lt;strong>é¦¬ä¸Šå»ºç½®&lt;/strong>ä¾†å»ºç½®å‰›å‰›å»ºå¥½çš„å°ˆæ¡ˆï¼Œå¦‚æœæˆ‘å€‘è¨­å®šä¸Šæ²’æœ‰å•é¡Œï¼Œæ‡‰è©²æœƒåœ¨å·¦ä¸‹è§’çš„&lt;strong>å»ºç½®æ­·ç¨‹&lt;/strong>é€™é‚Šçœ‹åˆ°æˆ‘å€‘çš„ç¬¬ä¸€å€‹å»ºç½®ç´€éŒ„ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/build.png"
alt="å»ºç½®å°ˆæ¡ˆ" width="800">&lt;figcaption>
&lt;p>å»ºç½®å°ˆæ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="5">
&lt;li>é»é€²å»å¾Œï¼Œå†é» &lt;strong>Console Output&lt;/strong>ï¼Œå¯ä»¥çœ‹åˆ°é€™æ¬¡å»ºç½®çš„çµæœï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/console.png"
alt="å»ºç½®å°ˆæ¡ˆ" width="800">&lt;figcaption>
&lt;p>å»ºç½®å°ˆæ¡ˆ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>é€™æ¨£æˆ‘å€‘çš„ç¬¬ä¸€å€‹ Jenkins Job å°±è¨­å®šå®Œæˆå›‰ï¼Jenkins ä¹Ÿç¢ºå¯¦çš„åŸ·è¡Œæˆ‘å€‘æ‰€è¨­å®šçš„æŒ‡ä»¤ï¼Œä¸¦å°‡ç³»çµ±çš„ä½¿ç”¨ç‹€æ³å‘ˆç¾åœ¨çµ‚ç«¯æ©Ÿçš„è¼¸å‡ºä¸Šã€‚
&lt;br>&lt;/p>
&lt;p>ä»¥ä¸Šå°±æ˜¯æˆ‘å€‘ç¬¬ä¸€å€‹ç°¡å–®çš„å°ˆæ¡ˆå»ºç½®æµç¨‹ï¼Œç•¶ç„¶ï¼ŒJenkins å¯ä»¥åšåˆ°çš„äº‹æƒ…ä¸åƒ…å¦‚æ­¤ï¼Œåœ¨å¾Œé¢æˆ‘å€‘æœƒé€éå®‰è£ä¸åŒçš„å¥—ä»¶ä¾†å¼·åŒ– Jenkinsï¼Œä¾†é”åˆ°å®Œæ•´çš„æŒçºŒæ•´åˆ ğŸ˜&lt;/p>
&lt;br>
&lt;h2>åŸå§‹ç¢¼ç®¡ç†èˆ‡å»ºç½®è§¸ç™¼ç¨‹åº&lt;span class="absolute -mt-20" id="åŸå§‹ç¢¼ç®¡ç†èˆ‡å»ºç½®è§¸ç™¼ç¨‹åº">&lt;/span>
&lt;a href="#%e5%8e%9f%e5%a7%8b%e7%a2%bc%e7%ae%a1%e7%90%86%e8%88%87%e5%bb%ba%e7%bd%ae%e8%a7%b8%e7%99%bc%e7%a8%8b%e5%ba%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ä¸Šé¢æœ‰æåˆ° Jenkins ä½œç‚ºä¸€å€‹æŒçºŒæ•´åˆçš„å·¥å…·ï¼Œèˆ‡åŸå§‹ç¢¼ç®¡ç†ç³»çµ±çš„æ•´åˆå°¤å…¶é‡è¦ã€‚æˆ‘å€‘é€™ä¸€ç« ç¯€ï¼Œæœƒä»‹ç´¹å¦‚ä½•åœ¨ Jenkins ä¸Šé€éåŸå§‹ç¢¼ç®¡ç† (source code management,SCM) ç³»çµ±ï¼Œä¾‹å¦‚å¾ GitHub ç²å¾—å°ˆæ¡ˆçš„åŸå§‹ç¢¼ï¼Œä¸¦è¨­ç½®å»ºç½®è§¸ç™¼ç¨‹åº (build triggers) ä¾†å¯¦è¸æŒçºŒæ•´åˆã€‚&lt;/p>
&lt;br>
&lt;h3>å»ºç½®å°ˆæ¡ˆ&lt;span class="absolute -mt-20" id="å»ºç½®å°ˆæ¡ˆ">&lt;/span>
&lt;a href="#%e5%bb%ba%e7%bd%ae%e5%b0%88%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;h4>HTTPS&lt;span class="absolute -mt-20" id="https">&lt;/span>
&lt;a href="#https" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æ¥ä¸‹ä¾†æˆ‘å€‘å…ˆå»ºç«‹ä¸€å€‹æ–°çš„ Jobï¼Œé¸æ“‡ Free-style æ¨¡å¼ï¼Œé€™æ¬¡è¦åœ¨åŸå§‹ç¢¼ç®¡ç†è£¡é¢é¸æ“‡ Gitï¼Œåœ¨ Repositories &amp;gt; Repository URL è£¡é¢è¼¸å…¥æˆ‘å€‘é€™æ¬¡è¦æ¸¬è©¦çš„ &lt;a href="https://github.com/880831ian/jenkins-github-tg-bot" target="_blank" rel="noopener">repository URL&lt;/a>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/repository.png"
alt="è¨­å®š Repository URL" width="1000">&lt;figcaption>
&lt;p>è¨­å®š Repository URL&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h4>SSH&lt;span class="absolute -mt-20" id="ssh">&lt;/span>
&lt;a href="#ssh" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>å¦‚æœæˆ‘å€‘æƒ³è¦é€é SSH ä¾†å­˜å–å°ˆæ¡ˆï¼Œæˆ‘å€‘æœƒé‡åˆ°ä»¥ä¸‹ç‹€æ³ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/ssh_error.png"
alt="SSH å°šæœªè¨­å®šéŒ¯èª¤è¨Šæ¯" width="1000">&lt;figcaption>
&lt;p>SSH å°šæœªè¨­å®šéŒ¯èª¤è¨Šæ¯&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>æœƒæœ‰éŒ¯èª¤è¨Šæ¯æ˜¯å› ç‚ºæˆ‘å€‘é‚„æ²’æœ‰æŠŠ Jenkins èˆ‡ GitHub åš SSH é‡‘é‘°é…å°ï¼Œæ‰€ä»¥ GitHub æ‹’çµ• Jenkins é€é SSH å­˜å–ã€‚é‚£è¦æ€éº¼è§£æ±ºå‘¢ï¼Ÿ&lt;/p>
&lt;p>æœ€ç°¡å–®çš„æ–¹æ³•å°±æ˜¯åœ¨ Jenkins ä¸»æ©Ÿä¸‹&lt;a href="https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/" target="_blank" rel="noopener">å»ºç«‹ SSH é‡‘é‘°&lt;/a>ï¼Œä¸¦&lt;a href="https://help.github.com/articles/adding-a-new-ssh-key-to-your-github-account/" target="_blank" rel="noopener">å°‡å…¬é–‹é‡‘é‘° Key åŠ å…¥åˆ° GitHub å¸³è™Ÿä¸­&lt;/a>ï¼Œæœ‰éœ€è¦çš„æœ‹å‹å¯ä»¥å†è‡ªè¡Œä½¿ç”¨ï¼Œè©²ç¯„ä¾‹ä½¿ç”¨ HTTPS ä¾†åšè¨­å®šã€‚&lt;/p>
&lt;br>
&lt;h3>å»ºç½®è§¸ç™¼ç¨‹åº&lt;span class="absolute -mt-20" id="å»ºç½®è§¸ç™¼ç¨‹åº">&lt;/span>
&lt;a href="#%e5%bb%ba%e7%bd%ae%e8%a7%b8%e7%99%bc%e7%a8%8b%e5%ba%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç”±æ–¼æˆ‘å€‘é‚„æ²’æœ‰å®šç¾©ä»»ä½•å»ºç½®çš„è§¸ç™¼ç¨‹åºï¼Œæ‰€ä»¥é™¤éæˆ‘å€‘æ‰‹å‹•å»æ“ä½œ Jenkinsï¼Œä¸ç„¶ Jenkins ä¸¦ä¸æœƒä¸»å‹•å¹«æˆ‘å€‘é€²è¡Œå»ºç½®ã€‚å› æ­¤ï¼Œåœ¨&lt;strong>å»ºç½®è§¸ç™¼ç¨‹åº&lt;/strong>é€™å€‹æ¬„ä½å…§ï¼Œæˆ‘å€‘å¯ä»¥è‡ªç”±è¨­å®šæˆ‘å€‘å¸Œæœ› Jenkins ä½•æ™‚è‡ªå‹•å¹«æˆ‘å€‘é€²è¡Œå»ºç½®å°ˆæ¡ˆã€‚é‚£ä¾ç…§å°ˆæ¡ˆçš„å±¬æ€§ä¸åŒï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥æ¡ç”¨ä¸åŒçš„å»ºç½®æ™‚æ©Ÿã€‚é‚£æœ€å¸¸è¦‹çš„æœ‰ä»¥ä¸‹å…©ç¨®ï¼š&lt;/p>
&lt;br>
&lt;h4>å®šæœŸå»ºç½®&lt;span class="absolute -mt-20" id="å®šæœŸå»ºç½®">&lt;/span>
&lt;a href="#%e5%ae%9a%e6%9c%9f%e5%bb%ba%e7%bd%ae" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>åœ¨ Jenkins ä¸­ï¼Œæˆ‘å€‘æ˜¯æ¡ç”¨ &lt;a href="https://cloud.google.com/scheduler/docs/configuring/cron-job-schedules" target="_blank" rel="noopener">Cron Format&lt;/a> çš„æ–¹å¼ä¾†å®šç¾©å»ºç½®è¡Œç¨‹ã€‚Cron Format ç¸½å…±äº”å€‹æ¬„ä½ï¼Œæ¬„ä½èˆ‡æ¬„ä½ä¹‹é–“å¯ç”¨ç©ºç™½æˆ– Tab éµåšå€éš”ï¼š&lt;/p>
&lt;ol>
&lt;li>åˆ† (minute)ï¼š0 - 59 åˆ†&lt;/li>
&lt;li>æ™‚ (hour)ï¼š0 - 23 æ™‚&lt;/li>
&lt;li>æ—¥ (day of month)ï¼š1 - 31 æ—¥&lt;/li>
&lt;li>æœˆ (month)ï¼š1 - 12 æœˆ&lt;/li>
&lt;li>æ˜ŸæœŸ (day of week)ï¼šæ˜ŸæœŸ 0 - 7 (å…¶ä¸­ 0 èˆ‡ 7 éƒ½ä»£è¡¨æ˜ŸæœŸå¤©)&lt;/li>
&lt;/ol>
&lt;p>å‡è¨­æˆ‘å€‘å¸Œæœ›æ¯å€‹ 30 åˆ†é˜å°±å»ºç½®ä¸€æ¬¡ç•¶å‰å°ˆæ¡ˆï¼Œæˆ‘å€‘å¯ä»¥åœ¨å®šç¾©è¦å‰‡è£¡é¢å¡«å…¥ &lt;code>H/15 * * * *&lt;/code>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/cron.png"
alt="å®šæœŸå»ºç½®" width="1000">&lt;figcaption>
&lt;p>å®šæœŸå»ºç½®&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h4>GitHub hook trigger for GITScm polling&lt;span class="absolute -mt-20" id="github-hook-trigger-for-gitscm-polling">&lt;/span>
&lt;a href="#github-hook-trigger-for-gitscm-polling" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>é€™ç¨®è§¸ç™¼æ–¹å¼åœ¨æŒçºŒæ•´åˆæ™‚éå¸¸å¯¦ç”¨ã€‚æˆ‘å€‘å¯ä»¥è®“ Jenkins è‡ªå‹•ç›£æ¸¬ç•¶åœ¨åŸå§‹ç¢¼å°ˆæ¡ˆæœ‰ä»»ä½•çš„ push event ç™¼ç”Ÿæ™‚å°±é€²è¡Œå»ºç½®ã€‚ç‚ºäº†è¦ä½¿ç”¨é€™ç¨®æ–¹å¼å»ºç½®ï¼Œéœ€è¦ä»¥ä¸‹å¹¾å€‹æ­¥é©Ÿä¾†è¨­å®šï¼š&lt;/p>
&lt;h5>æ–°å¢ GitHub personal access token&lt;span class="absolute -mt-20" id="æ–°å¢-github-personal-access-token">&lt;/span>
&lt;a href="#%e6%96%b0%e5%a2%9e-github-personal-access-token" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol>
&lt;li>é€²å…¥ GitHub é¦–é ï¼Œé»é¸å³ä¸Šè§’ä¸‹æ‹‰é¸å–®ï¼Œé»é¸ &lt;strong>Settings&lt;/strong>ï¼š&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_1.png"
alt="GitHub hook trigger for GITScm polling è¨­å®š" width="1000">&lt;figcaption>
&lt;p>GitHub hook trigger for GITScm polling è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>å…ˆé»é¸å·¦é‚Šçš„ &lt;strong>Developer settings&lt;/strong> &amp;gt; é»é¸å·¦é‚Šçš„ &lt;strong>Personal access tokens&lt;/strong> &amp;gt; é»é¸å³ä¸Šè§’çš„ &lt;strong>Generate new token&lt;/strong>ï¼Œè¼¸å…¥ token çš„æè¿°ä¸¦å‹¾é¸ &lt;code>repo&lt;/code> scope ä»¥åŠ &lt;code>admin:repo_hook&lt;/code> scope è·Ÿ &lt;code>admin:org_hook&lt;/code> scopeï¼Œé»é¸ &lt;strong>Generate token&lt;/strong>ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_2.png"
alt="GitHub hook trigger for GITScm polling è¨­å®š" width="700">&lt;figcaption>
&lt;p>GitHub hook trigger for GITScm polling è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>æœƒç”¢ç”Ÿä¸€å€‹ tokenï¼Œè«‹å…ˆæŠŠ token è¤‡è£½ä¸‹ä¾†ï¼Œé›¢é–‹é€™å€‹ç•«é¢å¾Œï¼Œtoken å°±æœƒçœ‹ä¸åˆ°äº†ï¼(æ­¤ token å·²åˆªé™¤ âœŒï¸)&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_3.png"
alt="GitHub hook trigger for GITScm polling è¨­å®š" width="1000">&lt;figcaption>
&lt;p>GitHub hook trigger for GITScm polling è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h5>è¨­å®š Jenkins GitHub&lt;span class="absolute -mt-20" id="è¨­å®š-jenkins-github">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a-jenkins-github" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol>
&lt;li>é€²å…¥ Jenkins å„€è¡¨æ¿é é¢ï¼Œé»é¸å·¦é‚Š&lt;strong>ç®¡ç† Jenkins&lt;/strong> &amp;gt; System Configuration çš„&lt;strong>è¨­å®šç³»çµ±&lt;/strong>ï¼Œå¾€ä¸‹æ»‘æ‰¾åˆ° GitHubï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_4.png"
alt="GitHub hook trigger for GITScm polling è¨­å®š" width="1000">&lt;figcaption>
&lt;p>GitHub hook trigger for GITScm polling è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>æ‰¾åˆ°å¾Œï¼Œå† GitHub Servers ä¸‹æ‹‰æ¬„ä½é¸æ“‡ Add GitHub Serverï¼Œæœƒçœ‹åˆ°ä¸‹é¢ç•«é¢ï¼ŒAPI URL è¼¸å…¥ &lt;code>https://api.github.com&lt;/code>ï¼ŒCredentials é» Addï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_5.png"
alt="GitHub hook trigger for GITScm polling è¨­å®š" width="1000">&lt;figcaption>
&lt;p>GitHub hook trigger for GITScm polling è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>Kind é¸æ“‡ Secret Textï¼ŒSecret è¼¸å…¥å‰›å‰›å­˜çš„ Personal Access Tokenï¼ŒDescription ç°¡å–®æè¿°ä¸€ä¸‹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_6.png"
alt="GitHub hook trigger for GITScm polling è¨­å®š" width="1000">&lt;figcaption>
&lt;p>GitHub hook trigger for GITScm polling è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>è¨­å®šå®Œå¾Œï¼Œé»é¸ä¸€ä¸‹å³é‚Šçš„ &lt;strong>Test connection&lt;/strong>ï¼Œå¦‚æœæˆ‘é¡¯ç¤º &lt;code>Credentials verified for user UserName, rate limit: xxx&lt;/code> å°±ä»£è¡¨æˆåŠŸå›‰ï¼&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_7.png"
alt="GitHub hook trigger for GITScm polling è¨­å®š" width="1000">&lt;figcaption>
&lt;p>GitHub hook trigger for GITScm polling è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h5>è¨­å®šå°ˆæ¡ˆçµ„æ…‹&lt;span class="absolute -mt-20" id="è¨­å®šå°ˆæ¡ˆçµ„æ…‹">&lt;/span>
&lt;a href="#%e8%a8%ad%e5%ae%9a%e5%b0%88%e6%a1%88%e7%b5%84%e6%85%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol>
&lt;li>æ¥è‘—æˆ‘å€‘è·³å›ä¾†å‰›å‰›çš„å°ˆæ¡ˆçµ„æ…‹ï¼Œä¸¦å‹¾é¸ &lt;strong>GitHub hook trigger for GITScm polling&lt;/strong>ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_8.png"
alt="è¨­å®šå°ˆæ¡ˆçµ„æ…‹" width="1000">&lt;figcaption>
&lt;p>è¨­å®šå°ˆæ¡ˆçµ„æ…‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>å¯«ä¸€å€‹ Shell Script ä¾†å»ºç½®å°ˆæ¡ˆï¼š&lt;/li>
&lt;/ol>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> file in &lt;span style="color:#66d9ef">$(&lt;/span>find . -type f -name &lt;span style="color:#e6db74">&amp;#34;*yaml&amp;#34;&lt;/span>&lt;span style="color:#66d9ef">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">do&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> yamllint $file
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">done&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_9.png"
alt="è¨­å®šå°ˆæ¡ˆçµ„æ…‹" width="1000">&lt;figcaption>
&lt;p>è¨­å®šå°ˆæ¡ˆçµ„æ…‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>é€™é‚Šåˆ©ç”¨ä¸€å€‹ç°¡å–®çš„ Shell Script è¿´åœˆä¾†å°æ‰€æœ‰ YAML file é€²è¡Œ yamllint çš„æª¢æŸ¥ï¼Œæœ€å¾Œé»é¸å„²å­˜é›¢é–‹ã€‚&lt;/p>
&lt;br>
&lt;h5>GitHub ä¸Šæ•´åˆ Jenkins&lt;span class="absolute -mt-20" id="github-ä¸Šæ•´åˆ-jenkins">&lt;/span>
&lt;a href="#github-%e4%b8%8a%e6%95%b4%e5%90%88-jenkins" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol>
&lt;li>
&lt;p>å…ˆåˆ° GitHub è¢«å»ºç½®å°ˆæ¡ˆçš„é é¢ä¸‹é» &lt;strong>Setting&lt;/strong> æ¨™ç±¤ &amp;gt; é»é¸å·¦é‚Šçš„ &lt;strong>Webhook&lt;/strong> &amp;gt; é»é¸å³ä¸Šè§’çš„ &lt;strong>Add webhook&lt;/strong> &amp;gt; è¼¸å…¥ &lt;strong>Jenkins Hook URL&lt;/strong> åˆ° Payload URLï¼š&lt;/p>
&lt;p>è¨˜å¾— Jenkins Hook URL å¾Œé¢è¦åŠ  &lt;code>/github-webhook/&lt;/code>ï¼Œå°å¼Ÿæˆ‘å¡åœ¨é€™è£¡å¾ˆä¹… ğŸ˜¢ ğŸ˜¢&lt;/p>
&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_10.png"
alt="Webhooks è¨­å®š" width="800">&lt;figcaption>
&lt;p>Webhooks è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ul>
&lt;li>Jenkins Hook URL è¨­å®š&amp;quot;&lt;/li>
&lt;/ul>
&lt;p>ç”±æ–¼æˆ‘å€‘æ˜¯å°‡ Jenkins é‹è¡Œåœ¨æœ¬æ©Ÿç«¯ï¼Œæ‰€ä»¥ Jenkins Hook URL &lt;code>http://localhost:8080&lt;/code> æ˜¯ Private IPã€‚GitHub æ²’æœ‰è¾¦æ³•æŠ“ Private IPï¼Œç‚ºäº†ç·´ç¿’ï¼Œæˆ‘å€‘å¯ä»¥é€é &lt;a href="https://ngrok.com/" target="_blank" rel="noopener">ngrok&lt;/a> é€™å¥—ç°¡å–®å°å·¥å…·ä¾†æš«æ™‚å°‡ &lt;code>http://localhost:8080&lt;/code> è®Šæˆ Public IPã€‚&lt;/p>
&lt;p>&lt;a href="https://ngrok.com/" target="_blank" rel="noopener">ngrok&lt;/a> çš„ä½¿ç”¨æ–¹å¼å¾ˆç°¡å–®ï¼Œåªè¦å…ˆä¸‹è¼‰ &lt;code>brew install ngrok/ngrok/ngrok&lt;/code> ï¼Œä¸¦ä½¿ç”¨ &lt;code>ngrok http 8080&lt;/code> æŒ‡ä»¤ï¼Œå°‡ Private IP è®Šæˆ Public IPï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_11.png"
alt="ngrok å°‡ Private IP è®Šæˆ Public IP" width="1000">&lt;figcaption>
&lt;p>ngrok å°‡ Private IP è®Šæˆ Public IP&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>åœ–ç‰‡ä¸­ &lt;code>https://2063-111-235-135-57.jp.ngrok.io&lt;/code> å°±æ˜¯ Public çš„ Jenkins Hook URL&lt;/p>
&lt;br>
&lt;p>å®Œæˆå¾Œï¼Œå…ˆé»é¸ &lt;strong>Recent Deliveries&lt;/strong> æª¢æŸ¥æ˜¯å¦æˆåŠŸï¼Œåº•ä¸‹çš„ Response éœ€è¦æ˜¯ &lt;font color=green>200&lt;/font>ï¼Œæ‰æ˜¯å°çš„æ­ï¼(é€™è£¡ä¸€å®šè¦å…ˆæª¢æŸ¥ï¼Œä¸ç„¶å¾Œé¢æœƒæ‰¾å•é¡Œåˆ°æ­» XD)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/setting_12.png"
alt="Webhooks è¨­å®š" width="1000">&lt;figcaption>
&lt;p>Webhooks è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ¸¬è©¦&lt;span class="absolute -mt-20" id="æ¸¬è©¦">&lt;/span>
&lt;a href="#%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æˆ‘å€‘éƒ½è¨­å®šå¥½å¾Œï¼Œè¦é–‹å§‹ä¾†æ¸¬è©¦ï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥å…ˆé»é¸ &lt;strong>é¦¬ä¸Šå»ºç½®&lt;/strong>ï¼Œä¾†æ¸¬è©¦æ˜¯å¦å¯ä»¥é€é &lt;strong>GitHub personal access token&lt;/strong>ï¼ŒæŠ“å– GitHub çš„æª”æ¡ˆã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/test_1.png"
alt="é¦¬ä¸Šå»ºç½®" width="800">&lt;figcaption>
&lt;p>é¦¬ä¸Šå»ºç½®&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°åœ¨å»ºç½®æµç¨‹é‚£é‚Šç™¼ç¾å»ºç½®å¤±æ•—ï¼Œé»é€²å»å¯ä»¥çœ‹è©³ç´°å…§å®¹ï¼Œ&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/test_2.png"
alt="å»ºç½®å¤±æ•—" width="800">&lt;figcaption>
&lt;p>å»ºç½®å¤±æ•—&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é»é¸å·¦å´çš„ &lt;strong>Console Output&lt;/strong>ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘å€‘æœ‰æˆåŠŸç²å– GitHub ä¸Šå¾—å°ˆæ¡ˆï¼Œä¸¦ä¸”åŸ·è¡Œæˆ‘å€‘çš„ Shell ä¾†æª¢æŸ¥ yaml çš„æª”æ¡ˆæ ¼å¼ï¼Œç™¼ç¾æ˜¯å› ç‚ºæ ¼å¼æœ‰éŒ¯èª¤ï¼Œæ‰€ä»¥å»ºç½®æ‰æœƒå¤±æ•— âŒ&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/test_3.png"
alt="Console Output" width="1000">&lt;figcaption>
&lt;p>Console Output&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ¥ä¸‹ä¾†æˆ‘å€‘å…ˆä¿®æ”¹ä¸€ä¸‹ yaml çš„æª”æ¡ˆï¼Œå¾Œé‡æ–° push åˆ° Github ä¸Šï¼Œä¸¦è§€å¯Ÿ Jenkins æœƒä¸æœƒè‡ªå‹•å»ºç½® ï¼(ä¿®æ”¹ä½ç½®å¤§å®¶å¯ä»¥ç›´æ¥çœ‹ &lt;a href="https://github.com/880831ian/jenkins-github-tg-bot/commit/729556412ef8796477a351040604aad8c8083c05" target="_blank" rel="noopener">Commit çµæœ&lt;/a>)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/test_4.png"
alt="Console Output" width="1000">&lt;figcaption>
&lt;p>Console Output&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>ç•¶ä½  push å®Œå¾Œï¼Œç™¼ç¾å®ƒæœƒè‡ªå‹•å»ºç½®ï¼Œè«‹å› ç‚ºæˆ‘å€‘ä¿®æ”¹æˆæ­£ç¢ºæ ¼å¼ï¼Œæ‰€ä»¥ä»–ä¹Ÿå»ºç½®æˆåŠŸå›‰ï¼&lt;/p>
&lt;br>
&lt;p>ä¹Ÿå¯ä»¥é»é¸å·¦å´æœ‰ä¸€å€‹æ–°çš„ &lt;strong>GitHub Hook Log&lt;/strong> ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘å€‘æˆåŠŸé€é &lt;strong>GitHub hook trigger for GITScm polling&lt;/strong> åµæ¸¬åˆ°æœ‰æ–°çš„ eventï¼Œé€é WebHook è®“ Jenkins çŸ¥é“ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/test_5.png"
alt="GitHub Hook Log" width="1000">&lt;figcaption>
&lt;p>GitHub Hook Log&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>å»ºç½®å¾Œè§¸ç™¼é€šçŸ¥&lt;span class="absolute -mt-20" id="å»ºç½®å¾Œè§¸ç™¼é€šçŸ¥">&lt;/span>
&lt;a href="#%e5%bb%ba%e7%bd%ae%e5%be%8c%e8%a7%b8%e7%99%bc%e9%80%9a%e7%9f%a5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç•¶æˆ‘å€‘è‡ªå‹•å»ºç½®æˆåŠŸç•¶ç„¶æ²’ä»€éº¼å•é¡Œï¼Œä½†å¦‚æœå¤±æ•—æœ‰å¯èƒ½å°±æœƒå½±éŸ¿å¾ŒçºŒç¨‹å¼çš„ä¸Šç·šæ™‚é–“ï¼Œæ‰€ä»¥æˆ‘å€‘å¸Œæœ›å»ºç½®å®Œæˆå¾Œï¼Œå¯ä»¥æ”¶åˆ°é€šçŸ¥ï¼Œé€šçŸ¥é™¤äº†å¯ä»¥ç”¨ email ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¥—ä»¶å»ä¸²æ¥æˆ‘å€‘å¸¸ç”¨çš„å¹³å°ï¼Œä¾‹å¦‚ Telegramã€Slackã€Line ç­‰ç­‰ï¼Œæ¥ä¸‹ä¾†æˆ‘æœƒæ•™å¤§å®¶è¦æ€éº¼å»ä¸²æ¥é€™äº›æœå‹™ï¼Œåœ¨é–‹å§‹ä¹‹å‰è¦è«‹å¤§å®¶å…ˆå®‰è£å…©å€‹å¥—ä»¶ï¼š&lt;/p>
&lt;h4>å®‰è£/è¨­å®š Build Timestamp&lt;span class="absolute -mt-20" id="å®‰è£è¨­å®š-build-timestamp">&lt;/span>
&lt;a href="#%e5%ae%89%e8%a3%9d%e8%a8%ad%e5%ae%9a-build-timestamp" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;a href="https://plugins.jenkins.io/build-timestamp/" target="_blank" rel="noopener">Build Timestamp&lt;/a> é€™å€‹å¥—ä»¶å¯ä»¥å¹«æˆ‘å€‘åœ¨ç¨å¾Œå‚³é€é€šçŸ¥æ™‚åŠ ä¸Šç•¶ä¸‹çš„æ™‚é–“æˆ³ï¼Œé‚£è¦æ€éº¼å®‰è£å¥—ä»¶å‘¢ï¼Ÿå…ˆåˆ°å„€è¡¨æ¿é¦–é ï¼Œé»é¸å·¦å´çš„ &lt;strong>ç®¡ç† Jenkins&lt;/strong> &amp;gt; é»é¸ &lt;strong>ç®¡ç†å¤–æ›ç¨‹å¼&lt;/strong>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_1.png"
alt="ç®¡ç† Jenkins &amp;amp;gt; ç®¡ç†å¤–æ›ç¨‹å¼" width="1200">&lt;figcaption>
&lt;p>ç®¡ç† Jenkins &amp;gt; ç®¡ç†å¤–æ›ç¨‹å¼&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å† Plugin Manager çš„ å¯ç”¨çš„è£¡é¢æœå°‹ Build Timestampï¼Œé¸æ“‡å¾Œé»ä¸‹æ–¹çš„ &lt;strong>Download now and install after restart&lt;/strong>ï¼Œç­‰å¾…ä»–å®‰è£å¾Œæœƒè‡ªå‹•é‡å•Ÿã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_2.png"
alt="å®‰è£ Build Timestamp" width="1200">&lt;figcaption>
&lt;p>å®‰è£ Build Timestamp&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é‡å•Ÿå¾Œå¾å„€è¡¨æ¿é»é¸å·¦å´ &lt;strong>ç®¡ç† Jenkins&lt;/strong> &amp;gt; é»é¸ &lt;strong>è¨­å®šç³»çµ±&lt;/strong>ï¼Œæ‰¾åˆ° &lt;strong>Build Timestamp&lt;/strong>ï¼Œé–‹å•Ÿè¨­å®šï¼Œä¸¦è¨­å®š Timezone ç‚º &lt;code>Asia/Taipei&lt;/code> ä»¥åŠ pattern &lt;code>yyyy-MM-dd HH:mm:ss z&lt;/code>ï¼Œé€™æ¨£æˆ‘å€‘å¾…æœƒå°±å¯ä»¥ä½¿ç”¨ &lt;code>BUILD_TIMESTAMP&lt;/code> åƒæ•¸ä¾†ç²å–ç•¶ä¸‹æ™‚é–“ï¼Œè¨˜å¾—è¦æŒ‰ä¸‹å„²å­˜æ­ï¼&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_3.png"
alt="è¨­å®š Build Timestamp" width="1200">&lt;figcaption>
&lt;p>è¨­å®š Build Timestamp&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h4>å®‰è£/è¨­å®š Notify.Events&lt;span class="absolute -mt-20" id="å®‰è£è¨­å®š-notifyevents">&lt;/span>
&lt;a href="#%e5%ae%89%e8%a3%9d%e8%a8%ad%e5%ae%9a-notifyevents" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;a href="https://plugins.jenkins.io/notify-events/" target="_blank" rel="noopener">Notify.Events&lt;/a> é€™å€‹å¥—ä»¶å¯ä»¥ä¸²æ¥å¾ˆå¤šçš„å¹³å°ï¼Œä¾‹å¦‚ Telegramã€Slackã€Line ç­‰ï¼Œä¹Ÿå¯ä»¥é€éå®ƒå¯„ç™¼éƒµä»¶ï¼Œæ˜¯ä¸€å€‹ååˆ†æ–¹ä¾¿çš„å¥—ä»¶ï¼Œä½†ç¼ºé»æ˜¯ä»–éœ€è¦è¨»å†Šï¼Œå…è²»ç‰ˆåªæœ‰æ¯å€‹æœˆ 300 æ¬¡çš„è¨Šæ¯å‚³è¼¸é‡ï¼Œä½†åœ¨æˆ‘å€‘æ¸¬è©¦éšæ®µå·²ç¶“ååˆ†å¤ ç”¨ã€‚ä¸€æ¨£æˆ‘å€‘ç”¨å‰›å‰›çš„æ–¹æ³•å®‰è£ &lt;strong>Notify.Events&lt;/strong>ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_4.png"
alt="å®‰è£ Notify.Events" width="1200">&lt;figcaption>
&lt;p>å®‰è£ Notify.Events&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å®‰è£å¥½å¾Œï¼ŒNotify.Events ä»–ä¸éœ€è¦å…ˆè¨­å®šï¼Œå®ƒå¯ä»¥ä¾æ“šä¸åŒçš„ Job æœ‰ä¸åŒçš„è¨­å®šï¼Œæ‰€ä»¥æˆ‘å€‘é–‹å•Ÿå‰›å‰›çš„ Job çµ„æ…‹ï¼Œæ‹‰åˆ°æœ€ä¸‹é¢æ‰¾åˆ° &lt;strong>å»ºç½®å¾Œå‹•ä½œ&lt;/strong> ï¼Œé¸æ“‡ &lt;strong>Notify.Events&lt;/strong>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_5.png"
alt="å®‰è£ Notify.Events" width="1200">&lt;figcaption>
&lt;p>å®‰è£ Notify.Events&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯ä»¥çœ‹åˆ°é€™é‚Šè¦å…ˆè¼¸å…¥ Tokenï¼Œé‚£ Token å°±å¿…é ˆå»å®˜ç¶²è¨»å†Šå¾Œè¨­å®šã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å…ˆé–‹å•Ÿç€è¦½å™¨ï¼Œæœå°‹ &lt;a href="https://notify.events/en" target="_blank" rel="noopener">Notify.Events&lt;/a>ï¼Œè¨»å†Šå¸³è™Ÿå¾Œï¼Œåœ¨ Channels é»é¸ &lt;strong>Create&lt;/strong>ï¼Œè¼¸å…¥ä¸€ä¸‹ Title æŒ‰ä¸‹ &lt;strong>Save&lt;/strong>ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_6.png"
alt="Notify.Events å®˜ç¶²è¨­å®š" width="1200">&lt;figcaption>
&lt;p>Notify.Events å®˜ç¶²è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å®Œæˆå¾Œï¼Œæ‡‰è©²å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ç•«é¢ï¼Œé€™é‚Šå°±å¯ä»¥è®“æˆ‘å€‘é¸æ“‡ä¾†æºï¼Œä»¥åŠè¦ç™¼é€åˆ°å“ªè£¡ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_7.png"
alt="Notify.Events å®˜ç¶²è¨­å®š" width="1200">&lt;figcaption>
&lt;p>Notify.Events å®˜ç¶²è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æˆ‘å€‘å…ˆé¸æ“‡ Sourcesï¼Œé»é¸ &lt;strong>Add source&lt;/strong>ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šä¾†æºï¼Œé¸æ“‡ &lt;strong>CI/CD and Version control&lt;/strong> ï¼Œå†é¸æ“‡ &lt;strong>Jenkins&lt;/strong>ï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_8.png"
alt="Notify.Events å®˜ç¶²è¨­å®š" width="1200">&lt;figcaption>
&lt;p>Notify.Events å®˜ç¶²è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é»é¸ &lt;strong>Next&lt;/strong>ï¼Œå°±å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ç•«é¢ï¼Œå®ƒå‘Šè¨´æˆ‘å€‘è¦å°‡å®ƒæä¾›çš„ &lt;code>Token&lt;/code> è²¼å…¥è¨­å®šæª”ï¼Œä¹Ÿå°±æ˜¯æˆ‘å€‘å‰›å‰›åœ¨ Job çµ„æ…‹è£¡é¢çš„é‚£å€‹ Tokenï¼š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_9.png"
alt="Notify.Events å®˜ç¶²è¨­å®š" width="1200">&lt;figcaption>
&lt;p>Notify.Events å®˜ç¶²è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>è¨­å®šå¥½ Sourcesï¼Œæ¥ä¸‹ä¾†è¦è¨­å®šæ¥æ”¶æ–¹ï¼Œå›åˆ°å‰›å‰› Notify.Events çš„å„€è¡¨æ¿ï¼Œé»é¸ &lt;strong>Subscribe&lt;/strong>ï¼Œæˆ‘å€‘æ¸¬è©¦ä½¿ç”¨ Telegram ä¾†ç•¶æ¥æ”¶æ–¹ï¼Œå®ƒæœƒè·³å‡ºä¸€å€‹è¦–çª—ï¼Œå‘Šè¨´ä½ è¦æ€éº¼æŠŠä»–çš„æ©Ÿå™¨äººåŠ æˆå¥½å‹æˆ–æ˜¯åŠ å…¥ç¾¤çµ„ï¼Œé€™é‚Šå°±ä¾å¤§å®¶éœ€è¦è‡ªè¡Œé¸æ“‡ï¼Œé‚£æˆ‘å°±å°‡å®ƒåŠ å…¥ç¾¤çµ„ï¼Œä½¿ç”¨ &lt;code>/subscribe DRr0bIZ0 @NotifyEventsBot&lt;/code> æŒ‡ä»¤ä¾†ç¶å®š&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_10.png"
alt="Notify.Events å®˜ç¶²è¨­å®š" width="1200">&lt;figcaption>
&lt;p>Notify.Events å®˜ç¶²è¨­å®š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>é€™æ™‚å€™æˆ‘å€‘éƒ½è¨­å®šå¥½äº†ï¼Œæˆ‘å€‘å›åˆ° Job çµ„æ…‹çš„ Notify.Events è¨­å®šä½ç½®ï¼Œå°‡ Token è²¼ä¸Šå»ï¼Œå®ƒå¯ä»¥è‡ªè¨‚è¨Šæ¯çš„æ¨¡æ¿ï¼Œå¯ä»¥å…¨éƒ¨éƒ½ä¸€æ¨£ï¼Œä¹Ÿå¯ä»¥é‡å°å»ºç½®å¾Œçš„ç‹€æ…‹ï¼Œç”¢ç”Ÿä¸åŒçš„è¨Šæ¯æ¨¡æ¿ï¼Œæˆ‘å€‘ä¾†è‡ªå®šç¾©è¨­è¨ˆä¸€ä¸‹ï¼š&lt;/p>
&lt;p>&lt;strong>Success&lt;/strong>&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ğŸ“¢ Jenkins å»ºç½®é€šçŸ¥ ğŸ“£
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ™‚é–“ï¼š$BUILD_TIMESTAMP ğŸ•
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>åç¨±ï¼š &amp;lt;a href&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$PROJECT_URL&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&amp;gt;$PROJECT_NAME&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ¬¡æ•¸ï¼š &amp;lt;a href&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$BUILD_URL&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&amp;gt;#$BUILD_NUMBER&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>å»ºç½®ç‹€æ…‹ï¼š ğŸŸ¢ &amp;lt;b&amp;gt;$BUILD_STATUS&amp;lt;/b&amp;gt; ğŸŸ¢
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;a href&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$BUILD_URL&lt;span style="color:#e6db74">/console&amp;#34;&lt;/span>&amp;gt;å»ºç½®æ—¥èªŒé€£çµ&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>--------- ğŸ˜ğŸ˜ğŸ˜ ---------&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_11.png"
alt="Notify.Events Success" width="1000">&lt;figcaption>
&lt;p>Notify.Events Success&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>&lt;strong>Failure&lt;/strong>&lt;/p>
&lt;div class="code-block relative mt-6 first:mt-0 group/code">&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>ğŸ“¢ Jenkins å»ºç½®é€šçŸ¥ ğŸ“£
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ™‚é–“ï¼š$BUILD_TIMESTAMP ğŸ•
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>åç¨±ï¼š &amp;lt;a href&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$PROJECT_URL&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&amp;gt;$PROJECT_NAME&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ¬¡æ•¸ï¼š &amp;lt;a href&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$BUILD_URL&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&amp;gt;#$BUILD_NUMBER&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>å»ºç½®ç‹€æ…‹ï¼š ğŸ”´ &amp;lt;b&amp;gt;$BUILD_STATUS&amp;lt;/b&amp;gt; ğŸ”´
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;a href&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$BUILD_URL&lt;span style="color:#e6db74">/console&amp;#34;&lt;/span>&amp;gt;å»ºç½®æ—¥èªŒé€£çµ&amp;lt;/a&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>--------- ğŸ˜­ğŸ˜­ğŸ˜­ ---------&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0">
&lt;button
class="code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50"
title="Copy code"
>
&lt;div class="group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;div class="hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_12.png"
alt="Notify.Events Failure" width="1000">&lt;figcaption>
&lt;p>Notify.Events Failure&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h4>Telegram é€šçŸ¥æ¸¬è©¦&lt;span class="absolute -mt-20" id="telegram-é€šçŸ¥æ¸¬è©¦">&lt;/span>
&lt;a href="#telegram-%e9%80%9a%e7%9f%a5%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æœ€å¾Œæˆ‘å€‘éƒ½è¨­å®šå¥½äº†ï¼Œå°±ä¾†æ¸¬è©¦ä¸€ä¸‹å§ï¼æˆ‘å€‘å…ˆæ•…æ„å°‡ç¨‹å¼ç¢¼æ ¼å¼ç”¨éŒ¯ï¼Œ&lt;a href="https://github.com/880831ian/jenkins-github-tg-bot/commit/e88d35d56f2b2d1b999682c0f748431999bb4b9e" target="_blank" rel="noopener">è®“ä»–å…ˆè·³å‡ºéŒ¯èª¤&lt;/a>ï¼Œ&lt;a href="https://github.com/880831ian/jenkins-github-tg-bot/commit/ec0e9f9c2148cecde6f70ec391d4c775fc180029" target="_blank" rel="noopener">å†ä¿®æ”¹&lt;/a>ï¼Œä¾†çœ‹çœ‹çµæœå¦‚ä½•å§ï¼(æ–‡å­—é€£çµæ˜¯å°æ‡‰çš„ Commit )&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/git-or-cicd/jenkins-github-tg-bot/trigger_13.png"
alt="Telegram é€šçŸ¥" width="600">&lt;figcaption>
&lt;p>Telegram é€šçŸ¥&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘å€‘åˆ†åˆ¥å…©æ¬¡çš„æ¸¬è©¦ï¼Œæœƒä¾æ“šæˆ‘å€‘å»ºç½®å¾Œçš„çµæœï¼Œè§¸ç™¼ä¸åŒçš„é€šçŸ¥æ¨¡æ¿ã€‚&lt;/p>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="absolute -mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://ithelp.ithome.com.tw/users/20103346/ironman/1473" target="_blank" rel="noopener">30 å¤©å…¥é–€ Ansible åŠ Jenkins&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://medium.com/@BuzonXXXX/ci-%E8%A8%AD%E5%AE%9Ajenkins%E9%80%A3%E7%B5%90github-private-repo-111c53d29047" target="_blank" rel="noopener">[CI]è¨­å®š jenkins é€£çµ GitHub Private Repo by Webhook&lt;/a>&lt;/p></description></item></channel></rss>