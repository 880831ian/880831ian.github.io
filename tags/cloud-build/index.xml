<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PIN-YI â€“ Cloud Build</title><link>https://pin-yi.me/tags/cloud-build/</link><description>Recent content in Cloud Build on PIN-YI</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><lastBuildDate>Wed, 06 Jul 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://pin-yi.me/tags/cloud-build/index.xml" rel="self" type="application/rss+xml"/><item><title>Google Cloud Platform (GCP) - Cloud Build</title><link>https://pin-yi.me/blog/gcp/cloud-build/</link><pubDate>Wed, 06 Jul 2022 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/cloud-build/</guid><description>
&lt;p>è·Ÿå¤§å®¶ä»‹ç´¹ä¸€ä¸‹ä»Šå¤©çš„ä¸»é¡Œ Cloud Buildï¼ŒCloud Build å¯ä»¥å¹«æˆ‘å€‘åšæŒçºŒå»ºæ§‹ã€æ¸¬è©¦å’Œéƒ¨ç½²ï¼Œæˆ‘å€‘å¯ä»¥æŠŠå®ƒæƒ³æˆç°¡æ˜“ç‰ˆçš„ Jenkinsï¼Œå¾žæ•´å€‹æ˜ åƒæª”æ¡ˆæ‰“åŒ…åˆ°éƒ¨ç½²ï¼Œä¹Ÿå°±å¹¾åˆ†é˜çš„äº‹æƒ…ï¼Œä¸”å…§å»ºè¨±å¤šæŒ‡ä»¤ã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘ä»Šå¤©æ–‡ç« ï¼Œéœ€è¦ä½¿ç”¨å‰å¹¾å¤©æåˆ°çš„ &lt;a href="https://pin-yi.me/blog/gcp/cloud-source-repositories/" >Cloud Source Repositories&lt;/a> ã€&lt;a href="https://pin-yi.me/blog/gcp/compute-engine/" >Compute Engine&lt;/a>ã€&lt;a href="https://pin-yi.me/blog/gcp/container-registry/" >Container Registry&lt;/a>ï¼Œæˆ‘å€‘éœ€è¦å…ˆé€éŽ GitLab å°‡ç¨‹å¼é¡åƒåˆ° Cloud Source Repositoriesï¼Œå†é€éŽ Cloud Build è§¸ç™¼å°‡ GitLab ä¸Šé¢çš„ Dockerfile å»ºç½®åˆ° Container Registry ä¸­ï¼Œå†éƒ¨ç½²åˆ° Compute Engine VM ä¸Šã€‚å¤§å®¶å¯ä»¥åƒè€ƒæµç¨‹åœ–ï¼Œæœƒæ›´æ¸…æ¥šä»Šå¤©çš„æµç¨‹ï¼é‚£æˆ‘å€‘å°±é–‹å§‹å›‰ ðŸ¥¸&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/1.webp"
alt="æµç¨‹åœ–" width="1200">&lt;figcaption>
&lt;p>æµç¨‹åœ–&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>Cloud Source Repositories æ¸¬è©¦&lt;span class="hx-absolute -hx-mt-20" id="cloud-source-repositories-æ¸¬è©¦">&lt;/span>
&lt;a href="#cloud-source-repositories-%e6%b8%ac%e8%a9%a6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å‰é¢ GitLab é¡åƒè¨­å®šï¼Œè«‹å…ˆåƒè€ƒä¸Šä¸Šç¯‡ &lt;a href="https://pin-yi.me/blog/gcp/cloud-source-repositories/" >Google Cloud Platform (GCP) - Cloud Source Repositories&lt;/a>ï¼Œä¸Šä¸Šç¯‡æœƒå¸¶å¤§å®¶å¾ž GitLab é¡åƒåˆ° Cloud Source Repositoriesï¼Œæ‰€ä»¥æˆ‘å€‘å°±æŽ¥çºŒä¹‹å‰çš„å…§å®¹ï¼Œç¹¼çºŒå¾€ä¸‹é–‹å§‹å­¸ç¿’å§ï½ž&lt;/p>
&lt;br>
&lt;ol>
&lt;li>é–‹å•Ÿ GCPï¼Œé¸æ“‡å·¦å´çš„ menu &amp;gt; é»žæ“Š &lt;strong>Cloud Build&lt;/strong> &amp;gt; é¸æ“‡ &lt;strong>è§¸ç™¼æ¢ä»¶&lt;/strong>ï¼Œé»žæ“Š &lt;strong>å»ºç«‹è§¸ç™¼æ¢ä»¶&lt;/strong> æŒ‰éˆ•ã€‚&lt;/li>
&lt;/ol>
&lt;br>
&lt;ol start="2">
&lt;li>è¼¸å…¥è§¸ç™¼æ¢ä»¶çš„åç¨±ï¼Œäº‹ä»¶å¯ä»¥è¨­å®šæˆ‘å€‘è¦æ€Žéº¼é€²è¡Œè§¸ç™¼ï¼Œæˆ‘å€‘é€™é‚Šå…ˆé¸æ“‡ &lt;strong>æŽ¨é€è‡³åˆ†æ”¯çš„ç‰ˆæœ¬&lt;/strong> ä¾†è§¸ç™¼ï¼Œåœ¨ä¾†æºé¸æ“‡ä¸Šä¸Šç¯‡å»ºç«‹å¥½çš„ Cloud Source Repositories å­˜æ”¾å€ï¼Œåˆ†æ”¯ç‰ˆæœ¬æˆ‘å€‘å…ˆä½¿ç”¨é è¨­çš„ masterï¼Œä¹Ÿå°±æ˜¯æŽ¨ç¨‹å¼åˆ° master ä»–æœƒå°±è§¸ç™¼ Cloud Buildï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/2.webp"
alt="å»ºç«‹è§¸ç™¼æ¢ä»¶ 1" width="900">&lt;figcaption>
&lt;p>å»ºç«‹è§¸ç™¼æ¢ä»¶ 1&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>è¨­å®šé¡žåž‹æˆ‘å€‘é¸æ“‡ Cloud Build è¨­å®šæª”ï¼Œä»–ä¹Ÿæ˜¯ Cloud Build å°ˆç”¨çš„è¨­å®šæª”ï¼Œå¾Œé¢æœƒå¸¶å¤§å®¶å¯«ä¸€ä»½ Cloud Buildï¼Œä½ç½®ç•¶ç„¶æ˜¯ä½¿ç”¨æˆ‘å€‘ Cloud Source Repositories å­˜æ”¾å€ï¼Œä»¥åŠå¯ä»¥ä¾ç…§å°ˆæ¡ˆä¾†ä¿®æ”¹ cloudbuild.yaml æ”¾åœ¨å°ˆæ¡ˆçš„å“ªè£¡ï¼Œæœ€å¾Œéƒ½æ²’å•é¡Œï¼Œå°±æŒ‰ä¸‹å»ºç«‹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/3.webp"
alt="å»ºç«‹è§¸ç™¼æ¢ä»¶ 2" width="900">&lt;figcaption>
&lt;p>å»ºç«‹è§¸ç™¼æ¢ä»¶ 2&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h3>æ’°å¯« cloudbuild.yaml è¨­å®šæª”&lt;span class="hx-absolute -hx-mt-20" id="æ’°å¯«-cloudbuildyaml-è¨­å®šæª”">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab-cloudbuildyaml-%e8%a8%ad%e5%ae%9a%e6%aa%94" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨é–‹å§‹å»ºç«‹æª”æ¡ˆå‰ï¼Œå…ˆä¾†è·Ÿå¤§å®¶èªªèªªæª”æ¡ˆå…§æœ‰å“ªäº›è¨­å®šå§ï¼š&lt;/p>
&lt;br>
&lt;p>é¦–å…ˆ Cloud Build å»ºæ§‹å™¨æ˜¯è£æœ‰å¸¸ç”¨çš„ç¨‹å¼èªžè¨€å’Œå·¥å…·çš„å®¹å™¨æ˜ åƒã€‚æˆ‘å€‘å¯ä»¥é…ç½® Cloud Buildï¼Œè®“å»ºæ§‹å™¨ä¸­é‹è¡Œç‰¹å®šå‘½ä»¤ï¼Œæˆ‘èˆ‰å€‹ä¾‹å­è®“å¤§å®¶äº†è§£ï¼š&lt;/p>
&lt;p>ä»¥ä¸‹ç¨‹å¼ç¢¼æ˜¯ä¾†è‡ª &lt;a href="https://hub.docker.com/search?q=&amp;amp;type=image" target="_blank" rel="noopener">Docker Hub&lt;/a> çš„ &lt;code>ubnutu&lt;/code> æ˜ åƒæª”ä¸­æ‰€åŸ·è¡Œçš„å‘½ä»¤ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">steps&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ubuntu&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;echo&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;hello world&amp;#34;&lt;/span>]&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘å€‘é…ç½®æ–‡ä»¶ä¸­ &lt;code>steps&lt;/code> åƒæ•¸æ˜¯æŒ‡æˆ‘å€‘è¦å»ºæ§‹çš„æ­¥é©Ÿï¼Œ &lt;code>name&lt;/code> å­—æ®µæŒ‡å®š Docker æ˜ åƒæª”çš„ä½ç½®ï¼Œä»¥åŠ &lt;code>args&lt;/code> å­—æ®µä¸­æ˜¯æŒ‡å®šæ˜ åƒæª”é‹è¡Œçš„å‘½ä»¤ã€‚&lt;/p>
&lt;p>æˆ‘å€‘çš„ Cloud Build ä¸€æ¨£æœƒéœ€è¦ç”¨ &lt;code>name&lt;/code> ä¾†æŒ‡å®šå»ºæ§‹å®¹å™¨çš„æ˜ åƒæª”ï¼Œä»¥åŠä½¿ç”¨ &lt;code>args&lt;/code> ä¾†åŸ·è¡Œæˆ‘å€‘æ˜ åƒæª”æ‰€è¦é‹è¡Œçš„å‘½ä»¤ã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘çš„ Cloud Build è¨­å®šæª”ä¸­çš„ &lt;code>name&lt;/code> å¸¸ç”¨çš„å»ºæ§‹å™¨æ˜ åƒæª”å¦‚ä¸‹ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">Builder&lt;/th>
&lt;th style="text-align: center">åç¨±&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">bazel&lt;/td>
&lt;td style="text-align: center">gcr.io/cloud-builders/bazel&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">docker&lt;/td>
&lt;td style="text-align: center">gcr.io/cloud-builders/docker&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">git&lt;/td>
&lt;td style="text-align: center">gcr.io/cloud-builders/git&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">gcloud&lt;/td>
&lt;td style="text-align: center">gcr.io/cloud-builders/gcloud&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">gke-deploy&lt;/td>
&lt;td style="text-align: center">gcr.io/cloud-builders/gke-deploy&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;br>
&lt;p>æŽ¥è‘—æˆ‘å€‘ä¾†è©¦è‘—å¯«ä¸€å€‹ cloudbuild.yaml ä¾†å»ºæ§‹æˆ‘å€‘çš„ nginx æœå‹™ï¼Œä¸¦éƒ¨ç½²åˆ° Compute Engine ä¸Šã€‚&lt;/p>
&lt;br>
&lt;p>æˆ‘å€‘å…ˆå›žåˆ° Gitlab è©²å°ˆæ¡ˆä¸‹çš„ç›®éŒ„ï¼Œæ–°å¢ž cloudbuild.yaml æª”æ¡ˆï¼Œå°‡è¤‡è£½ä»¥ä¸‹å…§å®¹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">steps&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Docker Build&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcr.io/cloud-builders/docker&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;build&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;-t&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;gcr.io/$PROJECT_ID/ian-test:ian-nginx-test&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Docker Push&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcr.io/cloud-builders/docker&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;push&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;gcr.io/$PROJECT_ID/ian-test:ian-nginx-test&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Build VM&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcr.io/google.com/cloudsdktool/cloud-sdk&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">entrypoint&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;gcloud&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">args&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;compute&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;instances&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;create-with-container&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;ian-test-vm&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;--container-image&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;gcr.io/$PROJECT_ID/ian-test:ian-nginx-test&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;CLOUDSDK_COMPUTE_REGION=asia-east1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;CLOUDSDK_COMPUTE_ZONE=asia-east1-b&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æˆ‘å€‘ä¸€å€‹ä¸€å€‹ä¾†èªªèªªçš„é€™å€‹ cloudbuild.yaml è£¡é¢çš„è¨­å®šå§ï¼(æˆ‘ä»¥å‰é¢çš„è¨»è§£ä¾†å€åˆ†)&lt;/p>
&lt;ul>
&lt;li>Docker Buildï¼šé€™é‚Šçš„ &lt;code>name&lt;/code> æˆ‘å€‘ç”¨ &lt;code>gcr.io/cloud-builders/docker&lt;/code>ï¼Œä»£è¡¨æˆ‘å€‘å°‡ä½¿ç”¨ docker å»ºæ§‹å™¨ï¼Œ&lt;code>args&lt;/code> é€™é‚Šä¸‹çš„æ„æ€æ˜¯è¦æŠŠèˆ‡ cloudbuild.yaml æ”¾åœ¨ä¸€èµ·çš„ Dokcerfile çµ¦ build èµ·ä¾†ï¼Œä¸¦æ”¹åç‚º gcr.io/$PROJECT_ID/ian-test:ian-nginx-testã€‚&lt;/li>
&lt;li>Docker Pushï¼šé€™é‚Šä¸€æ¨£ä½¿ç”¨ &lt;code>gcr.io/cloud-builders/docker&lt;/code>ï¼Œ&lt;code>args&lt;/code> æŒ‡ä»¤éƒ¨åˆ†è®Šæˆæˆ‘å€‘è¦æŠŠä»– push åˆ° gcr.io/$PROJECT_ID/ian-test é€™å€‹ Cloud Source Repositoriesï¼Œå…¶ä¸­é€™å€‹æ˜ åƒæª”æ¡ˆçš„ tag ç‚º ian-nginx-testã€‚&lt;/li>
&lt;li>Build VMï¼šé€™é‚Šæˆ‘å€‘ä½¿ç”¨ &lt;code>gcr.io/google.com/cloudsdktool/cloud-sdk&lt;/code>ï¼Œå¯ä»¥é€éŽå®ƒä¾†å»ºç«‹ VMï¼Œä¸¦ä¸”åŸ·è¡Œ tag åç‚º ian-nginx-test çš„æ˜ åƒæª”ï¼Œå¾Œé¢ç’°å¢ƒè®Šæ•¸æ˜¯ä¾†è¨­å®š VM çš„å€åŸŸç­‰ç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;br>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-rounded-lg hx-border hx-py-2 ltr:hx-pr-4 rtl:hx-pl-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-orange-100 hx-bg-orange-50 hx-text-orange-800 dark:hx-border-orange-400/30 dark:hx-bg-orange-400/20 dark:hx-text-orange-300">
&lt;div class="ltr:hx-pl-3 ltr:hx-pr-2 rtl:hx-pr-3 rtl:hx-pl-2">&lt;/div>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;code>ian-test&lt;/code> æ˜¯ Container Registry è³‡æ–™å¤¾åç¨±ï¼Œ&lt;code>ian-nginx-test&lt;/code> æ˜¯ Container Registry æ˜ åƒæª”çš„ tagï¼Œ&lt;code>ian-test-vm&lt;/code> æ˜¯æˆ‘å€‘å»ºç«‹ VM çš„åå­—ï¼Œæ‰€ä»¥è¦è¨˜å¾—æ”¹æˆè‡ªå·±çš„å‘½åæ­ï¼&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h3>æ’°å¯« Dockerfile&lt;span class="hx-absolute -hx-mt-20" id="æ’°å¯«-dockerfile">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab-dockerfile" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æŽ¥ä¸‹ä¾†å‰›å‰›æœ‰æåˆ° Docker Build æœƒå°‡æˆ‘å€‘æ”¾åœ¨ä¸€èµ·çš„ Dockerfile çµ¦ build èµ·ä¾†ï¼Œæ‰€ä»¥æˆ‘å€‘ä¹Ÿè¦å…ˆå¯«å¥½è¦ç”¨çš„ Dockerfileï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Dockerfile" data-lang="Dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> nginx:latest&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> ./index.html /usr/share/nginx/html/&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>æˆ‘å€‘çš„ Dockerfile å¾ˆç°¡å–®ï¼Œç°¡å–®å¯«äº†è¦ä½¿ç”¨çš„æ˜ åƒæª”ï¼Œä»¥åŠå°‡æˆ‘å€‘ç­‰ç­‰è¦æ¸¬è©¦çš„ index è¤‡è£½åˆ°è£¡é¢&lt;/p>
&lt;br>
&lt;h3>æ’°å¯«æ¸¬è©¦ index.html&lt;span class="hx-absolute -hx-mt-20" id="æ’°å¯«æ¸¬è©¦-indexhtml">&lt;/span>
&lt;a href="#%e6%92%b0%e5%af%ab%e6%b8%ac%e8%a9%a6-indexhtml" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">html&lt;/span> &lt;span style="color:#a6e22e">lang&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;en&amp;#34;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">head&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">meta&lt;/span> &lt;span style="color:#a6e22e">charset&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;UTF-8&amp;#34;&lt;/span> /&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">meta&lt;/span> &lt;span style="color:#a6e22e">http-equiv&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;X-UA-Compatible&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;IE=edge&amp;#34;&lt;/span> /&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">meta&lt;/span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;viewport&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">content&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&lt;/span> /&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">title&lt;/span>&amp;gt;æ¸¬è©¦æ¸¬è©¦æ¸¬è©¦&amp;lt;/&lt;span style="color:#f92672">title&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">head&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">body&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> æˆ‘æ˜¯æ¸¬è©¦æª”æ¡ˆ
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">body&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">html&lt;/span>&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;br>
&lt;p>é€™å€‹æ¸¬è©¦æª”æ¡ˆï¼Œæœƒè“‹éŽ nginx çš„é è¨­ç•«é¢ï¼Œç•¶æˆ‘å€‘æˆåŠŸå°‡ VM å»ºç«‹å¾Œï¼Œç€è¦½ 80 Port æ™‚ï¼Œæ‡‰è©²æœƒè·³å‡ºé€™å€‹æ¸¬è©¦çš„ç¶²é ã€‚&lt;/p>
&lt;br>
&lt;h3>Commit åˆ° GitLab&lt;span class="hx-absolute -hx-mt-20" id="commit-åˆ°-gitlab">&lt;/span>
&lt;a href="#commit-%e5%88%b0-gitlab" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç•¶æˆ‘å€‘éƒ½æ–°å¢žå¥½æª”æ¡ˆå¾Œï¼Œæˆ‘å€‘å°±å°‡ç¨‹å¼æŽ¨åˆ°æˆ‘å€‘å‰å¹¾ç¯‡çš„ Cloud Source Repositories å·²ç¶“é¡åƒçš„ GitLab ä¸­ï¼ŒæŽ¥è‘—å°±æ˜¯ç­‰å¾…è¦‹è­‰å¥‡è¹Ÿçš„æ™‚å€™äº†ï¼¸ï¼¤&lt;/p>
&lt;ol>
&lt;li>ç•¶æˆ‘å€‘æŽ¨é€å¾Œï¼Œæˆ‘å€‘å…ˆæª¢æŸ¥ Cloud Source Repositories æ˜¯å¦æœ‰æˆåŠŸå¾ž GitLab é¡åƒéŽä¾†ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/4.webp"
alt="Cloud Source Repositories" width="700">&lt;figcaption>
&lt;p>Cloud Source Repositories&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="2">
&lt;li>æª¢æŸ¥çœ‹çœ‹ Container Registry æ˜¯å¦å¤šäº†åç‚º &lt;code>ian-test&lt;/code> çš„è³‡æ–™å¤¾ï¼Œä¸”è£¡é¢æœ‰ä¸€å€‹ tag ç‚º &lt;code>ian-nginx-test&lt;/code> çš„æ˜ åƒæª”ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/5.webp"
alt="Container Registry" width="1000">&lt;figcaption>
&lt;p>Container Registry&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="3">
&lt;li>æª¢æŸ¥ä¸€ä¸‹ Cloud Build çš„è§¸ç™¼æ¢ä»¶æ˜¯ä¸æ˜¯åœ¨é‹ä½œï¼Œæœ€å¾ŒæˆåŠŸå¯ä»¥çœ‹åˆ°é¡žä¼¼ä¸‹æ–¹åœ–ç‰‡å…§å®¹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/6.webp"
alt="Cloud Build çš„è§¸ç™¼æ¢ä»¶" width="1200">&lt;figcaption>
&lt;p>Cloud Build çš„è§¸ç™¼æ¢ä»¶&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="4">
&lt;li>æª¢æŸ¥ Compute Engine çš„ VM æ˜¯å¦æœ‰æˆåŠŸè¢«å»ºç«‹ï¼š&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/7.webp"
alt="Compute Engine" width="1200">&lt;figcaption>
&lt;p>Compute Engine&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;ol start="5">
&lt;li>æœ€å¾Œå°±æ˜¯æ¸¬è©¦é€™å€‹æ˜ åƒæª”æ¡ˆï¼Œæ˜¯ä¸æ˜¯æˆ‘å€‘æ‰€ Build çš„ï¼Œæ¸¬è©¦æ–¹æ³•å¾ˆç°¡å–®ï¼Œæˆ‘å€‘å‰›å‰›åœ¨ Dockerfile æœ‰è¤‡è£½æˆ‘å€‘è‡ªå·±å¯«çš„ index.html æª”æ¡ˆï¼ŒåŽ»è“‹æŽ‰åŽŸæœ¬ nginx çš„é è¨­æª”ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥ç€è¦½ä¸Šé¢åœ–ç‰‡çš„å¤–éƒ¨ IPï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘å€‘æ‰€æ”¹çš„é é¢å›‰ï¼&lt;/li>
&lt;/ol>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/cloud-build/8.webp"
alt="æ¸¬è©¦ç”¨ index.html" width="700">&lt;figcaption>
&lt;p>æ¸¬è©¦ç”¨ index.html&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Cloud Builderï¼š&lt;a href="https://cloud.google.com/build/docs/cloud-builders" target="_blank" rel="noopener">https://cloud.google.com/build/docs/cloud-builders&lt;/a>&lt;/p>
&lt;p>Day27 - ç”¨ Cloud Build å¯¦ä½œ CI éƒ¨åˆ†ï¼š&lt;a href="https://ithelp.ithome.com.tw/articles/10224727" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10224727&lt;/a>&lt;/p></description></item></channel></rss>