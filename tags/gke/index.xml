<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PIN-YI â€“ GKE</title><link>https://pin-yi.me/tags/gke/</link><description>Recent content in GKE on PIN-YI</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><lastBuildDate>Fri, 10 Feb 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://pin-yi.me/tags/gke/index.xml" rel="self" type="application/rss+xml"/><item><title>Google Kubernetes Engine CronJob æœƒæœ‰çŸ­æš«æ™‚é–“æ²’æœ‰åŸ·è¡Œ Job</title><link>https://pin-yi.me/blog/gcp/gke-cronjob-not-working/</link><pubDate>Fri, 10 Feb 2023 00:00:00 +0000</pubDate><guid>https://pin-yi.me/blog/gcp/gke-cronjob-not-working/</guid><description>
&lt;p>å‰é™£å­å…¬å¸å»ºç«‹åœ¨ Google Kubernetes Engine å¢é›†ä¸Šçš„ CronJob æœå‹™æœƒæœ‰çŸ­æš«æ™‚é–“æ²’æœ‰åŸ·è¡Œ Jobã€‚å…ˆå‰æƒ…æè¦ä¸€ä¸‹ï¼Œæ­¤ CronJob çš„è¨­å®šæ˜¯æ¯åˆ†é˜éƒ½æœƒåŸ·è¡Œ (åœ–ä¸€)ï¼Œæ‰€ä»¥ç†ç•¶ä¾†èªª Log æ‡‰è©²è¦å¯ä»¥çœ‹åˆ°æ¯åˆ†é˜éƒ½æœ‰æ­¤ CronJob çš„ç´€éŒ„ï¼Œä½†æœ‰æ™‚å€™æœƒç™¼ç”Ÿ CronJob çŸ­æš«æ™‚é–“éƒ½æ²’æœ‰åŸ·è¡Œçš„ç‹€æ³ï¼Œæ‰¾äº†ä¸€é™£å­éƒ½æ²’æœ‰æ‰¾åˆ°åŽŸå› ï¼Œæœ€å¾Œé–‹æ”¯æ´å–®è«‹ Google é‚£é‚Šå”åŠ©æŸ¥çœ‹ï¼Œçµ‚æ–¼æ‰¾åˆ°åŽŸå› æ‹‰ ðŸ˜ã€‚é‚£å°±è·Ÿæˆ‘ä¸€èµ·çœ‹ä¸€ä¸‹ç™¼ç”Ÿçš„éŽç¨‹ï¼Œä»¥åŠ Google å¹«æˆ‘å€‘æ‰¾åˆ°çš„åŽŸå› ï¼Œä»¥åŠè¦å¦‚ä½•è§£æ±ºç­‰ç­‰ï½ž&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/1.webp"
alt="(åœ–ä¸€) CronJob schedule æ™‚é–“ç‚ºæ¯åˆ†é˜åŸ·è¡Œ" width="600">&lt;figcaption>
&lt;p>(åœ–ä¸€) CronJob schedule æ™‚é–“ç‚ºæ¯åˆ†é˜åŸ·è¡Œ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>å•é¡Œç™¼ç”Ÿä»¥åŠå•é¡ŒåŽŸå› &lt;span class="hx-absolute -hx-mt-20" id="å•é¡Œç™¼ç”Ÿä»¥åŠå•é¡ŒåŽŸå› ">&lt;/span>
&lt;a href="#%e5%95%8f%e9%a1%8c%e7%99%bc%e7%94%9f%e4%bb%a5%e5%8f%8a%e5%95%8f%e9%a1%8c%e5%8e%9f%e5%9b%a0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æˆ‘å€‘ä½¿ç”¨ Google Cloud Platform è£¡é¢çš„è¨˜éŒ„åŠŸèƒ½ï¼Œå¯ä»¥çœ‹åˆ° (åœ–äºŒ)ï¼Œåœ¨æ¯åˆ†é˜åŸ·è¡Œçš„ Log ä¸­ï¼Œæœ‰çŸ­æš«æ™‚é–“æ²’æœ‰åŸ·è¡Œ Jobï¼Œä½†é€™å€‹æ™‚é–“é™¤äº† CronJob ä»¥å¤–ï¼Œå…¶ä»–çš„æœå‹™éƒ½æ˜¯å¥½çš„ã€‚&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/2.webp"
alt="(åœ–äºŒ) Google Cloud Platform è¨˜éŒ„æœ‰çŸ­æš«æ²’æœ‰åŸ·è¡Œ" width="700">&lt;figcaption>
&lt;p>(åœ–äºŒ) Google Cloud Platform è¨˜éŒ„æœ‰çŸ­æš«æ²’æœ‰åŸ·è¡Œ&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æ‰¾äº†ä¸€é™£å­éƒ½æ²’æœ‰æ‰¾åˆ°åŽŸå› ï¼Œæ–¼æ˜¯æˆ‘å€‘é–‹æ”¯æ´å–®è«‹ Google é‚£é‚Šå”åŠ©æŸ¥çœ‹ï¼ŒGoogle é‚£é‚Šæ‰¾äº†ä¸€é™£å­å¾Œçµ‚æ–¼æ‰¾åˆ°åŽŸå› æ‹‰ï¼ï¼ï¼æˆ‘å€‘ä¸€èµ·ä¾†çœ‹çœ‹å§ (åœ–ä¸‰)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/3.webp"
alt="(åœ–ä¸‰) Google æ”¯æ´å–®å›žè¦†" width="700">&lt;figcaption>
&lt;p>(åœ–ä¸‰) Google æ”¯æ´å–®å›žè¦†&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>å°±å¦‚åŒ Google æ‰€èªªï¼Œä½¿ç”¨æä¾›çš„æŒ‡ä»¤åƒæ•¸ä¾†æŸ¥è©¢ï¼Œå¢é›†åœ¨è©²æ™‚æ®µæœ‰ç™¼ç”Ÿ master control plane çš„å‡ç´šï¼Œå¦‚ (åœ–å››)ï¼Œå†åŠ ä¸Šæˆ‘å€‘å»ºçš„é€™å€‹ cluster æ˜¯ä½¿ç”¨ zonal cluster (åœ–äº”)ï¼Œæ‰€ä»¥å¢é›†åªæœ‰ä¸€å€‹ control planeï¼Œç•¶ control plane åœ¨æ›´æ–°æ™‚ï¼Œæœƒç„¡æ³•éƒ¨ç½²æ–°çš„ workloadï¼Œå°Žè‡´è©² CronJob æ²’æœ‰åŸ·è¡Œ Jobã€‚åƒè€ƒè³‡æ–™ [1]&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/4.webp"
alt="(åœ–å››) ç™¼ç”Ÿ master control plane çš„å‡ç´š" width="700">&lt;figcaption>
&lt;p>(åœ–å››) ç™¼ç”Ÿ master control plane çš„å‡ç´š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/5.webp"
alt="(åœ–äº”) æœ‰å•é¡Œçš„å¢é›†ä½ç½®é¡žåž‹" width="450">&lt;figcaption>
&lt;p>(åœ–äº”) æœ‰å•é¡Œçš„å¢é›†ä½ç½®é¡žåž‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>Google çš„å»ºè­°æ˜¯å¯ä»¥è€ƒæ…®ä½¿ç”¨å¦ä¸€å€‹ regional clusterï¼Œè®“ master node åœ¨æ›´æ–°æ™‚ä¸æœƒåªåœ¨å–®ä¸€åœ°å€ï¼Œæˆ–æ˜¯ä¸€æ¨£ä½¿ç”¨èˆŠçš„ zonal clusterï¼Œé€éŽè¨­å®š Maintenance window æˆ–è€… Maintenance exclusions ä¾†é™ä½Žæœå‹™å—åˆ° workload çš„å½±éŸ¿ã€‚åƒè€ƒè³‡æ–™ [2]&lt;/p>
&lt;br>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-rounded-lg hx-border hx-py-2 ltr:hx-pr-4 rtl:hx-pl-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-orange-100 hx-bg-orange-50 hx-text-orange-800 dark:hx-border-orange-400/30 dark:hx-bg-orange-400/20 dark:hx-text-orange-300">
&lt;div class="ltr:hx-pl-3 ltr:hx-pr-2 rtl:hx-pr-3 rtl:hx-pl-2">&lt;/div>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;ol>
&lt;li>
&lt;p>å°±ç®—æŠŠ node_pool è£¡é¢çš„è‡ªå‹•å‡ç´šçµ¦åœæŽ‰ï¼Œä¹Ÿæ²’æœ‰è¾¦æ³•è§£æ±ºæ­¤å•é¡Œï¼å› ç‚ºæ­¤ master control plane (ä¹Ÿå°±æ˜¯ master node) çš„å‡ç´šï¼Œä¸æ˜¯ worker node çš„ node pool å‡ç´šï¼Œæ˜¯ç”± GKE è² è²¬ç¶­è­·çš„ï¼Œæ‰€ä»¥ä»–å€‘æœƒå®šæœŸå‡ç´š control planeï¼Œä¹Ÿæ²’è¾¦æ³•åœæ­¢æ­¤é¡žçš„å‡ç´šã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è‹¥å·²ç¶“å»ºç«‹å¥½ zonal cluster å¾Œï¼Œæƒ³è¦æ”¹æˆ regional cluster ï¼Œæ˜¯æ²’æœ‰è¾¦æ³•ä½¿ç”¨ä¿®æ”¹çš„æ–¹å¼ï¼Œä¸€å®šåªèƒ½é‡å»º clusterï¼Œæ‰€ä»¥å¤§å®¶åœ¨å»ºç«‹æ™‚è¦æ³¨æ„ï½ž&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;br>
&lt;h2>è§£æ±ºå•é¡Œ&lt;span class="hx-absolute -hx-mt-20" id="è§£æ±ºå•é¡Œ">&lt;/span>
&lt;a href="#%e8%a7%a3%e6%b1%ba%e5%95%8f%e9%a1%8c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æœ€å¾Œæˆ‘å€‘é¸æ“‡å°‡å¢é›†çµ¦æ•´å€‹é‡å»ºï¼Œä¾†ç¢ºä¿ CronJob ä¸æœƒæœ‰æ²’æœ‰åŸ·è¡Œåˆ°çš„ç‹€æ³ç™¼ç”Ÿï¼Œé‡å»ºå¢é›†è·Ÿæ¬æœå‹™çš„éŽç¨‹å¾ˆè¾›è‹¦çš„ ðŸ˜° å¸Œæœ›å¤§å®¶ä¸è¦ç™¼ç”Ÿ QQï¼Œæœ€å¾Œæˆ‘å€‘ä¾†çœ‹ä¸€ä¸‹é‡å»ºå®Œå¾Œï¼Œåœ¨ master control plane æ›´æ–°çš„æ™‚å€™ï¼Œé‚„æœƒä¸æœƒæœ‰ CronJob æ²’æœ‰åŸ·è¡Œçš„æƒ…æ³ç™¼ç”Ÿã€‚&lt;/p>
&lt;br>
&lt;p>æ–°å¢é›†ä½¿ç”¨ regional cluster ä¾†å»ºç«‹ï¼Œåœ¨ 2/1 ä¹Ÿæœ‰ master control plane çš„å‡ç´šã€‚ (åœ–å…­)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/6.webp"
alt="(åœ–å…­) ç™¼ç”Ÿ master control plane çš„å‡ç´š" width="700">&lt;figcaption>
&lt;p>(åœ–å…­) ç™¼ç”Ÿ master control plane çš„å‡ç´š&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;p>æŸ¥çœ‹ CronJob åŸ·è¡Œçš„ç´€éŒ„å¯ä»¥ç™¼ç¾ä¸¦æ²’æœ‰ Job æ²’æœ‰åŸ·è¡Œçš„æƒ…æ³ç™¼ç”Ÿã€‚ (åœ–ä¸ƒ)&lt;/p>
&lt;br>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/7.webp"
alt="(åœ–ä¸ƒ) å¢é›†ä½ç½®é¡žåž‹" width="700">&lt;figcaption>
&lt;p>(åœ–ä¸ƒ) å¢é›†ä½ç½®é¡žåž‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure>&lt;img src="https://pin-yi.me/gcp/gke-cronjob-not-working/8.webp"
alt="(åœ–å…«) æ–°å¢é›†ä½ç½®é¡žåž‹" width="450">&lt;figcaption>
&lt;p>(åœ–å…«) æ–°å¢é›†ä½ç½®é¡žåž‹&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;br>
&lt;h2>åƒè€ƒè³‡æ–™&lt;span class="hx-absolute -hx-mt-20" id="åƒè€ƒè³‡æ–™">&lt;/span>
&lt;a href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>[1] Standard cluster upgradesï¼š&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-upgrades" target="_blank" rel="noopener">https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-upgrades&lt;/a>&lt;/p>
&lt;p>[2] maintenance-windows-and-exclusionsï¼š&lt;a href="https://cloud.google.com/kubernetes-engine/docs/concepts/maintenance-windows-and-exclusions" target="_blank" rel="noopener">https://cloud.google.com/kubernetes-engine/docs/concepts/maintenance-windows-and-exclusions&lt;/a>&lt;/p></description></item></channel></rss>